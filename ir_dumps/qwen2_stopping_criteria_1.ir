[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  __call__ (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/stopping_criteria.py:534)
  __call__ (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/stopping_criteria.py:546)
  _sample (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:2455)
  generate (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1758)
  decorate_context (/workspaces/hug/hug/lib/python3.10/site-packages/torch/utils/_contextlib.py:116)
  <module> (/tmp/ipykernel_1456554/2982293035.py:14)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (6b7350cef848dc68638df698f371d508)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_sample@utils.py:2443, xla_shape=s64[]
  %1 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %2 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %3 = s64[] prim::Constant(), location=_sample@utils.py:2389, xla_shape=s64[]
  %4 = s64[1]{0} aten::expand(%3), location=_sample@utils.py:2389, xla_shape=s64[1]{0}
  %5 = s64[1]{0} aten::rsub(%4, %2, %1), scope=aten::rsub.545, location=__rsub__@_tensor.py:962, xla_shape=s64[1]{0}
  %6 = s64[] xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[]
  %7 = s64[1]{0} aten::mul(%6, %5), scope=aten::mul.546, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %8 = s64[] xla::device_data(), location=_sample@utils.py:2437, xla_shape=s64[]
  %9 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %10 = s64[] aten::mul(%9, %8), location=_sample@utils.py:2437, xla_shape=s64[]
  %11 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %12 = s64[] aten::add(%11, %10), location=_sample@utils.py:2437, xla_shape=s64[]
  %13 = f64[] xla::device_data(), location=__call__@logits_process.py:468, xla_shape=f64[]
  %14 = pred[] prim::Constant(), location=__call__@logits_process.py:464, xla_shape=pred[]
  %15 = pred[] aten::expand(%14), location=__call__@logits_process.py:464, xla_shape=pred[]
  %16 = pred[] aten::view(%15), location=__call__@logits_process.py:464, xla_shape=pred[]
  %17 = pred[1,1]{1,0} aten::expand(%16), location=__call__@logits_process.py:464, xla_shape=pred[1,1]{1,0}
  %18 = f64[] xla::device_data(), location=__call__@logits_process.py:462, xla_shape=f64[]
  %19 = f64[] xla::device_data(), location=__call__@logits_process.py:521, xla_shape=f64[]
  %20 = f32[] xla::device_data(), location=__call__@logits_process.py:292, xla_shape=f32[]
  %21 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %22 = s64[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %23 = s64[1,1,29]{2,1,0} aten::view(%22), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %24 = s64[1,1,29]{2,1,0} aten::expand(%23), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %25 = s64[1,29]{1,0} aten::view(%24), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,29]{1,0}
  %26 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %27 = bf16[3584,152064]{0,1} aten::permute(%26), location=forward@linear.py:117, xla_shape=bf16[3584,152064]{0,1}
  %28 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %29 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %30 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %31 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %32 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %33 = bf16[18944,3584]{0,1} aten::permute(%32), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %34 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %35 = bf16[3584,18944]{0,1} aten::permute(%34), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %36 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %37 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %38 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %39 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %40 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %41 = bf16[3584,3584]{0,1} aten::permute(%40), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %42 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %43 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %44 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %45 = bf16[3584,512]{0,1} aten::permute(%44), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %46 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %47 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %48 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %49 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %50 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %51 = bf16[18944,3584]{0,1} aten::permute(%50), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %52 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %53 = bf16[3584,18944]{0,1} aten::permute(%52), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %54 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %55 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %56 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %57 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %58 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %59 = bf16[3584,3584]{0,1} aten::permute(%58), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %60 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %61 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %62 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %63 = bf16[3584,512]{0,1} aten::permute(%62), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %64 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %65 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %66 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %67 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %68 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %69 = bf16[18944,3584]{0,1} aten::permute(%68), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %70 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %71 = bf16[3584,18944]{0,1} aten::permute(%70), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %72 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %73 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %74 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %75 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %76 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %77 = bf16[3584,3584]{0,1} aten::permute(%76), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %78 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %79 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %80 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %81 = bf16[3584,512]{0,1} aten::permute(%80), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %82 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %83 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %84 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %85 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %86 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %87 = bf16[18944,3584]{0,1} aten::permute(%86), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %88 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %89 = bf16[3584,18944]{0,1} aten::permute(%88), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %90 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %91 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %92 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %93 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %94 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %95 = bf16[3584,3584]{0,1} aten::permute(%94), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %96 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %97 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %98 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %99 = bf16[3584,512]{0,1} aten::permute(%98), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %100 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %101 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %102 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %103 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %104 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %105 = bf16[18944,3584]{0,1} aten::permute(%104), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %106 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %107 = bf16[3584,18944]{0,1} aten::permute(%106), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %108 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %109 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %110 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %111 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %112 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %113 = bf16[3584,3584]{0,1} aten::permute(%112), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %114 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %115 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %116 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %117 = bf16[3584,512]{0,1} aten::permute(%116), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %118 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %119 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %120 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %121 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %122 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %123 = bf16[18944,3584]{0,1} aten::permute(%122), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %124 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %125 = bf16[3584,18944]{0,1} aten::permute(%124), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %126 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %127 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %128 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %129 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %130 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %131 = bf16[3584,3584]{0,1} aten::permute(%130), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %132 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %133 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %134 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %135 = bf16[3584,512]{0,1} aten::permute(%134), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %136 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %137 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %138 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %139 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %140 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %141 = bf16[18944,3584]{0,1} aten::permute(%140), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %142 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %143 = bf16[3584,18944]{0,1} aten::permute(%142), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %144 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %145 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %146 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %147 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %148 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %149 = bf16[3584,3584]{0,1} aten::permute(%148), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %150 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %151 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %152 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %153 = bf16[3584,512]{0,1} aten::permute(%152), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %154 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %155 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %156 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %157 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %158 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %159 = bf16[18944,3584]{0,1} aten::permute(%158), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %160 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %161 = bf16[3584,18944]{0,1} aten::permute(%160), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %162 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %163 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %164 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %165 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %166 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %167 = bf16[3584,3584]{0,1} aten::permute(%166), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %168 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %169 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %170 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %171 = bf16[3584,512]{0,1} aten::permute(%170), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %172 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %173 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %174 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %175 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %176 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %177 = bf16[18944,3584]{0,1} aten::permute(%176), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %178 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %179 = bf16[3584,18944]{0,1} aten::permute(%178), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %180 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %181 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %182 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %183 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %184 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %185 = bf16[3584,3584]{0,1} aten::permute(%184), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %186 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %187 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %188 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %189 = bf16[3584,512]{0,1} aten::permute(%188), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %190 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %191 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %192 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %193 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %194 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %195 = bf16[18944,3584]{0,1} aten::permute(%194), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %196 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %197 = bf16[3584,18944]{0,1} aten::permute(%196), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %198 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %199 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %200 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %201 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %202 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %203 = bf16[3584,3584]{0,1} aten::permute(%202), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %204 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %205 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %206 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %207 = bf16[3584,512]{0,1} aten::permute(%206), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %208 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %209 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %210 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %211 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %212 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %213 = bf16[18944,3584]{0,1} aten::permute(%212), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %214 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %215 = bf16[3584,18944]{0,1} aten::permute(%214), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %216 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %217 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %218 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %219 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %220 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %221 = bf16[3584,3584]{0,1} aten::permute(%220), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %222 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %223 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %224 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %225 = bf16[3584,512]{0,1} aten::permute(%224), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %226 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %227 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %228 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %229 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %230 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %231 = bf16[18944,3584]{0,1} aten::permute(%230), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %232 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %233 = bf16[3584,18944]{0,1} aten::permute(%232), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %234 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %235 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %236 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %237 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %238 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %239 = bf16[3584,3584]{0,1} aten::permute(%238), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %240 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %241 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %242 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %243 = bf16[3584,512]{0,1} aten::permute(%242), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %244 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %245 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %246 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %247 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %248 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %249 = bf16[18944,3584]{0,1} aten::permute(%248), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %250 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %251 = bf16[3584,18944]{0,1} aten::permute(%250), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %252 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %253 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %254 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %255 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %256 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %257 = bf16[3584,3584]{0,1} aten::permute(%256), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %258 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %259 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %260 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %261 = bf16[3584,512]{0,1} aten::permute(%260), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %262 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %263 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %264 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %265 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %266 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %267 = bf16[18944,3584]{0,1} aten::permute(%266), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %268 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %269 = bf16[3584,18944]{0,1} aten::permute(%268), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %270 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %271 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %272 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %273 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %274 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %275 = bf16[3584,3584]{0,1} aten::permute(%274), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %276 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %277 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %278 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %279 = bf16[3584,512]{0,1} aten::permute(%278), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %280 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %281 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %282 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %283 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %284 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %285 = bf16[18944,3584]{0,1} aten::permute(%284), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %286 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %287 = bf16[3584,18944]{0,1} aten::permute(%286), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %288 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %289 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %290 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %291 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %292 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %293 = bf16[3584,3584]{0,1} aten::permute(%292), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %294 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %295 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %296 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %297 = bf16[3584,512]{0,1} aten::permute(%296), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %298 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %299 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %300 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %301 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %302 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %303 = bf16[18944,3584]{0,1} aten::permute(%302), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %304 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %305 = bf16[3584,18944]{0,1} aten::permute(%304), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %306 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %307 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %308 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %309 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %310 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %311 = bf16[3584,3584]{0,1} aten::permute(%310), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %312 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %313 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %314 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %315 = bf16[3584,512]{0,1} aten::permute(%314), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %316 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %317 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %318 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %319 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %320 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %321 = bf16[18944,3584]{0,1} aten::permute(%320), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %322 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %323 = bf16[3584,18944]{0,1} aten::permute(%322), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %324 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %325 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %326 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %327 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %328 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %329 = bf16[3584,3584]{0,1} aten::permute(%328), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %330 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %331 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %332 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %333 = bf16[3584,512]{0,1} aten::permute(%332), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %334 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %335 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %336 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %337 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %338 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %339 = bf16[18944,3584]{0,1} aten::permute(%338), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %340 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %341 = bf16[3584,18944]{0,1} aten::permute(%340), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %342 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %343 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %344 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %345 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %346 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %347 = bf16[3584,3584]{0,1} aten::permute(%346), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %348 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %349 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %350 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %351 = bf16[3584,512]{0,1} aten::permute(%350), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %352 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %353 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %354 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %355 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %356 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %357 = bf16[18944,3584]{0,1} aten::permute(%356), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %358 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %359 = bf16[3584,18944]{0,1} aten::permute(%358), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %360 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %361 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %362 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %363 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %364 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %365 = bf16[3584,3584]{0,1} aten::permute(%364), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %366 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %367 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %368 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %369 = bf16[3584,512]{0,1} aten::permute(%368), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %370 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %371 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %372 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %373 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %374 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %375 = bf16[18944,3584]{0,1} aten::permute(%374), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %376 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %377 = bf16[3584,18944]{0,1} aten::permute(%376), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %378 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %379 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %380 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %381 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %382 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %383 = bf16[3584,3584]{0,1} aten::permute(%382), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %384 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %385 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %386 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %387 = bf16[3584,512]{0,1} aten::permute(%386), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %388 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %389 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %390 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %391 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %392 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %393 = bf16[18944,3584]{0,1} aten::permute(%392), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %394 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %395 = bf16[3584,18944]{0,1} aten::permute(%394), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %396 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %397 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %398 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %399 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %400 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %401 = bf16[3584,3584]{0,1} aten::permute(%400), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %402 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %403 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %404 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %405 = bf16[3584,512]{0,1} aten::permute(%404), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %406 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %407 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %408 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %409 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %410 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %411 = bf16[18944,3584]{0,1} aten::permute(%410), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %412 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %413 = bf16[3584,18944]{0,1} aten::permute(%412), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %414 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %415 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %416 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %417 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %418 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %419 = bf16[3584,3584]{0,1} aten::permute(%418), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %420 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %421 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %422 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %423 = bf16[3584,512]{0,1} aten::permute(%422), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %424 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %425 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %426 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %427 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %428 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %429 = bf16[18944,3584]{0,1} aten::permute(%428), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %430 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %431 = bf16[3584,18944]{0,1} aten::permute(%430), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %432 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %433 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %434 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %435 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %436 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %437 = bf16[3584,3584]{0,1} aten::permute(%436), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %438 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %439 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %440 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %441 = bf16[3584,512]{0,1} aten::permute(%440), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %442 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %443 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %444 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %445 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %446 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %447 = bf16[18944,3584]{0,1} aten::permute(%446), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %448 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %449 = bf16[3584,18944]{0,1} aten::permute(%448), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %450 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %451 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %452 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %453 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %454 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %455 = bf16[3584,3584]{0,1} aten::permute(%454), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %456 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %457 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %458 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %459 = bf16[3584,512]{0,1} aten::permute(%458), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %460 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %461 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %462 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %463 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %464 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %465 = bf16[18944,3584]{0,1} aten::permute(%464), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %466 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %467 = bf16[3584,18944]{0,1} aten::permute(%466), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %468 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %469 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %470 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %471 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %472 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %473 = bf16[3584,3584]{0,1} aten::permute(%472), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %474 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %475 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %476 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %477 = bf16[3584,512]{0,1} aten::permute(%476), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %478 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %479 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %480 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %481 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %482 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %483 = bf16[18944,3584]{0,1} aten::permute(%482), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %484 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %485 = bf16[3584,18944]{0,1} aten::permute(%484), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %486 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %487 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %488 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %489 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %490 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %491 = bf16[3584,3584]{0,1} aten::permute(%490), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %492 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %493 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %494 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %495 = bf16[3584,512]{0,1} aten::permute(%494), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %496 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %497 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %498 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %499 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %500 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %501 = bf16[18944,3584]{0,1} aten::permute(%500), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %502 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %503 = bf16[3584,18944]{0,1} aten::permute(%502), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %504 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %505 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %506 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %507 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %508 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %509 = bf16[3584,3584]{0,1} aten::permute(%508), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %510 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %511 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %512 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %513 = bf16[3584,512]{0,1} aten::permute(%512), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %514 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %515 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %516 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %517 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %518 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %519 = bf16[18944,3584]{0,1} aten::permute(%518), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %520 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %521 = bf16[3584,18944]{0,1} aten::permute(%520), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %522 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %523 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %524 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %525 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %526 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %527 = bf16[3584,3584]{0,1} aten::permute(%526), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %528 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %529 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %530 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %531 = bf16[3584,512]{0,1} aten::permute(%530), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %532 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %533 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %534 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %535 = s64[29]{0} aten::view(%25), location=embedding@functional.py:2267, xla_shape=s64[29]{0}
  %536 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %537 = bf16[29,3584]{1,0} aten::index_select(%536, %535), location=embedding@functional.py:2267, xla_shape=bf16[29,3584]{1,0}
  %538 = bf16[1,29,3584]{2,1,0} aten::view(%537), location=embedding@functional.py:2267, xla_shape=bf16[1,29,3584]{2,1,0}
  %539 = f32[1,29,3584]{2,1,0} xla::cast(%538), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %540 = f32[1,29,3584]{2,1,0} aten::pow(%539, %534), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %541 = f32[1,29,1]{2,1,0} aten::mean(%540), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %542 = f32[1,29,1]{2,1,0} aten::add(%541, %533, %532), scope=aten::add.8, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %543 = f32[1,29,1]{2,1,0} aten::rsqrt(%542), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %544 = f32[1,29,3584]{2,1,0} aten::mul(%539, %543), scope=aten::mul.9, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %545 = bf16[1,29,3584]{2,1,0} xla::cast(%544), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %546 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %547 = bf16[1,29,3584]{2,1,0} aten::mul(%546, %545), scope=aten::mul.10, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %548 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %549 = bf16[29,512]{1,0} aten::mm(%548, %531), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %550 = bf16[1,29,512]{2,1,0} aten::view(%549), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %551 = bf16[1,29,512]{2,1,0} aten::add(%550, %529, %528), scope=aten::add.13, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %552 = bf16[1,29,4,128]{3,2,1,0} aten::view(%551), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %553 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%552), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %554 = bf16[1,4,29,128]{3,1,2,0} xla::select(%553), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %555 = bf16[1,4,29,128]{3,1,2,0} xla::select(%554), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %556 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%555), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %557 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%556), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %558 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%557), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %559 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%558), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %560 = bf16[1,28,29,128]{3,2,1,0} aten::view(%559), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %561 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%560), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %562 = bf16[28,29,128]{2,1,0} aten::view(%561), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %563 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %564 = f64[] xla::device_data(), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=f64[]
  %565 = f64[] xla::device_data(), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=f64[]
  %566 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %567 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %568 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[]
  %569 = pred[2]{0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[2]{0}
  %570 = pred[] aten::any(%569), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[]
  %571 = pred[] aten::bitwise_not(%570), location=_prepare_attention_mask_for_generation@utils.py:475, xla_shape=pred[]
  %572 = pred[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[1,29]{1,0}
  %573 = pred[] aten::any(%572), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[]
  %574 = pred[] aten::mul(%573, %571), scope=aten::mul.1, location=_prepare_attention_mask_for_generation@utils.py:478, xla_shape=pred[]
  %575 = pred[] aten::bitwise_not(%574), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=pred[]
  %576 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[]
  %577 = s64[1,29]{1,0} aten::expand(%576), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[1,29]{1,0}
  %578 = s64[1,29]{1,0} aten::mul(%577, %575), scope=aten::mul.3, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %579 = pred[1,29]{1,0} aten::ne(%22, %6), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=pred[1,29]{1,0}
  %580 = s64[1,29]{1,0} xla::cast(%579), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %581 = s64[1,29]{1,0} aten::mul(%580, %574), scope=aten::mul.2, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %582 = s64[1,29]{1,0} aten::add(%581, %578, %568), scope=aten::add.4, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %583 = s64[1,1,29]{2,1,0} aten::view(%582), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %584 = s64[1,1,29]{2,1,0} aten::expand(%583), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %585 = s64[1,29]{1,0} aten::view(%584), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,29]{1,0}
  %586 = s64[1,29]{1,0} xla::select(%585), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,29]{1,0}
  %587 = s64[1,1,29]{2,1,0} aten::view(%586), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29]{2,1,0}
  %588 = s64[1,1,1,29]{3,2,1,0} aten::view(%587), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %589 = s64[1,1,1,29]{3,2,1,0} xla::select(%588), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %590 = s64[1,1,29,29]{3,2,1,0} aten::expand(%589), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29,29]{3,2,1,0}
  %591 = bf16[1,1,29,29]{3,2,1,0} xla::cast(%590), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %592 = bf16[1,1,29,29]{3,2,1,0} aten::rsub(%591, %567, %566), scope=aten::rsub.7, location=__rsub__@_tensor.py:962, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %593 = pred[1,1,29,29]{3,2,1,0} xla::cast(%592), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %594 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%592, %593, %565), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %595 = pred[1,1,29,29]{3,2,1,0} xla::cast(%594), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %596 = f64[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=f64[]
  %597 = pred[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[]
  %598 = pred[29,29]{1,0} aten::expand(%597), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %599 = pred[29,29]{1,0} aten::tril(%598), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %600 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %601 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %602 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %603 = s64[29]{0} prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:157, xla_shape=s64[29]{0}
  %604 = s64[29]{0} aten::add(%603, %602, %601), scope=aten::add.6, location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29]{0}
  %605 = s64[29,1]{1,0} aten::view(%604), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29,1]{1,0}
  %606 = pred[29,29]{1,0} aten::lt(%603, %605), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=pred[29,29]{1,0}
  %607 = f32[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[]
  %608 = f32[29,29]{1,0} aten::expand(%607), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[29,29]{1,0}
  %609 = f32[29,29]{1,0} aten::masked_fill(%608, %606, %600), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=f32[29,29]{1,0}
  %610 = bf16[29,29]{1,0} xla::cast(%609), location=_make_causal_mask@modeling_attn_mask_utils.py:160, xla_shape=bf16[29,29]{1,0}
  %611 = bf16[29,29]{1,0} aten::masked_fill(%610, %599, %596), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=bf16[29,29]{1,0}
  %612 = bf16[1,29,29]{2,1,0} aten::view(%611), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,29,29]{2,1,0}
  %613 = bf16[1,1,29,29]{3,2,1,0} aten::view(%612), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %614 = bf16[1,1,29,29]{3,2,1,0} xla::select(%613), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %615 = bf16[1,1,29,29]{3,2,1,0} xla::select(%614), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %616 = bf16[1,1,29,29]{3,2,1,0} aten::expand(%615), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %617 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%616, %595, %564), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %618 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %619 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %620 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %621 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %622 = pred[1,29]{1,0} aten::eq(%585, %621), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=pred[1,29]{1,0}
  %623 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %624 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %625 = s64[1,29]{1,0} aten::cumsum(%585), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %626 = s64[1,29]{1,0} aten::sub(%625, %624, %623), scope=aten::sub.5, location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %627 = s64[1,29]{1,0} aten::masked_fill(%626, %622, %620), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[1,29]{1,0}
  %628 = s64[1,29]{1,0} aten::view(%627), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %629 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %630 = s64[1,29]{1,0} aten::expand(%629), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %631 = s64[1,29]{1,0} aten::add(%628, %630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %632 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %633 = pred[1,29]{1,0} aten::lt(%628, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %634 = s64[1,29]{1,0} aten::where(%633, %631, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %635 = s64[1,29,1]{2,1,0} aten::stack(%634), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %636 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %637 = bf16[29,128]{1,0} xla::select(%636), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %638 = bf16[1,29,128]{2,1,0} aten::index(%637, %635), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %639 = bf16[1,1,29,128]{3,2,1,0} aten::view(%638), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %640 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %641 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %642 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %643 = bf16[3584,512]{0,1} aten::permute(%642), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %644 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %645 = bf16[29,512]{1,0} aten::mm(%644, %643), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %646 = bf16[1,29,512]{2,1,0} aten::view(%645), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %647 = bf16[1,29,512]{2,1,0} aten::add(%646, %641, %640), scope=aten::add.12, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %648 = bf16[1,29,4,128]{3,2,1,0} aten::view(%647), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %649 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%648), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %650 = bf16[1,4,29,64]{3,1,2,0} xla::select(%649), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %651 = bf16[1,4,29,64]{3,1,2,0} xla::select(%649), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %652 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%651), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %653 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%652, %650), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %654 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%653, %639), scope=aten::mul.18, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %655 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %656 = s64[1,29]{1,0} aten::expand(%655), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %657 = s64[1,29]{1,0} aten::add(%628, %656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %658 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %659 = pred[1,29]{1,0} aten::lt(%628, %658), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %660 = s64[1,29]{1,0} aten::where(%659, %657, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %661 = s64[1,29,1]{2,1,0} aten::stack(%660), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %662 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %663 = bf16[29,128]{1,0} xla::select(%662), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %664 = bf16[1,29,128]{2,1,0} aten::index(%663, %661), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %665 = bf16[1,1,29,128]{3,2,1,0} aten::view(%664), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %666 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%649, %665), scope=aten::mul.17, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %667 = bf16[1,4,29,128]{3,2,1,0} aten::add(%666, %654, %619), scope=aten::add.19, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %668 = bf16[1,4,29,128]{3,2,1,0} xla::select(%667), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %669 = bf16[1,4,29,128]{3,2,1,0} xla::select(%668), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %670 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%669), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %671 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%670), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %672 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%671), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %673 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%672), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %674 = bf16[1,28,29,128]{3,2,1,0} aten::view(%673), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %675 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%674), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %676 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%675), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %677 = bf16[28,128,29]{2,1,0} aten::view(%676), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %678 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %679 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %680 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %681 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %682 = bf16[3584,3584]{0,1} aten::permute(%681), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %683 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %684 = bf16[29,3584]{1,0} aten::mm(%683, %682), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %685 = bf16[1,29,3584]{2,1,0} aten::view(%684), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %686 = bf16[1,29,3584]{2,1,0} aten::add(%685, %680, %679), scope=aten::add.11, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %687 = bf16[1,29,28,128]{3,2,1,0} aten::view(%686), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %688 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%687), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %689 = bf16[1,28,29,64]{3,1,2,0} xla::select(%688), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %690 = bf16[1,28,29,64]{3,1,2,0} xla::select(%688), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %691 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%690), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %692 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%691, %689), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %693 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%692, %639), scope=aten::mul.15, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %694 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%688, %665), scope=aten::mul.14, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %695 = bf16[1,28,29,128]{3,2,1,0} aten::add(%694, %693, %678), scope=aten::add.16, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %696 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%695), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %697 = bf16[28,29,128]{2,1,0} aten::view(%696), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %698 = bf16[28,29,29]{2,1,0} aten::matmul(%697, %677), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %699 = bf16[1,28,29,29]{3,2,1,0} aten::view(%698), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %700 = bf16[1,28,29,29]{3,2,1,0} aten::div(%699, %618), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %701 = bf16[1,28,29,29]{3,2,1,0} aten::add(%700, %617, %563), scope=aten::add.20, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %702 = f32[1,28,29,29]{3,2,1,0} xla::cast(%701), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %703 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%702), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %704 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%703), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %705 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%704), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %706 = bf16[28,29,29]{2,1,0} aten::view(%705), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %707 = bf16[28,29,128]{2,1,0} aten::matmul(%706, %562), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %708 = bf16[1,28,29,128]{3,2,1,0} aten::view(%707), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %709 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%708), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %710 = bf16[1,29,3584]{2,1,0} aten::view(%709), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %711 = bf16[29,3584]{1,0} aten::view(%710), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %712 = bf16[29,3584]{1,0} aten::mm(%711, %527), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %713 = bf16[1,29,3584]{2,1,0} aten::view(%712), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %714 = bf16[1,29,3584]{2,1,0} aten::add(%538, %713, %525), scope=aten::add.21, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %715 = f32[1,29,3584]{2,1,0} xla::cast(%714), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %716 = f32[1,29,3584]{2,1,0} aten::pow(%715, %524), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %717 = f32[1,29,1]{2,1,0} aten::mean(%716), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %718 = f32[1,29,1]{2,1,0} aten::add(%717, %523, %522), scope=aten::add.22, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %719 = f32[1,29,1]{2,1,0} aten::rsqrt(%718), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %720 = f32[1,29,3584]{2,1,0} aten::mul(%715, %719), scope=aten::mul.23, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %721 = bf16[1,29,3584]{2,1,0} xla::cast(%720), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %722 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %723 = bf16[1,29,3584]{2,1,0} aten::mul(%722, %721), scope=aten::mul.24, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %724 = bf16[29,3584]{1,0} aten::view(%723), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %725 = bf16[29,18944]{1,0} aten::mm(%724, %521), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %726 = bf16[1,29,18944]{2,1,0} aten::view(%725), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %727 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %728 = bf16[3584,18944]{0,1} aten::permute(%727), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %729 = bf16[29,3584]{1,0} aten::view(%723), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %730 = bf16[29,18944]{1,0} aten::mm(%729, %728), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %731 = bf16[1,29,18944]{2,1,0} aten::view(%730), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %732 = bf16[1,29,18944]{2,1,0} aten::silu(%731), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %733 = bf16[1,29,18944]{2,1,0} aten::mul(%732, %726), scope=aten::mul.25, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %734 = bf16[29,18944]{1,0} aten::view(%733), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %735 = bf16[29,3584]{1,0} aten::mm(%734, %519), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %736 = bf16[1,29,3584]{2,1,0} aten::view(%735), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %737 = bf16[1,29,3584]{2,1,0} aten::add(%714, %736, %517), scope=aten::add.26, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %738 = f32[1,29,3584]{2,1,0} xla::cast(%737), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %739 = f32[1,29,3584]{2,1,0} aten::pow(%738, %516), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %740 = f32[1,29,1]{2,1,0} aten::mean(%739), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %741 = f32[1,29,1]{2,1,0} aten::add(%740, %515, %514), scope=aten::add.27, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %742 = f32[1,29,1]{2,1,0} aten::rsqrt(%741), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %743 = f32[1,29,3584]{2,1,0} aten::mul(%738, %742), scope=aten::mul.28, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %744 = bf16[1,29,3584]{2,1,0} xla::cast(%743), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %745 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %746 = bf16[1,29,3584]{2,1,0} aten::mul(%745, %744), scope=aten::mul.29, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %747 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %748 = bf16[29,512]{1,0} aten::mm(%747, %513), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %749 = bf16[1,29,512]{2,1,0} aten::view(%748), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %750 = bf16[1,29,512]{2,1,0} aten::add(%749, %511, %510), scope=aten::add.32, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %751 = bf16[1,29,4,128]{3,2,1,0} aten::view(%750), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %752 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%751), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %753 = bf16[1,4,29,128]{3,1,2,0} xla::select(%752), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %754 = bf16[1,4,29,128]{3,1,2,0} xla::select(%753), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %755 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%754), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %756 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%755), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %757 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %758 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %759 = bf16[1,28,29,128]{3,2,1,0} aten::view(%758), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %760 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%759), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %761 = bf16[28,29,128]{2,1,0} aten::view(%760), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %762 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %763 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %764 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %765 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %766 = s64[1,29]{1,0} aten::expand(%765), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %767 = s64[1,29]{1,0} aten::add(%628, %766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %768 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %769 = pred[1,29]{1,0} aten::lt(%628, %768), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %770 = s64[1,29]{1,0} aten::where(%769, %767, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %771 = s64[1,29,1]{2,1,0} aten::stack(%770), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %772 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %773 = bf16[29,128]{1,0} xla::select(%772), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %774 = bf16[1,29,128]{2,1,0} aten::index(%773, %771), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %775 = bf16[1,1,29,128]{3,2,1,0} aten::view(%774), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %776 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %777 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %778 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %779 = bf16[3584,512]{0,1} aten::permute(%778), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %780 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %781 = bf16[29,512]{1,0} aten::mm(%780, %779), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %782 = bf16[1,29,512]{2,1,0} aten::view(%781), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %783 = bf16[1,29,512]{2,1,0} aten::add(%782, %777, %776), scope=aten::add.31, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %784 = bf16[1,29,4,128]{3,2,1,0} aten::view(%783), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %785 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%784), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %786 = bf16[1,4,29,64]{3,1,2,0} xla::select(%785), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %787 = bf16[1,4,29,64]{3,1,2,0} xla::select(%785), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %788 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%787), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %789 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%788, %786), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %790 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%789, %775), scope=aten::mul.37, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %791 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %792 = s64[1,29]{1,0} aten::expand(%791), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %793 = s64[1,29]{1,0} aten::add(%628, %792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %794 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %795 = pred[1,29]{1,0} aten::lt(%628, %794), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %796 = s64[1,29]{1,0} aten::where(%795, %793, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %797 = s64[1,29,1]{2,1,0} aten::stack(%796), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %798 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %799 = bf16[29,128]{1,0} xla::select(%798), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %800 = bf16[1,29,128]{2,1,0} aten::index(%799, %797), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %801 = bf16[1,1,29,128]{3,2,1,0} aten::view(%800), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %802 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%785, %801), scope=aten::mul.36, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %803 = bf16[1,4,29,128]{3,2,1,0} aten::add(%802, %790, %764), scope=aten::add.38, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %804 = bf16[1,4,29,128]{3,2,1,0} xla::select(%803), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %805 = bf16[1,4,29,128]{3,2,1,0} xla::select(%804), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %806 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%805), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %807 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%806), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %808 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%807), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %809 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%808), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %810 = bf16[1,28,29,128]{3,2,1,0} aten::view(%809), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %811 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%810), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %812 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%811), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %813 = bf16[28,128,29]{2,1,0} aten::view(%812), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %814 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %815 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %816 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %817 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %818 = bf16[3584,3584]{0,1} aten::permute(%817), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %819 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %820 = bf16[29,3584]{1,0} aten::mm(%819, %818), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %821 = bf16[1,29,3584]{2,1,0} aten::view(%820), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %822 = bf16[1,29,3584]{2,1,0} aten::add(%821, %816, %815), scope=aten::add.30, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %823 = bf16[1,29,28,128]{3,2,1,0} aten::view(%822), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %824 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%823), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %825 = bf16[1,28,29,64]{3,1,2,0} xla::select(%824), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %826 = bf16[1,28,29,64]{3,1,2,0} xla::select(%824), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %827 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%826), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %828 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%827, %825), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %829 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%828, %775), scope=aten::mul.34, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %830 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%824, %801), scope=aten::mul.33, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %831 = bf16[1,28,29,128]{3,2,1,0} aten::add(%830, %829, %814), scope=aten::add.35, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %832 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%831), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %833 = bf16[28,29,128]{2,1,0} aten::view(%832), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %834 = bf16[28,29,29]{2,1,0} aten::matmul(%833, %813), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %835 = bf16[1,28,29,29]{3,2,1,0} aten::view(%834), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %836 = bf16[1,28,29,29]{3,2,1,0} aten::div(%835, %763), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %837 = bf16[1,28,29,29]{3,2,1,0} aten::add(%836, %617, %762), scope=aten::add.39, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %838 = f32[1,28,29,29]{3,2,1,0} xla::cast(%837), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %839 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%838), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %840 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%839), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %841 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%840), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %842 = bf16[28,29,29]{2,1,0} aten::view(%841), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %843 = bf16[28,29,128]{2,1,0} aten::matmul(%842, %761), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %844 = bf16[1,28,29,128]{3,2,1,0} aten::view(%843), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %845 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%844), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %846 = bf16[1,29,3584]{2,1,0} aten::view(%845), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %847 = bf16[29,3584]{1,0} aten::view(%846), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %848 = bf16[29,3584]{1,0} aten::mm(%847, %509), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %849 = bf16[1,29,3584]{2,1,0} aten::view(%848), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %850 = bf16[1,29,3584]{2,1,0} aten::add(%737, %849, %507), scope=aten::add.40, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %851 = f32[1,29,3584]{2,1,0} xla::cast(%850), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %852 = f32[1,29,3584]{2,1,0} aten::pow(%851, %506), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %853 = f32[1,29,1]{2,1,0} aten::mean(%852), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %854 = f32[1,29,1]{2,1,0} aten::add(%853, %505, %504), scope=aten::add.41, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %855 = f32[1,29,1]{2,1,0} aten::rsqrt(%854), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %856 = f32[1,29,3584]{2,1,0} aten::mul(%851, %855), scope=aten::mul.42, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %857 = bf16[1,29,3584]{2,1,0} xla::cast(%856), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %858 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %859 = bf16[1,29,3584]{2,1,0} aten::mul(%858, %857), scope=aten::mul.43, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %860 = bf16[29,3584]{1,0} aten::view(%859), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %861 = bf16[29,18944]{1,0} aten::mm(%860, %503), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %862 = bf16[1,29,18944]{2,1,0} aten::view(%861), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %863 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %864 = bf16[3584,18944]{0,1} aten::permute(%863), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %865 = bf16[29,3584]{1,0} aten::view(%859), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %866 = bf16[29,18944]{1,0} aten::mm(%865, %864), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %867 = bf16[1,29,18944]{2,1,0} aten::view(%866), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %868 = bf16[1,29,18944]{2,1,0} aten::silu(%867), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %869 = bf16[1,29,18944]{2,1,0} aten::mul(%868, %862), scope=aten::mul.44, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %870 = bf16[29,18944]{1,0} aten::view(%869), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %871 = bf16[29,3584]{1,0} aten::mm(%870, %501), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %872 = bf16[1,29,3584]{2,1,0} aten::view(%871), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %873 = bf16[1,29,3584]{2,1,0} aten::add(%850, %872, %499), scope=aten::add.45, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %874 = f32[1,29,3584]{2,1,0} xla::cast(%873), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %875 = f32[1,29,3584]{2,1,0} aten::pow(%874, %498), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %876 = f32[1,29,1]{2,1,0} aten::mean(%875), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %877 = f32[1,29,1]{2,1,0} aten::add(%876, %497, %496), scope=aten::add.46, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %878 = f32[1,29,1]{2,1,0} aten::rsqrt(%877), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %879 = f32[1,29,3584]{2,1,0} aten::mul(%874, %878), scope=aten::mul.47, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %880 = bf16[1,29,3584]{2,1,0} xla::cast(%879), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %881 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %882 = bf16[1,29,3584]{2,1,0} aten::mul(%881, %880), scope=aten::mul.48, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %883 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %884 = bf16[29,512]{1,0} aten::mm(%883, %495), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %885 = bf16[1,29,512]{2,1,0} aten::view(%884), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %886 = bf16[1,29,512]{2,1,0} aten::add(%885, %493, %492), scope=aten::add.51, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %887 = bf16[1,29,4,128]{3,2,1,0} aten::view(%886), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %888 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%887), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %889 = bf16[1,4,29,128]{3,1,2,0} xla::select(%888), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %890 = bf16[1,4,29,128]{3,1,2,0} xla::select(%889), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %891 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%890), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %892 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%891), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %893 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %894 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %895 = bf16[1,28,29,128]{3,2,1,0} aten::view(%894), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %896 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%895), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %897 = bf16[28,29,128]{2,1,0} aten::view(%896), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %898 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %899 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %900 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %901 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %902 = s64[1,29]{1,0} aten::expand(%901), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %903 = s64[1,29]{1,0} aten::add(%628, %902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %904 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %905 = pred[1,29]{1,0} aten::lt(%628, %904), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %906 = s64[1,29]{1,0} aten::where(%905, %903, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %907 = s64[1,29,1]{2,1,0} aten::stack(%906), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %908 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %909 = bf16[29,128]{1,0} xla::select(%908), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %910 = bf16[1,29,128]{2,1,0} aten::index(%909, %907), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %911 = bf16[1,1,29,128]{3,2,1,0} aten::view(%910), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %912 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %913 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %914 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %915 = bf16[3584,512]{0,1} aten::permute(%914), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %916 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %917 = bf16[29,512]{1,0} aten::mm(%916, %915), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %918 = bf16[1,29,512]{2,1,0} aten::view(%917), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %919 = bf16[1,29,512]{2,1,0} aten::add(%918, %913, %912), scope=aten::add.50, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %920 = bf16[1,29,4,128]{3,2,1,0} aten::view(%919), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %921 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%920), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %922 = bf16[1,4,29,64]{3,1,2,0} xla::select(%921), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %923 = bf16[1,4,29,64]{3,1,2,0} xla::select(%921), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %924 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%923), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %925 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%924, %922), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %926 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%925, %911), scope=aten::mul.56, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %927 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %928 = s64[1,29]{1,0} aten::expand(%927), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %929 = s64[1,29]{1,0} aten::add(%628, %928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %930 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %931 = pred[1,29]{1,0} aten::lt(%628, %930), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %932 = s64[1,29]{1,0} aten::where(%931, %929, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %933 = s64[1,29,1]{2,1,0} aten::stack(%932), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %934 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %935 = bf16[29,128]{1,0} xla::select(%934), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %936 = bf16[1,29,128]{2,1,0} aten::index(%935, %933), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %937 = bf16[1,1,29,128]{3,2,1,0} aten::view(%936), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %938 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%921, %937), scope=aten::mul.55, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %939 = bf16[1,4,29,128]{3,2,1,0} aten::add(%938, %926, %900), scope=aten::add.57, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %940 = bf16[1,4,29,128]{3,2,1,0} xla::select(%939), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %941 = bf16[1,4,29,128]{3,2,1,0} xla::select(%940), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %942 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%941), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %943 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%942), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %944 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%943), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %945 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%944), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %946 = bf16[1,28,29,128]{3,2,1,0} aten::view(%945), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %947 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%946), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %948 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%947), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %949 = bf16[28,128,29]{2,1,0} aten::view(%948), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %950 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %951 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %952 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %953 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %954 = bf16[3584,3584]{0,1} aten::permute(%953), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %955 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %956 = bf16[29,3584]{1,0} aten::mm(%955, %954), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %957 = bf16[1,29,3584]{2,1,0} aten::view(%956), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %958 = bf16[1,29,3584]{2,1,0} aten::add(%957, %952, %951), scope=aten::add.49, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %959 = bf16[1,29,28,128]{3,2,1,0} aten::view(%958), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %960 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%959), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %961 = bf16[1,28,29,64]{3,1,2,0} xla::select(%960), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %962 = bf16[1,28,29,64]{3,1,2,0} xla::select(%960), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %963 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%962), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %964 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%963, %961), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %965 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%964, %911), scope=aten::mul.53, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %966 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%960, %937), scope=aten::mul.52, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %967 = bf16[1,28,29,128]{3,2,1,0} aten::add(%966, %965, %950), scope=aten::add.54, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %968 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%967), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %969 = bf16[28,29,128]{2,1,0} aten::view(%968), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %970 = bf16[28,29,29]{2,1,0} aten::matmul(%969, %949), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %971 = bf16[1,28,29,29]{3,2,1,0} aten::view(%970), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %972 = bf16[1,28,29,29]{3,2,1,0} aten::div(%971, %899), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %973 = bf16[1,28,29,29]{3,2,1,0} aten::add(%972, %617, %898), scope=aten::add.58, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %974 = f32[1,28,29,29]{3,2,1,0} xla::cast(%973), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %975 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%974), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %976 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%975), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %977 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%976), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %978 = bf16[28,29,29]{2,1,0} aten::view(%977), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %979 = bf16[28,29,128]{2,1,0} aten::matmul(%978, %897), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %980 = bf16[1,28,29,128]{3,2,1,0} aten::view(%979), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %981 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%980), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %982 = bf16[1,29,3584]{2,1,0} aten::view(%981), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %983 = bf16[29,3584]{1,0} aten::view(%982), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %984 = bf16[29,3584]{1,0} aten::mm(%983, %491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %985 = bf16[1,29,3584]{2,1,0} aten::view(%984), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %986 = bf16[1,29,3584]{2,1,0} aten::add(%873, %985, %489), scope=aten::add.59, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %987 = f32[1,29,3584]{2,1,0} xla::cast(%986), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %988 = f32[1,29,3584]{2,1,0} aten::pow(%987, %488), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %989 = f32[1,29,1]{2,1,0} aten::mean(%988), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %990 = f32[1,29,1]{2,1,0} aten::add(%989, %487, %486), scope=aten::add.60, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %991 = f32[1,29,1]{2,1,0} aten::rsqrt(%990), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %992 = f32[1,29,3584]{2,1,0} aten::mul(%987, %991), scope=aten::mul.61, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %993 = bf16[1,29,3584]{2,1,0} xla::cast(%992), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %994 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %995 = bf16[1,29,3584]{2,1,0} aten::mul(%994, %993), scope=aten::mul.62, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %996 = bf16[29,3584]{1,0} aten::view(%995), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %997 = bf16[29,18944]{1,0} aten::mm(%996, %485), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %998 = bf16[1,29,18944]{2,1,0} aten::view(%997), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %999 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1000 = bf16[3584,18944]{0,1} aten::permute(%999), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1001 = bf16[29,3584]{1,0} aten::view(%995), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1002 = bf16[29,18944]{1,0} aten::mm(%1001, %1000), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1003 = bf16[1,29,18944]{2,1,0} aten::view(%1002), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1004 = bf16[1,29,18944]{2,1,0} aten::silu(%1003), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1005 = bf16[1,29,18944]{2,1,0} aten::mul(%1004, %998), scope=aten::mul.63, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1006 = bf16[29,18944]{1,0} aten::view(%1005), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1007 = bf16[29,3584]{1,0} aten::mm(%1006, %483), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1008 = bf16[1,29,3584]{2,1,0} aten::view(%1007), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1009 = bf16[1,29,3584]{2,1,0} aten::add(%986, %1008, %481), scope=aten::add.64, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1010 = f32[1,29,3584]{2,1,0} xla::cast(%1009), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1011 = f32[1,29,3584]{2,1,0} aten::pow(%1010, %480), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1012 = f32[1,29,1]{2,1,0} aten::mean(%1011), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1013 = f32[1,29,1]{2,1,0} aten::add(%1012, %479, %478), scope=aten::add.65, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1014 = f32[1,29,1]{2,1,0} aten::rsqrt(%1013), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1015 = f32[1,29,3584]{2,1,0} aten::mul(%1010, %1014), scope=aten::mul.66, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1016 = bf16[1,29,3584]{2,1,0} xla::cast(%1015), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1017 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1018 = bf16[1,29,3584]{2,1,0} aten::mul(%1017, %1016), scope=aten::mul.67, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1019 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1020 = bf16[29,512]{1,0} aten::mm(%1019, %477), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1021 = bf16[1,29,512]{2,1,0} aten::view(%1020), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1022 = bf16[1,29,512]{2,1,0} aten::add(%1021, %475, %474), scope=aten::add.70, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1023 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1022), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1024 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1023), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1025 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1024), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1026 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1025), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1027 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1026), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1028 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1027), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1029 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1030 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1031 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1030), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1032 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1031), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1033 = bf16[28,29,128]{2,1,0} aten::view(%1032), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1034 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1035 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1036 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1037 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1038 = s64[1,29]{1,0} aten::expand(%1037), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1039 = s64[1,29]{1,0} aten::add(%628, %1038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1040 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1041 = pred[1,29]{1,0} aten::lt(%628, %1040), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1042 = s64[1,29]{1,0} aten::where(%1041, %1039, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1043 = s64[1,29,1]{2,1,0} aten::stack(%1042), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1044 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1045 = bf16[29,128]{1,0} xla::select(%1044), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1046 = bf16[1,29,128]{2,1,0} aten::index(%1045, %1043), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1047 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1046), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1048 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1049 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1050 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1051 = bf16[3584,512]{0,1} aten::permute(%1050), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1052 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1053 = bf16[29,512]{1,0} aten::mm(%1052, %1051), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1054 = bf16[1,29,512]{2,1,0} aten::view(%1053), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1055 = bf16[1,29,512]{2,1,0} aten::add(%1054, %1049, %1048), scope=aten::add.69, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1056 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1055), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1057 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1056), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1058 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1057), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1059 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1057), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1060 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1059), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1061 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1060, %1058), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1062 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1061, %1047), scope=aten::mul.75, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1063 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1064 = s64[1,29]{1,0} aten::expand(%1063), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1065 = s64[1,29]{1,0} aten::add(%628, %1064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1066 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1067 = pred[1,29]{1,0} aten::lt(%628, %1066), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1068 = s64[1,29]{1,0} aten::where(%1067, %1065, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1069 = s64[1,29,1]{2,1,0} aten::stack(%1068), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1070 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1071 = bf16[29,128]{1,0} xla::select(%1070), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1072 = bf16[1,29,128]{2,1,0} aten::index(%1071, %1069), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1073 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1072), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1074 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1057, %1073), scope=aten::mul.74, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1075 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1074, %1062, %1036), scope=aten::add.76, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1076 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1075), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1077 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1076), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1078 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1077), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1079 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1078), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1080 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1079), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1081 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1080), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1082 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1081), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1083 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1082), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1084 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1083), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1085 = bf16[28,128,29]{2,1,0} aten::view(%1084), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1086 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1087 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1088 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1089 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1090 = bf16[3584,3584]{0,1} aten::permute(%1089), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1091 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1092 = bf16[29,3584]{1,0} aten::mm(%1091, %1090), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1093 = bf16[1,29,3584]{2,1,0} aten::view(%1092), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1094 = bf16[1,29,3584]{2,1,0} aten::add(%1093, %1088, %1087), scope=aten::add.68, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1095 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1094), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1096 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1095), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1097 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1096), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1098 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1096), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1099 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1098), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1100 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1099, %1097), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1101 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1100, %1047), scope=aten::mul.72, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1102 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1096, %1073), scope=aten::mul.71, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1103 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1102, %1101, %1086), scope=aten::add.73, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1104 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1103), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1105 = bf16[28,29,128]{2,1,0} aten::view(%1104), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1106 = bf16[28,29,29]{2,1,0} aten::matmul(%1105, %1085), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1107 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1106), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1108 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1107, %1035), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1109 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1108, %617, %1034), scope=aten::add.77, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1110 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1109), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1111 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1110), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1112 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1111), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1113 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1112), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1114 = bf16[28,29,29]{2,1,0} aten::view(%1113), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1115 = bf16[28,29,128]{2,1,0} aten::matmul(%1114, %1033), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1116 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1115), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1117 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1116), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1118 = bf16[1,29,3584]{2,1,0} aten::view(%1117), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1119 = bf16[29,3584]{1,0} aten::view(%1118), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1120 = bf16[29,3584]{1,0} aten::mm(%1119, %473), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1121 = bf16[1,29,3584]{2,1,0} aten::view(%1120), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1122 = bf16[1,29,3584]{2,1,0} aten::add(%1009, %1121, %471), scope=aten::add.78, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1123 = f32[1,29,3584]{2,1,0} xla::cast(%1122), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1124 = f32[1,29,3584]{2,1,0} aten::pow(%1123, %470), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1125 = f32[1,29,1]{2,1,0} aten::mean(%1124), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1126 = f32[1,29,1]{2,1,0} aten::add(%1125, %469, %468), scope=aten::add.79, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1127 = f32[1,29,1]{2,1,0} aten::rsqrt(%1126), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1128 = f32[1,29,3584]{2,1,0} aten::mul(%1123, %1127), scope=aten::mul.80, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1129 = bf16[1,29,3584]{2,1,0} xla::cast(%1128), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1130 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1131 = bf16[1,29,3584]{2,1,0} aten::mul(%1130, %1129), scope=aten::mul.81, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1132 = bf16[29,3584]{1,0} aten::view(%1131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1133 = bf16[29,18944]{1,0} aten::mm(%1132, %467), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1134 = bf16[1,29,18944]{2,1,0} aten::view(%1133), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1135 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1136 = bf16[3584,18944]{0,1} aten::permute(%1135), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1137 = bf16[29,3584]{1,0} aten::view(%1131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1138 = bf16[29,18944]{1,0} aten::mm(%1137, %1136), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1139 = bf16[1,29,18944]{2,1,0} aten::view(%1138), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1140 = bf16[1,29,18944]{2,1,0} aten::silu(%1139), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1141 = bf16[1,29,18944]{2,1,0} aten::mul(%1140, %1134), scope=aten::mul.82, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1142 = bf16[29,18944]{1,0} aten::view(%1141), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1143 = bf16[29,3584]{1,0} aten::mm(%1142, %465), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1144 = bf16[1,29,3584]{2,1,0} aten::view(%1143), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1145 = bf16[1,29,3584]{2,1,0} aten::add(%1122, %1144, %463), scope=aten::add.83, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1146 = f32[1,29,3584]{2,1,0} xla::cast(%1145), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1147 = f32[1,29,3584]{2,1,0} aten::pow(%1146, %462), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1148 = f32[1,29,1]{2,1,0} aten::mean(%1147), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1149 = f32[1,29,1]{2,1,0} aten::add(%1148, %461, %460), scope=aten::add.84, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1150 = f32[1,29,1]{2,1,0} aten::rsqrt(%1149), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1151 = f32[1,29,3584]{2,1,0} aten::mul(%1146, %1150), scope=aten::mul.85, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1152 = bf16[1,29,3584]{2,1,0} xla::cast(%1151), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1153 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1154 = bf16[1,29,3584]{2,1,0} aten::mul(%1153, %1152), scope=aten::mul.86, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1155 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1156 = bf16[29,512]{1,0} aten::mm(%1155, %459), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1157 = bf16[1,29,512]{2,1,0} aten::view(%1156), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1158 = bf16[1,29,512]{2,1,0} aten::add(%1157, %457, %456), scope=aten::add.89, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1159 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1158), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1160 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1159), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1161 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1160), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1162 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1161), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1163 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1162), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1164 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1163), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1165 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1166 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1167 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1166), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1168 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1167), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1169 = bf16[28,29,128]{2,1,0} aten::view(%1168), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1170 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1171 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1172 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1173 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1174 = s64[1,29]{1,0} aten::expand(%1173), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1175 = s64[1,29]{1,0} aten::add(%628, %1174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1176 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1177 = pred[1,29]{1,0} aten::lt(%628, %1176), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1178 = s64[1,29]{1,0} aten::where(%1177, %1175, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1179 = s64[1,29,1]{2,1,0} aten::stack(%1178), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1180 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1181 = bf16[29,128]{1,0} xla::select(%1180), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1182 = bf16[1,29,128]{2,1,0} aten::index(%1181, %1179), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1183 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1182), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1184 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1185 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1186 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1187 = bf16[3584,512]{0,1} aten::permute(%1186), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1188 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1189 = bf16[29,512]{1,0} aten::mm(%1188, %1187), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1190 = bf16[1,29,512]{2,1,0} aten::view(%1189), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1191 = bf16[1,29,512]{2,1,0} aten::add(%1190, %1185, %1184), scope=aten::add.88, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1192 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1191), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1193 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1192), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1194 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1193), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1195 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1193), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1196 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1195), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1197 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1196, %1194), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1198 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1197, %1183), scope=aten::mul.94, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1199 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1200 = s64[1,29]{1,0} aten::expand(%1199), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1201 = s64[1,29]{1,0} aten::add(%628, %1200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1202 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1203 = pred[1,29]{1,0} aten::lt(%628, %1202), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1204 = s64[1,29]{1,0} aten::where(%1203, %1201, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1205 = s64[1,29,1]{2,1,0} aten::stack(%1204), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1206 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1207 = bf16[29,128]{1,0} xla::select(%1206), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1208 = bf16[1,29,128]{2,1,0} aten::index(%1207, %1205), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1209 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1208), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1210 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1193, %1209), scope=aten::mul.93, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1211 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1210, %1198, %1172), scope=aten::add.95, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1212 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1211), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1213 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1212), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1214 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1213), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1215 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1214), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1216 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1215), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1217 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1216), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1218 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1217), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1219 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1218), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1220 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1219), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1221 = bf16[28,128,29]{2,1,0} aten::view(%1220), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1222 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1223 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1224 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1225 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1226 = bf16[3584,3584]{0,1} aten::permute(%1225), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1227 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1228 = bf16[29,3584]{1,0} aten::mm(%1227, %1226), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1229 = bf16[1,29,3584]{2,1,0} aten::view(%1228), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1230 = bf16[1,29,3584]{2,1,0} aten::add(%1229, %1224, %1223), scope=aten::add.87, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1231 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1230), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1232 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1231), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1233 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1232), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1234 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1232), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1235 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1234), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1236 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1235, %1233), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1237 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1236, %1183), scope=aten::mul.91, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1238 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1232, %1209), scope=aten::mul.90, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1239 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1238, %1237, %1222), scope=aten::add.92, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1240 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1239), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1241 = bf16[28,29,128]{2,1,0} aten::view(%1240), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1242 = bf16[28,29,29]{2,1,0} aten::matmul(%1241, %1221), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1243 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1242), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1244 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1243, %1171), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1245 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1244, %617, %1170), scope=aten::add.96, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1246 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1245), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1247 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1246), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1248 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1247), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1249 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1248), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1250 = bf16[28,29,29]{2,1,0} aten::view(%1249), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1251 = bf16[28,29,128]{2,1,0} aten::matmul(%1250, %1169), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1252 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1251), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1253 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1252), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1254 = bf16[1,29,3584]{2,1,0} aten::view(%1253), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1255 = bf16[29,3584]{1,0} aten::view(%1254), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1256 = bf16[29,3584]{1,0} aten::mm(%1255, %455), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1257 = bf16[1,29,3584]{2,1,0} aten::view(%1256), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1258 = bf16[1,29,3584]{2,1,0} aten::add(%1145, %1257, %453), scope=aten::add.97, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1259 = f32[1,29,3584]{2,1,0} xla::cast(%1258), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1260 = f32[1,29,3584]{2,1,0} aten::pow(%1259, %452), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1261 = f32[1,29,1]{2,1,0} aten::mean(%1260), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1262 = f32[1,29,1]{2,1,0} aten::add(%1261, %451, %450), scope=aten::add.98, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1263 = f32[1,29,1]{2,1,0} aten::rsqrt(%1262), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1264 = f32[1,29,3584]{2,1,0} aten::mul(%1259, %1263), scope=aten::mul.99, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1265 = bf16[1,29,3584]{2,1,0} xla::cast(%1264), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1266 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1267 = bf16[1,29,3584]{2,1,0} aten::mul(%1266, %1265), scope=aten::mul.100, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1268 = bf16[29,3584]{1,0} aten::view(%1267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1269 = bf16[29,18944]{1,0} aten::mm(%1268, %449), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1270 = bf16[1,29,18944]{2,1,0} aten::view(%1269), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1271 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1272 = bf16[3584,18944]{0,1} aten::permute(%1271), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1273 = bf16[29,3584]{1,0} aten::view(%1267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1274 = bf16[29,18944]{1,0} aten::mm(%1273, %1272), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1275 = bf16[1,29,18944]{2,1,0} aten::view(%1274), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1276 = bf16[1,29,18944]{2,1,0} aten::silu(%1275), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1277 = bf16[1,29,18944]{2,1,0} aten::mul(%1276, %1270), scope=aten::mul.101, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1278 = bf16[29,18944]{1,0} aten::view(%1277), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1279 = bf16[29,3584]{1,0} aten::mm(%1278, %447), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1280 = bf16[1,29,3584]{2,1,0} aten::view(%1279), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1281 = bf16[1,29,3584]{2,1,0} aten::add(%1258, %1280, %445), scope=aten::add.102, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1282 = f32[1,29,3584]{2,1,0} xla::cast(%1281), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1283 = f32[1,29,3584]{2,1,0} aten::pow(%1282, %444), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1284 = f32[1,29,1]{2,1,0} aten::mean(%1283), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1285 = f32[1,29,1]{2,1,0} aten::add(%1284, %443, %442), scope=aten::add.103, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1286 = f32[1,29,1]{2,1,0} aten::rsqrt(%1285), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1287 = f32[1,29,3584]{2,1,0} aten::mul(%1282, %1286), scope=aten::mul.104, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1288 = bf16[1,29,3584]{2,1,0} xla::cast(%1287), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1289 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1290 = bf16[1,29,3584]{2,1,0} aten::mul(%1289, %1288), scope=aten::mul.105, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1291 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1292 = bf16[29,512]{1,0} aten::mm(%1291, %441), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1293 = bf16[1,29,512]{2,1,0} aten::view(%1292), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1294 = bf16[1,29,512]{2,1,0} aten::add(%1293, %439, %438), scope=aten::add.108, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1295 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1294), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1296 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1295), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1297 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1296), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1298 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1297), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1299 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1298), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1300 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1299), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1301 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1302 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1303 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1302), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1304 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1303), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1305 = bf16[28,29,128]{2,1,0} aten::view(%1304), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1306 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1307 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1308 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1309 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1310 = s64[1,29]{1,0} aten::expand(%1309), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1311 = s64[1,29]{1,0} aten::add(%628, %1310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1312 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1313 = pred[1,29]{1,0} aten::lt(%628, %1312), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1314 = s64[1,29]{1,0} aten::where(%1313, %1311, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1315 = s64[1,29,1]{2,1,0} aten::stack(%1314), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1316 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1317 = bf16[29,128]{1,0} xla::select(%1316), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1318 = bf16[1,29,128]{2,1,0} aten::index(%1317, %1315), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1319 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1318), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1320 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1321 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1322 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1323 = bf16[3584,512]{0,1} aten::permute(%1322), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1324 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1325 = bf16[29,512]{1,0} aten::mm(%1324, %1323), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1326 = bf16[1,29,512]{2,1,0} aten::view(%1325), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1327 = bf16[1,29,512]{2,1,0} aten::add(%1326, %1321, %1320), scope=aten::add.107, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1328 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1327), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1329 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1328), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1330 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1329), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1331 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1329), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1332 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1331), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1333 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1332, %1330), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1334 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1333, %1319), scope=aten::mul.113, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1335 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1336 = s64[1,29]{1,0} aten::expand(%1335), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1337 = s64[1,29]{1,0} aten::add(%628, %1336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1338 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1339 = pred[1,29]{1,0} aten::lt(%628, %1338), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1340 = s64[1,29]{1,0} aten::where(%1339, %1337, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1341 = s64[1,29,1]{2,1,0} aten::stack(%1340), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1342 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1343 = bf16[29,128]{1,0} xla::select(%1342), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1344 = bf16[1,29,128]{2,1,0} aten::index(%1343, %1341), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1345 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1344), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1346 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1329, %1345), scope=aten::mul.112, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1347 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1346, %1334, %1308), scope=aten::add.114, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1348 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1347), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1349 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1348), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1350 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1349), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1351 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1350), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1352 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1351), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1353 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1352), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1354 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1353), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1355 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1354), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1356 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1355), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1357 = bf16[28,128,29]{2,1,0} aten::view(%1356), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1358 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1359 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1360 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1361 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1362 = bf16[3584,3584]{0,1} aten::permute(%1361), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1363 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1364 = bf16[29,3584]{1,0} aten::mm(%1363, %1362), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1365 = bf16[1,29,3584]{2,1,0} aten::view(%1364), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1366 = bf16[1,29,3584]{2,1,0} aten::add(%1365, %1360, %1359), scope=aten::add.106, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1367 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1366), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1368 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1367), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1369 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1368), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1370 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1368), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1371 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1370), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1372 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1371, %1369), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1373 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1372, %1319), scope=aten::mul.110, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1374 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1368, %1345), scope=aten::mul.109, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1375 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1374, %1373, %1358), scope=aten::add.111, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1376 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1375), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1377 = bf16[28,29,128]{2,1,0} aten::view(%1376), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1378 = bf16[28,29,29]{2,1,0} aten::matmul(%1377, %1357), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1379 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1378), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1380 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1379, %1307), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1381 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1380, %617, %1306), scope=aten::add.115, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1382 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1381), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1383 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1382), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1384 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1383), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1385 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1384), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1386 = bf16[28,29,29]{2,1,0} aten::view(%1385), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1387 = bf16[28,29,128]{2,1,0} aten::matmul(%1386, %1305), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1388 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1387), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1389 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1388), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1390 = bf16[1,29,3584]{2,1,0} aten::view(%1389), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1391 = bf16[29,3584]{1,0} aten::view(%1390), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1392 = bf16[29,3584]{1,0} aten::mm(%1391, %437), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1393 = bf16[1,29,3584]{2,1,0} aten::view(%1392), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1394 = bf16[1,29,3584]{2,1,0} aten::add(%1281, %1393, %435), scope=aten::add.116, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1395 = f32[1,29,3584]{2,1,0} xla::cast(%1394), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1396 = f32[1,29,3584]{2,1,0} aten::pow(%1395, %434), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1397 = f32[1,29,1]{2,1,0} aten::mean(%1396), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1398 = f32[1,29,1]{2,1,0} aten::add(%1397, %433, %432), scope=aten::add.117, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1399 = f32[1,29,1]{2,1,0} aten::rsqrt(%1398), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1400 = f32[1,29,3584]{2,1,0} aten::mul(%1395, %1399), scope=aten::mul.118, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1401 = bf16[1,29,3584]{2,1,0} xla::cast(%1400), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1402 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1403 = bf16[1,29,3584]{2,1,0} aten::mul(%1402, %1401), scope=aten::mul.119, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1404 = bf16[29,3584]{1,0} aten::view(%1403), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1405 = bf16[29,18944]{1,0} aten::mm(%1404, %431), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1406 = bf16[1,29,18944]{2,1,0} aten::view(%1405), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1407 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1408 = bf16[3584,18944]{0,1} aten::permute(%1407), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1409 = bf16[29,3584]{1,0} aten::view(%1403), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1410 = bf16[29,18944]{1,0} aten::mm(%1409, %1408), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1411 = bf16[1,29,18944]{2,1,0} aten::view(%1410), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1412 = bf16[1,29,18944]{2,1,0} aten::silu(%1411), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1413 = bf16[1,29,18944]{2,1,0} aten::mul(%1412, %1406), scope=aten::mul.120, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1414 = bf16[29,18944]{1,0} aten::view(%1413), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1415 = bf16[29,3584]{1,0} aten::mm(%1414, %429), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1416 = bf16[1,29,3584]{2,1,0} aten::view(%1415), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1417 = bf16[1,29,3584]{2,1,0} aten::add(%1394, %1416, %427), scope=aten::add.121, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1418 = f32[1,29,3584]{2,1,0} xla::cast(%1417), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1419 = f32[1,29,3584]{2,1,0} aten::pow(%1418, %426), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1420 = f32[1,29,1]{2,1,0} aten::mean(%1419), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1421 = f32[1,29,1]{2,1,0} aten::add(%1420, %425, %424), scope=aten::add.122, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1422 = f32[1,29,1]{2,1,0} aten::rsqrt(%1421), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1423 = f32[1,29,3584]{2,1,0} aten::mul(%1418, %1422), scope=aten::mul.123, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1424 = bf16[1,29,3584]{2,1,0} xla::cast(%1423), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1425 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1426 = bf16[1,29,3584]{2,1,0} aten::mul(%1425, %1424), scope=aten::mul.124, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1427 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1428 = bf16[29,512]{1,0} aten::mm(%1427, %423), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1429 = bf16[1,29,512]{2,1,0} aten::view(%1428), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1430 = bf16[1,29,512]{2,1,0} aten::add(%1429, %421, %420), scope=aten::add.127, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1431 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1430), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1432 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1431), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1433 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1432), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1434 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1433), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1435 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1434), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1436 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1435), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1437 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1438 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1439 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1438), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1440 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1439), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1441 = bf16[28,29,128]{2,1,0} aten::view(%1440), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1442 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1443 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1444 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1445 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1446 = s64[1,29]{1,0} aten::expand(%1445), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1447 = s64[1,29]{1,0} aten::add(%628, %1446), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1448 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1449 = pred[1,29]{1,0} aten::lt(%628, %1448), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1450 = s64[1,29]{1,0} aten::where(%1449, %1447, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1451 = s64[1,29,1]{2,1,0} aten::stack(%1450), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1452 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1453 = bf16[29,128]{1,0} xla::select(%1452), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1454 = bf16[1,29,128]{2,1,0} aten::index(%1453, %1451), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1455 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1454), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1456 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1457 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1458 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1459 = bf16[3584,512]{0,1} aten::permute(%1458), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1460 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1461 = bf16[29,512]{1,0} aten::mm(%1460, %1459), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1462 = bf16[1,29,512]{2,1,0} aten::view(%1461), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1463 = bf16[1,29,512]{2,1,0} aten::add(%1462, %1457, %1456), scope=aten::add.126, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1464 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1463), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1465 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1464), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1466 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1465), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1467 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1465), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1468 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1467), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1469 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1468, %1466), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1470 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1469, %1455), scope=aten::mul.132, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1471 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1472 = s64[1,29]{1,0} aten::expand(%1471), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1473 = s64[1,29]{1,0} aten::add(%628, %1472), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1474 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1475 = pred[1,29]{1,0} aten::lt(%628, %1474), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1476 = s64[1,29]{1,0} aten::where(%1475, %1473, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1477 = s64[1,29,1]{2,1,0} aten::stack(%1476), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1478 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1479 = bf16[29,128]{1,0} xla::select(%1478), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1480 = bf16[1,29,128]{2,1,0} aten::index(%1479, %1477), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1481 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1480), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1482 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1465, %1481), scope=aten::mul.131, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1483 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1482, %1470, %1444), scope=aten::add.133, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1484 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1483), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1485 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1484), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1486 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1485), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1487 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1486), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1488 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1487), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1489 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1488), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1490 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1489), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1491 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1490), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1492 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1491), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1493 = bf16[28,128,29]{2,1,0} aten::view(%1492), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1494 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1495 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1496 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1497 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1498 = bf16[3584,3584]{0,1} aten::permute(%1497), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1499 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1500 = bf16[29,3584]{1,0} aten::mm(%1499, %1498), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1501 = bf16[1,29,3584]{2,1,0} aten::view(%1500), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1502 = bf16[1,29,3584]{2,1,0} aten::add(%1501, %1496, %1495), scope=aten::add.125, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1503 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1502), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1504 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1503), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1505 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1504), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1506 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1504), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1507 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1506), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1508 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1507, %1505), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1509 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1508, %1455), scope=aten::mul.129, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1510 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1504, %1481), scope=aten::mul.128, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1511 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1510, %1509, %1494), scope=aten::add.130, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1512 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1511), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1513 = bf16[28,29,128]{2,1,0} aten::view(%1512), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1514 = bf16[28,29,29]{2,1,0} aten::matmul(%1513, %1493), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1515 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1514), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1516 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1515, %1443), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1517 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1516, %617, %1442), scope=aten::add.134, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1518 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1517), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1519 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1518), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1520 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1519), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1521 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1520), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1522 = bf16[28,29,29]{2,1,0} aten::view(%1521), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1523 = bf16[28,29,128]{2,1,0} aten::matmul(%1522, %1441), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1524 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1523), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1525 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1524), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1526 = bf16[1,29,3584]{2,1,0} aten::view(%1525), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1527 = bf16[29,3584]{1,0} aten::view(%1526), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1528 = bf16[29,3584]{1,0} aten::mm(%1527, %419), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1529 = bf16[1,29,3584]{2,1,0} aten::view(%1528), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1530 = bf16[1,29,3584]{2,1,0} aten::add(%1417, %1529, %417), scope=aten::add.135, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1531 = f32[1,29,3584]{2,1,0} xla::cast(%1530), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1532 = f32[1,29,3584]{2,1,0} aten::pow(%1531, %416), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1533 = f32[1,29,1]{2,1,0} aten::mean(%1532), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1534 = f32[1,29,1]{2,1,0} aten::add(%1533, %415, %414), scope=aten::add.136, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1535 = f32[1,29,1]{2,1,0} aten::rsqrt(%1534), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1536 = f32[1,29,3584]{2,1,0} aten::mul(%1531, %1535), scope=aten::mul.137, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1537 = bf16[1,29,3584]{2,1,0} xla::cast(%1536), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1538 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1539 = bf16[1,29,3584]{2,1,0} aten::mul(%1538, %1537), scope=aten::mul.138, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1540 = bf16[29,3584]{1,0} aten::view(%1539), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1541 = bf16[29,18944]{1,0} aten::mm(%1540, %413), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1542 = bf16[1,29,18944]{2,1,0} aten::view(%1541), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1543 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1544 = bf16[3584,18944]{0,1} aten::permute(%1543), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1545 = bf16[29,3584]{1,0} aten::view(%1539), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1546 = bf16[29,18944]{1,0} aten::mm(%1545, %1544), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1547 = bf16[1,29,18944]{2,1,0} aten::view(%1546), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1548 = bf16[1,29,18944]{2,1,0} aten::silu(%1547), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1549 = bf16[1,29,18944]{2,1,0} aten::mul(%1548, %1542), scope=aten::mul.139, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1550 = bf16[29,18944]{1,0} aten::view(%1549), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1551 = bf16[29,3584]{1,0} aten::mm(%1550, %411), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1552 = bf16[1,29,3584]{2,1,0} aten::view(%1551), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1553 = bf16[1,29,3584]{2,1,0} aten::add(%1530, %1552, %409), scope=aten::add.140, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1554 = f32[1,29,3584]{2,1,0} xla::cast(%1553), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1555 = f32[1,29,3584]{2,1,0} aten::pow(%1554, %408), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1556 = f32[1,29,1]{2,1,0} aten::mean(%1555), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1557 = f32[1,29,1]{2,1,0} aten::add(%1556, %407, %406), scope=aten::add.141, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1558 = f32[1,29,1]{2,1,0} aten::rsqrt(%1557), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1559 = f32[1,29,3584]{2,1,0} aten::mul(%1554, %1558), scope=aten::mul.142, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1560 = bf16[1,29,3584]{2,1,0} xla::cast(%1559), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1561 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1562 = bf16[1,29,3584]{2,1,0} aten::mul(%1561, %1560), scope=aten::mul.143, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1563 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1564 = bf16[29,512]{1,0} aten::mm(%1563, %405), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1565 = bf16[1,29,512]{2,1,0} aten::view(%1564), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1566 = bf16[1,29,512]{2,1,0} aten::add(%1565, %403, %402), scope=aten::add.146, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1567 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1566), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1568 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1567), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1569 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1568), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1570 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1569), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1571 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1570), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1572 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1571), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1573 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1574 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1575 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1574), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1576 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1575), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1577 = bf16[28,29,128]{2,1,0} aten::view(%1576), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1578 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1579 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1580 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1581 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1582 = s64[1,29]{1,0} aten::expand(%1581), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1583 = s64[1,29]{1,0} aten::add(%628, %1582), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1584 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1585 = pred[1,29]{1,0} aten::lt(%628, %1584), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1586 = s64[1,29]{1,0} aten::where(%1585, %1583, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1587 = s64[1,29,1]{2,1,0} aten::stack(%1586), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1588 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1589 = bf16[29,128]{1,0} xla::select(%1588), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1590 = bf16[1,29,128]{2,1,0} aten::index(%1589, %1587), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1591 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1590), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1592 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1593 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1594 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1595 = bf16[3584,512]{0,1} aten::permute(%1594), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1596 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1597 = bf16[29,512]{1,0} aten::mm(%1596, %1595), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1598 = bf16[1,29,512]{2,1,0} aten::view(%1597), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1599 = bf16[1,29,512]{2,1,0} aten::add(%1598, %1593, %1592), scope=aten::add.145, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1600 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1599), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1601 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1600), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1602 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1601), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1603 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1601), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1604 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1603), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1605 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1604, %1602), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1606 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1605, %1591), scope=aten::mul.151, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1607 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1608 = s64[1,29]{1,0} aten::expand(%1607), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1609 = s64[1,29]{1,0} aten::add(%628, %1608), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1610 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1611 = pred[1,29]{1,0} aten::lt(%628, %1610), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1612 = s64[1,29]{1,0} aten::where(%1611, %1609, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1613 = s64[1,29,1]{2,1,0} aten::stack(%1612), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1614 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1615 = bf16[29,128]{1,0} xla::select(%1614), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1616 = bf16[1,29,128]{2,1,0} aten::index(%1615, %1613), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1617 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1616), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1618 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1601, %1617), scope=aten::mul.150, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1619 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1618, %1606, %1580), scope=aten::add.152, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1620 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1619), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1621 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1620), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1622 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1621), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1623 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1622), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1624 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1623), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1625 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1624), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1626 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1625), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1627 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1626), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1628 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1627), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1629 = bf16[28,128,29]{2,1,0} aten::view(%1628), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1630 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1631 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1632 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1633 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1634 = bf16[3584,3584]{0,1} aten::permute(%1633), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1635 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1636 = bf16[29,3584]{1,0} aten::mm(%1635, %1634), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1637 = bf16[1,29,3584]{2,1,0} aten::view(%1636), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1638 = bf16[1,29,3584]{2,1,0} aten::add(%1637, %1632, %1631), scope=aten::add.144, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1639 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1638), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1640 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1639), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1641 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1640), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1642 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1640), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1643 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1642), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1644 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1643, %1641), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1645 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1644, %1591), scope=aten::mul.148, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1646 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1640, %1617), scope=aten::mul.147, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1647 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1646, %1645, %1630), scope=aten::add.149, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1648 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1647), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1649 = bf16[28,29,128]{2,1,0} aten::view(%1648), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1650 = bf16[28,29,29]{2,1,0} aten::matmul(%1649, %1629), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1651 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1650), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1652 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1651, %1579), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1653 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1652, %617, %1578), scope=aten::add.153, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1654 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1653), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1655 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1654), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1656 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1655), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1657 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1656), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1658 = bf16[28,29,29]{2,1,0} aten::view(%1657), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1659 = bf16[28,29,128]{2,1,0} aten::matmul(%1658, %1577), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1660 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1659), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1661 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1660), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1662 = bf16[1,29,3584]{2,1,0} aten::view(%1661), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1663 = bf16[29,3584]{1,0} aten::view(%1662), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1664 = bf16[29,3584]{1,0} aten::mm(%1663, %401), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1665 = bf16[1,29,3584]{2,1,0} aten::view(%1664), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1666 = bf16[1,29,3584]{2,1,0} aten::add(%1553, %1665, %399), scope=aten::add.154, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1667 = f32[1,29,3584]{2,1,0} xla::cast(%1666), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1668 = f32[1,29,3584]{2,1,0} aten::pow(%1667, %398), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1669 = f32[1,29,1]{2,1,0} aten::mean(%1668), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1670 = f32[1,29,1]{2,1,0} aten::add(%1669, %397, %396), scope=aten::add.155, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1671 = f32[1,29,1]{2,1,0} aten::rsqrt(%1670), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1672 = f32[1,29,3584]{2,1,0} aten::mul(%1667, %1671), scope=aten::mul.156, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1673 = bf16[1,29,3584]{2,1,0} xla::cast(%1672), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1674 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1675 = bf16[1,29,3584]{2,1,0} aten::mul(%1674, %1673), scope=aten::mul.157, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1676 = bf16[29,3584]{1,0} aten::view(%1675), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1677 = bf16[29,18944]{1,0} aten::mm(%1676, %395), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1678 = bf16[1,29,18944]{2,1,0} aten::view(%1677), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1679 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1680 = bf16[3584,18944]{0,1} aten::permute(%1679), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1681 = bf16[29,3584]{1,0} aten::view(%1675), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1682 = bf16[29,18944]{1,0} aten::mm(%1681, %1680), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1683 = bf16[1,29,18944]{2,1,0} aten::view(%1682), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1684 = bf16[1,29,18944]{2,1,0} aten::silu(%1683), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1685 = bf16[1,29,18944]{2,1,0} aten::mul(%1684, %1678), scope=aten::mul.158, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1686 = bf16[29,18944]{1,0} aten::view(%1685), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1687 = bf16[29,3584]{1,0} aten::mm(%1686, %393), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1688 = bf16[1,29,3584]{2,1,0} aten::view(%1687), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1689 = bf16[1,29,3584]{2,1,0} aten::add(%1666, %1688, %391), scope=aten::add.159, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1690 = f32[1,29,3584]{2,1,0} xla::cast(%1689), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1691 = f32[1,29,3584]{2,1,0} aten::pow(%1690, %390), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1692 = f32[1,29,1]{2,1,0} aten::mean(%1691), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1693 = f32[1,29,1]{2,1,0} aten::add(%1692, %389, %388), scope=aten::add.160, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1694 = f32[1,29,1]{2,1,0} aten::rsqrt(%1693), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1695 = f32[1,29,3584]{2,1,0} aten::mul(%1690, %1694), scope=aten::mul.161, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1696 = bf16[1,29,3584]{2,1,0} xla::cast(%1695), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1697 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1698 = bf16[1,29,3584]{2,1,0} aten::mul(%1697, %1696), scope=aten::mul.162, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1699 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1700 = bf16[29,512]{1,0} aten::mm(%1699, %387), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1701 = bf16[1,29,512]{2,1,0} aten::view(%1700), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1702 = bf16[1,29,512]{2,1,0} aten::add(%1701, %385, %384), scope=aten::add.165, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1703 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1702), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1704 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1703), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1705 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1704), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1706 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1705), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1707 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1706), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1708 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1707), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1709 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1710 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1711 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1710), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1712 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1711), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1713 = bf16[28,29,128]{2,1,0} aten::view(%1712), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1714 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1715 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1716 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1717 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1718 = s64[1,29]{1,0} aten::expand(%1717), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1719 = s64[1,29]{1,0} aten::add(%628, %1718), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1720 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1721 = pred[1,29]{1,0} aten::lt(%628, %1720), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1722 = s64[1,29]{1,0} aten::where(%1721, %1719, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1723 = s64[1,29,1]{2,1,0} aten::stack(%1722), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1724 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1725 = bf16[29,128]{1,0} xla::select(%1724), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1726 = bf16[1,29,128]{2,1,0} aten::index(%1725, %1723), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1727 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1726), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1728 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1729 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1730 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1731 = bf16[3584,512]{0,1} aten::permute(%1730), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1732 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1733 = bf16[29,512]{1,0} aten::mm(%1732, %1731), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1734 = bf16[1,29,512]{2,1,0} aten::view(%1733), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1735 = bf16[1,29,512]{2,1,0} aten::add(%1734, %1729, %1728), scope=aten::add.164, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1736 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1735), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1737 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1736), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1738 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1737), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1739 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1737), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1740 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1739), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1741 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1740, %1738), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1742 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1741, %1727), scope=aten::mul.170, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1743 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1744 = s64[1,29]{1,0} aten::expand(%1743), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1745 = s64[1,29]{1,0} aten::add(%628, %1744), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1746 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1747 = pred[1,29]{1,0} aten::lt(%628, %1746), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1748 = s64[1,29]{1,0} aten::where(%1747, %1745, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1749 = s64[1,29,1]{2,1,0} aten::stack(%1748), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1750 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1751 = bf16[29,128]{1,0} xla::select(%1750), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1752 = bf16[1,29,128]{2,1,0} aten::index(%1751, %1749), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1753 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1752), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1754 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1737, %1753), scope=aten::mul.169, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1755 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1754, %1742, %1716), scope=aten::add.171, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1756 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1755), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1757 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1758 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1759 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1758), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1760 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1759), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1761 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1760), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1762 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1761), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1763 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1762), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1764 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1763), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1765 = bf16[28,128,29]{2,1,0} aten::view(%1764), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1766 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1767 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1768 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1769 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1770 = bf16[3584,3584]{0,1} aten::permute(%1769), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1771 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1772 = bf16[29,3584]{1,0} aten::mm(%1771, %1770), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1773 = bf16[1,29,3584]{2,1,0} aten::view(%1772), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1774 = bf16[1,29,3584]{2,1,0} aten::add(%1773, %1768, %1767), scope=aten::add.163, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1775 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1774), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1776 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1775), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1777 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1776), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1778 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1776), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1779 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1778), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1780 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1779, %1777), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1781 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1780, %1727), scope=aten::mul.167, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1782 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1776, %1753), scope=aten::mul.166, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1783 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1782, %1781, %1766), scope=aten::add.168, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1784 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1783), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1785 = bf16[28,29,128]{2,1,0} aten::view(%1784), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1786 = bf16[28,29,29]{2,1,0} aten::matmul(%1785, %1765), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1787 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1786), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1788 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1787, %1715), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1789 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1788, %617, %1714), scope=aten::add.172, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1790 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1789), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1791 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1790), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1792 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1791), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1793 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1792), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1794 = bf16[28,29,29]{2,1,0} aten::view(%1793), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1795 = bf16[28,29,128]{2,1,0} aten::matmul(%1794, %1713), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1796 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1795), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1797 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1796), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1798 = bf16[1,29,3584]{2,1,0} aten::view(%1797), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1799 = bf16[29,3584]{1,0} aten::view(%1798), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1800 = bf16[29,3584]{1,0} aten::mm(%1799, %383), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1801 = bf16[1,29,3584]{2,1,0} aten::view(%1800), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1802 = bf16[1,29,3584]{2,1,0} aten::add(%1689, %1801, %381), scope=aten::add.173, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1803 = f32[1,29,3584]{2,1,0} xla::cast(%1802), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1804 = f32[1,29,3584]{2,1,0} aten::pow(%1803, %380), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1805 = f32[1,29,1]{2,1,0} aten::mean(%1804), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1806 = f32[1,29,1]{2,1,0} aten::add(%1805, %379, %378), scope=aten::add.174, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1807 = f32[1,29,1]{2,1,0} aten::rsqrt(%1806), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1808 = f32[1,29,3584]{2,1,0} aten::mul(%1803, %1807), scope=aten::mul.175, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1809 = bf16[1,29,3584]{2,1,0} xla::cast(%1808), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1810 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1811 = bf16[1,29,3584]{2,1,0} aten::mul(%1810, %1809), scope=aten::mul.176, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1812 = bf16[29,3584]{1,0} aten::view(%1811), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1813 = bf16[29,18944]{1,0} aten::mm(%1812, %377), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1814 = bf16[1,29,18944]{2,1,0} aten::view(%1813), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1815 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1816 = bf16[3584,18944]{0,1} aten::permute(%1815), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1817 = bf16[29,3584]{1,0} aten::view(%1811), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1818 = bf16[29,18944]{1,0} aten::mm(%1817, %1816), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1819 = bf16[1,29,18944]{2,1,0} aten::view(%1818), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1820 = bf16[1,29,18944]{2,1,0} aten::silu(%1819), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1821 = bf16[1,29,18944]{2,1,0} aten::mul(%1820, %1814), scope=aten::mul.177, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1822 = bf16[29,18944]{1,0} aten::view(%1821), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1823 = bf16[29,3584]{1,0} aten::mm(%1822, %375), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1824 = bf16[1,29,3584]{2,1,0} aten::view(%1823), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1825 = bf16[1,29,3584]{2,1,0} aten::add(%1802, %1824, %373), scope=aten::add.178, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1826 = f32[1,29,3584]{2,1,0} xla::cast(%1825), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1827 = f32[1,29,3584]{2,1,0} aten::pow(%1826, %372), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1828 = f32[1,29,1]{2,1,0} aten::mean(%1827), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1829 = f32[1,29,1]{2,1,0} aten::add(%1828, %371, %370), scope=aten::add.179, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1830 = f32[1,29,1]{2,1,0} aten::rsqrt(%1829), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1831 = f32[1,29,3584]{2,1,0} aten::mul(%1826, %1830), scope=aten::mul.180, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1832 = bf16[1,29,3584]{2,1,0} xla::cast(%1831), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1833 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1834 = bf16[1,29,3584]{2,1,0} aten::mul(%1833, %1832), scope=aten::mul.181, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1835 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1836 = bf16[29,512]{1,0} aten::mm(%1835, %369), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1837 = bf16[1,29,512]{2,1,0} aten::view(%1836), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1838 = bf16[1,29,512]{2,1,0} aten::add(%1837, %367, %366), scope=aten::add.184, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1839 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1838), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1840 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1839), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1841 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1840), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1842 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1841), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1843 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1842), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1844 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1843), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1845 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1846 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1847 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1846), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1848 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1847), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1849 = bf16[28,29,128]{2,1,0} aten::view(%1848), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1850 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1851 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1852 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1853 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1854 = s64[1,29]{1,0} aten::expand(%1853), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1855 = s64[1,29]{1,0} aten::add(%628, %1854), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1856 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1857 = pred[1,29]{1,0} aten::lt(%628, %1856), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1858 = s64[1,29]{1,0} aten::where(%1857, %1855, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1859 = s64[1,29,1]{2,1,0} aten::stack(%1858), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1860 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1861 = bf16[29,128]{1,0} xla::select(%1860), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1862 = bf16[1,29,128]{2,1,0} aten::index(%1861, %1859), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1863 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1862), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1864 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1865 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1866 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1867 = bf16[3584,512]{0,1} aten::permute(%1866), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1868 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1869 = bf16[29,512]{1,0} aten::mm(%1868, %1867), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1870 = bf16[1,29,512]{2,1,0} aten::view(%1869), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1871 = bf16[1,29,512]{2,1,0} aten::add(%1870, %1865, %1864), scope=aten::add.183, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1872 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1871), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1873 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1872), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1874 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1873), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1875 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1873), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1876 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1875), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1877 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1876, %1874), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1878 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1877, %1863), scope=aten::mul.189, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1879 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1880 = s64[1,29]{1,0} aten::expand(%1879), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1881 = s64[1,29]{1,0} aten::add(%628, %1880), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1882 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1883 = pred[1,29]{1,0} aten::lt(%628, %1882), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1884 = s64[1,29]{1,0} aten::where(%1883, %1881, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1885 = s64[1,29,1]{2,1,0} aten::stack(%1884), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1886 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1887 = bf16[29,128]{1,0} xla::select(%1886), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1888 = bf16[1,29,128]{2,1,0} aten::index(%1887, %1885), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1889 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1888), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1890 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1873, %1889), scope=aten::mul.188, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1891 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1890, %1878, %1852), scope=aten::add.190, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1892 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1891), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1893 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1894 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1895 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1894), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1896 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1895), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1897 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1896), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1898 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1897), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1899 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1898), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1900 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1899), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1901 = bf16[28,128,29]{2,1,0} aten::view(%1900), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1902 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1903 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1904 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1905 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1906 = bf16[3584,3584]{0,1} aten::permute(%1905), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1907 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1908 = bf16[29,3584]{1,0} aten::mm(%1907, %1906), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1909 = bf16[1,29,3584]{2,1,0} aten::view(%1908), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1910 = bf16[1,29,3584]{2,1,0} aten::add(%1909, %1904, %1903), scope=aten::add.182, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1911 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1910), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1912 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1911), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1913 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1912), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1914 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1912), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1915 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1914), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1916 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1915, %1913), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1917 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1916, %1863), scope=aten::mul.186, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1918 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1912, %1889), scope=aten::mul.185, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1919 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1918, %1917, %1902), scope=aten::add.187, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1920 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1919), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1921 = bf16[28,29,128]{2,1,0} aten::view(%1920), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1922 = bf16[28,29,29]{2,1,0} aten::matmul(%1921, %1901), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1923 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1922), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1924 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1923, %1851), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1925 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1924, %617, %1850), scope=aten::add.191, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1926 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1925), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1927 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1926), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1928 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1927), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1929 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1928), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1930 = bf16[28,29,29]{2,1,0} aten::view(%1929), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1931 = bf16[28,29,128]{2,1,0} aten::matmul(%1930, %1849), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1932 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1931), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1933 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1932), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1934 = bf16[1,29,3584]{2,1,0} aten::view(%1933), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1935 = bf16[29,3584]{1,0} aten::view(%1934), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1936 = bf16[29,3584]{1,0} aten::mm(%1935, %365), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1937 = bf16[1,29,3584]{2,1,0} aten::view(%1936), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1938 = bf16[1,29,3584]{2,1,0} aten::add(%1825, %1937, %363), scope=aten::add.192, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1939 = f32[1,29,3584]{2,1,0} xla::cast(%1938), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1940 = f32[1,29,3584]{2,1,0} aten::pow(%1939, %362), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1941 = f32[1,29,1]{2,1,0} aten::mean(%1940), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1942 = f32[1,29,1]{2,1,0} aten::add(%1941, %361, %360), scope=aten::add.193, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1943 = f32[1,29,1]{2,1,0} aten::rsqrt(%1942), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1944 = f32[1,29,3584]{2,1,0} aten::mul(%1939, %1943), scope=aten::mul.194, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1945 = bf16[1,29,3584]{2,1,0} xla::cast(%1944), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1946 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1947 = bf16[1,29,3584]{2,1,0} aten::mul(%1946, %1945), scope=aten::mul.195, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1948 = bf16[29,3584]{1,0} aten::view(%1947), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1949 = bf16[29,18944]{1,0} aten::mm(%1948, %359), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1950 = bf16[1,29,18944]{2,1,0} aten::view(%1949), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1951 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1952 = bf16[3584,18944]{0,1} aten::permute(%1951), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1953 = bf16[29,3584]{1,0} aten::view(%1947), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1954 = bf16[29,18944]{1,0} aten::mm(%1953, %1952), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1955 = bf16[1,29,18944]{2,1,0} aten::view(%1954), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1956 = bf16[1,29,18944]{2,1,0} aten::silu(%1955), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1957 = bf16[1,29,18944]{2,1,0} aten::mul(%1956, %1950), scope=aten::mul.196, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1958 = bf16[29,18944]{1,0} aten::view(%1957), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1959 = bf16[29,3584]{1,0} aten::mm(%1958, %357), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1960 = bf16[1,29,3584]{2,1,0} aten::view(%1959), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1961 = bf16[1,29,3584]{2,1,0} aten::add(%1938, %1960, %355), scope=aten::add.197, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1962 = f32[1,29,3584]{2,1,0} xla::cast(%1961), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1963 = f32[1,29,3584]{2,1,0} aten::pow(%1962, %354), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1964 = f32[1,29,1]{2,1,0} aten::mean(%1963), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1965 = f32[1,29,1]{2,1,0} aten::add(%1964, %353, %352), scope=aten::add.198, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1966 = f32[1,29,1]{2,1,0} aten::rsqrt(%1965), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1967 = f32[1,29,3584]{2,1,0} aten::mul(%1962, %1966), scope=aten::mul.199, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1968 = bf16[1,29,3584]{2,1,0} xla::cast(%1967), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1969 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1970 = bf16[1,29,3584]{2,1,0} aten::mul(%1969, %1968), scope=aten::mul.200, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1971 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1972 = bf16[29,512]{1,0} aten::mm(%1971, %351), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1973 = bf16[1,29,512]{2,1,0} aten::view(%1972), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1974 = bf16[1,29,512]{2,1,0} aten::add(%1973, %349, %348), scope=aten::add.203, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1975 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1974), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1976 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1975), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1977 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1976), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1978 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1977), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1979 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1978), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1980 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1979), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1981 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1982 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1983 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1982), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1984 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1983), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1985 = bf16[28,29,128]{2,1,0} aten::view(%1984), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1986 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1987 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1988 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1989 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1990 = s64[1,29]{1,0} aten::expand(%1989), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1991 = s64[1,29]{1,0} aten::add(%628, %1990), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1992 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1993 = pred[1,29]{1,0} aten::lt(%628, %1992), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1994 = s64[1,29]{1,0} aten::where(%1993, %1991, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1995 = s64[1,29,1]{2,1,0} aten::stack(%1994), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1996 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1997 = bf16[29,128]{1,0} xla::select(%1996), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1998 = bf16[1,29,128]{2,1,0} aten::index(%1997, %1995), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1999 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1998), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2000 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2001 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2002 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2003 = bf16[3584,512]{0,1} aten::permute(%2002), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2004 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2005 = bf16[29,512]{1,0} aten::mm(%2004, %2003), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2006 = bf16[1,29,512]{2,1,0} aten::view(%2005), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2007 = bf16[1,29,512]{2,1,0} aten::add(%2006, %2001, %2000), scope=aten::add.202, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2008 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2007), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2009 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2008), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2010 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2009), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2011 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2009), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2012 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2011), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2013 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2012, %2010), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2014 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2013, %1999), scope=aten::mul.208, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2015 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2016 = s64[1,29]{1,0} aten::expand(%2015), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2017 = s64[1,29]{1,0} aten::add(%628, %2016), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2018 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2019 = pred[1,29]{1,0} aten::lt(%628, %2018), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2020 = s64[1,29]{1,0} aten::where(%2019, %2017, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2021 = s64[1,29,1]{2,1,0} aten::stack(%2020), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2022 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2023 = bf16[29,128]{1,0} xla::select(%2022), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2024 = bf16[1,29,128]{2,1,0} aten::index(%2023, %2021), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2025 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2024), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2026 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2009, %2025), scope=aten::mul.207, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2027 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2026, %2014, %1988), scope=aten::add.209, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2028 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2027), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2029 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2030 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2031 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2030), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2032 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2031), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2033 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2032), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2034 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2033), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2035 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2034), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2036 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2035), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2037 = bf16[28,128,29]{2,1,0} aten::view(%2036), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2038 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2039 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2040 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2041 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2042 = bf16[3584,3584]{0,1} aten::permute(%2041), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2043 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2044 = bf16[29,3584]{1,0} aten::mm(%2043, %2042), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2045 = bf16[1,29,3584]{2,1,0} aten::view(%2044), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2046 = bf16[1,29,3584]{2,1,0} aten::add(%2045, %2040, %2039), scope=aten::add.201, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2047 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2046), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2048 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2047), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2049 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2048), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2050 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2048), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2051 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2050), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2052 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2051, %2049), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2053 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2052, %1999), scope=aten::mul.205, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2054 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2048, %2025), scope=aten::mul.204, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2055 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2054, %2053, %2038), scope=aten::add.206, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2056 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2055), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2057 = bf16[28,29,128]{2,1,0} aten::view(%2056), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2058 = bf16[28,29,29]{2,1,0} aten::matmul(%2057, %2037), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2059 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2058), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2060 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2059, %1987), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2061 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2060, %617, %1986), scope=aten::add.210, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2062 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2061), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2063 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2062), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2064 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2063), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2065 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2064), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2066 = bf16[28,29,29]{2,1,0} aten::view(%2065), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2067 = bf16[28,29,128]{2,1,0} aten::matmul(%2066, %1985), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2068 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2067), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2069 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2068), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2070 = bf16[1,29,3584]{2,1,0} aten::view(%2069), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2071 = bf16[29,3584]{1,0} aten::view(%2070), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2072 = bf16[29,3584]{1,0} aten::mm(%2071, %347), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2073 = bf16[1,29,3584]{2,1,0} aten::view(%2072), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2074 = bf16[1,29,3584]{2,1,0} aten::add(%1961, %2073, %345), scope=aten::add.211, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2075 = f32[1,29,3584]{2,1,0} xla::cast(%2074), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2076 = f32[1,29,3584]{2,1,0} aten::pow(%2075, %344), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2077 = f32[1,29,1]{2,1,0} aten::mean(%2076), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2078 = f32[1,29,1]{2,1,0} aten::add(%2077, %343, %342), scope=aten::add.212, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2079 = f32[1,29,1]{2,1,0} aten::rsqrt(%2078), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2080 = f32[1,29,3584]{2,1,0} aten::mul(%2075, %2079), scope=aten::mul.213, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2081 = bf16[1,29,3584]{2,1,0} xla::cast(%2080), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2082 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2083 = bf16[1,29,3584]{2,1,0} aten::mul(%2082, %2081), scope=aten::mul.214, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2084 = bf16[29,3584]{1,0} aten::view(%2083), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2085 = bf16[29,18944]{1,0} aten::mm(%2084, %341), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2086 = bf16[1,29,18944]{2,1,0} aten::view(%2085), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2087 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2088 = bf16[3584,18944]{0,1} aten::permute(%2087), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2089 = bf16[29,3584]{1,0} aten::view(%2083), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2090 = bf16[29,18944]{1,0} aten::mm(%2089, %2088), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2091 = bf16[1,29,18944]{2,1,0} aten::view(%2090), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2092 = bf16[1,29,18944]{2,1,0} aten::silu(%2091), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2093 = bf16[1,29,18944]{2,1,0} aten::mul(%2092, %2086), scope=aten::mul.215, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2094 = bf16[29,18944]{1,0} aten::view(%2093), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2095 = bf16[29,3584]{1,0} aten::mm(%2094, %339), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2096 = bf16[1,29,3584]{2,1,0} aten::view(%2095), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2097 = bf16[1,29,3584]{2,1,0} aten::add(%2074, %2096, %337), scope=aten::add.216, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2098 = f32[1,29,3584]{2,1,0} xla::cast(%2097), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2099 = f32[1,29,3584]{2,1,0} aten::pow(%2098, %336), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2100 = f32[1,29,1]{2,1,0} aten::mean(%2099), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2101 = f32[1,29,1]{2,1,0} aten::add(%2100, %335, %334), scope=aten::add.217, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2102 = f32[1,29,1]{2,1,0} aten::rsqrt(%2101), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2103 = f32[1,29,3584]{2,1,0} aten::mul(%2098, %2102), scope=aten::mul.218, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2104 = bf16[1,29,3584]{2,1,0} xla::cast(%2103), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2105 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2106 = bf16[1,29,3584]{2,1,0} aten::mul(%2105, %2104), scope=aten::mul.219, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2107 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2108 = bf16[29,512]{1,0} aten::mm(%2107, %333), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2109 = bf16[1,29,512]{2,1,0} aten::view(%2108), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2110 = bf16[1,29,512]{2,1,0} aten::add(%2109, %331, %330), scope=aten::add.222, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2111 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2110), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2112 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2111), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2113 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2112), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2114 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2113), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2115 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2114), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2116 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2115), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2117 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2118 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2119 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2118), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2120 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2119), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2121 = bf16[28,29,128]{2,1,0} aten::view(%2120), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2122 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2123 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2124 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2125 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2126 = s64[1,29]{1,0} aten::expand(%2125), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2127 = s64[1,29]{1,0} aten::add(%628, %2126), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2128 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2129 = pred[1,29]{1,0} aten::lt(%628, %2128), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2130 = s64[1,29]{1,0} aten::where(%2129, %2127, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2131 = s64[1,29,1]{2,1,0} aten::stack(%2130), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2132 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2133 = bf16[29,128]{1,0} xla::select(%2132), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2134 = bf16[1,29,128]{2,1,0} aten::index(%2133, %2131), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2135 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2134), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2136 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2137 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2138 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2139 = bf16[3584,512]{0,1} aten::permute(%2138), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2140 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2141 = bf16[29,512]{1,0} aten::mm(%2140, %2139), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2142 = bf16[1,29,512]{2,1,0} aten::view(%2141), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2143 = bf16[1,29,512]{2,1,0} aten::add(%2142, %2137, %2136), scope=aten::add.221, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2144 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2143), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2145 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2144), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2146 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2145), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2147 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2145), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2148 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2147), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2149 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2148, %2146), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2150 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2149, %2135), scope=aten::mul.227, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2151 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2152 = s64[1,29]{1,0} aten::expand(%2151), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2153 = s64[1,29]{1,0} aten::add(%628, %2152), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2154 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2155 = pred[1,29]{1,0} aten::lt(%628, %2154), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2156 = s64[1,29]{1,0} aten::where(%2155, %2153, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2157 = s64[1,29,1]{2,1,0} aten::stack(%2156), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2158 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2159 = bf16[29,128]{1,0} xla::select(%2158), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2160 = bf16[1,29,128]{2,1,0} aten::index(%2159, %2157), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2161 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2160), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2162 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2145, %2161), scope=aten::mul.226, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2163 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2162, %2150, %2124), scope=aten::add.228, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2164 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2163), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2165 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2166 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2167 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2166), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2168 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2167), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2169 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2168), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2170 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2169), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2171 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2170), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2172 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2171), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2173 = bf16[28,128,29]{2,1,0} aten::view(%2172), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2174 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2175 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2176 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2177 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2178 = bf16[3584,3584]{0,1} aten::permute(%2177), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2179 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2180 = bf16[29,3584]{1,0} aten::mm(%2179, %2178), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2181 = bf16[1,29,3584]{2,1,0} aten::view(%2180), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2182 = bf16[1,29,3584]{2,1,0} aten::add(%2181, %2176, %2175), scope=aten::add.220, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2183 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2182), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2184 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2183), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2185 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2184), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2186 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2184), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2187 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2186), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2188 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2187, %2185), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2189 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2188, %2135), scope=aten::mul.224, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2190 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2184, %2161), scope=aten::mul.223, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2191 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2190, %2189, %2174), scope=aten::add.225, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2192 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2191), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2193 = bf16[28,29,128]{2,1,0} aten::view(%2192), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2194 = bf16[28,29,29]{2,1,0} aten::matmul(%2193, %2173), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2195 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2194), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2196 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2195, %2123), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2197 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2196, %617, %2122), scope=aten::add.229, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2198 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2197), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2199 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2198), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2200 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2199), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2201 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2200), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2202 = bf16[28,29,29]{2,1,0} aten::view(%2201), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2203 = bf16[28,29,128]{2,1,0} aten::matmul(%2202, %2121), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2204 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2203), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2205 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2204), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2206 = bf16[1,29,3584]{2,1,0} aten::view(%2205), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2207 = bf16[29,3584]{1,0} aten::view(%2206), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2208 = bf16[29,3584]{1,0} aten::mm(%2207, %329), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2209 = bf16[1,29,3584]{2,1,0} aten::view(%2208), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2210 = bf16[1,29,3584]{2,1,0} aten::add(%2097, %2209, %327), scope=aten::add.230, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2211 = f32[1,29,3584]{2,1,0} xla::cast(%2210), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2212 = f32[1,29,3584]{2,1,0} aten::pow(%2211, %326), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2213 = f32[1,29,1]{2,1,0} aten::mean(%2212), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2214 = f32[1,29,1]{2,1,0} aten::add(%2213, %325, %324), scope=aten::add.231, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2215 = f32[1,29,1]{2,1,0} aten::rsqrt(%2214), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2216 = f32[1,29,3584]{2,1,0} aten::mul(%2211, %2215), scope=aten::mul.232, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2217 = bf16[1,29,3584]{2,1,0} xla::cast(%2216), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2218 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2219 = bf16[1,29,3584]{2,1,0} aten::mul(%2218, %2217), scope=aten::mul.233, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2220 = bf16[29,3584]{1,0} aten::view(%2219), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2221 = bf16[29,18944]{1,0} aten::mm(%2220, %323), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2222 = bf16[1,29,18944]{2,1,0} aten::view(%2221), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2223 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2224 = bf16[3584,18944]{0,1} aten::permute(%2223), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2225 = bf16[29,3584]{1,0} aten::view(%2219), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2226 = bf16[29,18944]{1,0} aten::mm(%2225, %2224), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2227 = bf16[1,29,18944]{2,1,0} aten::view(%2226), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2228 = bf16[1,29,18944]{2,1,0} aten::silu(%2227), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2229 = bf16[1,29,18944]{2,1,0} aten::mul(%2228, %2222), scope=aten::mul.234, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2230 = bf16[29,18944]{1,0} aten::view(%2229), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2231 = bf16[29,3584]{1,0} aten::mm(%2230, %321), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2232 = bf16[1,29,3584]{2,1,0} aten::view(%2231), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2233 = bf16[1,29,3584]{2,1,0} aten::add(%2210, %2232, %319), scope=aten::add.235, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2234 = f32[1,29,3584]{2,1,0} xla::cast(%2233), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2235 = f32[1,29,3584]{2,1,0} aten::pow(%2234, %318), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2236 = f32[1,29,1]{2,1,0} aten::mean(%2235), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2237 = f32[1,29,1]{2,1,0} aten::add(%2236, %317, %316), scope=aten::add.236, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2238 = f32[1,29,1]{2,1,0} aten::rsqrt(%2237), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2239 = f32[1,29,3584]{2,1,0} aten::mul(%2234, %2238), scope=aten::mul.237, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2240 = bf16[1,29,3584]{2,1,0} xla::cast(%2239), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2241 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2242 = bf16[1,29,3584]{2,1,0} aten::mul(%2241, %2240), scope=aten::mul.238, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2243 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2244 = bf16[29,512]{1,0} aten::mm(%2243, %315), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2245 = bf16[1,29,512]{2,1,0} aten::view(%2244), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2246 = bf16[1,29,512]{2,1,0} aten::add(%2245, %313, %312), scope=aten::add.241, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2247 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2246), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2248 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2247), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2249 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2248), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2250 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2249), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2251 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2250), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2252 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2251), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2253 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2254 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2255 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2254), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2256 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2255), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2257 = bf16[28,29,128]{2,1,0} aten::view(%2256), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2258 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2259 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2260 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2261 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2262 = s64[1,29]{1,0} aten::expand(%2261), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2263 = s64[1,29]{1,0} aten::add(%628, %2262), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2264 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2265 = pred[1,29]{1,0} aten::lt(%628, %2264), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2266 = s64[1,29]{1,0} aten::where(%2265, %2263, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2267 = s64[1,29,1]{2,1,0} aten::stack(%2266), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2268 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2269 = bf16[29,128]{1,0} xla::select(%2268), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2270 = bf16[1,29,128]{2,1,0} aten::index(%2269, %2267), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2271 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2270), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2272 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2273 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2274 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2275 = bf16[3584,512]{0,1} aten::permute(%2274), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2276 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2277 = bf16[29,512]{1,0} aten::mm(%2276, %2275), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2278 = bf16[1,29,512]{2,1,0} aten::view(%2277), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2279 = bf16[1,29,512]{2,1,0} aten::add(%2278, %2273, %2272), scope=aten::add.240, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2280 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2279), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2281 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2280), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2282 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2281), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2283 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2281), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2284 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2283), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2285 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2284, %2282), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2286 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2285, %2271), scope=aten::mul.246, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2287 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2288 = s64[1,29]{1,0} aten::expand(%2287), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2289 = s64[1,29]{1,0} aten::add(%628, %2288), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2290 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2291 = pred[1,29]{1,0} aten::lt(%628, %2290), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2292 = s64[1,29]{1,0} aten::where(%2291, %2289, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2293 = s64[1,29,1]{2,1,0} aten::stack(%2292), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2294 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2295 = bf16[29,128]{1,0} xla::select(%2294), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2296 = bf16[1,29,128]{2,1,0} aten::index(%2295, %2293), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2297 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2296), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2298 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2281, %2297), scope=aten::mul.245, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2299 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2298, %2286, %2260), scope=aten::add.247, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2300 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2299), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2301 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2302 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2303 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2302), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2304 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2303), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2305 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2304), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2306 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2305), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2307 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2306), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2308 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2307), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2309 = bf16[28,128,29]{2,1,0} aten::view(%2308), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2310 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2311 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2312 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2313 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2314 = bf16[3584,3584]{0,1} aten::permute(%2313), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2315 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2316 = bf16[29,3584]{1,0} aten::mm(%2315, %2314), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2317 = bf16[1,29,3584]{2,1,0} aten::view(%2316), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2318 = bf16[1,29,3584]{2,1,0} aten::add(%2317, %2312, %2311), scope=aten::add.239, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2319 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2318), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2320 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2319), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2321 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2320), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2322 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2320), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2323 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2322), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2324 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2323, %2321), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2325 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2324, %2271), scope=aten::mul.243, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2326 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2320, %2297), scope=aten::mul.242, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2327 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2326, %2325, %2310), scope=aten::add.244, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2328 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2327), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2329 = bf16[28,29,128]{2,1,0} aten::view(%2328), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2330 = bf16[28,29,29]{2,1,0} aten::matmul(%2329, %2309), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2331 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2330), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2332 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2331, %2259), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2333 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2332, %617, %2258), scope=aten::add.248, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2334 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2333), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2335 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2334), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2336 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2335), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2337 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2336), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2338 = bf16[28,29,29]{2,1,0} aten::view(%2337), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2339 = bf16[28,29,128]{2,1,0} aten::matmul(%2338, %2257), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2340 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2339), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2341 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2340), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2342 = bf16[1,29,3584]{2,1,0} aten::view(%2341), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2343 = bf16[29,3584]{1,0} aten::view(%2342), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2344 = bf16[29,3584]{1,0} aten::mm(%2343, %311), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2345 = bf16[1,29,3584]{2,1,0} aten::view(%2344), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2346 = bf16[1,29,3584]{2,1,0} aten::add(%2233, %2345, %309), scope=aten::add.249, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2347 = f32[1,29,3584]{2,1,0} xla::cast(%2346), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2348 = f32[1,29,3584]{2,1,0} aten::pow(%2347, %308), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2349 = f32[1,29,1]{2,1,0} aten::mean(%2348), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2350 = f32[1,29,1]{2,1,0} aten::add(%2349, %307, %306), scope=aten::add.250, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2351 = f32[1,29,1]{2,1,0} aten::rsqrt(%2350), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2352 = f32[1,29,3584]{2,1,0} aten::mul(%2347, %2351), scope=aten::mul.251, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2353 = bf16[1,29,3584]{2,1,0} xla::cast(%2352), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2354 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2355 = bf16[1,29,3584]{2,1,0} aten::mul(%2354, %2353), scope=aten::mul.252, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2356 = bf16[29,3584]{1,0} aten::view(%2355), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2357 = bf16[29,18944]{1,0} aten::mm(%2356, %305), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2358 = bf16[1,29,18944]{2,1,0} aten::view(%2357), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2359 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2360 = bf16[3584,18944]{0,1} aten::permute(%2359), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2361 = bf16[29,3584]{1,0} aten::view(%2355), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2362 = bf16[29,18944]{1,0} aten::mm(%2361, %2360), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2363 = bf16[1,29,18944]{2,1,0} aten::view(%2362), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2364 = bf16[1,29,18944]{2,1,0} aten::silu(%2363), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2365 = bf16[1,29,18944]{2,1,0} aten::mul(%2364, %2358), scope=aten::mul.253, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2366 = bf16[29,18944]{1,0} aten::view(%2365), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2367 = bf16[29,3584]{1,0} aten::mm(%2366, %303), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2368 = bf16[1,29,3584]{2,1,0} aten::view(%2367), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2369 = bf16[1,29,3584]{2,1,0} aten::add(%2346, %2368, %301), scope=aten::add.254, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2370 = f32[1,29,3584]{2,1,0} xla::cast(%2369), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2371 = f32[1,29,3584]{2,1,0} aten::pow(%2370, %300), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2372 = f32[1,29,1]{2,1,0} aten::mean(%2371), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2373 = f32[1,29,1]{2,1,0} aten::add(%2372, %299, %298), scope=aten::add.255, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2374 = f32[1,29,1]{2,1,0} aten::rsqrt(%2373), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2375 = f32[1,29,3584]{2,1,0} aten::mul(%2370, %2374), scope=aten::mul.256, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2376 = bf16[1,29,3584]{2,1,0} xla::cast(%2375), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2377 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2378 = bf16[1,29,3584]{2,1,0} aten::mul(%2377, %2376), scope=aten::mul.257, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2379 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2380 = bf16[29,512]{1,0} aten::mm(%2379, %297), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2381 = bf16[1,29,512]{2,1,0} aten::view(%2380), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2382 = bf16[1,29,512]{2,1,0} aten::add(%2381, %295, %294), scope=aten::add.260, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2383 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2382), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2384 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2383), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2385 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2384), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2386 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2385), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2387 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2386), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2388 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2387), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2389 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2390 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2391 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2390), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2392 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2391), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2393 = bf16[28,29,128]{2,1,0} aten::view(%2392), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2394 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2395 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2396 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2397 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2398 = s64[1,29]{1,0} aten::expand(%2397), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2399 = s64[1,29]{1,0} aten::add(%628, %2398), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2400 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2401 = pred[1,29]{1,0} aten::lt(%628, %2400), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2402 = s64[1,29]{1,0} aten::where(%2401, %2399, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2403 = s64[1,29,1]{2,1,0} aten::stack(%2402), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2404 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2405 = bf16[29,128]{1,0} xla::select(%2404), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2406 = bf16[1,29,128]{2,1,0} aten::index(%2405, %2403), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2407 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2406), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2408 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2409 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2410 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2411 = bf16[3584,512]{0,1} aten::permute(%2410), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2412 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2413 = bf16[29,512]{1,0} aten::mm(%2412, %2411), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2414 = bf16[1,29,512]{2,1,0} aten::view(%2413), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2415 = bf16[1,29,512]{2,1,0} aten::add(%2414, %2409, %2408), scope=aten::add.259, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2416 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2415), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2417 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2416), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2418 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2417), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2419 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2417), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2420 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2419), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2421 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2420, %2418), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2422 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2421, %2407), scope=aten::mul.265, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2423 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2424 = s64[1,29]{1,0} aten::expand(%2423), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2425 = s64[1,29]{1,0} aten::add(%628, %2424), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2426 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2427 = pred[1,29]{1,0} aten::lt(%628, %2426), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2428 = s64[1,29]{1,0} aten::where(%2427, %2425, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2429 = s64[1,29,1]{2,1,0} aten::stack(%2428), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2430 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2431 = bf16[29,128]{1,0} xla::select(%2430), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2432 = bf16[1,29,128]{2,1,0} aten::index(%2431, %2429), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2433 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2432), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2434 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2417, %2433), scope=aten::mul.264, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2435 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2434, %2422, %2396), scope=aten::add.266, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2436 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2435), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2437 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2438 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2439 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2438), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2440 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2439), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2441 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2440), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2442 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2441), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2443 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2442), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2444 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2443), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2445 = bf16[28,128,29]{2,1,0} aten::view(%2444), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2446 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2447 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2448 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2449 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2450 = bf16[3584,3584]{0,1} aten::permute(%2449), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2451 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2452 = bf16[29,3584]{1,0} aten::mm(%2451, %2450), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2453 = bf16[1,29,3584]{2,1,0} aten::view(%2452), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2454 = bf16[1,29,3584]{2,1,0} aten::add(%2453, %2448, %2447), scope=aten::add.258, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2455 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2454), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2456 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2455), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2457 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2456), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2458 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2456), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2459 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2458), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2460 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2459, %2457), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2461 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2460, %2407), scope=aten::mul.262, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2462 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2456, %2433), scope=aten::mul.261, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2463 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2462, %2461, %2446), scope=aten::add.263, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2464 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2463), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2465 = bf16[28,29,128]{2,1,0} aten::view(%2464), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2466 = bf16[28,29,29]{2,1,0} aten::matmul(%2465, %2445), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2467 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2466), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2468 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2467, %2395), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2469 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2468, %617, %2394), scope=aten::add.267, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2470 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2469), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2471 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2470), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2472 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2471), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2473 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2472), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2474 = bf16[28,29,29]{2,1,0} aten::view(%2473), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2475 = bf16[28,29,128]{2,1,0} aten::matmul(%2474, %2393), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2476 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2475), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2477 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2476), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2478 = bf16[1,29,3584]{2,1,0} aten::view(%2477), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2479 = bf16[29,3584]{1,0} aten::view(%2478), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2480 = bf16[29,3584]{1,0} aten::mm(%2479, %293), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2481 = bf16[1,29,3584]{2,1,0} aten::view(%2480), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2482 = bf16[1,29,3584]{2,1,0} aten::add(%2369, %2481, %291), scope=aten::add.268, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2483 = f32[1,29,3584]{2,1,0} xla::cast(%2482), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2484 = f32[1,29,3584]{2,1,0} aten::pow(%2483, %290), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2485 = f32[1,29,1]{2,1,0} aten::mean(%2484), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2486 = f32[1,29,1]{2,1,0} aten::add(%2485, %289, %288), scope=aten::add.269, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2487 = f32[1,29,1]{2,1,0} aten::rsqrt(%2486), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2488 = f32[1,29,3584]{2,1,0} aten::mul(%2483, %2487), scope=aten::mul.270, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2489 = bf16[1,29,3584]{2,1,0} xla::cast(%2488), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2490 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2491 = bf16[1,29,3584]{2,1,0} aten::mul(%2490, %2489), scope=aten::mul.271, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2492 = bf16[29,3584]{1,0} aten::view(%2491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2493 = bf16[29,18944]{1,0} aten::mm(%2492, %287), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2494 = bf16[1,29,18944]{2,1,0} aten::view(%2493), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2495 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2496 = bf16[3584,18944]{0,1} aten::permute(%2495), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2497 = bf16[29,3584]{1,0} aten::view(%2491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2498 = bf16[29,18944]{1,0} aten::mm(%2497, %2496), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2499 = bf16[1,29,18944]{2,1,0} aten::view(%2498), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2500 = bf16[1,29,18944]{2,1,0} aten::silu(%2499), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2501 = bf16[1,29,18944]{2,1,0} aten::mul(%2500, %2494), scope=aten::mul.272, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2502 = bf16[29,18944]{1,0} aten::view(%2501), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2503 = bf16[29,3584]{1,0} aten::mm(%2502, %285), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2504 = bf16[1,29,3584]{2,1,0} aten::view(%2503), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2505 = bf16[1,29,3584]{2,1,0} aten::add(%2482, %2504, %283), scope=aten::add.273, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2506 = f32[1,29,3584]{2,1,0} xla::cast(%2505), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2507 = f32[1,29,3584]{2,1,0} aten::pow(%2506, %282), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2508 = f32[1,29,1]{2,1,0} aten::mean(%2507), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2509 = f32[1,29,1]{2,1,0} aten::add(%2508, %281, %280), scope=aten::add.274, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2510 = f32[1,29,1]{2,1,0} aten::rsqrt(%2509), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2511 = f32[1,29,3584]{2,1,0} aten::mul(%2506, %2510), scope=aten::mul.275, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2512 = bf16[1,29,3584]{2,1,0} xla::cast(%2511), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2513 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2514 = bf16[1,29,3584]{2,1,0} aten::mul(%2513, %2512), scope=aten::mul.276, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2515 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2516 = bf16[29,512]{1,0} aten::mm(%2515, %279), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2517 = bf16[1,29,512]{2,1,0} aten::view(%2516), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2518 = bf16[1,29,512]{2,1,0} aten::add(%2517, %277, %276), scope=aten::add.279, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2519 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2518), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2520 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2519), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2521 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2520), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2522 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2521), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2523 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2522), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2524 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2523), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2525 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2526 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2527 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2526), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2528 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2527), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2529 = bf16[28,29,128]{2,1,0} aten::view(%2528), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2530 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2531 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2532 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2533 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2534 = s64[1,29]{1,0} aten::expand(%2533), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2535 = s64[1,29]{1,0} aten::add(%628, %2534), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2536 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2537 = pred[1,29]{1,0} aten::lt(%628, %2536), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2538 = s64[1,29]{1,0} aten::where(%2537, %2535, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2539 = s64[1,29,1]{2,1,0} aten::stack(%2538), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2540 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2541 = bf16[29,128]{1,0} xla::select(%2540), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2542 = bf16[1,29,128]{2,1,0} aten::index(%2541, %2539), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2543 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2542), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2544 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2545 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2546 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2547 = bf16[3584,512]{0,1} aten::permute(%2546), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2548 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2549 = bf16[29,512]{1,0} aten::mm(%2548, %2547), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2550 = bf16[1,29,512]{2,1,0} aten::view(%2549), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2551 = bf16[1,29,512]{2,1,0} aten::add(%2550, %2545, %2544), scope=aten::add.278, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2552 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2551), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2553 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2552), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2554 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2553), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2555 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2553), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2556 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2555), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2557 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2556, %2554), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2558 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2557, %2543), scope=aten::mul.284, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2559 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2560 = s64[1,29]{1,0} aten::expand(%2559), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2561 = s64[1,29]{1,0} aten::add(%628, %2560), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2562 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2563 = pred[1,29]{1,0} aten::lt(%628, %2562), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2564 = s64[1,29]{1,0} aten::where(%2563, %2561, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2565 = s64[1,29,1]{2,1,0} aten::stack(%2564), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2566 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2567 = bf16[29,128]{1,0} xla::select(%2566), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2568 = bf16[1,29,128]{2,1,0} aten::index(%2567, %2565), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2569 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2568), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2570 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2553, %2569), scope=aten::mul.283, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2571 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2570, %2558, %2532), scope=aten::add.285, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2572 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2571), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2573 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2574 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2575 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2574), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2576 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2575), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2577 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2576), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2578 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2577), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2579 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2578), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2580 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2579), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2581 = bf16[28,128,29]{2,1,0} aten::view(%2580), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2582 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2583 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2584 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2585 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2586 = bf16[3584,3584]{0,1} aten::permute(%2585), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2587 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2588 = bf16[29,3584]{1,0} aten::mm(%2587, %2586), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2589 = bf16[1,29,3584]{2,1,0} aten::view(%2588), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2590 = bf16[1,29,3584]{2,1,0} aten::add(%2589, %2584, %2583), scope=aten::add.277, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2591 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2590), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2592 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2591), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2593 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2592), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2594 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2592), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2595 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2594), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2596 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2595, %2593), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2597 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2596, %2543), scope=aten::mul.281, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2598 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2592, %2569), scope=aten::mul.280, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2599 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2598, %2597, %2582), scope=aten::add.282, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2600 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2599), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2601 = bf16[28,29,128]{2,1,0} aten::view(%2600), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2602 = bf16[28,29,29]{2,1,0} aten::matmul(%2601, %2581), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2603 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2602), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2604 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2603, %2531), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2605 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2604, %617, %2530), scope=aten::add.286, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2606 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2605), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2607 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2606), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2608 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2607), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2609 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2608), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2610 = bf16[28,29,29]{2,1,0} aten::view(%2609), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2611 = bf16[28,29,128]{2,1,0} aten::matmul(%2610, %2529), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2612 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2611), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2613 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2612), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2614 = bf16[1,29,3584]{2,1,0} aten::view(%2613), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2615 = bf16[29,3584]{1,0} aten::view(%2614), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2616 = bf16[29,3584]{1,0} aten::mm(%2615, %275), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2617 = bf16[1,29,3584]{2,1,0} aten::view(%2616), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2618 = bf16[1,29,3584]{2,1,0} aten::add(%2505, %2617, %273), scope=aten::add.287, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2619 = f32[1,29,3584]{2,1,0} xla::cast(%2618), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2620 = f32[1,29,3584]{2,1,0} aten::pow(%2619, %272), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2621 = f32[1,29,1]{2,1,0} aten::mean(%2620), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2622 = f32[1,29,1]{2,1,0} aten::add(%2621, %271, %270), scope=aten::add.288, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2623 = f32[1,29,1]{2,1,0} aten::rsqrt(%2622), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2624 = f32[1,29,3584]{2,1,0} aten::mul(%2619, %2623), scope=aten::mul.289, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2625 = bf16[1,29,3584]{2,1,0} xla::cast(%2624), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2626 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2627 = bf16[1,29,3584]{2,1,0} aten::mul(%2626, %2625), scope=aten::mul.290, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2628 = bf16[29,3584]{1,0} aten::view(%2627), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2629 = bf16[29,18944]{1,0} aten::mm(%2628, %269), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2630 = bf16[1,29,18944]{2,1,0} aten::view(%2629), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2631 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2632 = bf16[3584,18944]{0,1} aten::permute(%2631), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2633 = bf16[29,3584]{1,0} aten::view(%2627), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2634 = bf16[29,18944]{1,0} aten::mm(%2633, %2632), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2635 = bf16[1,29,18944]{2,1,0} aten::view(%2634), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2636 = bf16[1,29,18944]{2,1,0} aten::silu(%2635), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2637 = bf16[1,29,18944]{2,1,0} aten::mul(%2636, %2630), scope=aten::mul.291, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2638 = bf16[29,18944]{1,0} aten::view(%2637), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2639 = bf16[29,3584]{1,0} aten::mm(%2638, %267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2640 = bf16[1,29,3584]{2,1,0} aten::view(%2639), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2641 = bf16[1,29,3584]{2,1,0} aten::add(%2618, %2640, %265), scope=aten::add.292, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2642 = f32[1,29,3584]{2,1,0} xla::cast(%2641), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2643 = f32[1,29,3584]{2,1,0} aten::pow(%2642, %264), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2644 = f32[1,29,1]{2,1,0} aten::mean(%2643), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2645 = f32[1,29,1]{2,1,0} aten::add(%2644, %263, %262), scope=aten::add.293, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2646 = f32[1,29,1]{2,1,0} aten::rsqrt(%2645), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2647 = f32[1,29,3584]{2,1,0} aten::mul(%2642, %2646), scope=aten::mul.294, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2648 = bf16[1,29,3584]{2,1,0} xla::cast(%2647), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2649 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2650 = bf16[1,29,3584]{2,1,0} aten::mul(%2649, %2648), scope=aten::mul.295, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2651 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2652 = bf16[29,512]{1,0} aten::mm(%2651, %261), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2653 = bf16[1,29,512]{2,1,0} aten::view(%2652), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2654 = bf16[1,29,512]{2,1,0} aten::add(%2653, %259, %258), scope=aten::add.298, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2655 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2654), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2656 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2655), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2657 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2656), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2658 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2657), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2659 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2658), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2660 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2659), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2661 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2662 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2663 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2662), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2664 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2663), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2665 = bf16[28,29,128]{2,1,0} aten::view(%2664), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2666 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2667 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2668 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2669 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2670 = s64[1,29]{1,0} aten::expand(%2669), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2671 = s64[1,29]{1,0} aten::add(%628, %2670), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2672 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2673 = pred[1,29]{1,0} aten::lt(%628, %2672), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2674 = s64[1,29]{1,0} aten::where(%2673, %2671, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2675 = s64[1,29,1]{2,1,0} aten::stack(%2674), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2676 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2677 = bf16[29,128]{1,0} xla::select(%2676), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2678 = bf16[1,29,128]{2,1,0} aten::index(%2677, %2675), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2679 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2678), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2680 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2681 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2682 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2683 = bf16[3584,512]{0,1} aten::permute(%2682), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2684 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2685 = bf16[29,512]{1,0} aten::mm(%2684, %2683), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2686 = bf16[1,29,512]{2,1,0} aten::view(%2685), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2687 = bf16[1,29,512]{2,1,0} aten::add(%2686, %2681, %2680), scope=aten::add.297, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2688 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2687), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2689 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2688), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2690 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2689), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2691 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2689), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2692 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2691), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2693 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2692, %2690), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2694 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2693, %2679), scope=aten::mul.303, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2695 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2696 = s64[1,29]{1,0} aten::expand(%2695), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2697 = s64[1,29]{1,0} aten::add(%628, %2696), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2698 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2699 = pred[1,29]{1,0} aten::lt(%628, %2698), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2700 = s64[1,29]{1,0} aten::where(%2699, %2697, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2701 = s64[1,29,1]{2,1,0} aten::stack(%2700), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2702 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2703 = bf16[29,128]{1,0} xla::select(%2702), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2704 = bf16[1,29,128]{2,1,0} aten::index(%2703, %2701), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2705 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2704), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2706 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2689, %2705), scope=aten::mul.302, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2707 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2706, %2694, %2668), scope=aten::add.304, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2708 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2707), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2709 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2710 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2711 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2710), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2712 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2711), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2713 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2712), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2714 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2713), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2715 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2714), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2716 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2715), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2717 = bf16[28,128,29]{2,1,0} aten::view(%2716), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2718 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2719 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2720 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2721 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2722 = bf16[3584,3584]{0,1} aten::permute(%2721), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2723 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2724 = bf16[29,3584]{1,0} aten::mm(%2723, %2722), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2725 = bf16[1,29,3584]{2,1,0} aten::view(%2724), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2726 = bf16[1,29,3584]{2,1,0} aten::add(%2725, %2720, %2719), scope=aten::add.296, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2727 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2726), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2728 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2727), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2729 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2728), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2730 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2728), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2731 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2730), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2732 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2731, %2729), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2733 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2732, %2679), scope=aten::mul.300, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2734 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2728, %2705), scope=aten::mul.299, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2735 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2734, %2733, %2718), scope=aten::add.301, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2736 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2735), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2737 = bf16[28,29,128]{2,1,0} aten::view(%2736), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2738 = bf16[28,29,29]{2,1,0} aten::matmul(%2737, %2717), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2739 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2738), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2740 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2739, %2667), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2741 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2740, %617, %2666), scope=aten::add.305, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2742 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2741), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2743 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2742), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2744 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2743), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2745 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2744), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2746 = bf16[28,29,29]{2,1,0} aten::view(%2745), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2747 = bf16[28,29,128]{2,1,0} aten::matmul(%2746, %2665), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2748 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2747), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2749 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2748), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2750 = bf16[1,29,3584]{2,1,0} aten::view(%2749), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2751 = bf16[29,3584]{1,0} aten::view(%2750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2752 = bf16[29,3584]{1,0} aten::mm(%2751, %257), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2753 = bf16[1,29,3584]{2,1,0} aten::view(%2752), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2754 = bf16[1,29,3584]{2,1,0} aten::add(%2641, %2753, %255), scope=aten::add.306, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2755 = f32[1,29,3584]{2,1,0} xla::cast(%2754), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2756 = f32[1,29,3584]{2,1,0} aten::pow(%2755, %254), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2757 = f32[1,29,1]{2,1,0} aten::mean(%2756), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2758 = f32[1,29,1]{2,1,0} aten::add(%2757, %253, %252), scope=aten::add.307, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2759 = f32[1,29,1]{2,1,0} aten::rsqrt(%2758), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2760 = f32[1,29,3584]{2,1,0} aten::mul(%2755, %2759), scope=aten::mul.308, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2761 = bf16[1,29,3584]{2,1,0} xla::cast(%2760), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2762 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2763 = bf16[1,29,3584]{2,1,0} aten::mul(%2762, %2761), scope=aten::mul.309, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2764 = bf16[29,3584]{1,0} aten::view(%2763), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2765 = bf16[29,18944]{1,0} aten::mm(%2764, %251), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2766 = bf16[1,29,18944]{2,1,0} aten::view(%2765), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2767 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2768 = bf16[3584,18944]{0,1} aten::permute(%2767), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2769 = bf16[29,3584]{1,0} aten::view(%2763), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2770 = bf16[29,18944]{1,0} aten::mm(%2769, %2768), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2771 = bf16[1,29,18944]{2,1,0} aten::view(%2770), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2772 = bf16[1,29,18944]{2,1,0} aten::silu(%2771), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2773 = bf16[1,29,18944]{2,1,0} aten::mul(%2772, %2766), scope=aten::mul.310, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2774 = bf16[29,18944]{1,0} aten::view(%2773), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2775 = bf16[29,3584]{1,0} aten::mm(%2774, %249), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2776 = bf16[1,29,3584]{2,1,0} aten::view(%2775), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2777 = bf16[1,29,3584]{2,1,0} aten::add(%2754, %2776, %247), scope=aten::add.311, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2778 = f32[1,29,3584]{2,1,0} xla::cast(%2777), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2779 = f32[1,29,3584]{2,1,0} aten::pow(%2778, %246), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2780 = f32[1,29,1]{2,1,0} aten::mean(%2779), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2781 = f32[1,29,1]{2,1,0} aten::add(%2780, %245, %244), scope=aten::add.312, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2782 = f32[1,29,1]{2,1,0} aten::rsqrt(%2781), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2783 = f32[1,29,3584]{2,1,0} aten::mul(%2778, %2782), scope=aten::mul.313, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2784 = bf16[1,29,3584]{2,1,0} xla::cast(%2783), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2785 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2786 = bf16[1,29,3584]{2,1,0} aten::mul(%2785, %2784), scope=aten::mul.314, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2787 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2788 = bf16[29,512]{1,0} aten::mm(%2787, %243), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2789 = bf16[1,29,512]{2,1,0} aten::view(%2788), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2790 = bf16[1,29,512]{2,1,0} aten::add(%2789, %241, %240), scope=aten::add.317, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2791 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2790), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2792 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2791), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2793 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2792), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2794 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2793), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2795 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2794), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2796 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2795), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2797 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2798 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2799 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2798), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2800 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2799), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2801 = bf16[28,29,128]{2,1,0} aten::view(%2800), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2802 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2803 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2804 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2805 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2806 = s64[1,29]{1,0} aten::expand(%2805), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2807 = s64[1,29]{1,0} aten::add(%628, %2806), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2808 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2809 = pred[1,29]{1,0} aten::lt(%628, %2808), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2810 = s64[1,29]{1,0} aten::where(%2809, %2807, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2811 = s64[1,29,1]{2,1,0} aten::stack(%2810), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2812 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2813 = bf16[29,128]{1,0} xla::select(%2812), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2814 = bf16[1,29,128]{2,1,0} aten::index(%2813, %2811), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2815 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2814), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2816 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2817 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2818 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2819 = bf16[3584,512]{0,1} aten::permute(%2818), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2820 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2821 = bf16[29,512]{1,0} aten::mm(%2820, %2819), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2822 = bf16[1,29,512]{2,1,0} aten::view(%2821), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2823 = bf16[1,29,512]{2,1,0} aten::add(%2822, %2817, %2816), scope=aten::add.316, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2824 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2823), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2825 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2824), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2826 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2825), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2827 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2825), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2828 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2827), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2829 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2828, %2826), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2830 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2829, %2815), scope=aten::mul.322, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2831 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2832 = s64[1,29]{1,0} aten::expand(%2831), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2833 = s64[1,29]{1,0} aten::add(%628, %2832), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2834 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2835 = pred[1,29]{1,0} aten::lt(%628, %2834), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2836 = s64[1,29]{1,0} aten::where(%2835, %2833, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2837 = s64[1,29,1]{2,1,0} aten::stack(%2836), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2838 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2839 = bf16[29,128]{1,0} xla::select(%2838), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2840 = bf16[1,29,128]{2,1,0} aten::index(%2839, %2837), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2841 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2840), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2842 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2825, %2841), scope=aten::mul.321, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2843 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2842, %2830, %2804), scope=aten::add.323, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2844 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2843), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2845 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2846 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2847 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2846), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2848 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2847), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2849 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2848), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2850 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2849), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2851 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2850), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2852 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2851), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2853 = bf16[28,128,29]{2,1,0} aten::view(%2852), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2854 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2855 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2856 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2857 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2858 = bf16[3584,3584]{0,1} aten::permute(%2857), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2859 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2860 = bf16[29,3584]{1,0} aten::mm(%2859, %2858), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2861 = bf16[1,29,3584]{2,1,0} aten::view(%2860), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2862 = bf16[1,29,3584]{2,1,0} aten::add(%2861, %2856, %2855), scope=aten::add.315, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2863 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2862), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2864 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2863), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2865 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2864), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2866 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2864), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2867 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2866), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2868 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2867, %2865), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2869 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2868, %2815), scope=aten::mul.319, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2870 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2864, %2841), scope=aten::mul.318, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2871 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2870, %2869, %2854), scope=aten::add.320, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2872 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2871), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2873 = bf16[28,29,128]{2,1,0} aten::view(%2872), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2874 = bf16[28,29,29]{2,1,0} aten::matmul(%2873, %2853), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2875 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2874), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2876 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2875, %2803), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2877 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2876, %617, %2802), scope=aten::add.324, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2878 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2877), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2879 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2878), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2880 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2879), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2881 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2880), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2882 = bf16[28,29,29]{2,1,0} aten::view(%2881), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2883 = bf16[28,29,128]{2,1,0} aten::matmul(%2882, %2801), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2884 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2883), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2885 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2884), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2886 = bf16[1,29,3584]{2,1,0} aten::view(%2885), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2887 = bf16[29,3584]{1,0} aten::view(%2886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2888 = bf16[29,3584]{1,0} aten::mm(%2887, %239), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2889 = bf16[1,29,3584]{2,1,0} aten::view(%2888), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2890 = bf16[1,29,3584]{2,1,0} aten::add(%2777, %2889, %237), scope=aten::add.325, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2891 = f32[1,29,3584]{2,1,0} xla::cast(%2890), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2892 = f32[1,29,3584]{2,1,0} aten::pow(%2891, %236), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2893 = f32[1,29,1]{2,1,0} aten::mean(%2892), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2894 = f32[1,29,1]{2,1,0} aten::add(%2893, %235, %234), scope=aten::add.326, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2895 = f32[1,29,1]{2,1,0} aten::rsqrt(%2894), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2896 = f32[1,29,3584]{2,1,0} aten::mul(%2891, %2895), scope=aten::mul.327, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2897 = bf16[1,29,3584]{2,1,0} xla::cast(%2896), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2898 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2899 = bf16[1,29,3584]{2,1,0} aten::mul(%2898, %2897), scope=aten::mul.328, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2900 = bf16[29,3584]{1,0} aten::view(%2899), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2901 = bf16[29,18944]{1,0} aten::mm(%2900, %233), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2902 = bf16[1,29,18944]{2,1,0} aten::view(%2901), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2903 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2904 = bf16[3584,18944]{0,1} aten::permute(%2903), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2905 = bf16[29,3584]{1,0} aten::view(%2899), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2906 = bf16[29,18944]{1,0} aten::mm(%2905, %2904), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2907 = bf16[1,29,18944]{2,1,0} aten::view(%2906), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2908 = bf16[1,29,18944]{2,1,0} aten::silu(%2907), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2909 = bf16[1,29,18944]{2,1,0} aten::mul(%2908, %2902), scope=aten::mul.329, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2910 = bf16[29,18944]{1,0} aten::view(%2909), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2911 = bf16[29,3584]{1,0} aten::mm(%2910, %231), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2912 = bf16[1,29,3584]{2,1,0} aten::view(%2911), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2913 = bf16[1,29,3584]{2,1,0} aten::add(%2890, %2912, %229), scope=aten::add.330, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2914 = f32[1,29,3584]{2,1,0} xla::cast(%2913), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2915 = f32[1,29,3584]{2,1,0} aten::pow(%2914, %228), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2916 = f32[1,29,1]{2,1,0} aten::mean(%2915), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2917 = f32[1,29,1]{2,1,0} aten::add(%2916, %227, %226), scope=aten::add.331, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2918 = f32[1,29,1]{2,1,0} aten::rsqrt(%2917), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2919 = f32[1,29,3584]{2,1,0} aten::mul(%2914, %2918), scope=aten::mul.332, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2920 = bf16[1,29,3584]{2,1,0} xla::cast(%2919), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2921 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2922 = bf16[1,29,3584]{2,1,0} aten::mul(%2921, %2920), scope=aten::mul.333, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2923 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2924 = bf16[29,512]{1,0} aten::mm(%2923, %225), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2925 = bf16[1,29,512]{2,1,0} aten::view(%2924), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2926 = bf16[1,29,512]{2,1,0} aten::add(%2925, %223, %222), scope=aten::add.336, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2927 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2926), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2928 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2927), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2929 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2928), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2930 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2929), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2931 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2930), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2932 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2931), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2933 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2934 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2935 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2934), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2936 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2935), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2937 = bf16[28,29,128]{2,1,0} aten::view(%2936), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2938 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2939 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2940 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2941 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2942 = s64[1,29]{1,0} aten::expand(%2941), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2943 = s64[1,29]{1,0} aten::add(%628, %2942), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2944 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2945 = pred[1,29]{1,0} aten::lt(%628, %2944), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2946 = s64[1,29]{1,0} aten::where(%2945, %2943, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2947 = s64[1,29,1]{2,1,0} aten::stack(%2946), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2948 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2949 = bf16[29,128]{1,0} xla::select(%2948), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2950 = bf16[1,29,128]{2,1,0} aten::index(%2949, %2947), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2951 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2950), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2952 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2953 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2954 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2955 = bf16[3584,512]{0,1} aten::permute(%2954), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2956 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2957 = bf16[29,512]{1,0} aten::mm(%2956, %2955), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2958 = bf16[1,29,512]{2,1,0} aten::view(%2957), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2959 = bf16[1,29,512]{2,1,0} aten::add(%2958, %2953, %2952), scope=aten::add.335, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2960 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2959), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2961 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2960), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2962 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2961), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2963 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2961), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2964 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2963), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2965 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2964, %2962), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2966 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2965, %2951), scope=aten::mul.341, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2967 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2968 = s64[1,29]{1,0} aten::expand(%2967), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2969 = s64[1,29]{1,0} aten::add(%628, %2968), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2970 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2971 = pred[1,29]{1,0} aten::lt(%628, %2970), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2972 = s64[1,29]{1,0} aten::where(%2971, %2969, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2973 = s64[1,29,1]{2,1,0} aten::stack(%2972), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2974 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2975 = bf16[29,128]{1,0} xla::select(%2974), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2976 = bf16[1,29,128]{2,1,0} aten::index(%2975, %2973), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2977 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2976), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2978 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2961, %2977), scope=aten::mul.340, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2979 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2978, %2966, %2940), scope=aten::add.342, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2980 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2979), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2981 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2982 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2983 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2982), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2984 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2983), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2985 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2984), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2986 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2985), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2987 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2986), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2988 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2987), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2989 = bf16[28,128,29]{2,1,0} aten::view(%2988), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2990 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2991 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2992 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2993 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2994 = bf16[3584,3584]{0,1} aten::permute(%2993), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2995 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2996 = bf16[29,3584]{1,0} aten::mm(%2995, %2994), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2997 = bf16[1,29,3584]{2,1,0} aten::view(%2996), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2998 = bf16[1,29,3584]{2,1,0} aten::add(%2997, %2992, %2991), scope=aten::add.334, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2999 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2998), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3000 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2999), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3001 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3000), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3002 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3000), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3003 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3002), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3004 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3003, %3001), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3005 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3004, %2951), scope=aten::mul.338, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3006 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3000, %2977), scope=aten::mul.337, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3007 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3006, %3005, %2990), scope=aten::add.339, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3008 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3007), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3009 = bf16[28,29,128]{2,1,0} aten::view(%3008), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3010 = bf16[28,29,29]{2,1,0} aten::matmul(%3009, %2989), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3011 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3010), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3012 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3011, %2939), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3013 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3012, %617, %2938), scope=aten::add.343, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3014 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3013), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3015 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3014), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3016 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3015), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3017 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3016), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3018 = bf16[28,29,29]{2,1,0} aten::view(%3017), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3019 = bf16[28,29,128]{2,1,0} aten::matmul(%3018, %2937), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3020 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3019), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3021 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3020), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3022 = bf16[1,29,3584]{2,1,0} aten::view(%3021), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3023 = bf16[29,3584]{1,0} aten::view(%3022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3024 = bf16[29,3584]{1,0} aten::mm(%3023, %221), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3025 = bf16[1,29,3584]{2,1,0} aten::view(%3024), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3026 = bf16[1,29,3584]{2,1,0} aten::add(%2913, %3025, %219), scope=aten::add.344, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3027 = f32[1,29,3584]{2,1,0} xla::cast(%3026), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3028 = f32[1,29,3584]{2,1,0} aten::pow(%3027, %218), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3029 = f32[1,29,1]{2,1,0} aten::mean(%3028), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3030 = f32[1,29,1]{2,1,0} aten::add(%3029, %217, %216), scope=aten::add.345, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3031 = f32[1,29,1]{2,1,0} aten::rsqrt(%3030), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3032 = f32[1,29,3584]{2,1,0} aten::mul(%3027, %3031), scope=aten::mul.346, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3033 = bf16[1,29,3584]{2,1,0} xla::cast(%3032), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3034 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3035 = bf16[1,29,3584]{2,1,0} aten::mul(%3034, %3033), scope=aten::mul.347, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3036 = bf16[29,3584]{1,0} aten::view(%3035), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3037 = bf16[29,18944]{1,0} aten::mm(%3036, %215), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3038 = bf16[1,29,18944]{2,1,0} aten::view(%3037), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3039 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3040 = bf16[3584,18944]{0,1} aten::permute(%3039), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3041 = bf16[29,3584]{1,0} aten::view(%3035), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3042 = bf16[29,18944]{1,0} aten::mm(%3041, %3040), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3043 = bf16[1,29,18944]{2,1,0} aten::view(%3042), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3044 = bf16[1,29,18944]{2,1,0} aten::silu(%3043), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3045 = bf16[1,29,18944]{2,1,0} aten::mul(%3044, %3038), scope=aten::mul.348, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3046 = bf16[29,18944]{1,0} aten::view(%3045), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3047 = bf16[29,3584]{1,0} aten::mm(%3046, %213), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3048 = bf16[1,29,3584]{2,1,0} aten::view(%3047), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3049 = bf16[1,29,3584]{2,1,0} aten::add(%3026, %3048, %211), scope=aten::add.349, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3050 = f32[1,29,3584]{2,1,0} xla::cast(%3049), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3051 = f32[1,29,3584]{2,1,0} aten::pow(%3050, %210), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3052 = f32[1,29,1]{2,1,0} aten::mean(%3051), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3053 = f32[1,29,1]{2,1,0} aten::add(%3052, %209, %208), scope=aten::add.350, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3054 = f32[1,29,1]{2,1,0} aten::rsqrt(%3053), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3055 = f32[1,29,3584]{2,1,0} aten::mul(%3050, %3054), scope=aten::mul.351, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3056 = bf16[1,29,3584]{2,1,0} xla::cast(%3055), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3057 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3058 = bf16[1,29,3584]{2,1,0} aten::mul(%3057, %3056), scope=aten::mul.352, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3059 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3060 = bf16[29,512]{1,0} aten::mm(%3059, %207), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3061 = bf16[1,29,512]{2,1,0} aten::view(%3060), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3062 = bf16[1,29,512]{2,1,0} aten::add(%3061, %205, %204), scope=aten::add.355, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3063 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3062), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3064 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3063), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3065 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3064), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3066 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3065), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3067 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3066), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3068 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3067), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3069 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3070 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3071 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3070), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3072 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3071), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3073 = bf16[28,29,128]{2,1,0} aten::view(%3072), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3074 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3075 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3076 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3077 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3078 = s64[1,29]{1,0} aten::expand(%3077), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3079 = s64[1,29]{1,0} aten::add(%628, %3078), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3080 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3081 = pred[1,29]{1,0} aten::lt(%628, %3080), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3082 = s64[1,29]{1,0} aten::where(%3081, %3079, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3083 = s64[1,29,1]{2,1,0} aten::stack(%3082), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3084 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3085 = bf16[29,128]{1,0} xla::select(%3084), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3086 = bf16[1,29,128]{2,1,0} aten::index(%3085, %3083), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3087 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3086), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3088 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3089 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3090 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3091 = bf16[3584,512]{0,1} aten::permute(%3090), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3092 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3093 = bf16[29,512]{1,0} aten::mm(%3092, %3091), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3094 = bf16[1,29,512]{2,1,0} aten::view(%3093), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3095 = bf16[1,29,512]{2,1,0} aten::add(%3094, %3089, %3088), scope=aten::add.354, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3096 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3095), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3097 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3096), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3098 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3097), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3099 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3097), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3100 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3099), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3101 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3100, %3098), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3102 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3101, %3087), scope=aten::mul.360, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3103 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3104 = s64[1,29]{1,0} aten::expand(%3103), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3105 = s64[1,29]{1,0} aten::add(%628, %3104), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3106 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3107 = pred[1,29]{1,0} aten::lt(%628, %3106), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3108 = s64[1,29]{1,0} aten::where(%3107, %3105, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3109 = s64[1,29,1]{2,1,0} aten::stack(%3108), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3110 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3111 = bf16[29,128]{1,0} xla::select(%3110), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3112 = bf16[1,29,128]{2,1,0} aten::index(%3111, %3109), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3113 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3112), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3114 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3097, %3113), scope=aten::mul.359, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3115 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3114, %3102, %3076), scope=aten::add.361, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3116 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3115), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3117 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3118 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3119 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3118), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3120 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3119), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3121 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3120), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3122 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3121), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3123 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3122), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3124 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3123), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3125 = bf16[28,128,29]{2,1,0} aten::view(%3124), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3126 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3127 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3128 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3129 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3130 = bf16[3584,3584]{0,1} aten::permute(%3129), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3131 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3132 = bf16[29,3584]{1,0} aten::mm(%3131, %3130), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3133 = bf16[1,29,3584]{2,1,0} aten::view(%3132), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3134 = bf16[1,29,3584]{2,1,0} aten::add(%3133, %3128, %3127), scope=aten::add.353, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3135 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3134), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3136 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3135), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3137 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3136), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3138 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3136), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3139 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3138), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3140 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3139, %3137), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3141 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3140, %3087), scope=aten::mul.357, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3142 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3136, %3113), scope=aten::mul.356, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3143 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3142, %3141, %3126), scope=aten::add.358, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3144 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3143), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3145 = bf16[28,29,128]{2,1,0} aten::view(%3144), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3146 = bf16[28,29,29]{2,1,0} aten::matmul(%3145, %3125), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3147 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3146), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3148 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3147, %3075), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3149 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3148, %617, %3074), scope=aten::add.362, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3150 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3149), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3151 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3150), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3152 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3151), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3153 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3152), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3154 = bf16[28,29,29]{2,1,0} aten::view(%3153), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3155 = bf16[28,29,128]{2,1,0} aten::matmul(%3154, %3073), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3156 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3155), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3157 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3156), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3158 = bf16[1,29,3584]{2,1,0} aten::view(%3157), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3159 = bf16[29,3584]{1,0} aten::view(%3158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3160 = bf16[29,3584]{1,0} aten::mm(%3159, %203), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3161 = bf16[1,29,3584]{2,1,0} aten::view(%3160), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3162 = bf16[1,29,3584]{2,1,0} aten::add(%3049, %3161, %201), scope=aten::add.363, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3163 = f32[1,29,3584]{2,1,0} xla::cast(%3162), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3164 = f32[1,29,3584]{2,1,0} aten::pow(%3163, %200), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3165 = f32[1,29,1]{2,1,0} aten::mean(%3164), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3166 = f32[1,29,1]{2,1,0} aten::add(%3165, %199, %198), scope=aten::add.364, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3167 = f32[1,29,1]{2,1,0} aten::rsqrt(%3166), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3168 = f32[1,29,3584]{2,1,0} aten::mul(%3163, %3167), scope=aten::mul.365, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3169 = bf16[1,29,3584]{2,1,0} xla::cast(%3168), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3170 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3171 = bf16[1,29,3584]{2,1,0} aten::mul(%3170, %3169), scope=aten::mul.366, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3172 = bf16[29,3584]{1,0} aten::view(%3171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3173 = bf16[29,18944]{1,0} aten::mm(%3172, %197), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3174 = bf16[1,29,18944]{2,1,0} aten::view(%3173), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3175 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3176 = bf16[3584,18944]{0,1} aten::permute(%3175), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3177 = bf16[29,3584]{1,0} aten::view(%3171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3178 = bf16[29,18944]{1,0} aten::mm(%3177, %3176), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3179 = bf16[1,29,18944]{2,1,0} aten::view(%3178), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3180 = bf16[1,29,18944]{2,1,0} aten::silu(%3179), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3181 = bf16[1,29,18944]{2,1,0} aten::mul(%3180, %3174), scope=aten::mul.367, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3182 = bf16[29,18944]{1,0} aten::view(%3181), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3183 = bf16[29,3584]{1,0} aten::mm(%3182, %195), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3184 = bf16[1,29,3584]{2,1,0} aten::view(%3183), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3185 = bf16[1,29,3584]{2,1,0} aten::add(%3162, %3184, %193), scope=aten::add.368, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3186 = f32[1,29,3584]{2,1,0} xla::cast(%3185), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3187 = f32[1,29,3584]{2,1,0} aten::pow(%3186, %192), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3188 = f32[1,29,1]{2,1,0} aten::mean(%3187), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3189 = f32[1,29,1]{2,1,0} aten::add(%3188, %191, %190), scope=aten::add.369, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3190 = f32[1,29,1]{2,1,0} aten::rsqrt(%3189), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3191 = f32[1,29,3584]{2,1,0} aten::mul(%3186, %3190), scope=aten::mul.370, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3192 = bf16[1,29,3584]{2,1,0} xla::cast(%3191), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3193 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3194 = bf16[1,29,3584]{2,1,0} aten::mul(%3193, %3192), scope=aten::mul.371, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3195 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3196 = bf16[29,512]{1,0} aten::mm(%3195, %189), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3197 = bf16[1,29,512]{2,1,0} aten::view(%3196), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3198 = bf16[1,29,512]{2,1,0} aten::add(%3197, %187, %186), scope=aten::add.374, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3199 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3198), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3200 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3199), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3201 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3200), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3202 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3201), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3203 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3202), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3204 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3203), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3205 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3206 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3207 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3206), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3208 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3207), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3209 = bf16[28,29,128]{2,1,0} aten::view(%3208), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3210 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3211 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3212 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3213 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3214 = s64[1,29]{1,0} aten::expand(%3213), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3215 = s64[1,29]{1,0} aten::add(%628, %3214), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3216 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3217 = pred[1,29]{1,0} aten::lt(%628, %3216), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3218 = s64[1,29]{1,0} aten::where(%3217, %3215, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3219 = s64[1,29,1]{2,1,0} aten::stack(%3218), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3220 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3221 = bf16[29,128]{1,0} xla::select(%3220), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3222 = bf16[1,29,128]{2,1,0} aten::index(%3221, %3219), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3223 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3222), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3224 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3225 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3226 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3227 = bf16[3584,512]{0,1} aten::permute(%3226), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3228 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3229 = bf16[29,512]{1,0} aten::mm(%3228, %3227), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3230 = bf16[1,29,512]{2,1,0} aten::view(%3229), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3231 = bf16[1,29,512]{2,1,0} aten::add(%3230, %3225, %3224), scope=aten::add.373, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3232 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3231), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3233 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3232), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3234 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3233), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3235 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3233), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3236 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3235), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3237 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3236, %3234), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3238 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3237, %3223), scope=aten::mul.379, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3239 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3240 = s64[1,29]{1,0} aten::expand(%3239), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3241 = s64[1,29]{1,0} aten::add(%628, %3240), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3242 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3243 = pred[1,29]{1,0} aten::lt(%628, %3242), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3244 = s64[1,29]{1,0} aten::where(%3243, %3241, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3245 = s64[1,29,1]{2,1,0} aten::stack(%3244), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3246 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3247 = bf16[29,128]{1,0} xla::select(%3246), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3248 = bf16[1,29,128]{2,1,0} aten::index(%3247, %3245), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3249 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3248), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3250 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3233, %3249), scope=aten::mul.378, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3251 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3250, %3238, %3212), scope=aten::add.380, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3252 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3251), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3253 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3254 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3255 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3254), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3256 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3255), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3257 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3256), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3258 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3257), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3259 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3258), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3260 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3259), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3261 = bf16[28,128,29]{2,1,0} aten::view(%3260), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3262 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3263 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3264 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3265 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3266 = bf16[3584,3584]{0,1} aten::permute(%3265), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3267 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3268 = bf16[29,3584]{1,0} aten::mm(%3267, %3266), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3269 = bf16[1,29,3584]{2,1,0} aten::view(%3268), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3270 = bf16[1,29,3584]{2,1,0} aten::add(%3269, %3264, %3263), scope=aten::add.372, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3271 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3270), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3272 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3271), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3273 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3272), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3274 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3272), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3275 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3274), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3276 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3275, %3273), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3277 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3276, %3223), scope=aten::mul.376, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3278 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3272, %3249), scope=aten::mul.375, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3279 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3278, %3277, %3262), scope=aten::add.377, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3280 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3279), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3281 = bf16[28,29,128]{2,1,0} aten::view(%3280), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3282 = bf16[28,29,29]{2,1,0} aten::matmul(%3281, %3261), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3283 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3282), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3284 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3283, %3211), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3285 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3284, %617, %3210), scope=aten::add.381, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3286 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3285), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3287 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3286), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3288 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3287), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3289 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3288), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3290 = bf16[28,29,29]{2,1,0} aten::view(%3289), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3291 = bf16[28,29,128]{2,1,0} aten::matmul(%3290, %3209), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3292 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3291), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3293 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3292), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3294 = bf16[1,29,3584]{2,1,0} aten::view(%3293), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3295 = bf16[29,3584]{1,0} aten::view(%3294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3296 = bf16[29,3584]{1,0} aten::mm(%3295, %185), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3297 = bf16[1,29,3584]{2,1,0} aten::view(%3296), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3298 = bf16[1,29,3584]{2,1,0} aten::add(%3185, %3297, %183), scope=aten::add.382, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3299 = f32[1,29,3584]{2,1,0} xla::cast(%3298), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3300 = f32[1,29,3584]{2,1,0} aten::pow(%3299, %182), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3301 = f32[1,29,1]{2,1,0} aten::mean(%3300), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3302 = f32[1,29,1]{2,1,0} aten::add(%3301, %181, %180), scope=aten::add.383, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3303 = f32[1,29,1]{2,1,0} aten::rsqrt(%3302), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3304 = f32[1,29,3584]{2,1,0} aten::mul(%3299, %3303), scope=aten::mul.384, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3305 = bf16[1,29,3584]{2,1,0} xla::cast(%3304), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3306 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3307 = bf16[1,29,3584]{2,1,0} aten::mul(%3306, %3305), scope=aten::mul.385, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3308 = bf16[29,3584]{1,0} aten::view(%3307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3309 = bf16[29,18944]{1,0} aten::mm(%3308, %179), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3310 = bf16[1,29,18944]{2,1,0} aten::view(%3309), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3311 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3312 = bf16[3584,18944]{0,1} aten::permute(%3311), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3313 = bf16[29,3584]{1,0} aten::view(%3307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3314 = bf16[29,18944]{1,0} aten::mm(%3313, %3312), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3315 = bf16[1,29,18944]{2,1,0} aten::view(%3314), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3316 = bf16[1,29,18944]{2,1,0} aten::silu(%3315), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3317 = bf16[1,29,18944]{2,1,0} aten::mul(%3316, %3310), scope=aten::mul.386, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3318 = bf16[29,18944]{1,0} aten::view(%3317), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3319 = bf16[29,3584]{1,0} aten::mm(%3318, %177), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3320 = bf16[1,29,3584]{2,1,0} aten::view(%3319), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3321 = bf16[1,29,3584]{2,1,0} aten::add(%3298, %3320, %175), scope=aten::add.387, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3322 = f32[1,29,3584]{2,1,0} xla::cast(%3321), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3323 = f32[1,29,3584]{2,1,0} aten::pow(%3322, %174), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3324 = f32[1,29,1]{2,1,0} aten::mean(%3323), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3325 = f32[1,29,1]{2,1,0} aten::add(%3324, %173, %172), scope=aten::add.388, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3326 = f32[1,29,1]{2,1,0} aten::rsqrt(%3325), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3327 = f32[1,29,3584]{2,1,0} aten::mul(%3322, %3326), scope=aten::mul.389, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3328 = bf16[1,29,3584]{2,1,0} xla::cast(%3327), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3329 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3330 = bf16[1,29,3584]{2,1,0} aten::mul(%3329, %3328), scope=aten::mul.390, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3331 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3332 = bf16[29,512]{1,0} aten::mm(%3331, %171), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3333 = bf16[1,29,512]{2,1,0} aten::view(%3332), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3334 = bf16[1,29,512]{2,1,0} aten::add(%3333, %169, %168), scope=aten::add.393, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3335 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3334), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3336 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3335), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3337 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3336), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3338 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3337), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3339 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3338), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3340 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3339), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3341 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3342 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3343 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3342), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3344 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3343), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3345 = bf16[28,29,128]{2,1,0} aten::view(%3344), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3346 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3347 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3348 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3349 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3350 = s64[1,29]{1,0} aten::expand(%3349), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3351 = s64[1,29]{1,0} aten::add(%628, %3350), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3352 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3353 = pred[1,29]{1,0} aten::lt(%628, %3352), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3354 = s64[1,29]{1,0} aten::where(%3353, %3351, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3355 = s64[1,29,1]{2,1,0} aten::stack(%3354), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3356 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3357 = bf16[29,128]{1,0} xla::select(%3356), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3358 = bf16[1,29,128]{2,1,0} aten::index(%3357, %3355), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3359 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3358), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3360 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3361 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3362 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3363 = bf16[3584,512]{0,1} aten::permute(%3362), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3364 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3365 = bf16[29,512]{1,0} aten::mm(%3364, %3363), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3366 = bf16[1,29,512]{2,1,0} aten::view(%3365), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3367 = bf16[1,29,512]{2,1,0} aten::add(%3366, %3361, %3360), scope=aten::add.392, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3368 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3367), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3369 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3368), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3370 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3369), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3371 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3369), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3372 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3371), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3373 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3372, %3370), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3374 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3373, %3359), scope=aten::mul.398, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3375 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3376 = s64[1,29]{1,0} aten::expand(%3375), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3377 = s64[1,29]{1,0} aten::add(%628, %3376), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3378 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3379 = pred[1,29]{1,0} aten::lt(%628, %3378), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3380 = s64[1,29]{1,0} aten::where(%3379, %3377, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3381 = s64[1,29,1]{2,1,0} aten::stack(%3380), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3382 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3383 = bf16[29,128]{1,0} xla::select(%3382), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3384 = bf16[1,29,128]{2,1,0} aten::index(%3383, %3381), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3385 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3384), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3386 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3369, %3385), scope=aten::mul.397, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3387 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3386, %3374, %3348), scope=aten::add.399, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3388 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3387), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3389 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3390 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3391 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3390), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3392 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3391), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3393 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3392), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3394 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3393), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3395 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3394), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3396 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3395), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3397 = bf16[28,128,29]{2,1,0} aten::view(%3396), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3398 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3399 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3400 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3401 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3402 = bf16[3584,3584]{0,1} aten::permute(%3401), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3403 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3404 = bf16[29,3584]{1,0} aten::mm(%3403, %3402), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3405 = bf16[1,29,3584]{2,1,0} aten::view(%3404), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3406 = bf16[1,29,3584]{2,1,0} aten::add(%3405, %3400, %3399), scope=aten::add.391, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3407 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3406), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3408 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3407), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3409 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3408), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3410 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3408), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3411 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3410), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3412 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3411, %3409), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3413 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3412, %3359), scope=aten::mul.395, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3414 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3408, %3385), scope=aten::mul.394, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3415 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3414, %3413, %3398), scope=aten::add.396, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3416 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3415), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3417 = bf16[28,29,128]{2,1,0} aten::view(%3416), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3418 = bf16[28,29,29]{2,1,0} aten::matmul(%3417, %3397), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3419 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3418), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3420 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3419, %3347), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3421 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3420, %617, %3346), scope=aten::add.400, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3422 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3421), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3423 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3422), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3424 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3423), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3425 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3424), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3426 = bf16[28,29,29]{2,1,0} aten::view(%3425), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3427 = bf16[28,29,128]{2,1,0} aten::matmul(%3426, %3345), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3428 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3427), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3429 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3428), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3430 = bf16[1,29,3584]{2,1,0} aten::view(%3429), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3431 = bf16[29,3584]{1,0} aten::view(%3430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3432 = bf16[29,3584]{1,0} aten::mm(%3431, %167), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3433 = bf16[1,29,3584]{2,1,0} aten::view(%3432), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3434 = bf16[1,29,3584]{2,1,0} aten::add(%3321, %3433, %165), scope=aten::add.401, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3435 = f32[1,29,3584]{2,1,0} xla::cast(%3434), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3436 = f32[1,29,3584]{2,1,0} aten::pow(%3435, %164), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3437 = f32[1,29,1]{2,1,0} aten::mean(%3436), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3438 = f32[1,29,1]{2,1,0} aten::add(%3437, %163, %162), scope=aten::add.402, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3439 = f32[1,29,1]{2,1,0} aten::rsqrt(%3438), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3440 = f32[1,29,3584]{2,1,0} aten::mul(%3435, %3439), scope=aten::mul.403, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3441 = bf16[1,29,3584]{2,1,0} xla::cast(%3440), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3442 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3443 = bf16[1,29,3584]{2,1,0} aten::mul(%3442, %3441), scope=aten::mul.404, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3444 = bf16[29,3584]{1,0} aten::view(%3443), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3445 = bf16[29,18944]{1,0} aten::mm(%3444, %161), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3446 = bf16[1,29,18944]{2,1,0} aten::view(%3445), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3447 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3448 = bf16[3584,18944]{0,1} aten::permute(%3447), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3449 = bf16[29,3584]{1,0} aten::view(%3443), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3450 = bf16[29,18944]{1,0} aten::mm(%3449, %3448), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3451 = bf16[1,29,18944]{2,1,0} aten::view(%3450), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3452 = bf16[1,29,18944]{2,1,0} aten::silu(%3451), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3453 = bf16[1,29,18944]{2,1,0} aten::mul(%3452, %3446), scope=aten::mul.405, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3454 = bf16[29,18944]{1,0} aten::view(%3453), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3455 = bf16[29,3584]{1,0} aten::mm(%3454, %159), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3456 = bf16[1,29,3584]{2,1,0} aten::view(%3455), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3457 = bf16[1,29,3584]{2,1,0} aten::add(%3434, %3456, %157), scope=aten::add.406, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3458 = f32[1,29,3584]{2,1,0} xla::cast(%3457), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3459 = f32[1,29,3584]{2,1,0} aten::pow(%3458, %156), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3460 = f32[1,29,1]{2,1,0} aten::mean(%3459), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3461 = f32[1,29,1]{2,1,0} aten::add(%3460, %155, %154), scope=aten::add.407, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3462 = f32[1,29,1]{2,1,0} aten::rsqrt(%3461), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3463 = f32[1,29,3584]{2,1,0} aten::mul(%3458, %3462), scope=aten::mul.408, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3464 = bf16[1,29,3584]{2,1,0} xla::cast(%3463), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3465 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3466 = bf16[1,29,3584]{2,1,0} aten::mul(%3465, %3464), scope=aten::mul.409, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3467 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3468 = bf16[29,512]{1,0} aten::mm(%3467, %153), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3469 = bf16[1,29,512]{2,1,0} aten::view(%3468), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3470 = bf16[1,29,512]{2,1,0} aten::add(%3469, %151, %150), scope=aten::add.412, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3471 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3470), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3472 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3471), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3473 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3472), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3474 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3473), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3475 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3474), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3476 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3475), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3477 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3476), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3478 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3477), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3479 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3478), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3480 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3479), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3481 = bf16[28,29,128]{2,1,0} aten::view(%3480), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3482 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3483 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3484 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3485 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3486 = s64[1,29]{1,0} aten::expand(%3485), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3487 = s64[1,29]{1,0} aten::add(%628, %3486), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3488 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3489 = pred[1,29]{1,0} aten::lt(%628, %3488), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3490 = s64[1,29]{1,0} aten::where(%3489, %3487, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3491 = s64[1,29,1]{2,1,0} aten::stack(%3490), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3492 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3493 = bf16[29,128]{1,0} xla::select(%3492), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3494 = bf16[1,29,128]{2,1,0} aten::index(%3493, %3491), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3495 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3494), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3496 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3497 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3498 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3499 = bf16[3584,512]{0,1} aten::permute(%3498), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3500 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3501 = bf16[29,512]{1,0} aten::mm(%3500, %3499), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3502 = bf16[1,29,512]{2,1,0} aten::view(%3501), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3503 = bf16[1,29,512]{2,1,0} aten::add(%3502, %3497, %3496), scope=aten::add.411, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3504 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3503), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3505 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3504), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3506 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3505), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3507 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3505), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3508 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3507), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3509 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3508, %3506), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3510 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3509, %3495), scope=aten::mul.417, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3511 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3512 = s64[1,29]{1,0} aten::expand(%3511), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3513 = s64[1,29]{1,0} aten::add(%628, %3512), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3514 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3515 = pred[1,29]{1,0} aten::lt(%628, %3514), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3516 = s64[1,29]{1,0} aten::where(%3515, %3513, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3517 = s64[1,29,1]{2,1,0} aten::stack(%3516), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3518 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3519 = bf16[29,128]{1,0} xla::select(%3518), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3520 = bf16[1,29,128]{2,1,0} aten::index(%3519, %3517), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3521 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3520), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3522 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3505, %3521), scope=aten::mul.416, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3523 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3522, %3510, %3484), scope=aten::add.418, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3524 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3523), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3525 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3526 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3527 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3526), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3528 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3527), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3529 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3528), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3530 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3529), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3531 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3530), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3532 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3531), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3533 = bf16[28,128,29]{2,1,0} aten::view(%3532), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3534 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3535 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3536 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3537 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3538 = bf16[3584,3584]{0,1} aten::permute(%3537), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3539 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3540 = bf16[29,3584]{1,0} aten::mm(%3539, %3538), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3541 = bf16[1,29,3584]{2,1,0} aten::view(%3540), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3542 = bf16[1,29,3584]{2,1,0} aten::add(%3541, %3536, %3535), scope=aten::add.410, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3543 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3542), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3544 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3543), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3545 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3544), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3546 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3544), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3547 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3546), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3548 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3547, %3545), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3549 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3548, %3495), scope=aten::mul.414, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3550 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3544, %3521), scope=aten::mul.413, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3551 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3550, %3549, %3534), scope=aten::add.415, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3552 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3551), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3553 = bf16[28,29,128]{2,1,0} aten::view(%3552), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3554 = bf16[28,29,29]{2,1,0} aten::matmul(%3553, %3533), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3555 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3554), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3556 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3555, %3483), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3557 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3556, %617, %3482), scope=aten::add.419, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3558 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3557), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3559 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3558), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3560 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3559), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3561 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3560), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3562 = bf16[28,29,29]{2,1,0} aten::view(%3561), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3563 = bf16[28,29,128]{2,1,0} aten::matmul(%3562, %3481), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3564 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3563), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3565 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3564), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3566 = bf16[1,29,3584]{2,1,0} aten::view(%3565), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3567 = bf16[29,3584]{1,0} aten::view(%3566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3568 = bf16[29,3584]{1,0} aten::mm(%3567, %149), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3569 = bf16[1,29,3584]{2,1,0} aten::view(%3568), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3570 = bf16[1,29,3584]{2,1,0} aten::add(%3457, %3569, %147), scope=aten::add.420, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3571 = f32[1,29,3584]{2,1,0} xla::cast(%3570), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3572 = f32[1,29,3584]{2,1,0} aten::pow(%3571, %146), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3573 = f32[1,29,1]{2,1,0} aten::mean(%3572), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3574 = f32[1,29,1]{2,1,0} aten::add(%3573, %145, %144), scope=aten::add.421, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3575 = f32[1,29,1]{2,1,0} aten::rsqrt(%3574), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3576 = f32[1,29,3584]{2,1,0} aten::mul(%3571, %3575), scope=aten::mul.422, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3577 = bf16[1,29,3584]{2,1,0} xla::cast(%3576), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3578 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3579 = bf16[1,29,3584]{2,1,0} aten::mul(%3578, %3577), scope=aten::mul.423, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3580 = bf16[29,3584]{1,0} aten::view(%3579), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3581 = bf16[29,18944]{1,0} aten::mm(%3580, %143), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3582 = bf16[1,29,18944]{2,1,0} aten::view(%3581), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3583 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3584 = bf16[3584,18944]{0,1} aten::permute(%3583), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3585 = bf16[29,3584]{1,0} aten::view(%3579), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3586 = bf16[29,18944]{1,0} aten::mm(%3585, %3584), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3587 = bf16[1,29,18944]{2,1,0} aten::view(%3586), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3588 = bf16[1,29,18944]{2,1,0} aten::silu(%3587), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3589 = bf16[1,29,18944]{2,1,0} aten::mul(%3588, %3582), scope=aten::mul.424, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3590 = bf16[29,18944]{1,0} aten::view(%3589), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3591 = bf16[29,3584]{1,0} aten::mm(%3590, %141), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3592 = bf16[1,29,3584]{2,1,0} aten::view(%3591), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3593 = bf16[1,29,3584]{2,1,0} aten::add(%3570, %3592, %139), scope=aten::add.425, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3594 = f32[1,29,3584]{2,1,0} xla::cast(%3593), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3595 = f32[1,29,3584]{2,1,0} aten::pow(%3594, %138), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3596 = f32[1,29,1]{2,1,0} aten::mean(%3595), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3597 = f32[1,29,1]{2,1,0} aten::add(%3596, %137, %136), scope=aten::add.426, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3598 = f32[1,29,1]{2,1,0} aten::rsqrt(%3597), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3599 = f32[1,29,3584]{2,1,0} aten::mul(%3594, %3598), scope=aten::mul.427, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3600 = bf16[1,29,3584]{2,1,0} xla::cast(%3599), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3601 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3602 = bf16[1,29,3584]{2,1,0} aten::mul(%3601, %3600), scope=aten::mul.428, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3603 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3604 = bf16[29,512]{1,0} aten::mm(%3603, %135), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3605 = bf16[1,29,512]{2,1,0} aten::view(%3604), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3606 = bf16[1,29,512]{2,1,0} aten::add(%3605, %133, %132), scope=aten::add.431, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3607 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3606), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3608 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3607), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3609 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3608), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3610 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3609), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3611 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3610), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3612 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3611), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3613 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3612), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3614 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3613), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3615 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3614), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3616 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3615), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3617 = bf16[28,29,128]{2,1,0} aten::view(%3616), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3618 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3619 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3620 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3621 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3622 = s64[1,29]{1,0} aten::expand(%3621), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3623 = s64[1,29]{1,0} aten::add(%628, %3622), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3624 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3625 = pred[1,29]{1,0} aten::lt(%628, %3624), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3626 = s64[1,29]{1,0} aten::where(%3625, %3623, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3627 = s64[1,29,1]{2,1,0} aten::stack(%3626), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3628 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3629 = bf16[29,128]{1,0} xla::select(%3628), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3630 = bf16[1,29,128]{2,1,0} aten::index(%3629, %3627), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3631 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3632 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3633 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3634 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3635 = bf16[3584,512]{0,1} aten::permute(%3634), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3636 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3637 = bf16[29,512]{1,0} aten::mm(%3636, %3635), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3638 = bf16[1,29,512]{2,1,0} aten::view(%3637), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3639 = bf16[1,29,512]{2,1,0} aten::add(%3638, %3633, %3632), scope=aten::add.430, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3640 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3639), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3641 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3640), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3642 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3641), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3643 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3641), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3644 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3643), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3645 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3644, %3642), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3646 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3645, %3631), scope=aten::mul.436, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3647 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3648 = s64[1,29]{1,0} aten::expand(%3647), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3649 = s64[1,29]{1,0} aten::add(%628, %3648), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3650 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3651 = pred[1,29]{1,0} aten::lt(%628, %3650), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3652 = s64[1,29]{1,0} aten::where(%3651, %3649, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3653 = s64[1,29,1]{2,1,0} aten::stack(%3652), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3654 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3655 = bf16[29,128]{1,0} xla::select(%3654), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3656 = bf16[1,29,128]{2,1,0} aten::index(%3655, %3653), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3657 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3658 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3641, %3657), scope=aten::mul.435, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3659 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3658, %3646, %3620), scope=aten::add.437, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3660 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3659), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3661 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3662 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3663 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3662), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3664 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3663), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3665 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3664), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3666 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3665), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3667 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3666), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3668 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3667), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3669 = bf16[28,128,29]{2,1,0} aten::view(%3668), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3670 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3671 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3672 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3673 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3674 = bf16[3584,3584]{0,1} aten::permute(%3673), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3675 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3676 = bf16[29,3584]{1,0} aten::mm(%3675, %3674), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3677 = bf16[1,29,3584]{2,1,0} aten::view(%3676), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3678 = bf16[1,29,3584]{2,1,0} aten::add(%3677, %3672, %3671), scope=aten::add.429, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3679 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3678), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3680 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3679), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3681 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3680), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3682 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3680), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3683 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3682), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3684 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3683, %3681), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3685 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3684, %3631), scope=aten::mul.433, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3686 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3680, %3657), scope=aten::mul.432, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3687 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3686, %3685, %3670), scope=aten::add.434, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3688 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3687), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3689 = bf16[28,29,128]{2,1,0} aten::view(%3688), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3690 = bf16[28,29,29]{2,1,0} aten::matmul(%3689, %3669), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3691 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3690), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3692 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3691, %3619), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3693 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3692, %617, %3618), scope=aten::add.438, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3694 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3693), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3695 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3694), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3696 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3695), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3697 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3696), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3698 = bf16[28,29,29]{2,1,0} aten::view(%3697), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3699 = bf16[28,29,128]{2,1,0} aten::matmul(%3698, %3617), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3700 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3699), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3701 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3700), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3702 = bf16[1,29,3584]{2,1,0} aten::view(%3701), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3703 = bf16[29,3584]{1,0} aten::view(%3702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3704 = bf16[29,3584]{1,0} aten::mm(%3703, %131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3705 = bf16[1,29,3584]{2,1,0} aten::view(%3704), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3706 = bf16[1,29,3584]{2,1,0} aten::add(%3593, %3705, %129), scope=aten::add.439, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3707 = f32[1,29,3584]{2,1,0} xla::cast(%3706), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3708 = f32[1,29,3584]{2,1,0} aten::pow(%3707, %128), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3709 = f32[1,29,1]{2,1,0} aten::mean(%3708), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3710 = f32[1,29,1]{2,1,0} aten::add(%3709, %127, %126), scope=aten::add.440, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3711 = f32[1,29,1]{2,1,0} aten::rsqrt(%3710), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3712 = f32[1,29,3584]{2,1,0} aten::mul(%3707, %3711), scope=aten::mul.441, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3713 = bf16[1,29,3584]{2,1,0} xla::cast(%3712), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3714 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3715 = bf16[1,29,3584]{2,1,0} aten::mul(%3714, %3713), scope=aten::mul.442, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3716 = bf16[29,3584]{1,0} aten::view(%3715), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3717 = bf16[29,18944]{1,0} aten::mm(%3716, %125), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3718 = bf16[1,29,18944]{2,1,0} aten::view(%3717), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3719 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3720 = bf16[3584,18944]{0,1} aten::permute(%3719), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3721 = bf16[29,3584]{1,0} aten::view(%3715), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3722 = bf16[29,18944]{1,0} aten::mm(%3721, %3720), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3723 = bf16[1,29,18944]{2,1,0} aten::view(%3722), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3724 = bf16[1,29,18944]{2,1,0} aten::silu(%3723), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3725 = bf16[1,29,18944]{2,1,0} aten::mul(%3724, %3718), scope=aten::mul.443, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3726 = bf16[29,18944]{1,0} aten::view(%3725), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3727 = bf16[29,3584]{1,0} aten::mm(%3726, %123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3728 = bf16[1,29,3584]{2,1,0} aten::view(%3727), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3729 = bf16[1,29,3584]{2,1,0} aten::add(%3706, %3728, %121), scope=aten::add.444, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3730 = f32[1,29,3584]{2,1,0} xla::cast(%3729), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3731 = f32[1,29,3584]{2,1,0} aten::pow(%3730, %120), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3732 = f32[1,29,1]{2,1,0} aten::mean(%3731), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3733 = f32[1,29,1]{2,1,0} aten::add(%3732, %119, %118), scope=aten::add.445, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3734 = f32[1,29,1]{2,1,0} aten::rsqrt(%3733), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3735 = f32[1,29,3584]{2,1,0} aten::mul(%3730, %3734), scope=aten::mul.446, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3736 = bf16[1,29,3584]{2,1,0} xla::cast(%3735), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3737 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3738 = bf16[1,29,3584]{2,1,0} aten::mul(%3737, %3736), scope=aten::mul.447, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3739 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3740 = bf16[29,512]{1,0} aten::mm(%3739, %117), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3741 = bf16[1,29,512]{2,1,0} aten::view(%3740), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3742 = bf16[1,29,512]{2,1,0} aten::add(%3741, %115, %114), scope=aten::add.450, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3743 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3742), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3744 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3743), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3745 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3744), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3746 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3745), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3747 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3746), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3748 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3747), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3749 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3748), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3750 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3749), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3751 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3750), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3752 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3751), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3753 = bf16[28,29,128]{2,1,0} aten::view(%3752), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3754 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3755 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3756 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3757 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3758 = s64[1,29]{1,0} aten::expand(%3757), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3759 = s64[1,29]{1,0} aten::add(%628, %3758), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3760 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3761 = pred[1,29]{1,0} aten::lt(%628, %3760), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3762 = s64[1,29]{1,0} aten::where(%3761, %3759, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3763 = s64[1,29,1]{2,1,0} aten::stack(%3762), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3764 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3765 = bf16[29,128]{1,0} xla::select(%3764), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3766 = bf16[1,29,128]{2,1,0} aten::index(%3765, %3763), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3767 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3768 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3769 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3770 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3771 = bf16[3584,512]{0,1} aten::permute(%3770), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3772 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3773 = bf16[29,512]{1,0} aten::mm(%3772, %3771), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3774 = bf16[1,29,512]{2,1,0} aten::view(%3773), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3775 = bf16[1,29,512]{2,1,0} aten::add(%3774, %3769, %3768), scope=aten::add.449, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3776 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3775), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3777 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3776), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3778 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3777), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3779 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3777), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3780 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3779), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3781 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3780, %3778), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3782 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3781, %3767), scope=aten::mul.455, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3783 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3784 = s64[1,29]{1,0} aten::expand(%3783), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3785 = s64[1,29]{1,0} aten::add(%628, %3784), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3786 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3787 = pred[1,29]{1,0} aten::lt(%628, %3786), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3788 = s64[1,29]{1,0} aten::where(%3787, %3785, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3789 = s64[1,29,1]{2,1,0} aten::stack(%3788), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3790 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3791 = bf16[29,128]{1,0} xla::select(%3790), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3792 = bf16[1,29,128]{2,1,0} aten::index(%3791, %3789), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3793 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3794 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3777, %3793), scope=aten::mul.454, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3795 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3794, %3782, %3756), scope=aten::add.456, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3796 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3795), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3797 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3798 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3799 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3798), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3800 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3799), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3801 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3800), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3802 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3801), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3803 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3802), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3804 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3803), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3805 = bf16[28,128,29]{2,1,0} aten::view(%3804), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3806 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3807 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3808 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3809 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3810 = bf16[3584,3584]{0,1} aten::permute(%3809), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3811 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3812 = bf16[29,3584]{1,0} aten::mm(%3811, %3810), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3813 = bf16[1,29,3584]{2,1,0} aten::view(%3812), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3814 = bf16[1,29,3584]{2,1,0} aten::add(%3813, %3808, %3807), scope=aten::add.448, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3815 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3814), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3816 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3815), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3817 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3816), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3818 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3816), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3819 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3818), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3820 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3819, %3817), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3821 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3820, %3767), scope=aten::mul.452, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3822 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3816, %3793), scope=aten::mul.451, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3823 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3822, %3821, %3806), scope=aten::add.453, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3824 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3823), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3825 = bf16[28,29,128]{2,1,0} aten::view(%3824), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3826 = bf16[28,29,29]{2,1,0} aten::matmul(%3825, %3805), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3827 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3826), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3828 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3827, %3755), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3829 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3828, %617, %3754), scope=aten::add.457, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3830 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3829), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3831 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3830), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3832 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3831), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3833 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3832), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3834 = bf16[28,29,29]{2,1,0} aten::view(%3833), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3835 = bf16[28,29,128]{2,1,0} aten::matmul(%3834, %3753), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3836 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3835), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3837 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3836), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3838 = bf16[1,29,3584]{2,1,0} aten::view(%3837), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3839 = bf16[29,3584]{1,0} aten::view(%3838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3840 = bf16[29,3584]{1,0} aten::mm(%3839, %113), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3841 = bf16[1,29,3584]{2,1,0} aten::view(%3840), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3842 = bf16[1,29,3584]{2,1,0} aten::add(%3729, %3841, %111), scope=aten::add.458, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3843 = f32[1,29,3584]{2,1,0} xla::cast(%3842), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3844 = f32[1,29,3584]{2,1,0} aten::pow(%3843, %110), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3845 = f32[1,29,1]{2,1,0} aten::mean(%3844), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3846 = f32[1,29,1]{2,1,0} aten::add(%3845, %109, %108), scope=aten::add.459, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3847 = f32[1,29,1]{2,1,0} aten::rsqrt(%3846), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3848 = f32[1,29,3584]{2,1,0} aten::mul(%3843, %3847), scope=aten::mul.460, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3849 = bf16[1,29,3584]{2,1,0} xla::cast(%3848), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3850 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3851 = bf16[1,29,3584]{2,1,0} aten::mul(%3850, %3849), scope=aten::mul.461, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3852 = bf16[29,3584]{1,0} aten::view(%3851), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3853 = bf16[29,18944]{1,0} aten::mm(%3852, %107), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3854 = bf16[1,29,18944]{2,1,0} aten::view(%3853), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3855 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3856 = bf16[3584,18944]{0,1} aten::permute(%3855), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3857 = bf16[29,3584]{1,0} aten::view(%3851), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3858 = bf16[29,18944]{1,0} aten::mm(%3857, %3856), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3859 = bf16[1,29,18944]{2,1,0} aten::view(%3858), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3860 = bf16[1,29,18944]{2,1,0} aten::silu(%3859), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3861 = bf16[1,29,18944]{2,1,0} aten::mul(%3860, %3854), scope=aten::mul.462, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3862 = bf16[29,18944]{1,0} aten::view(%3861), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3863 = bf16[29,3584]{1,0} aten::mm(%3862, %105), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3864 = bf16[1,29,3584]{2,1,0} aten::view(%3863), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3865 = bf16[1,29,3584]{2,1,0} aten::add(%3842, %3864, %103), scope=aten::add.463, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3866 = f32[1,29,3584]{2,1,0} xla::cast(%3865), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3867 = f32[1,29,3584]{2,1,0} aten::pow(%3866, %102), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3868 = f32[1,29,1]{2,1,0} aten::mean(%3867), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3869 = f32[1,29,1]{2,1,0} aten::add(%3868, %101, %100), scope=aten::add.464, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3870 = f32[1,29,1]{2,1,0} aten::rsqrt(%3869), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3871 = f32[1,29,3584]{2,1,0} aten::mul(%3866, %3870), scope=aten::mul.465, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3872 = bf16[1,29,3584]{2,1,0} xla::cast(%3871), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3873 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3874 = bf16[1,29,3584]{2,1,0} aten::mul(%3873, %3872), scope=aten::mul.466, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3875 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3876 = bf16[29,512]{1,0} aten::mm(%3875, %99), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3877 = bf16[1,29,512]{2,1,0} aten::view(%3876), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3878 = bf16[1,29,512]{2,1,0} aten::add(%3877, %97, %96), scope=aten::add.469, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3879 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3878), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3880 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3879), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3881 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3880), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3882 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3881), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3883 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3882), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3884 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3883), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3885 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3884), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3886 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3885), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3887 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3886), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3888 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3887), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3889 = bf16[28,29,128]{2,1,0} aten::view(%3888), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3890 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3891 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3892 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3893 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3894 = s64[1,29]{1,0} aten::expand(%3893), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3895 = s64[1,29]{1,0} aten::add(%628, %3894), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3896 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3897 = pred[1,29]{1,0} aten::lt(%628, %3896), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3898 = s64[1,29]{1,0} aten::where(%3897, %3895, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3899 = s64[1,29,1]{2,1,0} aten::stack(%3898), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3900 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3901 = bf16[29,128]{1,0} xla::select(%3900), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3902 = bf16[1,29,128]{2,1,0} aten::index(%3901, %3899), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3903 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3904 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3905 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3906 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3907 = bf16[3584,512]{0,1} aten::permute(%3906), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3908 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3909 = bf16[29,512]{1,0} aten::mm(%3908, %3907), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3910 = bf16[1,29,512]{2,1,0} aten::view(%3909), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3911 = bf16[1,29,512]{2,1,0} aten::add(%3910, %3905, %3904), scope=aten::add.468, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3912 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3911), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3913 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3912), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3914 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3913), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3915 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3913), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3916 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3915), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3917 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3916, %3914), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3918 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3917, %3903), scope=aten::mul.474, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3919 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3920 = s64[1,29]{1,0} aten::expand(%3919), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3921 = s64[1,29]{1,0} aten::add(%628, %3920), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3922 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3923 = pred[1,29]{1,0} aten::lt(%628, %3922), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3924 = s64[1,29]{1,0} aten::where(%3923, %3921, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3925 = s64[1,29,1]{2,1,0} aten::stack(%3924), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3926 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3927 = bf16[29,128]{1,0} xla::select(%3926), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3928 = bf16[1,29,128]{2,1,0} aten::index(%3927, %3925), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3929 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3930 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3913, %3929), scope=aten::mul.473, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3931 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3930, %3918, %3892), scope=aten::add.475, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3932 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3931), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3933 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3934 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3935 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3934), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3936 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3935), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3937 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3936), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3938 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3937), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3939 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3938), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3940 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3939), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3941 = bf16[28,128,29]{2,1,0} aten::view(%3940), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3942 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3943 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3944 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3945 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3946 = bf16[3584,3584]{0,1} aten::permute(%3945), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3947 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3948 = bf16[29,3584]{1,0} aten::mm(%3947, %3946), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3949 = bf16[1,29,3584]{2,1,0} aten::view(%3948), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3950 = bf16[1,29,3584]{2,1,0} aten::add(%3949, %3944, %3943), scope=aten::add.467, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3951 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3950), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3952 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3951), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3953 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3952), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3954 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3952), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3955 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3954), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3956 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3955, %3953), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3957 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3956, %3903), scope=aten::mul.471, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3958 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3952, %3929), scope=aten::mul.470, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3959 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3958, %3957, %3942), scope=aten::add.472, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3960 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3959), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3961 = bf16[28,29,128]{2,1,0} aten::view(%3960), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3962 = bf16[28,29,29]{2,1,0} aten::matmul(%3961, %3941), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3963 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3962), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3964 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3963, %3891), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3965 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3964, %617, %3890), scope=aten::add.476, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3966 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3965), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3967 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3966), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3968 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3967), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3969 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3968), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3970 = bf16[28,29,29]{2,1,0} aten::view(%3969), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3971 = bf16[28,29,128]{2,1,0} aten::matmul(%3970, %3889), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3972 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3971), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3973 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3972), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3974 = bf16[1,29,3584]{2,1,0} aten::view(%3973), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3975 = bf16[29,3584]{1,0} aten::view(%3974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3976 = bf16[29,3584]{1,0} aten::mm(%3975, %95), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3977 = bf16[1,29,3584]{2,1,0} aten::view(%3976), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3978 = bf16[1,29,3584]{2,1,0} aten::add(%3865, %3977, %93), scope=aten::add.477, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3979 = f32[1,29,3584]{2,1,0} xla::cast(%3978), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3980 = f32[1,29,3584]{2,1,0} aten::pow(%3979, %92), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3981 = f32[1,29,1]{2,1,0} aten::mean(%3980), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3982 = f32[1,29,1]{2,1,0} aten::add(%3981, %91, %90), scope=aten::add.478, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3983 = f32[1,29,1]{2,1,0} aten::rsqrt(%3982), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3984 = f32[1,29,3584]{2,1,0} aten::mul(%3979, %3983), scope=aten::mul.479, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3985 = bf16[1,29,3584]{2,1,0} xla::cast(%3984), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3986 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3987 = bf16[1,29,3584]{2,1,0} aten::mul(%3986, %3985), scope=aten::mul.480, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3988 = bf16[29,3584]{1,0} aten::view(%3987), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3989 = bf16[29,18944]{1,0} aten::mm(%3988, %89), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3990 = bf16[1,29,18944]{2,1,0} aten::view(%3989), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3991 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3992 = bf16[3584,18944]{0,1} aten::permute(%3991), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3993 = bf16[29,3584]{1,0} aten::view(%3987), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3994 = bf16[29,18944]{1,0} aten::mm(%3993, %3992), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3995 = bf16[1,29,18944]{2,1,0} aten::view(%3994), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3996 = bf16[1,29,18944]{2,1,0} aten::silu(%3995), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3997 = bf16[1,29,18944]{2,1,0} aten::mul(%3996, %3990), scope=aten::mul.481, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3998 = bf16[29,18944]{1,0} aten::view(%3997), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3999 = bf16[29,3584]{1,0} aten::mm(%3998, %87), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4000 = bf16[1,29,3584]{2,1,0} aten::view(%3999), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4001 = bf16[1,29,3584]{2,1,0} aten::add(%3978, %4000, %85), scope=aten::add.482, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4002 = f32[1,29,3584]{2,1,0} xla::cast(%4001), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4003 = f32[1,29,3584]{2,1,0} aten::pow(%4002, %84), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4004 = f32[1,29,1]{2,1,0} aten::mean(%4003), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4005 = f32[1,29,1]{2,1,0} aten::add(%4004, %83, %82), scope=aten::add.483, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4006 = f32[1,29,1]{2,1,0} aten::rsqrt(%4005), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4007 = f32[1,29,3584]{2,1,0} aten::mul(%4002, %4006), scope=aten::mul.484, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4008 = bf16[1,29,3584]{2,1,0} xla::cast(%4007), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4009 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4010 = bf16[1,29,3584]{2,1,0} aten::mul(%4009, %4008), scope=aten::mul.485, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4011 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4012 = bf16[29,512]{1,0} aten::mm(%4011, %81), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4013 = bf16[1,29,512]{2,1,0} aten::view(%4012), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4014 = bf16[1,29,512]{2,1,0} aten::add(%4013, %79, %78), scope=aten::add.488, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4015 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4014), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4016 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4015), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4017 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4016), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4018 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4017), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4019 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4018), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4020 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4019), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4021 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4020), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4022 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4021), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4023 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4022), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4024 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4023), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4025 = bf16[28,29,128]{2,1,0} aten::view(%4024), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4026 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4027 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4028 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4029 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4030 = s64[1,29]{1,0} aten::expand(%4029), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4031 = s64[1,29]{1,0} aten::add(%628, %4030), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4032 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4033 = pred[1,29]{1,0} aten::lt(%628, %4032), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4034 = s64[1,29]{1,0} aten::where(%4033, %4031, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4035 = s64[1,29,1]{2,1,0} aten::stack(%4034), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4036 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4037 = bf16[29,128]{1,0} xla::select(%4036), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4038 = bf16[1,29,128]{2,1,0} aten::index(%4037, %4035), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4039 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4040 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4041 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4042 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4043 = bf16[3584,512]{0,1} aten::permute(%4042), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4044 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4045 = bf16[29,512]{1,0} aten::mm(%4044, %4043), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4046 = bf16[1,29,512]{2,1,0} aten::view(%4045), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4047 = bf16[1,29,512]{2,1,0} aten::add(%4046, %4041, %4040), scope=aten::add.487, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4048 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4047), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4049 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4048), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4050 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4049), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4051 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4049), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4052 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4051), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4053 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4052, %4050), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4054 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4053, %4039), scope=aten::mul.493, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4055 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4056 = s64[1,29]{1,0} aten::expand(%4055), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4057 = s64[1,29]{1,0} aten::add(%628, %4056), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4058 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4059 = pred[1,29]{1,0} aten::lt(%628, %4058), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4060 = s64[1,29]{1,0} aten::where(%4059, %4057, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4061 = s64[1,29,1]{2,1,0} aten::stack(%4060), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4062 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4063 = bf16[29,128]{1,0} xla::select(%4062), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4064 = bf16[1,29,128]{2,1,0} aten::index(%4063, %4061), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4065 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4066 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4049, %4065), scope=aten::mul.492, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4067 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4066, %4054, %4028), scope=aten::add.494, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4068 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4067), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4069 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4070 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4071 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4070), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4072 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4071), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4073 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4072), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4074 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4073), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4075 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4074), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4076 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4075), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4077 = bf16[28,128,29]{2,1,0} aten::view(%4076), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4078 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4079 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4080 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4081 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4082 = bf16[3584,3584]{0,1} aten::permute(%4081), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4083 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4084 = bf16[29,3584]{1,0} aten::mm(%4083, %4082), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4085 = bf16[1,29,3584]{2,1,0} aten::view(%4084), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4086 = bf16[1,29,3584]{2,1,0} aten::add(%4085, %4080, %4079), scope=aten::add.486, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4087 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4086), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4088 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4087), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4089 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4088), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4090 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4088), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4091 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4090), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4092 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4091, %4089), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4093 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4092, %4039), scope=aten::mul.490, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4094 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4088, %4065), scope=aten::mul.489, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4095 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4094, %4093, %4078), scope=aten::add.491, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4096 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4095), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4097 = bf16[28,29,128]{2,1,0} aten::view(%4096), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4098 = bf16[28,29,29]{2,1,0} aten::matmul(%4097, %4077), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4099 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4098), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4100 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4099, %4027), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4101 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4100, %617, %4026), scope=aten::add.495, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4102 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4101), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4103 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4102), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4104 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4103), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4105 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4104), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4106 = bf16[28,29,29]{2,1,0} aten::view(%4105), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4107 = bf16[28,29,128]{2,1,0} aten::matmul(%4106, %4025), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4108 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4107), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4109 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4108), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4110 = bf16[1,29,3584]{2,1,0} aten::view(%4109), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4111 = bf16[29,3584]{1,0} aten::view(%4110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4112 = bf16[29,3584]{1,0} aten::mm(%4111, %77), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4113 = bf16[1,29,3584]{2,1,0} aten::view(%4112), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4114 = bf16[1,29,3584]{2,1,0} aten::add(%4001, %4113, %75), scope=aten::add.496, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4115 = f32[1,29,3584]{2,1,0} xla::cast(%4114), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4116 = f32[1,29,3584]{2,1,0} aten::pow(%4115, %74), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4117 = f32[1,29,1]{2,1,0} aten::mean(%4116), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4118 = f32[1,29,1]{2,1,0} aten::add(%4117, %73, %72), scope=aten::add.497, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4119 = f32[1,29,1]{2,1,0} aten::rsqrt(%4118), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4120 = f32[1,29,3584]{2,1,0} aten::mul(%4115, %4119), scope=aten::mul.498, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4121 = bf16[1,29,3584]{2,1,0} xla::cast(%4120), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4122 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4123 = bf16[1,29,3584]{2,1,0} aten::mul(%4122, %4121), scope=aten::mul.499, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4124 = bf16[29,3584]{1,0} aten::view(%4123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4125 = bf16[29,18944]{1,0} aten::mm(%4124, %71), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4126 = bf16[1,29,18944]{2,1,0} aten::view(%4125), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4127 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4128 = bf16[3584,18944]{0,1} aten::permute(%4127), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4129 = bf16[29,3584]{1,0} aten::view(%4123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4130 = bf16[29,18944]{1,0} aten::mm(%4129, %4128), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4131 = bf16[1,29,18944]{2,1,0} aten::view(%4130), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4132 = bf16[1,29,18944]{2,1,0} aten::silu(%4131), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4133 = bf16[1,29,18944]{2,1,0} aten::mul(%4132, %4126), scope=aten::mul.500, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4134 = bf16[29,18944]{1,0} aten::view(%4133), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4135 = bf16[29,3584]{1,0} aten::mm(%4134, %69), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4136 = bf16[1,29,3584]{2,1,0} aten::view(%4135), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4137 = bf16[1,29,3584]{2,1,0} aten::add(%4114, %4136, %67), scope=aten::add.501, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4138 = f32[1,29,3584]{2,1,0} xla::cast(%4137), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4139 = f32[1,29,3584]{2,1,0} aten::pow(%4138, %66), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4140 = f32[1,29,1]{2,1,0} aten::mean(%4139), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4141 = f32[1,29,1]{2,1,0} aten::add(%4140, %65, %64), scope=aten::add.502, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4142 = f32[1,29,1]{2,1,0} aten::rsqrt(%4141), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4143 = f32[1,29,3584]{2,1,0} aten::mul(%4138, %4142), scope=aten::mul.503, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4144 = bf16[1,29,3584]{2,1,0} xla::cast(%4143), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4145 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4146 = bf16[1,29,3584]{2,1,0} aten::mul(%4145, %4144), scope=aten::mul.504, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4147 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4148 = bf16[29,512]{1,0} aten::mm(%4147, %63), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4149 = bf16[1,29,512]{2,1,0} aten::view(%4148), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4150 = bf16[1,29,512]{2,1,0} aten::add(%4149, %61, %60), scope=aten::add.507, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4151 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4150), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4152 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4151), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4153 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4152), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4154 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4153), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4155 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4154), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4156 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4155), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4157 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4156), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4158 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4157), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4159 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4158), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4160 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4159), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4161 = bf16[28,29,128]{2,1,0} aten::view(%4160), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4162 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4163 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4164 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4165 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4166 = s64[1,29]{1,0} aten::expand(%4165), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4167 = s64[1,29]{1,0} aten::add(%628, %4166), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4168 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4169 = pred[1,29]{1,0} aten::lt(%628, %4168), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4170 = s64[1,29]{1,0} aten::where(%4169, %4167, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4171 = s64[1,29,1]{2,1,0} aten::stack(%4170), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4172 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4173 = bf16[29,128]{1,0} xla::select(%4172), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4174 = bf16[1,29,128]{2,1,0} aten::index(%4173, %4171), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4175 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4176 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4177 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4178 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4179 = bf16[3584,512]{0,1} aten::permute(%4178), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4180 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4181 = bf16[29,512]{1,0} aten::mm(%4180, %4179), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4182 = bf16[1,29,512]{2,1,0} aten::view(%4181), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4183 = bf16[1,29,512]{2,1,0} aten::add(%4182, %4177, %4176), scope=aten::add.506, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4184 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4183), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4185 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4184), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4186 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4185), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4187 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4185), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4188 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4187), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4189 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4188, %4186), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4190 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4189, %4175), scope=aten::mul.512, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4191 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4192 = s64[1,29]{1,0} aten::expand(%4191), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4193 = s64[1,29]{1,0} aten::add(%628, %4192), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4194 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4195 = pred[1,29]{1,0} aten::lt(%628, %4194), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4196 = s64[1,29]{1,0} aten::where(%4195, %4193, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4197 = s64[1,29,1]{2,1,0} aten::stack(%4196), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4198 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4199 = bf16[29,128]{1,0} xla::select(%4198), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4200 = bf16[1,29,128]{2,1,0} aten::index(%4199, %4197), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4201 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4202 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4185, %4201), scope=aten::mul.511, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4203 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4202, %4190, %4164), scope=aten::add.513, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4204 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4203), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4205 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4206 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4207 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4206), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4208 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4207), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4209 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4208), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4210 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4209), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4211 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4210), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4212 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4211), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4213 = bf16[28,128,29]{2,1,0} aten::view(%4212), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4214 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4215 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4216 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4217 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4218 = bf16[3584,3584]{0,1} aten::permute(%4217), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4219 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4220 = bf16[29,3584]{1,0} aten::mm(%4219, %4218), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4221 = bf16[1,29,3584]{2,1,0} aten::view(%4220), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4222 = bf16[1,29,3584]{2,1,0} aten::add(%4221, %4216, %4215), scope=aten::add.505, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4223 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4222), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4224 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4223), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4225 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4224), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4226 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4224), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4227 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4226), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4228 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4227, %4225), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4229 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4228, %4175), scope=aten::mul.509, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4230 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4224, %4201), scope=aten::mul.508, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4231 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4230, %4229, %4214), scope=aten::add.510, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4232 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4231), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4233 = bf16[28,29,128]{2,1,0} aten::view(%4232), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4234 = bf16[28,29,29]{2,1,0} aten::matmul(%4233, %4213), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4235 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4234), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4236 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4235, %4163), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4237 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4236, %617, %4162), scope=aten::add.514, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4238 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4237), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4239 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4238), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4240 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4239), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4241 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4240), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4242 = bf16[28,29,29]{2,1,0} aten::view(%4241), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4243 = bf16[28,29,128]{2,1,0} aten::matmul(%4242, %4161), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4244 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4243), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4245 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4244), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4246 = bf16[1,29,3584]{2,1,0} aten::view(%4245), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4247 = bf16[29,3584]{1,0} aten::view(%4246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4248 = bf16[29,3584]{1,0} aten::mm(%4247, %59), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4249 = bf16[1,29,3584]{2,1,0} aten::view(%4248), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4250 = bf16[1,29,3584]{2,1,0} aten::add(%4137, %4249, %57), scope=aten::add.515, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4251 = f32[1,29,3584]{2,1,0} xla::cast(%4250), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4252 = f32[1,29,3584]{2,1,0} aten::pow(%4251, %56), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4253 = f32[1,29,1]{2,1,0} aten::mean(%4252), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4254 = f32[1,29,1]{2,1,0} aten::add(%4253, %55, %54), scope=aten::add.516, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4255 = f32[1,29,1]{2,1,0} aten::rsqrt(%4254), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4256 = f32[1,29,3584]{2,1,0} aten::mul(%4251, %4255), scope=aten::mul.517, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4257 = bf16[1,29,3584]{2,1,0} xla::cast(%4256), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4258 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4259 = bf16[1,29,3584]{2,1,0} aten::mul(%4258, %4257), scope=aten::mul.518, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4260 = bf16[29,3584]{1,0} aten::view(%4259), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4261 = bf16[29,18944]{1,0} aten::mm(%4260, %53), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4262 = bf16[1,29,18944]{2,1,0} aten::view(%4261), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4263 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4264 = bf16[3584,18944]{0,1} aten::permute(%4263), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4265 = bf16[29,3584]{1,0} aten::view(%4259), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4266 = bf16[29,18944]{1,0} aten::mm(%4265, %4264), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4267 = bf16[1,29,18944]{2,1,0} aten::view(%4266), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4268 = bf16[1,29,18944]{2,1,0} aten::silu(%4267), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4269 = bf16[1,29,18944]{2,1,0} aten::mul(%4268, %4262), scope=aten::mul.519, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4270 = bf16[29,18944]{1,0} aten::view(%4269), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4271 = bf16[29,3584]{1,0} aten::mm(%4270, %51), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4272 = bf16[1,29,3584]{2,1,0} aten::view(%4271), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4273 = bf16[1,29,3584]{2,1,0} aten::add(%4250, %4272, %49), scope=aten::add.520, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4274 = f32[1,29,3584]{2,1,0} xla::cast(%4273), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4275 = f32[1,29,3584]{2,1,0} aten::pow(%4274, %48), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4276 = f32[1,29,1]{2,1,0} aten::mean(%4275), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4277 = f32[1,29,1]{2,1,0} aten::add(%4276, %47, %46), scope=aten::add.521, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4278 = f32[1,29,1]{2,1,0} aten::rsqrt(%4277), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4279 = f32[1,29,3584]{2,1,0} aten::mul(%4274, %4278), scope=aten::mul.522, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4280 = bf16[1,29,3584]{2,1,0} xla::cast(%4279), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4281 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4282 = bf16[1,29,3584]{2,1,0} aten::mul(%4281, %4280), scope=aten::mul.523, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4283 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4284 = bf16[29,512]{1,0} aten::mm(%4283, %45), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4285 = bf16[1,29,512]{2,1,0} aten::view(%4284), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4286 = bf16[1,29,512]{2,1,0} aten::add(%4285, %43, %42), scope=aten::add.526, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4287 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4286), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4288 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4287), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4289 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4288), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4290 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4289), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4291 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4290), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4292 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4291), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4293 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4292), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4294 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4293), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4295 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4294), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4296 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4295), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4297 = bf16[28,29,128]{2,1,0} aten::view(%4296), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4298 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4299 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4300 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4301 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4302 = s64[1,29]{1,0} aten::expand(%4301), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4303 = s64[1,29]{1,0} aten::add(%628, %4302), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4304 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4305 = pred[1,29]{1,0} aten::lt(%628, %4304), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4306 = s64[1,29]{1,0} aten::where(%4305, %4303, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4307 = s64[1,29,1]{2,1,0} aten::stack(%4306), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4308 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4309 = bf16[29,128]{1,0} xla::select(%4308), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4310 = bf16[1,29,128]{2,1,0} aten::index(%4309, %4307), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4311 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4312 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4313 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4314 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4315 = bf16[3584,512]{0,1} aten::permute(%4314), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4316 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4317 = bf16[29,512]{1,0} aten::mm(%4316, %4315), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4318 = bf16[1,29,512]{2,1,0} aten::view(%4317), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4319 = bf16[1,29,512]{2,1,0} aten::add(%4318, %4313, %4312), scope=aten::add.525, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4320 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4319), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4321 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4320), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4322 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4321), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4323 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4321), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4324 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4323), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4325 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4324, %4322), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4326 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4325, %4311), scope=aten::mul.531, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4327 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4328 = s64[1,29]{1,0} aten::expand(%4327), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4329 = s64[1,29]{1,0} aten::add(%628, %4328), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4330 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4331 = pred[1,29]{1,0} aten::lt(%628, %4330), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4332 = s64[1,29]{1,0} aten::where(%4331, %4329, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4333 = s64[1,29,1]{2,1,0} aten::stack(%4332), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4334 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4335 = bf16[29,128]{1,0} xla::select(%4334), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4336 = bf16[1,29,128]{2,1,0} aten::index(%4335, %4333), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4337 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4338 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4321, %4337), scope=aten::mul.530, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4339 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4338, %4326, %4300), scope=aten::add.532, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4340 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4339), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4341 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4342 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4343 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4342), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4344 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4343), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4345 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4344), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4346 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4345), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4347 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4346), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4348 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4347), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4349 = bf16[28,128,29]{2,1,0} aten::view(%4348), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4350 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4351 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4352 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4353 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4354 = bf16[3584,3584]{0,1} aten::permute(%4353), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4355 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4356 = bf16[29,3584]{1,0} aten::mm(%4355, %4354), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4357 = bf16[1,29,3584]{2,1,0} aten::view(%4356), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4358 = bf16[1,29,3584]{2,1,0} aten::add(%4357, %4352, %4351), scope=aten::add.524, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4359 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4358), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4360 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4359), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4361 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4360), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4362 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4360), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4363 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4362), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4364 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4363, %4361), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4365 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4364, %4311), scope=aten::mul.528, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4366 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4360, %4337), scope=aten::mul.527, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4367 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4366, %4365, %4350), scope=aten::add.529, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4368 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4367), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4369 = bf16[28,29,128]{2,1,0} aten::view(%4368), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4370 = bf16[28,29,29]{2,1,0} aten::matmul(%4369, %4349), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4371 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4370), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4372 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4371, %4299), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4373 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4372, %617, %4298), scope=aten::add.533, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4374 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4373), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4375 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4374), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4376 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4375), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4377 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4376), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4378 = bf16[28,29,29]{2,1,0} aten::view(%4377), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4379 = bf16[28,29,128]{2,1,0} aten::matmul(%4378, %4297), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4380 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4379), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4381 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4380), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4382 = bf16[1,29,3584]{2,1,0} aten::view(%4381), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4383 = bf16[29,3584]{1,0} aten::view(%4382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4384 = bf16[29,3584]{1,0} aten::mm(%4383, %41), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4385 = bf16[1,29,3584]{2,1,0} aten::view(%4384), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4386 = bf16[1,29,3584]{2,1,0} aten::add(%4273, %4385, %39), scope=aten::add.534, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4387 = f32[1,29,3584]{2,1,0} xla::cast(%4386), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4388 = f32[1,29,3584]{2,1,0} aten::pow(%4387, %38), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4389 = f32[1,29,1]{2,1,0} aten::mean(%4388), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4390 = f32[1,29,1]{2,1,0} aten::add(%4389, %37, %36), scope=aten::add.535, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4391 = f32[1,29,1]{2,1,0} aten::rsqrt(%4390), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4392 = f32[1,29,3584]{2,1,0} aten::mul(%4387, %4391), scope=aten::mul.536, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4393 = bf16[1,29,3584]{2,1,0} xla::cast(%4392), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4394 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4395 = bf16[1,29,3584]{2,1,0} aten::mul(%4394, %4393), scope=aten::mul.537, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4396 = bf16[29,3584]{1,0} aten::view(%4395), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4397 = bf16[29,18944]{1,0} aten::mm(%4396, %35), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4398 = bf16[1,29,18944]{2,1,0} aten::view(%4397), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4399 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4400 = bf16[3584,18944]{0,1} aten::permute(%4399), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4401 = bf16[29,3584]{1,0} aten::view(%4395), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4402 = bf16[29,18944]{1,0} aten::mm(%4401, %4400), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4403 = bf16[1,29,18944]{2,1,0} aten::view(%4402), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4404 = bf16[1,29,18944]{2,1,0} aten::silu(%4403), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4405 = bf16[1,29,18944]{2,1,0} aten::mul(%4404, %4398), scope=aten::mul.538, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4406 = bf16[29,18944]{1,0} aten::view(%4405), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4407 = bf16[29,3584]{1,0} aten::mm(%4406, %33), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4408 = bf16[1,29,3584]{2,1,0} aten::view(%4407), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4409 = bf16[1,29,3584]{2,1,0} aten::add(%4386, %4408, %31), scope=aten::add.539, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4410 = f32[1,29,3584]{2,1,0} xla::cast(%4409), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4411 = f32[1,29,3584]{2,1,0} aten::pow(%4410, %30), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4412 = f32[1,29,1]{2,1,0} aten::mean(%4411), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4413 = f32[1,29,1]{2,1,0} aten::add(%4412, %29, %28), scope=aten::add.540, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4414 = f32[1,29,1]{2,1,0} aten::rsqrt(%4413), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4415 = f32[1,29,3584]{2,1,0} aten::mul(%4410, %4414), scope=aten::mul.541, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4416 = bf16[1,29,3584]{2,1,0} xla::cast(%4415), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4417 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4418 = bf16[1,29,3584]{2,1,0} aten::mul(%4417, %4416), scope=aten::mul.542, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4419 = bf16[29,3584]{1,0} aten::view(%4418), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4420 = bf16[29,152064]{1,0} aten::mm(%4419, %27), location=forward@linear.py:117, xla_shape=bf16[29,152064]{1,0}
  %4421 = bf16[1,29,152064]{2,1,0} aten::view(%4420), location=forward@linear.py:117, xla_shape=bf16[1,29,152064]{2,1,0}
  %4422 = f32[1,29,152064]{2,1,0} xla::cast(%4421), location=forward@modeling_qwen2.py:1163, xla_shape=f32[1,29,152064]{2,1,0}
  %4423 = f32[1,29,152064]{2,1,0} xla::select(%4422), location=_sample@utils.py:2407, xla_shape=f32[1,29,152064]{2,1,0}
  %4424 = f32[1,1,152064]{2,1,0} xla::generic_slice(%4423), location=_sample@utils.py:2407, xla_shape=f32[1,1,152064]{2,1,0}
  %4425 = f32[1,152064]{1,0} aten::view(%4424), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4426 = f32[1,152064]{1,0} xla::select(%4425), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4427 = f32[1,29]{1,0} aten::gather(%4426, %25), location=__call__@logits_process.py:341, xla_shape=f32[1,29]{1,0}
  %4428 = f32[1,29]{1,0} aten::div(%4427, %21), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4429 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %4430 = f32[1,29]{1,0} aten::mul(%4427, %4429), scope=aten::mul.543, location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4431 = s64[] prim::Constant(), location=__call__@logits_process.py:344, xla_shape=s64[]
  %4432 = pred[1,29]{1,0} aten::lt(%4427, %4431), location=__call__@logits_process.py:344, xla_shape=pred[1,29]{1,0}
  %4433 = f32[1,29]{1,0} aten::where(%4432, %4430, %4428), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4434 = f32[1,152064]{1,0} aten::scatter(%4426, %25, %4433), location=__call__@logits_process.py:346, xla_shape=f32[1,152064]{1,0}
  %4435 = f32[1,152064]{1,0} aten::div(%4434, %20), location=__call__@logits_process.py:292, xla_shape=f32[1,152064]{1,0}
  %4436 = (f32[1,20]{1,0}, s64[1,20]{1,0}) aten::topk(%4435), num_outputs=2, location=__call__@logits_process.py:520, xla_shape=(f32[1,20]{1,0}, s64[1,20]{1,0})
  %4437 = f32[1,1]{1,0} xla::generic_slice(%4436.0), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4438 = f32[1]{0} aten::view(%4437), location=__call__@logits_process.py:520, xla_shape=f32[1]{0}
  %4439 = f32[1,1]{1,0} aten::view(%4438), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4440 = pred[1,152064]{1,0} aten::lt(%4435, %4439), location=__call__@logits_process.py:520, xla_shape=pred[1,152064]{1,0}
  %4441 = f32[1,152064]{1,0} aten::masked_fill(%4435, %4440, %19), location=__call__@logits_process.py:521, xla_shape=f32[1,152064]{1,0}
  %4442 = (f32[1,152064]{1,0}, s64[1,152064]{1,0}) aten::topk(%4441), num_outputs=2, location=__call__@logits_process.py:458, xla_shape=(f32[1,152064]{1,0}, s64[1,152064]{1,0})
  %4443 = f32[1,152064]{1,0} aten::softmax(%4442.0), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4444 = f32[1,152064]{1,0} aten::cumsum(%4443), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4445 = pred[1,152064]{1,0} aten::le(%4444, %18), location=__call__@logits_process.py:462, xla_shape=pred[1,152064]{1,0}
  %4446 = pred[1,152064]{1,0} xla::unselect(%4445, %17), location=__call__@logits_process.py:464, xla_shape=pred[1,152064]{1,0}
  %4447 = pred[1,152064]{1,0} aten::scatter(%4446, %4442.1, %4446), location=__call__@logits_process.py:467, xla_shape=pred[1,152064]{1,0}
  %4448 = f32[1,152064]{1,0} aten::masked_fill(%4441, %4447, %13), location=__call__@logits_process.py:468, xla_shape=f32[1,152064]{1,0}
  %4449 = f32[1,152064]{1,0} aten::softmax(%4448), location=softmax@functional.py:1888, xla_shape=f32[1,152064]{1,0}
  %4450 = s64[1,1]{1,0} aten::multinomial(%4449, %12), location=_sample@utils.py:2437, xla_shape=s64[1,1]{1,0}
  %4451 = s64[1]{0} aten::view(%4450), location=_sample@utils.py:2437, xla_shape=s64[1]{0}
  %4452 = s64[1]{0} aten::mul(%4451, %4), scope=aten::mul.544, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4453 = s64[1]{0} aten::add(%4452, %7, %0), scope=aten::add.547, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4454 = s64[1]{0} xla::select(%4453), location=_sample@utils.py:2446, xla_shape=s64[1]{0}
  %4455 = s64[1,1]{1,0} aten::view(%4454), location=_sample@utils.py:2446, xla_shape=s64[1,1]{1,0}
  %4456 = s64[1,30]{1,0} aten::cat(%25, %4455), location=_sample@utils.py:2446, xla_shape=s64[1,30]{1,0}
  %4457 = s64[1,30]{1,0} xla::select(%4456), location=__call__@stopping_criteria.py:534, xla_shape=s64[1,30]{1,0}
  %4458 = s64[1,1]{1,0} xla::generic_slice(%4457), location=__call__@stopping_criteria.py:534, xla_shape=s64[1,1]{1,0}
  %4459 = s64[1]{0} aten::view(%4458), location=__call__@stopping_criteria.py:534, xla_shape=s64[1]{0}, ROOT=0
}

Graph Hash: 5378f29ba5c1c833dcf50e774376a9cb

## END_GRAPH
