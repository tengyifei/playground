[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  _prepare_special_tokens (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1428)
  generate (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1565)
  decorate_context (/workspaces/hug/hug/lib/python3.10/site-packages/torch/utils/_contextlib.py:116)
  <module> (/tmp/ipykernel_1456554/2982293035.py:14)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (bbf9df5c1d27dd1092228df58f015d98)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_prepare_special_tokens@utils.py:1428, xla_shape=s64[]
  %1 = s64[2]{0} xla::device_data(), location=_tensor_or_none@utils.py:1396, xla_shape=s64[2]{0}
  %2 = pred[2]{0} aten::lt(%1, %0), location=_prepare_special_tokens@utils.py:1428, xla_shape=pred[2]{0}
  %3 = pred[] aten::any(%2), location=_prepare_special_tokens@utils.py:1428, xla_shape=pred[], ROOT=0
}

Graph Hash: ef9d710033ce30476429f94647442635

## END_GRAPH

[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  __call__ (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/stopping_criteria.py:534)
  __call__ (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/stopping_criteria.py:546)
  _sample (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:2455)
  generate (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1758)
  decorate_context (/workspaces/hug/hug/lib/python3.10/site-packages/torch/utils/_contextlib.py:116)
  <module> (/tmp/ipykernel_1456554/2982293035.py:14)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (6b7350cef848dc68638df698f371d508)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_sample@utils.py:2443, xla_shape=s64[]
  %1 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %2 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %3 = s64[] prim::Constant(), location=_sample@utils.py:2389, xla_shape=s64[]
  %4 = s64[1]{0} aten::expand(%3), location=_sample@utils.py:2389, xla_shape=s64[1]{0}
  %5 = s64[1]{0} aten::rsub(%4, %2, %1), scope=aten::rsub.545, location=__rsub__@_tensor.py:962, xla_shape=s64[1]{0}
  %6 = s64[] xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[]
  %7 = s64[1]{0} aten::mul(%6, %5), scope=aten::mul.546, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %8 = s64[] xla::device_data(), location=_sample@utils.py:2437, xla_shape=s64[]
  %9 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %10 = s64[] aten::mul(%9, %8), location=_sample@utils.py:2437, xla_shape=s64[]
  %11 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %12 = s64[] aten::add(%11, %10), location=_sample@utils.py:2437, xla_shape=s64[]
  %13 = f64[] xla::device_data(), location=__call__@logits_process.py:468, xla_shape=f64[]
  %14 = pred[] prim::Constant(), location=__call__@logits_process.py:464, xla_shape=pred[]
  %15 = pred[] aten::expand(%14), location=__call__@logits_process.py:464, xla_shape=pred[]
  %16 = pred[] aten::view(%15), location=__call__@logits_process.py:464, xla_shape=pred[]
  %17 = pred[1,1]{1,0} aten::expand(%16), location=__call__@logits_process.py:464, xla_shape=pred[1,1]{1,0}
  %18 = f64[] xla::device_data(), location=__call__@logits_process.py:462, xla_shape=f64[]
  %19 = f64[] xla::device_data(), location=__call__@logits_process.py:521, xla_shape=f64[]
  %20 = f32[] xla::device_data(), location=__call__@logits_process.py:292, xla_shape=f32[]
  %21 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %22 = s64[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %23 = s64[1,1,29]{2,1,0} aten::view(%22), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %24 = s64[1,1,29]{2,1,0} aten::expand(%23), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %25 = s64[1,29]{1,0} aten::view(%24), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,29]{1,0}
  %26 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %27 = bf16[3584,152064]{0,1} aten::permute(%26), location=forward@linear.py:117, xla_shape=bf16[3584,152064]{0,1}
  %28 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %29 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %30 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %31 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %32 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %33 = bf16[18944,3584]{0,1} aten::permute(%32), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %34 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %35 = bf16[3584,18944]{0,1} aten::permute(%34), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %36 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %37 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %38 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %39 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %40 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %41 = bf16[3584,3584]{0,1} aten::permute(%40), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %42 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %43 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %44 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %45 = bf16[3584,512]{0,1} aten::permute(%44), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %46 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %47 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %48 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %49 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %50 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %51 = bf16[18944,3584]{0,1} aten::permute(%50), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %52 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %53 = bf16[3584,18944]{0,1} aten::permute(%52), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %54 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %55 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %56 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %57 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %58 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %59 = bf16[3584,3584]{0,1} aten::permute(%58), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %60 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %61 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %62 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %63 = bf16[3584,512]{0,1} aten::permute(%62), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %64 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %65 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %66 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %67 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %68 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %69 = bf16[18944,3584]{0,1} aten::permute(%68), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %70 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %71 = bf16[3584,18944]{0,1} aten::permute(%70), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %72 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %73 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %74 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %75 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %76 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %77 = bf16[3584,3584]{0,1} aten::permute(%76), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %78 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %79 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %80 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %81 = bf16[3584,512]{0,1} aten::permute(%80), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %82 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %83 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %84 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %85 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %86 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %87 = bf16[18944,3584]{0,1} aten::permute(%86), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %88 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %89 = bf16[3584,18944]{0,1} aten::permute(%88), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %90 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %91 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %92 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %93 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %94 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %95 = bf16[3584,3584]{0,1} aten::permute(%94), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %96 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %97 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %98 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %99 = bf16[3584,512]{0,1} aten::permute(%98), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %100 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %101 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %102 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %103 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %104 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %105 = bf16[18944,3584]{0,1} aten::permute(%104), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %106 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %107 = bf16[3584,18944]{0,1} aten::permute(%106), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %108 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %109 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %110 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %111 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %112 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %113 = bf16[3584,3584]{0,1} aten::permute(%112), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %114 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %115 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %116 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %117 = bf16[3584,512]{0,1} aten::permute(%116), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %118 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %119 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %120 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %121 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %122 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %123 = bf16[18944,3584]{0,1} aten::permute(%122), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %124 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %125 = bf16[3584,18944]{0,1} aten::permute(%124), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %126 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %127 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %128 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %129 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %130 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %131 = bf16[3584,3584]{0,1} aten::permute(%130), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %132 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %133 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %134 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %135 = bf16[3584,512]{0,1} aten::permute(%134), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %136 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %137 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %138 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %139 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %140 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %141 = bf16[18944,3584]{0,1} aten::permute(%140), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %142 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %143 = bf16[3584,18944]{0,1} aten::permute(%142), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %144 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %145 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %146 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %147 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %148 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %149 = bf16[3584,3584]{0,1} aten::permute(%148), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %150 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %151 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %152 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %153 = bf16[3584,512]{0,1} aten::permute(%152), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %154 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %155 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %156 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %157 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %158 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %159 = bf16[18944,3584]{0,1} aten::permute(%158), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %160 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %161 = bf16[3584,18944]{0,1} aten::permute(%160), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %162 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %163 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %164 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %165 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %166 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %167 = bf16[3584,3584]{0,1} aten::permute(%166), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %168 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %169 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %170 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %171 = bf16[3584,512]{0,1} aten::permute(%170), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %172 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %173 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %174 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %175 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %176 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %177 = bf16[18944,3584]{0,1} aten::permute(%176), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %178 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %179 = bf16[3584,18944]{0,1} aten::permute(%178), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %180 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %181 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %182 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %183 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %184 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %185 = bf16[3584,3584]{0,1} aten::permute(%184), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %186 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %187 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %188 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %189 = bf16[3584,512]{0,1} aten::permute(%188), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %190 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %191 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %192 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %193 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %194 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %195 = bf16[18944,3584]{0,1} aten::permute(%194), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %196 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %197 = bf16[3584,18944]{0,1} aten::permute(%196), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %198 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %199 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %200 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %201 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %202 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %203 = bf16[3584,3584]{0,1} aten::permute(%202), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %204 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %205 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %206 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %207 = bf16[3584,512]{0,1} aten::permute(%206), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %208 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %209 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %210 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %211 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %212 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %213 = bf16[18944,3584]{0,1} aten::permute(%212), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %214 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %215 = bf16[3584,18944]{0,1} aten::permute(%214), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %216 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %217 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %218 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %219 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %220 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %221 = bf16[3584,3584]{0,1} aten::permute(%220), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %222 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %223 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %224 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %225 = bf16[3584,512]{0,1} aten::permute(%224), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %226 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %227 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %228 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %229 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %230 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %231 = bf16[18944,3584]{0,1} aten::permute(%230), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %232 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %233 = bf16[3584,18944]{0,1} aten::permute(%232), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %234 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %235 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %236 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %237 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %238 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %239 = bf16[3584,3584]{0,1} aten::permute(%238), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %240 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %241 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %242 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %243 = bf16[3584,512]{0,1} aten::permute(%242), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %244 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %245 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %246 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %247 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %248 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %249 = bf16[18944,3584]{0,1} aten::permute(%248), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %250 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %251 = bf16[3584,18944]{0,1} aten::permute(%250), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %252 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %253 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %254 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %255 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %256 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %257 = bf16[3584,3584]{0,1} aten::permute(%256), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %258 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %259 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %260 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %261 = bf16[3584,512]{0,1} aten::permute(%260), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %262 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %263 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %264 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %265 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %266 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %267 = bf16[18944,3584]{0,1} aten::permute(%266), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %268 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %269 = bf16[3584,18944]{0,1} aten::permute(%268), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %270 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %271 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %272 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %273 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %274 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %275 = bf16[3584,3584]{0,1} aten::permute(%274), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %276 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %277 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %278 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %279 = bf16[3584,512]{0,1} aten::permute(%278), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %280 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %281 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %282 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %283 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %284 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %285 = bf16[18944,3584]{0,1} aten::permute(%284), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %286 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %287 = bf16[3584,18944]{0,1} aten::permute(%286), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %288 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %289 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %290 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %291 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %292 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %293 = bf16[3584,3584]{0,1} aten::permute(%292), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %294 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %295 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %296 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %297 = bf16[3584,512]{0,1} aten::permute(%296), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %298 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %299 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %300 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %301 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %302 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %303 = bf16[18944,3584]{0,1} aten::permute(%302), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %304 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %305 = bf16[3584,18944]{0,1} aten::permute(%304), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %306 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %307 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %308 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %309 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %310 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %311 = bf16[3584,3584]{0,1} aten::permute(%310), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %312 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %313 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %314 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %315 = bf16[3584,512]{0,1} aten::permute(%314), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %316 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %317 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %318 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %319 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %320 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %321 = bf16[18944,3584]{0,1} aten::permute(%320), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %322 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %323 = bf16[3584,18944]{0,1} aten::permute(%322), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %324 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %325 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %326 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %327 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %328 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %329 = bf16[3584,3584]{0,1} aten::permute(%328), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %330 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %331 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %332 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %333 = bf16[3584,512]{0,1} aten::permute(%332), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %334 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %335 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %336 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %337 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %338 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %339 = bf16[18944,3584]{0,1} aten::permute(%338), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %340 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %341 = bf16[3584,18944]{0,1} aten::permute(%340), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %342 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %343 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %344 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %345 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %346 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %347 = bf16[3584,3584]{0,1} aten::permute(%346), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %348 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %349 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %350 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %351 = bf16[3584,512]{0,1} aten::permute(%350), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %352 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %353 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %354 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %355 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %356 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %357 = bf16[18944,3584]{0,1} aten::permute(%356), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %358 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %359 = bf16[3584,18944]{0,1} aten::permute(%358), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %360 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %361 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %362 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %363 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %364 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %365 = bf16[3584,3584]{0,1} aten::permute(%364), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %366 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %367 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %368 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %369 = bf16[3584,512]{0,1} aten::permute(%368), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %370 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %371 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %372 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %373 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %374 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %375 = bf16[18944,3584]{0,1} aten::permute(%374), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %376 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %377 = bf16[3584,18944]{0,1} aten::permute(%376), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %378 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %379 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %380 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %381 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %382 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %383 = bf16[3584,3584]{0,1} aten::permute(%382), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %384 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %385 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %386 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %387 = bf16[3584,512]{0,1} aten::permute(%386), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %388 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %389 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %390 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %391 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %392 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %393 = bf16[18944,3584]{0,1} aten::permute(%392), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %394 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %395 = bf16[3584,18944]{0,1} aten::permute(%394), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %396 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %397 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %398 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %399 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %400 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %401 = bf16[3584,3584]{0,1} aten::permute(%400), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %402 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %403 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %404 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %405 = bf16[3584,512]{0,1} aten::permute(%404), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %406 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %407 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %408 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %409 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %410 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %411 = bf16[18944,3584]{0,1} aten::permute(%410), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %412 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %413 = bf16[3584,18944]{0,1} aten::permute(%412), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %414 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %415 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %416 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %417 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %418 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %419 = bf16[3584,3584]{0,1} aten::permute(%418), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %420 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %421 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %422 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %423 = bf16[3584,512]{0,1} aten::permute(%422), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %424 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %425 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %426 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %427 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %428 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %429 = bf16[18944,3584]{0,1} aten::permute(%428), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %430 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %431 = bf16[3584,18944]{0,1} aten::permute(%430), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %432 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %433 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %434 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %435 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %436 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %437 = bf16[3584,3584]{0,1} aten::permute(%436), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %438 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %439 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %440 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %441 = bf16[3584,512]{0,1} aten::permute(%440), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %442 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %443 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %444 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %445 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %446 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %447 = bf16[18944,3584]{0,1} aten::permute(%446), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %448 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %449 = bf16[3584,18944]{0,1} aten::permute(%448), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %450 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %451 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %452 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %453 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %454 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %455 = bf16[3584,3584]{0,1} aten::permute(%454), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %456 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %457 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %458 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %459 = bf16[3584,512]{0,1} aten::permute(%458), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %460 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %461 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %462 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %463 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %464 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %465 = bf16[18944,3584]{0,1} aten::permute(%464), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %466 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %467 = bf16[3584,18944]{0,1} aten::permute(%466), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %468 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %469 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %470 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %471 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %472 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %473 = bf16[3584,3584]{0,1} aten::permute(%472), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %474 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %475 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %476 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %477 = bf16[3584,512]{0,1} aten::permute(%476), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %478 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %479 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %480 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %481 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %482 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %483 = bf16[18944,3584]{0,1} aten::permute(%482), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %484 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %485 = bf16[3584,18944]{0,1} aten::permute(%484), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %486 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %487 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %488 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %489 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %490 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %491 = bf16[3584,3584]{0,1} aten::permute(%490), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %492 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %493 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %494 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %495 = bf16[3584,512]{0,1} aten::permute(%494), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %496 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %497 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %498 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %499 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %500 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %501 = bf16[18944,3584]{0,1} aten::permute(%500), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %502 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %503 = bf16[3584,18944]{0,1} aten::permute(%502), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %504 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %505 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %506 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %507 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %508 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %509 = bf16[3584,3584]{0,1} aten::permute(%508), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %510 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %511 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %512 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %513 = bf16[3584,512]{0,1} aten::permute(%512), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %514 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %515 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %516 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %517 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %518 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %519 = bf16[18944,3584]{0,1} aten::permute(%518), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %520 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %521 = bf16[3584,18944]{0,1} aten::permute(%520), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %522 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %523 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %524 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %525 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %526 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %527 = bf16[3584,3584]{0,1} aten::permute(%526), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %528 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %529 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %530 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %531 = bf16[3584,512]{0,1} aten::permute(%530), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %532 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %533 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %534 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %535 = s64[29]{0} aten::view(%25), location=embedding@functional.py:2267, xla_shape=s64[29]{0}
  %536 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %537 = bf16[29,3584]{1,0} aten::index_select(%536, %535), location=embedding@functional.py:2267, xla_shape=bf16[29,3584]{1,0}
  %538 = bf16[1,29,3584]{2,1,0} aten::view(%537), location=embedding@functional.py:2267, xla_shape=bf16[1,29,3584]{2,1,0}
  %539 = f32[1,29,3584]{2,1,0} xla::cast(%538), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %540 = f32[1,29,3584]{2,1,0} aten::pow(%539, %534), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %541 = f32[1,29,1]{2,1,0} aten::mean(%540), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %542 = f32[1,29,1]{2,1,0} aten::add(%541, %533, %532), scope=aten::add.8, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %543 = f32[1,29,1]{2,1,0} aten::rsqrt(%542), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %544 = f32[1,29,3584]{2,1,0} aten::mul(%539, %543), scope=aten::mul.9, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %545 = bf16[1,29,3584]{2,1,0} xla::cast(%544), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %546 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %547 = bf16[1,29,3584]{2,1,0} aten::mul(%546, %545), scope=aten::mul.10, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %548 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %549 = bf16[29,512]{1,0} aten::mm(%548, %531), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %550 = bf16[1,29,512]{2,1,0} aten::view(%549), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %551 = bf16[1,29,512]{2,1,0} aten::add(%550, %529, %528), scope=aten::add.13, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %552 = bf16[1,29,4,128]{3,2,1,0} aten::view(%551), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %553 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%552), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %554 = bf16[1,4,29,128]{3,1,2,0} xla::select(%553), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %555 = bf16[1,4,29,128]{3,1,2,0} xla::select(%554), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %556 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%555), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %557 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%556), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %558 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%557), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %559 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%558), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %560 = bf16[1,28,29,128]{3,2,1,0} aten::view(%559), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %561 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%560), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %562 = bf16[28,29,128]{2,1,0} aten::view(%561), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %563 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %564 = f64[] xla::device_data(), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=f64[]
  %565 = f64[] xla::device_data(), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=f64[]
  %566 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %567 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %568 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[]
  %569 = pred[2]{0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[2]{0}
  %570 = pred[] aten::any(%569), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[]
  %571 = pred[] aten::bitwise_not(%570), location=_prepare_attention_mask_for_generation@utils.py:475, xla_shape=pred[]
  %572 = pred[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[1,29]{1,0}
  %573 = pred[] aten::any(%572), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[]
  %574 = pred[] aten::mul(%573, %571), scope=aten::mul.1, location=_prepare_attention_mask_for_generation@utils.py:478, xla_shape=pred[]
  %575 = pred[] aten::bitwise_not(%574), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=pred[]
  %576 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[]
  %577 = s64[1,29]{1,0} aten::expand(%576), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[1,29]{1,0}
  %578 = s64[1,29]{1,0} aten::mul(%577, %575), scope=aten::mul.3, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %579 = pred[1,29]{1,0} aten::ne(%22, %6), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=pred[1,29]{1,0}
  %580 = s64[1,29]{1,0} xla::cast(%579), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %581 = s64[1,29]{1,0} aten::mul(%580, %574), scope=aten::mul.2, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %582 = s64[1,29]{1,0} aten::add(%581, %578, %568), scope=aten::add.4, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %583 = s64[1,1,29]{2,1,0} aten::view(%582), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %584 = s64[1,1,29]{2,1,0} aten::expand(%583), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %585 = s64[1,29]{1,0} aten::view(%584), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,29]{1,0}
  %586 = s64[1,29]{1,0} xla::select(%585), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,29]{1,0}
  %587 = s64[1,1,29]{2,1,0} aten::view(%586), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29]{2,1,0}
  %588 = s64[1,1,1,29]{3,2,1,0} aten::view(%587), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %589 = s64[1,1,1,29]{3,2,1,0} xla::select(%588), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %590 = s64[1,1,29,29]{3,2,1,0} aten::expand(%589), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29,29]{3,2,1,0}
  %591 = bf16[1,1,29,29]{3,2,1,0} xla::cast(%590), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %592 = bf16[1,1,29,29]{3,2,1,0} aten::rsub(%591, %567, %566), scope=aten::rsub.7, location=__rsub__@_tensor.py:962, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %593 = pred[1,1,29,29]{3,2,1,0} xla::cast(%592), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %594 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%592, %593, %565), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %595 = pred[1,1,29,29]{3,2,1,0} xla::cast(%594), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %596 = f64[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=f64[]
  %597 = pred[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[]
  %598 = pred[29,29]{1,0} aten::expand(%597), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %599 = pred[29,29]{1,0} aten::tril(%598), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %600 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %601 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %602 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %603 = s64[29]{0} prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:157, xla_shape=s64[29]{0}
  %604 = s64[29]{0} aten::add(%603, %602, %601), scope=aten::add.6, location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29]{0}
  %605 = s64[29,1]{1,0} aten::view(%604), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29,1]{1,0}
  %606 = pred[29,29]{1,0} aten::lt(%603, %605), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=pred[29,29]{1,0}
  %607 = f32[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[]
  %608 = f32[29,29]{1,0} aten::expand(%607), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[29,29]{1,0}
  %609 = f32[29,29]{1,0} aten::masked_fill(%608, %606, %600), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=f32[29,29]{1,0}
  %610 = bf16[29,29]{1,0} xla::cast(%609), location=_make_causal_mask@modeling_attn_mask_utils.py:160, xla_shape=bf16[29,29]{1,0}
  %611 = bf16[29,29]{1,0} aten::masked_fill(%610, %599, %596), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=bf16[29,29]{1,0}
  %612 = bf16[1,29,29]{2,1,0} aten::view(%611), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,29,29]{2,1,0}
  %613 = bf16[1,1,29,29]{3,2,1,0} aten::view(%612), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %614 = bf16[1,1,29,29]{3,2,1,0} xla::select(%613), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %615 = bf16[1,1,29,29]{3,2,1,0} xla::select(%614), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %616 = bf16[1,1,29,29]{3,2,1,0} aten::expand(%615), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %617 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%616, %595, %564), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %618 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %619 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %620 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %621 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %622 = pred[1,29]{1,0} aten::eq(%585, %621), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=pred[1,29]{1,0}
  %623 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %624 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %625 = s64[1,29]{1,0} aten::cumsum(%585), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %626 = s64[1,29]{1,0} aten::sub(%625, %624, %623), scope=aten::sub.5, location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %627 = s64[1,29]{1,0} aten::masked_fill(%626, %622, %620), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[1,29]{1,0}
  %628 = s64[1,29]{1,0} aten::view(%627), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %629 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %630 = s64[1,29]{1,0} aten::expand(%629), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %631 = s64[1,29]{1,0} aten::add(%628, %630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %632 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %633 = pred[1,29]{1,0} aten::lt(%628, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %634 = s64[1,29]{1,0} aten::where(%633, %631, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %635 = s64[1,29,1]{2,1,0} aten::stack(%634), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %636 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %637 = bf16[29,128]{1,0} xla::select(%636), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %638 = bf16[1,29,128]{2,1,0} aten::index(%637, %635), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %639 = bf16[1,1,29,128]{3,2,1,0} aten::view(%638), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %640 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %641 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %642 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %643 = bf16[3584,512]{0,1} aten::permute(%642), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %644 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %645 = bf16[29,512]{1,0} aten::mm(%644, %643), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %646 = bf16[1,29,512]{2,1,0} aten::view(%645), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %647 = bf16[1,29,512]{2,1,0} aten::add(%646, %641, %640), scope=aten::add.12, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %648 = bf16[1,29,4,128]{3,2,1,0} aten::view(%647), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %649 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%648), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %650 = bf16[1,4,29,64]{3,1,2,0} xla::select(%649), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %651 = bf16[1,4,29,64]{3,1,2,0} xla::select(%649), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %652 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%651), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %653 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%652, %650), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %654 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%653, %639), scope=aten::mul.18, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %655 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %656 = s64[1,29]{1,0} aten::expand(%655), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %657 = s64[1,29]{1,0} aten::add(%628, %656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %658 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %659 = pred[1,29]{1,0} aten::lt(%628, %658), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %660 = s64[1,29]{1,0} aten::where(%659, %657, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %661 = s64[1,29,1]{2,1,0} aten::stack(%660), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %662 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %663 = bf16[29,128]{1,0} xla::select(%662), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %664 = bf16[1,29,128]{2,1,0} aten::index(%663, %661), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %665 = bf16[1,1,29,128]{3,2,1,0} aten::view(%664), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %666 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%649, %665), scope=aten::mul.17, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %667 = bf16[1,4,29,128]{3,2,1,0} aten::add(%666, %654, %619), scope=aten::add.19, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %668 = bf16[1,4,29,128]{3,2,1,0} xla::select(%667), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %669 = bf16[1,4,29,128]{3,2,1,0} xla::select(%668), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %670 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%669), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %671 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%670), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %672 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%671), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %673 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%672), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %674 = bf16[1,28,29,128]{3,2,1,0} aten::view(%673), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %675 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%674), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %676 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%675), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %677 = bf16[28,128,29]{2,1,0} aten::view(%676), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %678 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %679 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %680 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %681 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %682 = bf16[3584,3584]{0,1} aten::permute(%681), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %683 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %684 = bf16[29,3584]{1,0} aten::mm(%683, %682), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %685 = bf16[1,29,3584]{2,1,0} aten::view(%684), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %686 = bf16[1,29,3584]{2,1,0} aten::add(%685, %680, %679), scope=aten::add.11, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %687 = bf16[1,29,28,128]{3,2,1,0} aten::view(%686), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %688 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%687), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %689 = bf16[1,28,29,64]{3,1,2,0} xla::select(%688), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %690 = bf16[1,28,29,64]{3,1,2,0} xla::select(%688), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %691 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%690), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %692 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%691, %689), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %693 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%692, %639), scope=aten::mul.15, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %694 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%688, %665), scope=aten::mul.14, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %695 = bf16[1,28,29,128]{3,2,1,0} aten::add(%694, %693, %678), scope=aten::add.16, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %696 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%695), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %697 = bf16[28,29,128]{2,1,0} aten::view(%696), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %698 = bf16[28,29,29]{2,1,0} aten::matmul(%697, %677), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %699 = bf16[1,28,29,29]{3,2,1,0} aten::view(%698), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %700 = bf16[1,28,29,29]{3,2,1,0} aten::div(%699, %618), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %701 = bf16[1,28,29,29]{3,2,1,0} aten::add(%700, %617, %563), scope=aten::add.20, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %702 = f32[1,28,29,29]{3,2,1,0} xla::cast(%701), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %703 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%702), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %704 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%703), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %705 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%704), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %706 = bf16[28,29,29]{2,1,0} aten::view(%705), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %707 = bf16[28,29,128]{2,1,0} aten::matmul(%706, %562), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %708 = bf16[1,28,29,128]{3,2,1,0} aten::view(%707), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %709 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%708), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %710 = bf16[1,29,3584]{2,1,0} aten::view(%709), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %711 = bf16[29,3584]{1,0} aten::view(%710), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %712 = bf16[29,3584]{1,0} aten::mm(%711, %527), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %713 = bf16[1,29,3584]{2,1,0} aten::view(%712), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %714 = bf16[1,29,3584]{2,1,0} aten::add(%538, %713, %525), scope=aten::add.21, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %715 = f32[1,29,3584]{2,1,0} xla::cast(%714), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %716 = f32[1,29,3584]{2,1,0} aten::pow(%715, %524), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %717 = f32[1,29,1]{2,1,0} aten::mean(%716), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %718 = f32[1,29,1]{2,1,0} aten::add(%717, %523, %522), scope=aten::add.22, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %719 = f32[1,29,1]{2,1,0} aten::rsqrt(%718), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %720 = f32[1,29,3584]{2,1,0} aten::mul(%715, %719), scope=aten::mul.23, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %721 = bf16[1,29,3584]{2,1,0} xla::cast(%720), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %722 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %723 = bf16[1,29,3584]{2,1,0} aten::mul(%722, %721), scope=aten::mul.24, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %724 = bf16[29,3584]{1,0} aten::view(%723), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %725 = bf16[29,18944]{1,0} aten::mm(%724, %521), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %726 = bf16[1,29,18944]{2,1,0} aten::view(%725), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %727 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %728 = bf16[3584,18944]{0,1} aten::permute(%727), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %729 = bf16[29,3584]{1,0} aten::view(%723), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %730 = bf16[29,18944]{1,0} aten::mm(%729, %728), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %731 = bf16[1,29,18944]{2,1,0} aten::view(%730), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %732 = bf16[1,29,18944]{2,1,0} aten::silu(%731), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %733 = bf16[1,29,18944]{2,1,0} aten::mul(%732, %726), scope=aten::mul.25, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %734 = bf16[29,18944]{1,0} aten::view(%733), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %735 = bf16[29,3584]{1,0} aten::mm(%734, %519), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %736 = bf16[1,29,3584]{2,1,0} aten::view(%735), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %737 = bf16[1,29,3584]{2,1,0} aten::add(%714, %736, %517), scope=aten::add.26, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %738 = f32[1,29,3584]{2,1,0} xla::cast(%737), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %739 = f32[1,29,3584]{2,1,0} aten::pow(%738, %516), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %740 = f32[1,29,1]{2,1,0} aten::mean(%739), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %741 = f32[1,29,1]{2,1,0} aten::add(%740, %515, %514), scope=aten::add.27, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %742 = f32[1,29,1]{2,1,0} aten::rsqrt(%741), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %743 = f32[1,29,3584]{2,1,0} aten::mul(%738, %742), scope=aten::mul.28, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %744 = bf16[1,29,3584]{2,1,0} xla::cast(%743), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %745 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %746 = bf16[1,29,3584]{2,1,0} aten::mul(%745, %744), scope=aten::mul.29, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %747 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %748 = bf16[29,512]{1,0} aten::mm(%747, %513), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %749 = bf16[1,29,512]{2,1,0} aten::view(%748), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %750 = bf16[1,29,512]{2,1,0} aten::add(%749, %511, %510), scope=aten::add.32, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %751 = bf16[1,29,4,128]{3,2,1,0} aten::view(%750), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %752 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%751), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %753 = bf16[1,4,29,128]{3,1,2,0} xla::select(%752), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %754 = bf16[1,4,29,128]{3,1,2,0} xla::select(%753), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %755 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%754), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %756 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%755), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %757 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %758 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %759 = bf16[1,28,29,128]{3,2,1,0} aten::view(%758), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %760 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%759), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %761 = bf16[28,29,128]{2,1,0} aten::view(%760), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %762 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %763 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %764 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %765 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %766 = s64[1,29]{1,0} aten::expand(%765), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %767 = s64[1,29]{1,0} aten::add(%628, %766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %768 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %769 = pred[1,29]{1,0} aten::lt(%628, %768), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %770 = s64[1,29]{1,0} aten::where(%769, %767, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %771 = s64[1,29,1]{2,1,0} aten::stack(%770), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %772 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %773 = bf16[29,128]{1,0} xla::select(%772), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %774 = bf16[1,29,128]{2,1,0} aten::index(%773, %771), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %775 = bf16[1,1,29,128]{3,2,1,0} aten::view(%774), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %776 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %777 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %778 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %779 = bf16[3584,512]{0,1} aten::permute(%778), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %780 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %781 = bf16[29,512]{1,0} aten::mm(%780, %779), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %782 = bf16[1,29,512]{2,1,0} aten::view(%781), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %783 = bf16[1,29,512]{2,1,0} aten::add(%782, %777, %776), scope=aten::add.31, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %784 = bf16[1,29,4,128]{3,2,1,0} aten::view(%783), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %785 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%784), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %786 = bf16[1,4,29,64]{3,1,2,0} xla::select(%785), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %787 = bf16[1,4,29,64]{3,1,2,0} xla::select(%785), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %788 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%787), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %789 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%788, %786), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %790 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%789, %775), scope=aten::mul.37, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %791 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %792 = s64[1,29]{1,0} aten::expand(%791), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %793 = s64[1,29]{1,0} aten::add(%628, %792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %794 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %795 = pred[1,29]{1,0} aten::lt(%628, %794), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %796 = s64[1,29]{1,0} aten::where(%795, %793, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %797 = s64[1,29,1]{2,1,0} aten::stack(%796), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %798 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %799 = bf16[29,128]{1,0} xla::select(%798), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %800 = bf16[1,29,128]{2,1,0} aten::index(%799, %797), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %801 = bf16[1,1,29,128]{3,2,1,0} aten::view(%800), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %802 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%785, %801), scope=aten::mul.36, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %803 = bf16[1,4,29,128]{3,2,1,0} aten::add(%802, %790, %764), scope=aten::add.38, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %804 = bf16[1,4,29,128]{3,2,1,0} xla::select(%803), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %805 = bf16[1,4,29,128]{3,2,1,0} xla::select(%804), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %806 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%805), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %807 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%806), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %808 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%807), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %809 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%808), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %810 = bf16[1,28,29,128]{3,2,1,0} aten::view(%809), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %811 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%810), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %812 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%811), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %813 = bf16[28,128,29]{2,1,0} aten::view(%812), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %814 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %815 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %816 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %817 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %818 = bf16[3584,3584]{0,1} aten::permute(%817), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %819 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %820 = bf16[29,3584]{1,0} aten::mm(%819, %818), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %821 = bf16[1,29,3584]{2,1,0} aten::view(%820), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %822 = bf16[1,29,3584]{2,1,0} aten::add(%821, %816, %815), scope=aten::add.30, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %823 = bf16[1,29,28,128]{3,2,1,0} aten::view(%822), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %824 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%823), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %825 = bf16[1,28,29,64]{3,1,2,0} xla::select(%824), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %826 = bf16[1,28,29,64]{3,1,2,0} xla::select(%824), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %827 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%826), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %828 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%827, %825), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %829 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%828, %775), scope=aten::mul.34, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %830 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%824, %801), scope=aten::mul.33, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %831 = bf16[1,28,29,128]{3,2,1,0} aten::add(%830, %829, %814), scope=aten::add.35, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %832 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%831), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %833 = bf16[28,29,128]{2,1,0} aten::view(%832), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %834 = bf16[28,29,29]{2,1,0} aten::matmul(%833, %813), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %835 = bf16[1,28,29,29]{3,2,1,0} aten::view(%834), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %836 = bf16[1,28,29,29]{3,2,1,0} aten::div(%835, %763), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %837 = bf16[1,28,29,29]{3,2,1,0} aten::add(%836, %617, %762), scope=aten::add.39, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %838 = f32[1,28,29,29]{3,2,1,0} xla::cast(%837), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %839 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%838), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %840 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%839), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %841 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%840), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %842 = bf16[28,29,29]{2,1,0} aten::view(%841), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %843 = bf16[28,29,128]{2,1,0} aten::matmul(%842, %761), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %844 = bf16[1,28,29,128]{3,2,1,0} aten::view(%843), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %845 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%844), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %846 = bf16[1,29,3584]{2,1,0} aten::view(%845), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %847 = bf16[29,3584]{1,0} aten::view(%846), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %848 = bf16[29,3584]{1,0} aten::mm(%847, %509), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %849 = bf16[1,29,3584]{2,1,0} aten::view(%848), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %850 = bf16[1,29,3584]{2,1,0} aten::add(%737, %849, %507), scope=aten::add.40, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %851 = f32[1,29,3584]{2,1,0} xla::cast(%850), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %852 = f32[1,29,3584]{2,1,0} aten::pow(%851, %506), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %853 = f32[1,29,1]{2,1,0} aten::mean(%852), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %854 = f32[1,29,1]{2,1,0} aten::add(%853, %505, %504), scope=aten::add.41, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %855 = f32[1,29,1]{2,1,0} aten::rsqrt(%854), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %856 = f32[1,29,3584]{2,1,0} aten::mul(%851, %855), scope=aten::mul.42, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %857 = bf16[1,29,3584]{2,1,0} xla::cast(%856), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %858 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %859 = bf16[1,29,3584]{2,1,0} aten::mul(%858, %857), scope=aten::mul.43, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %860 = bf16[29,3584]{1,0} aten::view(%859), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %861 = bf16[29,18944]{1,0} aten::mm(%860, %503), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %862 = bf16[1,29,18944]{2,1,0} aten::view(%861), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %863 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %864 = bf16[3584,18944]{0,1} aten::permute(%863), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %865 = bf16[29,3584]{1,0} aten::view(%859), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %866 = bf16[29,18944]{1,0} aten::mm(%865, %864), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %867 = bf16[1,29,18944]{2,1,0} aten::view(%866), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %868 = bf16[1,29,18944]{2,1,0} aten::silu(%867), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %869 = bf16[1,29,18944]{2,1,0} aten::mul(%868, %862), scope=aten::mul.44, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %870 = bf16[29,18944]{1,0} aten::view(%869), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %871 = bf16[29,3584]{1,0} aten::mm(%870, %501), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %872 = bf16[1,29,3584]{2,1,0} aten::view(%871), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %873 = bf16[1,29,3584]{2,1,0} aten::add(%850, %872, %499), scope=aten::add.45, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %874 = f32[1,29,3584]{2,1,0} xla::cast(%873), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %875 = f32[1,29,3584]{2,1,0} aten::pow(%874, %498), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %876 = f32[1,29,1]{2,1,0} aten::mean(%875), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %877 = f32[1,29,1]{2,1,0} aten::add(%876, %497, %496), scope=aten::add.46, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %878 = f32[1,29,1]{2,1,0} aten::rsqrt(%877), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %879 = f32[1,29,3584]{2,1,0} aten::mul(%874, %878), scope=aten::mul.47, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %880 = bf16[1,29,3584]{2,1,0} xla::cast(%879), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %881 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %882 = bf16[1,29,3584]{2,1,0} aten::mul(%881, %880), scope=aten::mul.48, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %883 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %884 = bf16[29,512]{1,0} aten::mm(%883, %495), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %885 = bf16[1,29,512]{2,1,0} aten::view(%884), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %886 = bf16[1,29,512]{2,1,0} aten::add(%885, %493, %492), scope=aten::add.51, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %887 = bf16[1,29,4,128]{3,2,1,0} aten::view(%886), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %888 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%887), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %889 = bf16[1,4,29,128]{3,1,2,0} xla::select(%888), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %890 = bf16[1,4,29,128]{3,1,2,0} xla::select(%889), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %891 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%890), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %892 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%891), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %893 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %894 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %895 = bf16[1,28,29,128]{3,2,1,0} aten::view(%894), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %896 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%895), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %897 = bf16[28,29,128]{2,1,0} aten::view(%896), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %898 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %899 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %900 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %901 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %902 = s64[1,29]{1,0} aten::expand(%901), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %903 = s64[1,29]{1,0} aten::add(%628, %902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %904 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %905 = pred[1,29]{1,0} aten::lt(%628, %904), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %906 = s64[1,29]{1,0} aten::where(%905, %903, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %907 = s64[1,29,1]{2,1,0} aten::stack(%906), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %908 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %909 = bf16[29,128]{1,0} xla::select(%908), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %910 = bf16[1,29,128]{2,1,0} aten::index(%909, %907), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %911 = bf16[1,1,29,128]{3,2,1,0} aten::view(%910), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %912 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %913 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %914 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %915 = bf16[3584,512]{0,1} aten::permute(%914), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %916 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %917 = bf16[29,512]{1,0} aten::mm(%916, %915), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %918 = bf16[1,29,512]{2,1,0} aten::view(%917), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %919 = bf16[1,29,512]{2,1,0} aten::add(%918, %913, %912), scope=aten::add.50, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %920 = bf16[1,29,4,128]{3,2,1,0} aten::view(%919), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %921 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%920), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %922 = bf16[1,4,29,64]{3,1,2,0} xla::select(%921), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %923 = bf16[1,4,29,64]{3,1,2,0} xla::select(%921), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %924 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%923), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %925 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%924, %922), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %926 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%925, %911), scope=aten::mul.56, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %927 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %928 = s64[1,29]{1,0} aten::expand(%927), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %929 = s64[1,29]{1,0} aten::add(%628, %928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %930 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %931 = pred[1,29]{1,0} aten::lt(%628, %930), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %932 = s64[1,29]{1,0} aten::where(%931, %929, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %933 = s64[1,29,1]{2,1,0} aten::stack(%932), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %934 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %935 = bf16[29,128]{1,0} xla::select(%934), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %936 = bf16[1,29,128]{2,1,0} aten::index(%935, %933), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %937 = bf16[1,1,29,128]{3,2,1,0} aten::view(%936), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %938 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%921, %937), scope=aten::mul.55, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %939 = bf16[1,4,29,128]{3,2,1,0} aten::add(%938, %926, %900), scope=aten::add.57, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %940 = bf16[1,4,29,128]{3,2,1,0} xla::select(%939), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %941 = bf16[1,4,29,128]{3,2,1,0} xla::select(%940), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %942 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%941), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %943 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%942), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %944 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%943), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %945 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%944), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %946 = bf16[1,28,29,128]{3,2,1,0} aten::view(%945), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %947 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%946), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %948 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%947), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %949 = bf16[28,128,29]{2,1,0} aten::view(%948), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %950 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %951 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %952 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %953 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %954 = bf16[3584,3584]{0,1} aten::permute(%953), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %955 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %956 = bf16[29,3584]{1,0} aten::mm(%955, %954), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %957 = bf16[1,29,3584]{2,1,0} aten::view(%956), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %958 = bf16[1,29,3584]{2,1,0} aten::add(%957, %952, %951), scope=aten::add.49, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %959 = bf16[1,29,28,128]{3,2,1,0} aten::view(%958), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %960 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%959), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %961 = bf16[1,28,29,64]{3,1,2,0} xla::select(%960), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %962 = bf16[1,28,29,64]{3,1,2,0} xla::select(%960), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %963 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%962), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %964 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%963, %961), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %965 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%964, %911), scope=aten::mul.53, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %966 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%960, %937), scope=aten::mul.52, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %967 = bf16[1,28,29,128]{3,2,1,0} aten::add(%966, %965, %950), scope=aten::add.54, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %968 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%967), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %969 = bf16[28,29,128]{2,1,0} aten::view(%968), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %970 = bf16[28,29,29]{2,1,0} aten::matmul(%969, %949), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %971 = bf16[1,28,29,29]{3,2,1,0} aten::view(%970), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %972 = bf16[1,28,29,29]{3,2,1,0} aten::div(%971, %899), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %973 = bf16[1,28,29,29]{3,2,1,0} aten::add(%972, %617, %898), scope=aten::add.58, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %974 = f32[1,28,29,29]{3,2,1,0} xla::cast(%973), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %975 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%974), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %976 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%975), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %977 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%976), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %978 = bf16[28,29,29]{2,1,0} aten::view(%977), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %979 = bf16[28,29,128]{2,1,0} aten::matmul(%978, %897), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %980 = bf16[1,28,29,128]{3,2,1,0} aten::view(%979), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %981 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%980), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %982 = bf16[1,29,3584]{2,1,0} aten::view(%981), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %983 = bf16[29,3584]{1,0} aten::view(%982), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %984 = bf16[29,3584]{1,0} aten::mm(%983, %491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %985 = bf16[1,29,3584]{2,1,0} aten::view(%984), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %986 = bf16[1,29,3584]{2,1,0} aten::add(%873, %985, %489), scope=aten::add.59, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %987 = f32[1,29,3584]{2,1,0} xla::cast(%986), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %988 = f32[1,29,3584]{2,1,0} aten::pow(%987, %488), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %989 = f32[1,29,1]{2,1,0} aten::mean(%988), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %990 = f32[1,29,1]{2,1,0} aten::add(%989, %487, %486), scope=aten::add.60, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %991 = f32[1,29,1]{2,1,0} aten::rsqrt(%990), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %992 = f32[1,29,3584]{2,1,0} aten::mul(%987, %991), scope=aten::mul.61, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %993 = bf16[1,29,3584]{2,1,0} xla::cast(%992), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %994 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %995 = bf16[1,29,3584]{2,1,0} aten::mul(%994, %993), scope=aten::mul.62, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %996 = bf16[29,3584]{1,0} aten::view(%995), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %997 = bf16[29,18944]{1,0} aten::mm(%996, %485), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %998 = bf16[1,29,18944]{2,1,0} aten::view(%997), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %999 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1000 = bf16[3584,18944]{0,1} aten::permute(%999), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1001 = bf16[29,3584]{1,0} aten::view(%995), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1002 = bf16[29,18944]{1,0} aten::mm(%1001, %1000), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1003 = bf16[1,29,18944]{2,1,0} aten::view(%1002), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1004 = bf16[1,29,18944]{2,1,0} aten::silu(%1003), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1005 = bf16[1,29,18944]{2,1,0} aten::mul(%1004, %998), scope=aten::mul.63, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1006 = bf16[29,18944]{1,0} aten::view(%1005), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1007 = bf16[29,3584]{1,0} aten::mm(%1006, %483), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1008 = bf16[1,29,3584]{2,1,0} aten::view(%1007), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1009 = bf16[1,29,3584]{2,1,0} aten::add(%986, %1008, %481), scope=aten::add.64, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1010 = f32[1,29,3584]{2,1,0} xla::cast(%1009), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1011 = f32[1,29,3584]{2,1,0} aten::pow(%1010, %480), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1012 = f32[1,29,1]{2,1,0} aten::mean(%1011), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1013 = f32[1,29,1]{2,1,0} aten::add(%1012, %479, %478), scope=aten::add.65, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1014 = f32[1,29,1]{2,1,0} aten::rsqrt(%1013), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1015 = f32[1,29,3584]{2,1,0} aten::mul(%1010, %1014), scope=aten::mul.66, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1016 = bf16[1,29,3584]{2,1,0} xla::cast(%1015), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1017 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1018 = bf16[1,29,3584]{2,1,0} aten::mul(%1017, %1016), scope=aten::mul.67, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1019 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1020 = bf16[29,512]{1,0} aten::mm(%1019, %477), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1021 = bf16[1,29,512]{2,1,0} aten::view(%1020), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1022 = bf16[1,29,512]{2,1,0} aten::add(%1021, %475, %474), scope=aten::add.70, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1023 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1022), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1024 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1023), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1025 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1024), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1026 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1025), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1027 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1026), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1028 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1027), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1029 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1030 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1031 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1030), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1032 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1031), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1033 = bf16[28,29,128]{2,1,0} aten::view(%1032), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1034 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1035 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1036 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1037 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1038 = s64[1,29]{1,0} aten::expand(%1037), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1039 = s64[1,29]{1,0} aten::add(%628, %1038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1040 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1041 = pred[1,29]{1,0} aten::lt(%628, %1040), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1042 = s64[1,29]{1,0} aten::where(%1041, %1039, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1043 = s64[1,29,1]{2,1,0} aten::stack(%1042), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1044 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1045 = bf16[29,128]{1,0} xla::select(%1044), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1046 = bf16[1,29,128]{2,1,0} aten::index(%1045, %1043), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1047 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1046), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1048 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1049 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1050 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1051 = bf16[3584,512]{0,1} aten::permute(%1050), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1052 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1053 = bf16[29,512]{1,0} aten::mm(%1052, %1051), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1054 = bf16[1,29,512]{2,1,0} aten::view(%1053), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1055 = bf16[1,29,512]{2,1,0} aten::add(%1054, %1049, %1048), scope=aten::add.69, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1056 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1055), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1057 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1056), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1058 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1057), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1059 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1057), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1060 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1059), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1061 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1060, %1058), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1062 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1061, %1047), scope=aten::mul.75, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1063 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1064 = s64[1,29]{1,0} aten::expand(%1063), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1065 = s64[1,29]{1,0} aten::add(%628, %1064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1066 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1067 = pred[1,29]{1,0} aten::lt(%628, %1066), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1068 = s64[1,29]{1,0} aten::where(%1067, %1065, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1069 = s64[1,29,1]{2,1,0} aten::stack(%1068), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1070 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1071 = bf16[29,128]{1,0} xla::select(%1070), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1072 = bf16[1,29,128]{2,1,0} aten::index(%1071, %1069), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1073 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1072), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1074 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1057, %1073), scope=aten::mul.74, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1075 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1074, %1062, %1036), scope=aten::add.76, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1076 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1075), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1077 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1076), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1078 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1077), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1079 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1078), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1080 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1079), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1081 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1080), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1082 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1081), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1083 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1082), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1084 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1083), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1085 = bf16[28,128,29]{2,1,0} aten::view(%1084), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1086 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1087 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1088 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1089 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1090 = bf16[3584,3584]{0,1} aten::permute(%1089), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1091 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1092 = bf16[29,3584]{1,0} aten::mm(%1091, %1090), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1093 = bf16[1,29,3584]{2,1,0} aten::view(%1092), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1094 = bf16[1,29,3584]{2,1,0} aten::add(%1093, %1088, %1087), scope=aten::add.68, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1095 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1094), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1096 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1095), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1097 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1096), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1098 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1096), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1099 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1098), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1100 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1099, %1097), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1101 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1100, %1047), scope=aten::mul.72, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1102 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1096, %1073), scope=aten::mul.71, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1103 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1102, %1101, %1086), scope=aten::add.73, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1104 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1103), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1105 = bf16[28,29,128]{2,1,0} aten::view(%1104), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1106 = bf16[28,29,29]{2,1,0} aten::matmul(%1105, %1085), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1107 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1106), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1108 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1107, %1035), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1109 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1108, %617, %1034), scope=aten::add.77, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1110 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1109), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1111 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1110), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1112 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1111), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1113 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1112), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1114 = bf16[28,29,29]{2,1,0} aten::view(%1113), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1115 = bf16[28,29,128]{2,1,0} aten::matmul(%1114, %1033), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1116 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1115), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1117 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1116), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1118 = bf16[1,29,3584]{2,1,0} aten::view(%1117), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1119 = bf16[29,3584]{1,0} aten::view(%1118), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1120 = bf16[29,3584]{1,0} aten::mm(%1119, %473), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1121 = bf16[1,29,3584]{2,1,0} aten::view(%1120), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1122 = bf16[1,29,3584]{2,1,0} aten::add(%1009, %1121, %471), scope=aten::add.78, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1123 = f32[1,29,3584]{2,1,0} xla::cast(%1122), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1124 = f32[1,29,3584]{2,1,0} aten::pow(%1123, %470), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1125 = f32[1,29,1]{2,1,0} aten::mean(%1124), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1126 = f32[1,29,1]{2,1,0} aten::add(%1125, %469, %468), scope=aten::add.79, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1127 = f32[1,29,1]{2,1,0} aten::rsqrt(%1126), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1128 = f32[1,29,3584]{2,1,0} aten::mul(%1123, %1127), scope=aten::mul.80, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1129 = bf16[1,29,3584]{2,1,0} xla::cast(%1128), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1130 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1131 = bf16[1,29,3584]{2,1,0} aten::mul(%1130, %1129), scope=aten::mul.81, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1132 = bf16[29,3584]{1,0} aten::view(%1131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1133 = bf16[29,18944]{1,0} aten::mm(%1132, %467), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1134 = bf16[1,29,18944]{2,1,0} aten::view(%1133), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1135 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1136 = bf16[3584,18944]{0,1} aten::permute(%1135), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1137 = bf16[29,3584]{1,0} aten::view(%1131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1138 = bf16[29,18944]{1,0} aten::mm(%1137, %1136), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1139 = bf16[1,29,18944]{2,1,0} aten::view(%1138), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1140 = bf16[1,29,18944]{2,1,0} aten::silu(%1139), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1141 = bf16[1,29,18944]{2,1,0} aten::mul(%1140, %1134), scope=aten::mul.82, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1142 = bf16[29,18944]{1,0} aten::view(%1141), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1143 = bf16[29,3584]{1,0} aten::mm(%1142, %465), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1144 = bf16[1,29,3584]{2,1,0} aten::view(%1143), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1145 = bf16[1,29,3584]{2,1,0} aten::add(%1122, %1144, %463), scope=aten::add.83, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1146 = f32[1,29,3584]{2,1,0} xla::cast(%1145), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1147 = f32[1,29,3584]{2,1,0} aten::pow(%1146, %462), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1148 = f32[1,29,1]{2,1,0} aten::mean(%1147), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1149 = f32[1,29,1]{2,1,0} aten::add(%1148, %461, %460), scope=aten::add.84, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1150 = f32[1,29,1]{2,1,0} aten::rsqrt(%1149), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1151 = f32[1,29,3584]{2,1,0} aten::mul(%1146, %1150), scope=aten::mul.85, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1152 = bf16[1,29,3584]{2,1,0} xla::cast(%1151), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1153 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1154 = bf16[1,29,3584]{2,1,0} aten::mul(%1153, %1152), scope=aten::mul.86, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1155 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1156 = bf16[29,512]{1,0} aten::mm(%1155, %459), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1157 = bf16[1,29,512]{2,1,0} aten::view(%1156), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1158 = bf16[1,29,512]{2,1,0} aten::add(%1157, %457, %456), scope=aten::add.89, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1159 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1158), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1160 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1159), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1161 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1160), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1162 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1161), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1163 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1162), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1164 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1163), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1165 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1166 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1167 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1166), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1168 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1167), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1169 = bf16[28,29,128]{2,1,0} aten::view(%1168), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1170 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1171 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1172 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1173 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1174 = s64[1,29]{1,0} aten::expand(%1173), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1175 = s64[1,29]{1,0} aten::add(%628, %1174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1176 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1177 = pred[1,29]{1,0} aten::lt(%628, %1176), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1178 = s64[1,29]{1,0} aten::where(%1177, %1175, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1179 = s64[1,29,1]{2,1,0} aten::stack(%1178), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1180 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1181 = bf16[29,128]{1,0} xla::select(%1180), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1182 = bf16[1,29,128]{2,1,0} aten::index(%1181, %1179), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1183 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1182), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1184 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1185 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1186 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1187 = bf16[3584,512]{0,1} aten::permute(%1186), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1188 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1189 = bf16[29,512]{1,0} aten::mm(%1188, %1187), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1190 = bf16[1,29,512]{2,1,0} aten::view(%1189), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1191 = bf16[1,29,512]{2,1,0} aten::add(%1190, %1185, %1184), scope=aten::add.88, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1192 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1191), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1193 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1192), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1194 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1193), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1195 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1193), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1196 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1195), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1197 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1196, %1194), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1198 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1197, %1183), scope=aten::mul.94, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1199 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1200 = s64[1,29]{1,0} aten::expand(%1199), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1201 = s64[1,29]{1,0} aten::add(%628, %1200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1202 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1203 = pred[1,29]{1,0} aten::lt(%628, %1202), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1204 = s64[1,29]{1,0} aten::where(%1203, %1201, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1205 = s64[1,29,1]{2,1,0} aten::stack(%1204), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1206 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1207 = bf16[29,128]{1,0} xla::select(%1206), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1208 = bf16[1,29,128]{2,1,0} aten::index(%1207, %1205), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1209 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1208), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1210 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1193, %1209), scope=aten::mul.93, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1211 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1210, %1198, %1172), scope=aten::add.95, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1212 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1211), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1213 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1212), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1214 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1213), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1215 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1214), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1216 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1215), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1217 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1216), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1218 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1217), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1219 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1218), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1220 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1219), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1221 = bf16[28,128,29]{2,1,0} aten::view(%1220), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1222 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1223 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1224 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1225 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1226 = bf16[3584,3584]{0,1} aten::permute(%1225), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1227 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1228 = bf16[29,3584]{1,0} aten::mm(%1227, %1226), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1229 = bf16[1,29,3584]{2,1,0} aten::view(%1228), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1230 = bf16[1,29,3584]{2,1,0} aten::add(%1229, %1224, %1223), scope=aten::add.87, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1231 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1230), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1232 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1231), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1233 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1232), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1234 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1232), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1235 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1234), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1236 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1235, %1233), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1237 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1236, %1183), scope=aten::mul.91, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1238 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1232, %1209), scope=aten::mul.90, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1239 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1238, %1237, %1222), scope=aten::add.92, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1240 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1239), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1241 = bf16[28,29,128]{2,1,0} aten::view(%1240), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1242 = bf16[28,29,29]{2,1,0} aten::matmul(%1241, %1221), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1243 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1242), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1244 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1243, %1171), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1245 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1244, %617, %1170), scope=aten::add.96, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1246 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1245), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1247 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1246), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1248 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1247), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1249 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1248), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1250 = bf16[28,29,29]{2,1,0} aten::view(%1249), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1251 = bf16[28,29,128]{2,1,0} aten::matmul(%1250, %1169), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1252 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1251), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1253 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1252), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1254 = bf16[1,29,3584]{2,1,0} aten::view(%1253), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1255 = bf16[29,3584]{1,0} aten::view(%1254), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1256 = bf16[29,3584]{1,0} aten::mm(%1255, %455), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1257 = bf16[1,29,3584]{2,1,0} aten::view(%1256), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1258 = bf16[1,29,3584]{2,1,0} aten::add(%1145, %1257, %453), scope=aten::add.97, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1259 = f32[1,29,3584]{2,1,0} xla::cast(%1258), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1260 = f32[1,29,3584]{2,1,0} aten::pow(%1259, %452), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1261 = f32[1,29,1]{2,1,0} aten::mean(%1260), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1262 = f32[1,29,1]{2,1,0} aten::add(%1261, %451, %450), scope=aten::add.98, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1263 = f32[1,29,1]{2,1,0} aten::rsqrt(%1262), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1264 = f32[1,29,3584]{2,1,0} aten::mul(%1259, %1263), scope=aten::mul.99, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1265 = bf16[1,29,3584]{2,1,0} xla::cast(%1264), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1266 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1267 = bf16[1,29,3584]{2,1,0} aten::mul(%1266, %1265), scope=aten::mul.100, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1268 = bf16[29,3584]{1,0} aten::view(%1267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1269 = bf16[29,18944]{1,0} aten::mm(%1268, %449), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1270 = bf16[1,29,18944]{2,1,0} aten::view(%1269), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1271 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1272 = bf16[3584,18944]{0,1} aten::permute(%1271), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1273 = bf16[29,3584]{1,0} aten::view(%1267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1274 = bf16[29,18944]{1,0} aten::mm(%1273, %1272), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1275 = bf16[1,29,18944]{2,1,0} aten::view(%1274), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1276 = bf16[1,29,18944]{2,1,0} aten::silu(%1275), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1277 = bf16[1,29,18944]{2,1,0} aten::mul(%1276, %1270), scope=aten::mul.101, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1278 = bf16[29,18944]{1,0} aten::view(%1277), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1279 = bf16[29,3584]{1,0} aten::mm(%1278, %447), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1280 = bf16[1,29,3584]{2,1,0} aten::view(%1279), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1281 = bf16[1,29,3584]{2,1,0} aten::add(%1258, %1280, %445), scope=aten::add.102, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1282 = f32[1,29,3584]{2,1,0} xla::cast(%1281), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1283 = f32[1,29,3584]{2,1,0} aten::pow(%1282, %444), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1284 = f32[1,29,1]{2,1,0} aten::mean(%1283), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1285 = f32[1,29,1]{2,1,0} aten::add(%1284, %443, %442), scope=aten::add.103, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1286 = f32[1,29,1]{2,1,0} aten::rsqrt(%1285), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1287 = f32[1,29,3584]{2,1,0} aten::mul(%1282, %1286), scope=aten::mul.104, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1288 = bf16[1,29,3584]{2,1,0} xla::cast(%1287), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1289 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1290 = bf16[1,29,3584]{2,1,0} aten::mul(%1289, %1288), scope=aten::mul.105, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1291 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1292 = bf16[29,512]{1,0} aten::mm(%1291, %441), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1293 = bf16[1,29,512]{2,1,0} aten::view(%1292), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1294 = bf16[1,29,512]{2,1,0} aten::add(%1293, %439, %438), scope=aten::add.108, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1295 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1294), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1296 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1295), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1297 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1296), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1298 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1297), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1299 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1298), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1300 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1299), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1301 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1302 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1303 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1302), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1304 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1303), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1305 = bf16[28,29,128]{2,1,0} aten::view(%1304), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1306 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1307 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1308 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1309 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1310 = s64[1,29]{1,0} aten::expand(%1309), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1311 = s64[1,29]{1,0} aten::add(%628, %1310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1312 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1313 = pred[1,29]{1,0} aten::lt(%628, %1312), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1314 = s64[1,29]{1,0} aten::where(%1313, %1311, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1315 = s64[1,29,1]{2,1,0} aten::stack(%1314), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1316 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1317 = bf16[29,128]{1,0} xla::select(%1316), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1318 = bf16[1,29,128]{2,1,0} aten::index(%1317, %1315), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1319 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1318), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1320 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1321 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1322 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1323 = bf16[3584,512]{0,1} aten::permute(%1322), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1324 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1325 = bf16[29,512]{1,0} aten::mm(%1324, %1323), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1326 = bf16[1,29,512]{2,1,0} aten::view(%1325), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1327 = bf16[1,29,512]{2,1,0} aten::add(%1326, %1321, %1320), scope=aten::add.107, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1328 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1327), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1329 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1328), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1330 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1329), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1331 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1329), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1332 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1331), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1333 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1332, %1330), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1334 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1333, %1319), scope=aten::mul.113, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1335 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1336 = s64[1,29]{1,0} aten::expand(%1335), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1337 = s64[1,29]{1,0} aten::add(%628, %1336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1338 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1339 = pred[1,29]{1,0} aten::lt(%628, %1338), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1340 = s64[1,29]{1,0} aten::where(%1339, %1337, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1341 = s64[1,29,1]{2,1,0} aten::stack(%1340), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1342 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1343 = bf16[29,128]{1,0} xla::select(%1342), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1344 = bf16[1,29,128]{2,1,0} aten::index(%1343, %1341), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1345 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1344), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1346 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1329, %1345), scope=aten::mul.112, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1347 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1346, %1334, %1308), scope=aten::add.114, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1348 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1347), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1349 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1348), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1350 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1349), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1351 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1350), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1352 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1351), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1353 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1352), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1354 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1353), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1355 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1354), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1356 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1355), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1357 = bf16[28,128,29]{2,1,0} aten::view(%1356), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1358 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1359 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1360 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1361 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1362 = bf16[3584,3584]{0,1} aten::permute(%1361), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1363 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1364 = bf16[29,3584]{1,0} aten::mm(%1363, %1362), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1365 = bf16[1,29,3584]{2,1,0} aten::view(%1364), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1366 = bf16[1,29,3584]{2,1,0} aten::add(%1365, %1360, %1359), scope=aten::add.106, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1367 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1366), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1368 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1367), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1369 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1368), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1370 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1368), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1371 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1370), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1372 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1371, %1369), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1373 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1372, %1319), scope=aten::mul.110, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1374 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1368, %1345), scope=aten::mul.109, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1375 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1374, %1373, %1358), scope=aten::add.111, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1376 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1375), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1377 = bf16[28,29,128]{2,1,0} aten::view(%1376), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1378 = bf16[28,29,29]{2,1,0} aten::matmul(%1377, %1357), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1379 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1378), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1380 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1379, %1307), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1381 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1380, %617, %1306), scope=aten::add.115, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1382 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1381), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1383 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1382), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1384 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1383), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1385 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1384), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1386 = bf16[28,29,29]{2,1,0} aten::view(%1385), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1387 = bf16[28,29,128]{2,1,0} aten::matmul(%1386, %1305), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1388 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1387), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1389 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1388), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1390 = bf16[1,29,3584]{2,1,0} aten::view(%1389), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1391 = bf16[29,3584]{1,0} aten::view(%1390), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1392 = bf16[29,3584]{1,0} aten::mm(%1391, %437), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1393 = bf16[1,29,3584]{2,1,0} aten::view(%1392), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1394 = bf16[1,29,3584]{2,1,0} aten::add(%1281, %1393, %435), scope=aten::add.116, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1395 = f32[1,29,3584]{2,1,0} xla::cast(%1394), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1396 = f32[1,29,3584]{2,1,0} aten::pow(%1395, %434), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1397 = f32[1,29,1]{2,1,0} aten::mean(%1396), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1398 = f32[1,29,1]{2,1,0} aten::add(%1397, %433, %432), scope=aten::add.117, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1399 = f32[1,29,1]{2,1,0} aten::rsqrt(%1398), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1400 = f32[1,29,3584]{2,1,0} aten::mul(%1395, %1399), scope=aten::mul.118, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1401 = bf16[1,29,3584]{2,1,0} xla::cast(%1400), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1402 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1403 = bf16[1,29,3584]{2,1,0} aten::mul(%1402, %1401), scope=aten::mul.119, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1404 = bf16[29,3584]{1,0} aten::view(%1403), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1405 = bf16[29,18944]{1,0} aten::mm(%1404, %431), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1406 = bf16[1,29,18944]{2,1,0} aten::view(%1405), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1407 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1408 = bf16[3584,18944]{0,1} aten::permute(%1407), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1409 = bf16[29,3584]{1,0} aten::view(%1403), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1410 = bf16[29,18944]{1,0} aten::mm(%1409, %1408), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1411 = bf16[1,29,18944]{2,1,0} aten::view(%1410), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1412 = bf16[1,29,18944]{2,1,0} aten::silu(%1411), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1413 = bf16[1,29,18944]{2,1,0} aten::mul(%1412, %1406), scope=aten::mul.120, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1414 = bf16[29,18944]{1,0} aten::view(%1413), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1415 = bf16[29,3584]{1,0} aten::mm(%1414, %429), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1416 = bf16[1,29,3584]{2,1,0} aten::view(%1415), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1417 = bf16[1,29,3584]{2,1,0} aten::add(%1394, %1416, %427), scope=aten::add.121, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1418 = f32[1,29,3584]{2,1,0} xla::cast(%1417), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1419 = f32[1,29,3584]{2,1,0} aten::pow(%1418, %426), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1420 = f32[1,29,1]{2,1,0} aten::mean(%1419), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1421 = f32[1,29,1]{2,1,0} aten::add(%1420, %425, %424), scope=aten::add.122, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1422 = f32[1,29,1]{2,1,0} aten::rsqrt(%1421), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1423 = f32[1,29,3584]{2,1,0} aten::mul(%1418, %1422), scope=aten::mul.123, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1424 = bf16[1,29,3584]{2,1,0} xla::cast(%1423), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1425 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1426 = bf16[1,29,3584]{2,1,0} aten::mul(%1425, %1424), scope=aten::mul.124, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1427 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1428 = bf16[29,512]{1,0} aten::mm(%1427, %423), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1429 = bf16[1,29,512]{2,1,0} aten::view(%1428), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1430 = bf16[1,29,512]{2,1,0} aten::add(%1429, %421, %420), scope=aten::add.127, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1431 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1430), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1432 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1431), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1433 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1432), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1434 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1433), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1435 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1434), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1436 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1435), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1437 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1438 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1439 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1438), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1440 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1439), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1441 = bf16[28,29,128]{2,1,0} aten::view(%1440), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1442 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1443 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1444 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1445 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1446 = s64[1,29]{1,0} aten::expand(%1445), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1447 = s64[1,29]{1,0} aten::add(%628, %1446), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1448 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1449 = pred[1,29]{1,0} aten::lt(%628, %1448), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1450 = s64[1,29]{1,0} aten::where(%1449, %1447, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1451 = s64[1,29,1]{2,1,0} aten::stack(%1450), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1452 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1453 = bf16[29,128]{1,0} xla::select(%1452), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1454 = bf16[1,29,128]{2,1,0} aten::index(%1453, %1451), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1455 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1454), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1456 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1457 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1458 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1459 = bf16[3584,512]{0,1} aten::permute(%1458), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1460 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1461 = bf16[29,512]{1,0} aten::mm(%1460, %1459), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1462 = bf16[1,29,512]{2,1,0} aten::view(%1461), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1463 = bf16[1,29,512]{2,1,0} aten::add(%1462, %1457, %1456), scope=aten::add.126, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1464 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1463), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1465 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1464), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1466 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1465), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1467 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1465), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1468 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1467), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1469 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1468, %1466), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1470 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1469, %1455), scope=aten::mul.132, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1471 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1472 = s64[1,29]{1,0} aten::expand(%1471), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1473 = s64[1,29]{1,0} aten::add(%628, %1472), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1474 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1475 = pred[1,29]{1,0} aten::lt(%628, %1474), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1476 = s64[1,29]{1,0} aten::where(%1475, %1473, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1477 = s64[1,29,1]{2,1,0} aten::stack(%1476), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1478 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1479 = bf16[29,128]{1,0} xla::select(%1478), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1480 = bf16[1,29,128]{2,1,0} aten::index(%1479, %1477), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1481 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1480), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1482 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1465, %1481), scope=aten::mul.131, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1483 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1482, %1470, %1444), scope=aten::add.133, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1484 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1483), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1485 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1484), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1486 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1485), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1487 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1486), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1488 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1487), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1489 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1488), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1490 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1489), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1491 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1490), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1492 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1491), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1493 = bf16[28,128,29]{2,1,0} aten::view(%1492), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1494 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1495 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1496 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1497 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1498 = bf16[3584,3584]{0,1} aten::permute(%1497), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1499 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1500 = bf16[29,3584]{1,0} aten::mm(%1499, %1498), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1501 = bf16[1,29,3584]{2,1,0} aten::view(%1500), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1502 = bf16[1,29,3584]{2,1,0} aten::add(%1501, %1496, %1495), scope=aten::add.125, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1503 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1502), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1504 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1503), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1505 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1504), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1506 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1504), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1507 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1506), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1508 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1507, %1505), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1509 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1508, %1455), scope=aten::mul.129, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1510 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1504, %1481), scope=aten::mul.128, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1511 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1510, %1509, %1494), scope=aten::add.130, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1512 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1511), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1513 = bf16[28,29,128]{2,1,0} aten::view(%1512), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1514 = bf16[28,29,29]{2,1,0} aten::matmul(%1513, %1493), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1515 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1514), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1516 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1515, %1443), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1517 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1516, %617, %1442), scope=aten::add.134, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1518 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1517), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1519 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1518), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1520 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1519), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1521 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1520), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1522 = bf16[28,29,29]{2,1,0} aten::view(%1521), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1523 = bf16[28,29,128]{2,1,0} aten::matmul(%1522, %1441), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1524 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1523), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1525 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1524), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1526 = bf16[1,29,3584]{2,1,0} aten::view(%1525), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1527 = bf16[29,3584]{1,0} aten::view(%1526), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1528 = bf16[29,3584]{1,0} aten::mm(%1527, %419), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1529 = bf16[1,29,3584]{2,1,0} aten::view(%1528), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1530 = bf16[1,29,3584]{2,1,0} aten::add(%1417, %1529, %417), scope=aten::add.135, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1531 = f32[1,29,3584]{2,1,0} xla::cast(%1530), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1532 = f32[1,29,3584]{2,1,0} aten::pow(%1531, %416), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1533 = f32[1,29,1]{2,1,0} aten::mean(%1532), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1534 = f32[1,29,1]{2,1,0} aten::add(%1533, %415, %414), scope=aten::add.136, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1535 = f32[1,29,1]{2,1,0} aten::rsqrt(%1534), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1536 = f32[1,29,3584]{2,1,0} aten::mul(%1531, %1535), scope=aten::mul.137, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1537 = bf16[1,29,3584]{2,1,0} xla::cast(%1536), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1538 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1539 = bf16[1,29,3584]{2,1,0} aten::mul(%1538, %1537), scope=aten::mul.138, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1540 = bf16[29,3584]{1,0} aten::view(%1539), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1541 = bf16[29,18944]{1,0} aten::mm(%1540, %413), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1542 = bf16[1,29,18944]{2,1,0} aten::view(%1541), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1543 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1544 = bf16[3584,18944]{0,1} aten::permute(%1543), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1545 = bf16[29,3584]{1,0} aten::view(%1539), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1546 = bf16[29,18944]{1,0} aten::mm(%1545, %1544), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1547 = bf16[1,29,18944]{2,1,0} aten::view(%1546), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1548 = bf16[1,29,18944]{2,1,0} aten::silu(%1547), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1549 = bf16[1,29,18944]{2,1,0} aten::mul(%1548, %1542), scope=aten::mul.139, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1550 = bf16[29,18944]{1,0} aten::view(%1549), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1551 = bf16[29,3584]{1,0} aten::mm(%1550, %411), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1552 = bf16[1,29,3584]{2,1,0} aten::view(%1551), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1553 = bf16[1,29,3584]{2,1,0} aten::add(%1530, %1552, %409), scope=aten::add.140, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1554 = f32[1,29,3584]{2,1,0} xla::cast(%1553), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1555 = f32[1,29,3584]{2,1,0} aten::pow(%1554, %408), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1556 = f32[1,29,1]{2,1,0} aten::mean(%1555), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1557 = f32[1,29,1]{2,1,0} aten::add(%1556, %407, %406), scope=aten::add.141, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1558 = f32[1,29,1]{2,1,0} aten::rsqrt(%1557), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1559 = f32[1,29,3584]{2,1,0} aten::mul(%1554, %1558), scope=aten::mul.142, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1560 = bf16[1,29,3584]{2,1,0} xla::cast(%1559), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1561 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1562 = bf16[1,29,3584]{2,1,0} aten::mul(%1561, %1560), scope=aten::mul.143, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1563 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1564 = bf16[29,512]{1,0} aten::mm(%1563, %405), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1565 = bf16[1,29,512]{2,1,0} aten::view(%1564), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1566 = bf16[1,29,512]{2,1,0} aten::add(%1565, %403, %402), scope=aten::add.146, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1567 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1566), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1568 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1567), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1569 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1568), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1570 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1569), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1571 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1570), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1572 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1571), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1573 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1574 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1575 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1574), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1576 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1575), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1577 = bf16[28,29,128]{2,1,0} aten::view(%1576), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1578 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1579 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1580 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1581 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1582 = s64[1,29]{1,0} aten::expand(%1581), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1583 = s64[1,29]{1,0} aten::add(%628, %1582), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1584 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1585 = pred[1,29]{1,0} aten::lt(%628, %1584), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1586 = s64[1,29]{1,0} aten::where(%1585, %1583, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1587 = s64[1,29,1]{2,1,0} aten::stack(%1586), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1588 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1589 = bf16[29,128]{1,0} xla::select(%1588), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1590 = bf16[1,29,128]{2,1,0} aten::index(%1589, %1587), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1591 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1590), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1592 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1593 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1594 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1595 = bf16[3584,512]{0,1} aten::permute(%1594), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1596 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1597 = bf16[29,512]{1,0} aten::mm(%1596, %1595), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1598 = bf16[1,29,512]{2,1,0} aten::view(%1597), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1599 = bf16[1,29,512]{2,1,0} aten::add(%1598, %1593, %1592), scope=aten::add.145, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1600 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1599), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1601 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1600), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1602 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1601), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1603 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1601), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1604 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1603), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1605 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1604, %1602), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1606 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1605, %1591), scope=aten::mul.151, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1607 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1608 = s64[1,29]{1,0} aten::expand(%1607), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1609 = s64[1,29]{1,0} aten::add(%628, %1608), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1610 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1611 = pred[1,29]{1,0} aten::lt(%628, %1610), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1612 = s64[1,29]{1,0} aten::where(%1611, %1609, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1613 = s64[1,29,1]{2,1,0} aten::stack(%1612), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1614 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1615 = bf16[29,128]{1,0} xla::select(%1614), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1616 = bf16[1,29,128]{2,1,0} aten::index(%1615, %1613), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1617 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1616), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1618 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1601, %1617), scope=aten::mul.150, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1619 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1618, %1606, %1580), scope=aten::add.152, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1620 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1619), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1621 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1620), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1622 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1621), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1623 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1622), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1624 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1623), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1625 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1624), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1626 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1625), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1627 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1626), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1628 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1627), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1629 = bf16[28,128,29]{2,1,0} aten::view(%1628), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1630 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1631 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1632 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1633 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1634 = bf16[3584,3584]{0,1} aten::permute(%1633), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1635 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1636 = bf16[29,3584]{1,0} aten::mm(%1635, %1634), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1637 = bf16[1,29,3584]{2,1,0} aten::view(%1636), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1638 = bf16[1,29,3584]{2,1,0} aten::add(%1637, %1632, %1631), scope=aten::add.144, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1639 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1638), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1640 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1639), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1641 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1640), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1642 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1640), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1643 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1642), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1644 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1643, %1641), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1645 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1644, %1591), scope=aten::mul.148, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1646 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1640, %1617), scope=aten::mul.147, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1647 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1646, %1645, %1630), scope=aten::add.149, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1648 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1647), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1649 = bf16[28,29,128]{2,1,0} aten::view(%1648), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1650 = bf16[28,29,29]{2,1,0} aten::matmul(%1649, %1629), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1651 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1650), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1652 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1651, %1579), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1653 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1652, %617, %1578), scope=aten::add.153, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1654 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1653), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1655 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1654), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1656 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1655), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1657 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1656), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1658 = bf16[28,29,29]{2,1,0} aten::view(%1657), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1659 = bf16[28,29,128]{2,1,0} aten::matmul(%1658, %1577), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1660 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1659), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1661 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1660), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1662 = bf16[1,29,3584]{2,1,0} aten::view(%1661), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1663 = bf16[29,3584]{1,0} aten::view(%1662), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1664 = bf16[29,3584]{1,0} aten::mm(%1663, %401), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1665 = bf16[1,29,3584]{2,1,0} aten::view(%1664), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1666 = bf16[1,29,3584]{2,1,0} aten::add(%1553, %1665, %399), scope=aten::add.154, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1667 = f32[1,29,3584]{2,1,0} xla::cast(%1666), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1668 = f32[1,29,3584]{2,1,0} aten::pow(%1667, %398), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1669 = f32[1,29,1]{2,1,0} aten::mean(%1668), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1670 = f32[1,29,1]{2,1,0} aten::add(%1669, %397, %396), scope=aten::add.155, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1671 = f32[1,29,1]{2,1,0} aten::rsqrt(%1670), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1672 = f32[1,29,3584]{2,1,0} aten::mul(%1667, %1671), scope=aten::mul.156, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1673 = bf16[1,29,3584]{2,1,0} xla::cast(%1672), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1674 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1675 = bf16[1,29,3584]{2,1,0} aten::mul(%1674, %1673), scope=aten::mul.157, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1676 = bf16[29,3584]{1,0} aten::view(%1675), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1677 = bf16[29,18944]{1,0} aten::mm(%1676, %395), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1678 = bf16[1,29,18944]{2,1,0} aten::view(%1677), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1679 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1680 = bf16[3584,18944]{0,1} aten::permute(%1679), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1681 = bf16[29,3584]{1,0} aten::view(%1675), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1682 = bf16[29,18944]{1,0} aten::mm(%1681, %1680), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1683 = bf16[1,29,18944]{2,1,0} aten::view(%1682), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1684 = bf16[1,29,18944]{2,1,0} aten::silu(%1683), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1685 = bf16[1,29,18944]{2,1,0} aten::mul(%1684, %1678), scope=aten::mul.158, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1686 = bf16[29,18944]{1,0} aten::view(%1685), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1687 = bf16[29,3584]{1,0} aten::mm(%1686, %393), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1688 = bf16[1,29,3584]{2,1,0} aten::view(%1687), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1689 = bf16[1,29,3584]{2,1,0} aten::add(%1666, %1688, %391), scope=aten::add.159, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1690 = f32[1,29,3584]{2,1,0} xla::cast(%1689), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1691 = f32[1,29,3584]{2,1,0} aten::pow(%1690, %390), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1692 = f32[1,29,1]{2,1,0} aten::mean(%1691), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1693 = f32[1,29,1]{2,1,0} aten::add(%1692, %389, %388), scope=aten::add.160, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1694 = f32[1,29,1]{2,1,0} aten::rsqrt(%1693), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1695 = f32[1,29,3584]{2,1,0} aten::mul(%1690, %1694), scope=aten::mul.161, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1696 = bf16[1,29,3584]{2,1,0} xla::cast(%1695), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1697 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1698 = bf16[1,29,3584]{2,1,0} aten::mul(%1697, %1696), scope=aten::mul.162, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1699 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1700 = bf16[29,512]{1,0} aten::mm(%1699, %387), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1701 = bf16[1,29,512]{2,1,0} aten::view(%1700), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1702 = bf16[1,29,512]{2,1,0} aten::add(%1701, %385, %384), scope=aten::add.165, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1703 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1702), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1704 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1703), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1705 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1704), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1706 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1705), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1707 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1706), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1708 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1707), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1709 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1710 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1711 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1710), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1712 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1711), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1713 = bf16[28,29,128]{2,1,0} aten::view(%1712), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1714 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1715 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1716 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1717 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1718 = s64[1,29]{1,0} aten::expand(%1717), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1719 = s64[1,29]{1,0} aten::add(%628, %1718), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1720 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1721 = pred[1,29]{1,0} aten::lt(%628, %1720), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1722 = s64[1,29]{1,0} aten::where(%1721, %1719, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1723 = s64[1,29,1]{2,1,0} aten::stack(%1722), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1724 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1725 = bf16[29,128]{1,0} xla::select(%1724), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1726 = bf16[1,29,128]{2,1,0} aten::index(%1725, %1723), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1727 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1726), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1728 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1729 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1730 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1731 = bf16[3584,512]{0,1} aten::permute(%1730), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1732 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1733 = bf16[29,512]{1,0} aten::mm(%1732, %1731), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1734 = bf16[1,29,512]{2,1,0} aten::view(%1733), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1735 = bf16[1,29,512]{2,1,0} aten::add(%1734, %1729, %1728), scope=aten::add.164, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1736 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1735), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1737 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1736), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1738 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1737), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1739 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1737), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1740 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1739), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1741 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1740, %1738), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1742 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1741, %1727), scope=aten::mul.170, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1743 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1744 = s64[1,29]{1,0} aten::expand(%1743), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1745 = s64[1,29]{1,0} aten::add(%628, %1744), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1746 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1747 = pred[1,29]{1,0} aten::lt(%628, %1746), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1748 = s64[1,29]{1,0} aten::where(%1747, %1745, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1749 = s64[1,29,1]{2,1,0} aten::stack(%1748), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1750 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1751 = bf16[29,128]{1,0} xla::select(%1750), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1752 = bf16[1,29,128]{2,1,0} aten::index(%1751, %1749), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1753 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1752), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1754 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1737, %1753), scope=aten::mul.169, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1755 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1754, %1742, %1716), scope=aten::add.171, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1756 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1755), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1757 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1758 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1759 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1758), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1760 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1759), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1761 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1760), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1762 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1761), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1763 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1762), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1764 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1763), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1765 = bf16[28,128,29]{2,1,0} aten::view(%1764), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1766 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1767 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1768 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1769 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1770 = bf16[3584,3584]{0,1} aten::permute(%1769), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1771 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1772 = bf16[29,3584]{1,0} aten::mm(%1771, %1770), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1773 = bf16[1,29,3584]{2,1,0} aten::view(%1772), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1774 = bf16[1,29,3584]{2,1,0} aten::add(%1773, %1768, %1767), scope=aten::add.163, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1775 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1774), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1776 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1775), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1777 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1776), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1778 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1776), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1779 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1778), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1780 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1779, %1777), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1781 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1780, %1727), scope=aten::mul.167, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1782 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1776, %1753), scope=aten::mul.166, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1783 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1782, %1781, %1766), scope=aten::add.168, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1784 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1783), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1785 = bf16[28,29,128]{2,1,0} aten::view(%1784), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1786 = bf16[28,29,29]{2,1,0} aten::matmul(%1785, %1765), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1787 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1786), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1788 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1787, %1715), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1789 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1788, %617, %1714), scope=aten::add.172, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1790 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1789), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1791 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1790), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1792 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1791), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1793 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1792), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1794 = bf16[28,29,29]{2,1,0} aten::view(%1793), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1795 = bf16[28,29,128]{2,1,0} aten::matmul(%1794, %1713), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1796 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1795), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1797 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1796), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1798 = bf16[1,29,3584]{2,1,0} aten::view(%1797), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1799 = bf16[29,3584]{1,0} aten::view(%1798), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1800 = bf16[29,3584]{1,0} aten::mm(%1799, %383), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1801 = bf16[1,29,3584]{2,1,0} aten::view(%1800), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1802 = bf16[1,29,3584]{2,1,0} aten::add(%1689, %1801, %381), scope=aten::add.173, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1803 = f32[1,29,3584]{2,1,0} xla::cast(%1802), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1804 = f32[1,29,3584]{2,1,0} aten::pow(%1803, %380), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1805 = f32[1,29,1]{2,1,0} aten::mean(%1804), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1806 = f32[1,29,1]{2,1,0} aten::add(%1805, %379, %378), scope=aten::add.174, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1807 = f32[1,29,1]{2,1,0} aten::rsqrt(%1806), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1808 = f32[1,29,3584]{2,1,0} aten::mul(%1803, %1807), scope=aten::mul.175, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1809 = bf16[1,29,3584]{2,1,0} xla::cast(%1808), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1810 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1811 = bf16[1,29,3584]{2,1,0} aten::mul(%1810, %1809), scope=aten::mul.176, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1812 = bf16[29,3584]{1,0} aten::view(%1811), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1813 = bf16[29,18944]{1,0} aten::mm(%1812, %377), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1814 = bf16[1,29,18944]{2,1,0} aten::view(%1813), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1815 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1816 = bf16[3584,18944]{0,1} aten::permute(%1815), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1817 = bf16[29,3584]{1,0} aten::view(%1811), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1818 = bf16[29,18944]{1,0} aten::mm(%1817, %1816), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1819 = bf16[1,29,18944]{2,1,0} aten::view(%1818), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1820 = bf16[1,29,18944]{2,1,0} aten::silu(%1819), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1821 = bf16[1,29,18944]{2,1,0} aten::mul(%1820, %1814), scope=aten::mul.177, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1822 = bf16[29,18944]{1,0} aten::view(%1821), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1823 = bf16[29,3584]{1,0} aten::mm(%1822, %375), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1824 = bf16[1,29,3584]{2,1,0} aten::view(%1823), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1825 = bf16[1,29,3584]{2,1,0} aten::add(%1802, %1824, %373), scope=aten::add.178, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1826 = f32[1,29,3584]{2,1,0} xla::cast(%1825), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1827 = f32[1,29,3584]{2,1,0} aten::pow(%1826, %372), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1828 = f32[1,29,1]{2,1,0} aten::mean(%1827), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1829 = f32[1,29,1]{2,1,0} aten::add(%1828, %371, %370), scope=aten::add.179, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1830 = f32[1,29,1]{2,1,0} aten::rsqrt(%1829), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1831 = f32[1,29,3584]{2,1,0} aten::mul(%1826, %1830), scope=aten::mul.180, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1832 = bf16[1,29,3584]{2,1,0} xla::cast(%1831), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1833 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1834 = bf16[1,29,3584]{2,1,0} aten::mul(%1833, %1832), scope=aten::mul.181, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1835 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1836 = bf16[29,512]{1,0} aten::mm(%1835, %369), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1837 = bf16[1,29,512]{2,1,0} aten::view(%1836), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1838 = bf16[1,29,512]{2,1,0} aten::add(%1837, %367, %366), scope=aten::add.184, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1839 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1838), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1840 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1839), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1841 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1840), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1842 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1841), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1843 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1842), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1844 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1843), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1845 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1846 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1847 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1846), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1848 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1847), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1849 = bf16[28,29,128]{2,1,0} aten::view(%1848), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1850 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1851 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1852 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1853 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1854 = s64[1,29]{1,0} aten::expand(%1853), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1855 = s64[1,29]{1,0} aten::add(%628, %1854), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1856 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1857 = pred[1,29]{1,0} aten::lt(%628, %1856), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1858 = s64[1,29]{1,0} aten::where(%1857, %1855, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1859 = s64[1,29,1]{2,1,0} aten::stack(%1858), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1860 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1861 = bf16[29,128]{1,0} xla::select(%1860), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1862 = bf16[1,29,128]{2,1,0} aten::index(%1861, %1859), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1863 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1862), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1864 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1865 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1866 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1867 = bf16[3584,512]{0,1} aten::permute(%1866), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1868 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1869 = bf16[29,512]{1,0} aten::mm(%1868, %1867), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1870 = bf16[1,29,512]{2,1,0} aten::view(%1869), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1871 = bf16[1,29,512]{2,1,0} aten::add(%1870, %1865, %1864), scope=aten::add.183, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1872 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1871), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1873 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1872), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1874 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1873), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1875 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1873), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1876 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1875), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1877 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1876, %1874), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1878 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1877, %1863), scope=aten::mul.189, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1879 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1880 = s64[1,29]{1,0} aten::expand(%1879), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1881 = s64[1,29]{1,0} aten::add(%628, %1880), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1882 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1883 = pred[1,29]{1,0} aten::lt(%628, %1882), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1884 = s64[1,29]{1,0} aten::where(%1883, %1881, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1885 = s64[1,29,1]{2,1,0} aten::stack(%1884), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1886 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1887 = bf16[29,128]{1,0} xla::select(%1886), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1888 = bf16[1,29,128]{2,1,0} aten::index(%1887, %1885), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1889 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1888), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1890 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1873, %1889), scope=aten::mul.188, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1891 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1890, %1878, %1852), scope=aten::add.190, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1892 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1891), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1893 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1894 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1895 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1894), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1896 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1895), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1897 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1896), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1898 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1897), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1899 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1898), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1900 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1899), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1901 = bf16[28,128,29]{2,1,0} aten::view(%1900), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1902 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1903 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1904 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1905 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1906 = bf16[3584,3584]{0,1} aten::permute(%1905), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1907 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1908 = bf16[29,3584]{1,0} aten::mm(%1907, %1906), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1909 = bf16[1,29,3584]{2,1,0} aten::view(%1908), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1910 = bf16[1,29,3584]{2,1,0} aten::add(%1909, %1904, %1903), scope=aten::add.182, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1911 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1910), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1912 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1911), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1913 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1912), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1914 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1912), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1915 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1914), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1916 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1915, %1913), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1917 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1916, %1863), scope=aten::mul.186, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1918 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1912, %1889), scope=aten::mul.185, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1919 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1918, %1917, %1902), scope=aten::add.187, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1920 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1919), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1921 = bf16[28,29,128]{2,1,0} aten::view(%1920), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1922 = bf16[28,29,29]{2,1,0} aten::matmul(%1921, %1901), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1923 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1922), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1924 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1923, %1851), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1925 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1924, %617, %1850), scope=aten::add.191, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1926 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1925), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1927 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1926), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1928 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1927), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1929 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1928), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1930 = bf16[28,29,29]{2,1,0} aten::view(%1929), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1931 = bf16[28,29,128]{2,1,0} aten::matmul(%1930, %1849), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1932 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1931), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1933 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1932), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1934 = bf16[1,29,3584]{2,1,0} aten::view(%1933), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1935 = bf16[29,3584]{1,0} aten::view(%1934), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1936 = bf16[29,3584]{1,0} aten::mm(%1935, %365), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1937 = bf16[1,29,3584]{2,1,0} aten::view(%1936), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1938 = bf16[1,29,3584]{2,1,0} aten::add(%1825, %1937, %363), scope=aten::add.192, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1939 = f32[1,29,3584]{2,1,0} xla::cast(%1938), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1940 = f32[1,29,3584]{2,1,0} aten::pow(%1939, %362), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1941 = f32[1,29,1]{2,1,0} aten::mean(%1940), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1942 = f32[1,29,1]{2,1,0} aten::add(%1941, %361, %360), scope=aten::add.193, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1943 = f32[1,29,1]{2,1,0} aten::rsqrt(%1942), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1944 = f32[1,29,3584]{2,1,0} aten::mul(%1939, %1943), scope=aten::mul.194, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1945 = bf16[1,29,3584]{2,1,0} xla::cast(%1944), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1946 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1947 = bf16[1,29,3584]{2,1,0} aten::mul(%1946, %1945), scope=aten::mul.195, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1948 = bf16[29,3584]{1,0} aten::view(%1947), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1949 = bf16[29,18944]{1,0} aten::mm(%1948, %359), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1950 = bf16[1,29,18944]{2,1,0} aten::view(%1949), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1951 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1952 = bf16[3584,18944]{0,1} aten::permute(%1951), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1953 = bf16[29,3584]{1,0} aten::view(%1947), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1954 = bf16[29,18944]{1,0} aten::mm(%1953, %1952), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1955 = bf16[1,29,18944]{2,1,0} aten::view(%1954), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1956 = bf16[1,29,18944]{2,1,0} aten::silu(%1955), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1957 = bf16[1,29,18944]{2,1,0} aten::mul(%1956, %1950), scope=aten::mul.196, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1958 = bf16[29,18944]{1,0} aten::view(%1957), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1959 = bf16[29,3584]{1,0} aten::mm(%1958, %357), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1960 = bf16[1,29,3584]{2,1,0} aten::view(%1959), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1961 = bf16[1,29,3584]{2,1,0} aten::add(%1938, %1960, %355), scope=aten::add.197, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1962 = f32[1,29,3584]{2,1,0} xla::cast(%1961), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1963 = f32[1,29,3584]{2,1,0} aten::pow(%1962, %354), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1964 = f32[1,29,1]{2,1,0} aten::mean(%1963), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1965 = f32[1,29,1]{2,1,0} aten::add(%1964, %353, %352), scope=aten::add.198, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1966 = f32[1,29,1]{2,1,0} aten::rsqrt(%1965), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1967 = f32[1,29,3584]{2,1,0} aten::mul(%1962, %1966), scope=aten::mul.199, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1968 = bf16[1,29,3584]{2,1,0} xla::cast(%1967), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1969 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1970 = bf16[1,29,3584]{2,1,0} aten::mul(%1969, %1968), scope=aten::mul.200, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1971 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1972 = bf16[29,512]{1,0} aten::mm(%1971, %351), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1973 = bf16[1,29,512]{2,1,0} aten::view(%1972), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1974 = bf16[1,29,512]{2,1,0} aten::add(%1973, %349, %348), scope=aten::add.203, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1975 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1974), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1976 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1975), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1977 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1976), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1978 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1977), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1979 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1978), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1980 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1979), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1981 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1982 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1983 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1982), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1984 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1983), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1985 = bf16[28,29,128]{2,1,0} aten::view(%1984), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1986 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1987 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1988 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1989 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1990 = s64[1,29]{1,0} aten::expand(%1989), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1991 = s64[1,29]{1,0} aten::add(%628, %1990), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1992 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1993 = pred[1,29]{1,0} aten::lt(%628, %1992), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1994 = s64[1,29]{1,0} aten::where(%1993, %1991, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1995 = s64[1,29,1]{2,1,0} aten::stack(%1994), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1996 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1997 = bf16[29,128]{1,0} xla::select(%1996), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1998 = bf16[1,29,128]{2,1,0} aten::index(%1997, %1995), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1999 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1998), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2000 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2001 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2002 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2003 = bf16[3584,512]{0,1} aten::permute(%2002), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2004 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2005 = bf16[29,512]{1,0} aten::mm(%2004, %2003), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2006 = bf16[1,29,512]{2,1,0} aten::view(%2005), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2007 = bf16[1,29,512]{2,1,0} aten::add(%2006, %2001, %2000), scope=aten::add.202, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2008 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2007), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2009 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2008), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2010 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2009), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2011 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2009), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2012 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2011), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2013 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2012, %2010), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2014 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2013, %1999), scope=aten::mul.208, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2015 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2016 = s64[1,29]{1,0} aten::expand(%2015), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2017 = s64[1,29]{1,0} aten::add(%628, %2016), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2018 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2019 = pred[1,29]{1,0} aten::lt(%628, %2018), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2020 = s64[1,29]{1,0} aten::where(%2019, %2017, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2021 = s64[1,29,1]{2,1,0} aten::stack(%2020), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2022 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2023 = bf16[29,128]{1,0} xla::select(%2022), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2024 = bf16[1,29,128]{2,1,0} aten::index(%2023, %2021), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2025 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2024), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2026 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2009, %2025), scope=aten::mul.207, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2027 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2026, %2014, %1988), scope=aten::add.209, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2028 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2027), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2029 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2030 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2031 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2030), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2032 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2031), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2033 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2032), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2034 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2033), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2035 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2034), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2036 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2035), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2037 = bf16[28,128,29]{2,1,0} aten::view(%2036), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2038 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2039 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2040 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2041 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2042 = bf16[3584,3584]{0,1} aten::permute(%2041), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2043 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2044 = bf16[29,3584]{1,0} aten::mm(%2043, %2042), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2045 = bf16[1,29,3584]{2,1,0} aten::view(%2044), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2046 = bf16[1,29,3584]{2,1,0} aten::add(%2045, %2040, %2039), scope=aten::add.201, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2047 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2046), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2048 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2047), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2049 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2048), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2050 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2048), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2051 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2050), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2052 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2051, %2049), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2053 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2052, %1999), scope=aten::mul.205, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2054 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2048, %2025), scope=aten::mul.204, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2055 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2054, %2053, %2038), scope=aten::add.206, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2056 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2055), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2057 = bf16[28,29,128]{2,1,0} aten::view(%2056), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2058 = bf16[28,29,29]{2,1,0} aten::matmul(%2057, %2037), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2059 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2058), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2060 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2059, %1987), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2061 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2060, %617, %1986), scope=aten::add.210, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2062 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2061), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2063 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2062), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2064 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2063), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2065 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2064), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2066 = bf16[28,29,29]{2,1,0} aten::view(%2065), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2067 = bf16[28,29,128]{2,1,0} aten::matmul(%2066, %1985), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2068 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2067), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2069 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2068), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2070 = bf16[1,29,3584]{2,1,0} aten::view(%2069), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2071 = bf16[29,3584]{1,0} aten::view(%2070), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2072 = bf16[29,3584]{1,0} aten::mm(%2071, %347), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2073 = bf16[1,29,3584]{2,1,0} aten::view(%2072), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2074 = bf16[1,29,3584]{2,1,0} aten::add(%1961, %2073, %345), scope=aten::add.211, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2075 = f32[1,29,3584]{2,1,0} xla::cast(%2074), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2076 = f32[1,29,3584]{2,1,0} aten::pow(%2075, %344), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2077 = f32[1,29,1]{2,1,0} aten::mean(%2076), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2078 = f32[1,29,1]{2,1,0} aten::add(%2077, %343, %342), scope=aten::add.212, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2079 = f32[1,29,1]{2,1,0} aten::rsqrt(%2078), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2080 = f32[1,29,3584]{2,1,0} aten::mul(%2075, %2079), scope=aten::mul.213, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2081 = bf16[1,29,3584]{2,1,0} xla::cast(%2080), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2082 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2083 = bf16[1,29,3584]{2,1,0} aten::mul(%2082, %2081), scope=aten::mul.214, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2084 = bf16[29,3584]{1,0} aten::view(%2083), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2085 = bf16[29,18944]{1,0} aten::mm(%2084, %341), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2086 = bf16[1,29,18944]{2,1,0} aten::view(%2085), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2087 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2088 = bf16[3584,18944]{0,1} aten::permute(%2087), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2089 = bf16[29,3584]{1,0} aten::view(%2083), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2090 = bf16[29,18944]{1,0} aten::mm(%2089, %2088), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2091 = bf16[1,29,18944]{2,1,0} aten::view(%2090), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2092 = bf16[1,29,18944]{2,1,0} aten::silu(%2091), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2093 = bf16[1,29,18944]{2,1,0} aten::mul(%2092, %2086), scope=aten::mul.215, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2094 = bf16[29,18944]{1,0} aten::view(%2093), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2095 = bf16[29,3584]{1,0} aten::mm(%2094, %339), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2096 = bf16[1,29,3584]{2,1,0} aten::view(%2095), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2097 = bf16[1,29,3584]{2,1,0} aten::add(%2074, %2096, %337), scope=aten::add.216, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2098 = f32[1,29,3584]{2,1,0} xla::cast(%2097), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2099 = f32[1,29,3584]{2,1,0} aten::pow(%2098, %336), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2100 = f32[1,29,1]{2,1,0} aten::mean(%2099), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2101 = f32[1,29,1]{2,1,0} aten::add(%2100, %335, %334), scope=aten::add.217, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2102 = f32[1,29,1]{2,1,0} aten::rsqrt(%2101), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2103 = f32[1,29,3584]{2,1,0} aten::mul(%2098, %2102), scope=aten::mul.218, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2104 = bf16[1,29,3584]{2,1,0} xla::cast(%2103), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2105 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2106 = bf16[1,29,3584]{2,1,0} aten::mul(%2105, %2104), scope=aten::mul.219, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2107 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2108 = bf16[29,512]{1,0} aten::mm(%2107, %333), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2109 = bf16[1,29,512]{2,1,0} aten::view(%2108), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2110 = bf16[1,29,512]{2,1,0} aten::add(%2109, %331, %330), scope=aten::add.222, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2111 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2110), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2112 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2111), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2113 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2112), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2114 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2113), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2115 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2114), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2116 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2115), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2117 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2118 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2119 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2118), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2120 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2119), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2121 = bf16[28,29,128]{2,1,0} aten::view(%2120), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2122 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2123 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2124 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2125 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2126 = s64[1,29]{1,0} aten::expand(%2125), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2127 = s64[1,29]{1,0} aten::add(%628, %2126), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2128 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2129 = pred[1,29]{1,0} aten::lt(%628, %2128), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2130 = s64[1,29]{1,0} aten::where(%2129, %2127, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2131 = s64[1,29,1]{2,1,0} aten::stack(%2130), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2132 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2133 = bf16[29,128]{1,0} xla::select(%2132), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2134 = bf16[1,29,128]{2,1,0} aten::index(%2133, %2131), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2135 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2134), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2136 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2137 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2138 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2139 = bf16[3584,512]{0,1} aten::permute(%2138), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2140 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2141 = bf16[29,512]{1,0} aten::mm(%2140, %2139), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2142 = bf16[1,29,512]{2,1,0} aten::view(%2141), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2143 = bf16[1,29,512]{2,1,0} aten::add(%2142, %2137, %2136), scope=aten::add.221, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2144 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2143), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2145 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2144), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2146 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2145), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2147 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2145), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2148 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2147), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2149 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2148, %2146), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2150 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2149, %2135), scope=aten::mul.227, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2151 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2152 = s64[1,29]{1,0} aten::expand(%2151), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2153 = s64[1,29]{1,0} aten::add(%628, %2152), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2154 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2155 = pred[1,29]{1,0} aten::lt(%628, %2154), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2156 = s64[1,29]{1,0} aten::where(%2155, %2153, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2157 = s64[1,29,1]{2,1,0} aten::stack(%2156), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2158 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2159 = bf16[29,128]{1,0} xla::select(%2158), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2160 = bf16[1,29,128]{2,1,0} aten::index(%2159, %2157), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2161 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2160), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2162 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2145, %2161), scope=aten::mul.226, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2163 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2162, %2150, %2124), scope=aten::add.228, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2164 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2163), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2165 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2166 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2167 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2166), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2168 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2167), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2169 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2168), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2170 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2169), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2171 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2170), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2172 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2171), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2173 = bf16[28,128,29]{2,1,0} aten::view(%2172), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2174 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2175 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2176 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2177 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2178 = bf16[3584,3584]{0,1} aten::permute(%2177), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2179 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2180 = bf16[29,3584]{1,0} aten::mm(%2179, %2178), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2181 = bf16[1,29,3584]{2,1,0} aten::view(%2180), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2182 = bf16[1,29,3584]{2,1,0} aten::add(%2181, %2176, %2175), scope=aten::add.220, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2183 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2182), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2184 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2183), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2185 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2184), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2186 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2184), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2187 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2186), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2188 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2187, %2185), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2189 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2188, %2135), scope=aten::mul.224, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2190 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2184, %2161), scope=aten::mul.223, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2191 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2190, %2189, %2174), scope=aten::add.225, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2192 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2191), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2193 = bf16[28,29,128]{2,1,0} aten::view(%2192), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2194 = bf16[28,29,29]{2,1,0} aten::matmul(%2193, %2173), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2195 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2194), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2196 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2195, %2123), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2197 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2196, %617, %2122), scope=aten::add.229, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2198 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2197), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2199 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2198), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2200 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2199), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2201 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2200), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2202 = bf16[28,29,29]{2,1,0} aten::view(%2201), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2203 = bf16[28,29,128]{2,1,0} aten::matmul(%2202, %2121), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2204 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2203), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2205 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2204), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2206 = bf16[1,29,3584]{2,1,0} aten::view(%2205), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2207 = bf16[29,3584]{1,0} aten::view(%2206), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2208 = bf16[29,3584]{1,0} aten::mm(%2207, %329), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2209 = bf16[1,29,3584]{2,1,0} aten::view(%2208), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2210 = bf16[1,29,3584]{2,1,0} aten::add(%2097, %2209, %327), scope=aten::add.230, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2211 = f32[1,29,3584]{2,1,0} xla::cast(%2210), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2212 = f32[1,29,3584]{2,1,0} aten::pow(%2211, %326), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2213 = f32[1,29,1]{2,1,0} aten::mean(%2212), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2214 = f32[1,29,1]{2,1,0} aten::add(%2213, %325, %324), scope=aten::add.231, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2215 = f32[1,29,1]{2,1,0} aten::rsqrt(%2214), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2216 = f32[1,29,3584]{2,1,0} aten::mul(%2211, %2215), scope=aten::mul.232, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2217 = bf16[1,29,3584]{2,1,0} xla::cast(%2216), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2218 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2219 = bf16[1,29,3584]{2,1,0} aten::mul(%2218, %2217), scope=aten::mul.233, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2220 = bf16[29,3584]{1,0} aten::view(%2219), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2221 = bf16[29,18944]{1,0} aten::mm(%2220, %323), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2222 = bf16[1,29,18944]{2,1,0} aten::view(%2221), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2223 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2224 = bf16[3584,18944]{0,1} aten::permute(%2223), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2225 = bf16[29,3584]{1,0} aten::view(%2219), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2226 = bf16[29,18944]{1,0} aten::mm(%2225, %2224), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2227 = bf16[1,29,18944]{2,1,0} aten::view(%2226), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2228 = bf16[1,29,18944]{2,1,0} aten::silu(%2227), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2229 = bf16[1,29,18944]{2,1,0} aten::mul(%2228, %2222), scope=aten::mul.234, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2230 = bf16[29,18944]{1,0} aten::view(%2229), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2231 = bf16[29,3584]{1,0} aten::mm(%2230, %321), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2232 = bf16[1,29,3584]{2,1,0} aten::view(%2231), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2233 = bf16[1,29,3584]{2,1,0} aten::add(%2210, %2232, %319), scope=aten::add.235, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2234 = f32[1,29,3584]{2,1,0} xla::cast(%2233), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2235 = f32[1,29,3584]{2,1,0} aten::pow(%2234, %318), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2236 = f32[1,29,1]{2,1,0} aten::mean(%2235), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2237 = f32[1,29,1]{2,1,0} aten::add(%2236, %317, %316), scope=aten::add.236, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2238 = f32[1,29,1]{2,1,0} aten::rsqrt(%2237), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2239 = f32[1,29,3584]{2,1,0} aten::mul(%2234, %2238), scope=aten::mul.237, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2240 = bf16[1,29,3584]{2,1,0} xla::cast(%2239), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2241 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2242 = bf16[1,29,3584]{2,1,0} aten::mul(%2241, %2240), scope=aten::mul.238, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2243 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2244 = bf16[29,512]{1,0} aten::mm(%2243, %315), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2245 = bf16[1,29,512]{2,1,0} aten::view(%2244), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2246 = bf16[1,29,512]{2,1,0} aten::add(%2245, %313, %312), scope=aten::add.241, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2247 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2246), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2248 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2247), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2249 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2248), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2250 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2249), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2251 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2250), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2252 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2251), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2253 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2254 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2255 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2254), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2256 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2255), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2257 = bf16[28,29,128]{2,1,0} aten::view(%2256), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2258 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2259 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2260 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2261 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2262 = s64[1,29]{1,0} aten::expand(%2261), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2263 = s64[1,29]{1,0} aten::add(%628, %2262), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2264 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2265 = pred[1,29]{1,0} aten::lt(%628, %2264), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2266 = s64[1,29]{1,0} aten::where(%2265, %2263, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2267 = s64[1,29,1]{2,1,0} aten::stack(%2266), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2268 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2269 = bf16[29,128]{1,0} xla::select(%2268), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2270 = bf16[1,29,128]{2,1,0} aten::index(%2269, %2267), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2271 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2270), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2272 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2273 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2274 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2275 = bf16[3584,512]{0,1} aten::permute(%2274), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2276 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2277 = bf16[29,512]{1,0} aten::mm(%2276, %2275), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2278 = bf16[1,29,512]{2,1,0} aten::view(%2277), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2279 = bf16[1,29,512]{2,1,0} aten::add(%2278, %2273, %2272), scope=aten::add.240, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2280 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2279), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2281 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2280), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2282 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2281), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2283 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2281), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2284 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2283), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2285 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2284, %2282), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2286 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2285, %2271), scope=aten::mul.246, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2287 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2288 = s64[1,29]{1,0} aten::expand(%2287), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2289 = s64[1,29]{1,0} aten::add(%628, %2288), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2290 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2291 = pred[1,29]{1,0} aten::lt(%628, %2290), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2292 = s64[1,29]{1,0} aten::where(%2291, %2289, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2293 = s64[1,29,1]{2,1,0} aten::stack(%2292), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2294 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2295 = bf16[29,128]{1,0} xla::select(%2294), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2296 = bf16[1,29,128]{2,1,0} aten::index(%2295, %2293), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2297 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2296), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2298 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2281, %2297), scope=aten::mul.245, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2299 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2298, %2286, %2260), scope=aten::add.247, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2300 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2299), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2301 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2302 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2303 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2302), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2304 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2303), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2305 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2304), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2306 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2305), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2307 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2306), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2308 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2307), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2309 = bf16[28,128,29]{2,1,0} aten::view(%2308), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2310 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2311 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2312 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2313 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2314 = bf16[3584,3584]{0,1} aten::permute(%2313), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2315 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2316 = bf16[29,3584]{1,0} aten::mm(%2315, %2314), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2317 = bf16[1,29,3584]{2,1,0} aten::view(%2316), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2318 = bf16[1,29,3584]{2,1,0} aten::add(%2317, %2312, %2311), scope=aten::add.239, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2319 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2318), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2320 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2319), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2321 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2320), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2322 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2320), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2323 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2322), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2324 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2323, %2321), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2325 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2324, %2271), scope=aten::mul.243, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2326 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2320, %2297), scope=aten::mul.242, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2327 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2326, %2325, %2310), scope=aten::add.244, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2328 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2327), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2329 = bf16[28,29,128]{2,1,0} aten::view(%2328), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2330 = bf16[28,29,29]{2,1,0} aten::matmul(%2329, %2309), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2331 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2330), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2332 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2331, %2259), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2333 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2332, %617, %2258), scope=aten::add.248, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2334 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2333), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2335 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2334), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2336 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2335), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2337 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2336), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2338 = bf16[28,29,29]{2,1,0} aten::view(%2337), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2339 = bf16[28,29,128]{2,1,0} aten::matmul(%2338, %2257), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2340 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2339), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2341 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2340), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2342 = bf16[1,29,3584]{2,1,0} aten::view(%2341), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2343 = bf16[29,3584]{1,0} aten::view(%2342), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2344 = bf16[29,3584]{1,0} aten::mm(%2343, %311), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2345 = bf16[1,29,3584]{2,1,0} aten::view(%2344), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2346 = bf16[1,29,3584]{2,1,0} aten::add(%2233, %2345, %309), scope=aten::add.249, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2347 = f32[1,29,3584]{2,1,0} xla::cast(%2346), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2348 = f32[1,29,3584]{2,1,0} aten::pow(%2347, %308), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2349 = f32[1,29,1]{2,1,0} aten::mean(%2348), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2350 = f32[1,29,1]{2,1,0} aten::add(%2349, %307, %306), scope=aten::add.250, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2351 = f32[1,29,1]{2,1,0} aten::rsqrt(%2350), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2352 = f32[1,29,3584]{2,1,0} aten::mul(%2347, %2351), scope=aten::mul.251, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2353 = bf16[1,29,3584]{2,1,0} xla::cast(%2352), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2354 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2355 = bf16[1,29,3584]{2,1,0} aten::mul(%2354, %2353), scope=aten::mul.252, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2356 = bf16[29,3584]{1,0} aten::view(%2355), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2357 = bf16[29,18944]{1,0} aten::mm(%2356, %305), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2358 = bf16[1,29,18944]{2,1,0} aten::view(%2357), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2359 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2360 = bf16[3584,18944]{0,1} aten::permute(%2359), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2361 = bf16[29,3584]{1,0} aten::view(%2355), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2362 = bf16[29,18944]{1,0} aten::mm(%2361, %2360), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2363 = bf16[1,29,18944]{2,1,0} aten::view(%2362), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2364 = bf16[1,29,18944]{2,1,0} aten::silu(%2363), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2365 = bf16[1,29,18944]{2,1,0} aten::mul(%2364, %2358), scope=aten::mul.253, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2366 = bf16[29,18944]{1,0} aten::view(%2365), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2367 = bf16[29,3584]{1,0} aten::mm(%2366, %303), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2368 = bf16[1,29,3584]{2,1,0} aten::view(%2367), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2369 = bf16[1,29,3584]{2,1,0} aten::add(%2346, %2368, %301), scope=aten::add.254, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2370 = f32[1,29,3584]{2,1,0} xla::cast(%2369), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2371 = f32[1,29,3584]{2,1,0} aten::pow(%2370, %300), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2372 = f32[1,29,1]{2,1,0} aten::mean(%2371), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2373 = f32[1,29,1]{2,1,0} aten::add(%2372, %299, %298), scope=aten::add.255, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2374 = f32[1,29,1]{2,1,0} aten::rsqrt(%2373), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2375 = f32[1,29,3584]{2,1,0} aten::mul(%2370, %2374), scope=aten::mul.256, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2376 = bf16[1,29,3584]{2,1,0} xla::cast(%2375), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2377 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2378 = bf16[1,29,3584]{2,1,0} aten::mul(%2377, %2376), scope=aten::mul.257, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2379 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2380 = bf16[29,512]{1,0} aten::mm(%2379, %297), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2381 = bf16[1,29,512]{2,1,0} aten::view(%2380), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2382 = bf16[1,29,512]{2,1,0} aten::add(%2381, %295, %294), scope=aten::add.260, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2383 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2382), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2384 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2383), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2385 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2384), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2386 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2385), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2387 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2386), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2388 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2387), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2389 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2390 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2391 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2390), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2392 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2391), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2393 = bf16[28,29,128]{2,1,0} aten::view(%2392), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2394 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2395 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2396 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2397 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2398 = s64[1,29]{1,0} aten::expand(%2397), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2399 = s64[1,29]{1,0} aten::add(%628, %2398), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2400 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2401 = pred[1,29]{1,0} aten::lt(%628, %2400), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2402 = s64[1,29]{1,0} aten::where(%2401, %2399, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2403 = s64[1,29,1]{2,1,0} aten::stack(%2402), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2404 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2405 = bf16[29,128]{1,0} xla::select(%2404), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2406 = bf16[1,29,128]{2,1,0} aten::index(%2405, %2403), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2407 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2406), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2408 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2409 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2410 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2411 = bf16[3584,512]{0,1} aten::permute(%2410), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2412 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2413 = bf16[29,512]{1,0} aten::mm(%2412, %2411), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2414 = bf16[1,29,512]{2,1,0} aten::view(%2413), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2415 = bf16[1,29,512]{2,1,0} aten::add(%2414, %2409, %2408), scope=aten::add.259, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2416 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2415), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2417 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2416), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2418 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2417), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2419 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2417), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2420 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2419), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2421 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2420, %2418), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2422 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2421, %2407), scope=aten::mul.265, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2423 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2424 = s64[1,29]{1,0} aten::expand(%2423), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2425 = s64[1,29]{1,0} aten::add(%628, %2424), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2426 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2427 = pred[1,29]{1,0} aten::lt(%628, %2426), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2428 = s64[1,29]{1,0} aten::where(%2427, %2425, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2429 = s64[1,29,1]{2,1,0} aten::stack(%2428), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2430 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2431 = bf16[29,128]{1,0} xla::select(%2430), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2432 = bf16[1,29,128]{2,1,0} aten::index(%2431, %2429), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2433 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2432), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2434 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2417, %2433), scope=aten::mul.264, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2435 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2434, %2422, %2396), scope=aten::add.266, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2436 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2435), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2437 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2438 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2439 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2438), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2440 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2439), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2441 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2440), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2442 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2441), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2443 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2442), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2444 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2443), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2445 = bf16[28,128,29]{2,1,0} aten::view(%2444), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2446 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2447 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2448 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2449 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2450 = bf16[3584,3584]{0,1} aten::permute(%2449), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2451 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2452 = bf16[29,3584]{1,0} aten::mm(%2451, %2450), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2453 = bf16[1,29,3584]{2,1,0} aten::view(%2452), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2454 = bf16[1,29,3584]{2,1,0} aten::add(%2453, %2448, %2447), scope=aten::add.258, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2455 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2454), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2456 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2455), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2457 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2456), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2458 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2456), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2459 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2458), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2460 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2459, %2457), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2461 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2460, %2407), scope=aten::mul.262, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2462 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2456, %2433), scope=aten::mul.261, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2463 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2462, %2461, %2446), scope=aten::add.263, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2464 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2463), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2465 = bf16[28,29,128]{2,1,0} aten::view(%2464), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2466 = bf16[28,29,29]{2,1,0} aten::matmul(%2465, %2445), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2467 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2466), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2468 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2467, %2395), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2469 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2468, %617, %2394), scope=aten::add.267, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2470 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2469), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2471 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2470), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2472 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2471), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2473 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2472), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2474 = bf16[28,29,29]{2,1,0} aten::view(%2473), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2475 = bf16[28,29,128]{2,1,0} aten::matmul(%2474, %2393), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2476 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2475), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2477 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2476), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2478 = bf16[1,29,3584]{2,1,0} aten::view(%2477), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2479 = bf16[29,3584]{1,0} aten::view(%2478), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2480 = bf16[29,3584]{1,0} aten::mm(%2479, %293), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2481 = bf16[1,29,3584]{2,1,0} aten::view(%2480), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2482 = bf16[1,29,3584]{2,1,0} aten::add(%2369, %2481, %291), scope=aten::add.268, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2483 = f32[1,29,3584]{2,1,0} xla::cast(%2482), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2484 = f32[1,29,3584]{2,1,0} aten::pow(%2483, %290), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2485 = f32[1,29,1]{2,1,0} aten::mean(%2484), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2486 = f32[1,29,1]{2,1,0} aten::add(%2485, %289, %288), scope=aten::add.269, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2487 = f32[1,29,1]{2,1,0} aten::rsqrt(%2486), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2488 = f32[1,29,3584]{2,1,0} aten::mul(%2483, %2487), scope=aten::mul.270, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2489 = bf16[1,29,3584]{2,1,0} xla::cast(%2488), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2490 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2491 = bf16[1,29,3584]{2,1,0} aten::mul(%2490, %2489), scope=aten::mul.271, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2492 = bf16[29,3584]{1,0} aten::view(%2491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2493 = bf16[29,18944]{1,0} aten::mm(%2492, %287), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2494 = bf16[1,29,18944]{2,1,0} aten::view(%2493), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2495 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2496 = bf16[3584,18944]{0,1} aten::permute(%2495), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2497 = bf16[29,3584]{1,0} aten::view(%2491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2498 = bf16[29,18944]{1,0} aten::mm(%2497, %2496), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2499 = bf16[1,29,18944]{2,1,0} aten::view(%2498), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2500 = bf16[1,29,18944]{2,1,0} aten::silu(%2499), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2501 = bf16[1,29,18944]{2,1,0} aten::mul(%2500, %2494), scope=aten::mul.272, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2502 = bf16[29,18944]{1,0} aten::view(%2501), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2503 = bf16[29,3584]{1,0} aten::mm(%2502, %285), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2504 = bf16[1,29,3584]{2,1,0} aten::view(%2503), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2505 = bf16[1,29,3584]{2,1,0} aten::add(%2482, %2504, %283), scope=aten::add.273, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2506 = f32[1,29,3584]{2,1,0} xla::cast(%2505), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2507 = f32[1,29,3584]{2,1,0} aten::pow(%2506, %282), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2508 = f32[1,29,1]{2,1,0} aten::mean(%2507), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2509 = f32[1,29,1]{2,1,0} aten::add(%2508, %281, %280), scope=aten::add.274, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2510 = f32[1,29,1]{2,1,0} aten::rsqrt(%2509), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2511 = f32[1,29,3584]{2,1,0} aten::mul(%2506, %2510), scope=aten::mul.275, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2512 = bf16[1,29,3584]{2,1,0} xla::cast(%2511), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2513 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2514 = bf16[1,29,3584]{2,1,0} aten::mul(%2513, %2512), scope=aten::mul.276, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2515 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2516 = bf16[29,512]{1,0} aten::mm(%2515, %279), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2517 = bf16[1,29,512]{2,1,0} aten::view(%2516), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2518 = bf16[1,29,512]{2,1,0} aten::add(%2517, %277, %276), scope=aten::add.279, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2519 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2518), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2520 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2519), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2521 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2520), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2522 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2521), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2523 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2522), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2524 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2523), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2525 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2526 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2527 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2526), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2528 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2527), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2529 = bf16[28,29,128]{2,1,0} aten::view(%2528), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2530 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2531 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2532 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2533 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2534 = s64[1,29]{1,0} aten::expand(%2533), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2535 = s64[1,29]{1,0} aten::add(%628, %2534), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2536 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2537 = pred[1,29]{1,0} aten::lt(%628, %2536), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2538 = s64[1,29]{1,0} aten::where(%2537, %2535, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2539 = s64[1,29,1]{2,1,0} aten::stack(%2538), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2540 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2541 = bf16[29,128]{1,0} xla::select(%2540), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2542 = bf16[1,29,128]{2,1,0} aten::index(%2541, %2539), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2543 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2542), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2544 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2545 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2546 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2547 = bf16[3584,512]{0,1} aten::permute(%2546), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2548 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2549 = bf16[29,512]{1,0} aten::mm(%2548, %2547), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2550 = bf16[1,29,512]{2,1,0} aten::view(%2549), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2551 = bf16[1,29,512]{2,1,0} aten::add(%2550, %2545, %2544), scope=aten::add.278, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2552 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2551), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2553 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2552), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2554 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2553), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2555 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2553), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2556 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2555), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2557 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2556, %2554), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2558 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2557, %2543), scope=aten::mul.284, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2559 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2560 = s64[1,29]{1,0} aten::expand(%2559), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2561 = s64[1,29]{1,0} aten::add(%628, %2560), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2562 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2563 = pred[1,29]{1,0} aten::lt(%628, %2562), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2564 = s64[1,29]{1,0} aten::where(%2563, %2561, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2565 = s64[1,29,1]{2,1,0} aten::stack(%2564), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2566 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2567 = bf16[29,128]{1,0} xla::select(%2566), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2568 = bf16[1,29,128]{2,1,0} aten::index(%2567, %2565), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2569 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2568), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2570 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2553, %2569), scope=aten::mul.283, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2571 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2570, %2558, %2532), scope=aten::add.285, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2572 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2571), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2573 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2574 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2575 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2574), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2576 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2575), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2577 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2576), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2578 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2577), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2579 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2578), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2580 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2579), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2581 = bf16[28,128,29]{2,1,0} aten::view(%2580), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2582 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2583 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2584 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2585 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2586 = bf16[3584,3584]{0,1} aten::permute(%2585), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2587 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2588 = bf16[29,3584]{1,0} aten::mm(%2587, %2586), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2589 = bf16[1,29,3584]{2,1,0} aten::view(%2588), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2590 = bf16[1,29,3584]{2,1,0} aten::add(%2589, %2584, %2583), scope=aten::add.277, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2591 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2590), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2592 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2591), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2593 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2592), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2594 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2592), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2595 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2594), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2596 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2595, %2593), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2597 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2596, %2543), scope=aten::mul.281, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2598 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2592, %2569), scope=aten::mul.280, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2599 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2598, %2597, %2582), scope=aten::add.282, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2600 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2599), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2601 = bf16[28,29,128]{2,1,0} aten::view(%2600), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2602 = bf16[28,29,29]{2,1,0} aten::matmul(%2601, %2581), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2603 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2602), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2604 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2603, %2531), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2605 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2604, %617, %2530), scope=aten::add.286, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2606 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2605), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2607 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2606), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2608 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2607), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2609 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2608), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2610 = bf16[28,29,29]{2,1,0} aten::view(%2609), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2611 = bf16[28,29,128]{2,1,0} aten::matmul(%2610, %2529), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2612 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2611), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2613 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2612), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2614 = bf16[1,29,3584]{2,1,0} aten::view(%2613), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2615 = bf16[29,3584]{1,0} aten::view(%2614), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2616 = bf16[29,3584]{1,0} aten::mm(%2615, %275), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2617 = bf16[1,29,3584]{2,1,0} aten::view(%2616), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2618 = bf16[1,29,3584]{2,1,0} aten::add(%2505, %2617, %273), scope=aten::add.287, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2619 = f32[1,29,3584]{2,1,0} xla::cast(%2618), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2620 = f32[1,29,3584]{2,1,0} aten::pow(%2619, %272), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2621 = f32[1,29,1]{2,1,0} aten::mean(%2620), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2622 = f32[1,29,1]{2,1,0} aten::add(%2621, %271, %270), scope=aten::add.288, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2623 = f32[1,29,1]{2,1,0} aten::rsqrt(%2622), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2624 = f32[1,29,3584]{2,1,0} aten::mul(%2619, %2623), scope=aten::mul.289, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2625 = bf16[1,29,3584]{2,1,0} xla::cast(%2624), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2626 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2627 = bf16[1,29,3584]{2,1,0} aten::mul(%2626, %2625), scope=aten::mul.290, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2628 = bf16[29,3584]{1,0} aten::view(%2627), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2629 = bf16[29,18944]{1,0} aten::mm(%2628, %269), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2630 = bf16[1,29,18944]{2,1,0} aten::view(%2629), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2631 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2632 = bf16[3584,18944]{0,1} aten::permute(%2631), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2633 = bf16[29,3584]{1,0} aten::view(%2627), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2634 = bf16[29,18944]{1,0} aten::mm(%2633, %2632), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2635 = bf16[1,29,18944]{2,1,0} aten::view(%2634), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2636 = bf16[1,29,18944]{2,1,0} aten::silu(%2635), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2637 = bf16[1,29,18944]{2,1,0} aten::mul(%2636, %2630), scope=aten::mul.291, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2638 = bf16[29,18944]{1,0} aten::view(%2637), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2639 = bf16[29,3584]{1,0} aten::mm(%2638, %267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2640 = bf16[1,29,3584]{2,1,0} aten::view(%2639), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2641 = bf16[1,29,3584]{2,1,0} aten::add(%2618, %2640, %265), scope=aten::add.292, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2642 = f32[1,29,3584]{2,1,0} xla::cast(%2641), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2643 = f32[1,29,3584]{2,1,0} aten::pow(%2642, %264), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2644 = f32[1,29,1]{2,1,0} aten::mean(%2643), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2645 = f32[1,29,1]{2,1,0} aten::add(%2644, %263, %262), scope=aten::add.293, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2646 = f32[1,29,1]{2,1,0} aten::rsqrt(%2645), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2647 = f32[1,29,3584]{2,1,0} aten::mul(%2642, %2646), scope=aten::mul.294, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2648 = bf16[1,29,3584]{2,1,0} xla::cast(%2647), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2649 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2650 = bf16[1,29,3584]{2,1,0} aten::mul(%2649, %2648), scope=aten::mul.295, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2651 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2652 = bf16[29,512]{1,0} aten::mm(%2651, %261), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2653 = bf16[1,29,512]{2,1,0} aten::view(%2652), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2654 = bf16[1,29,512]{2,1,0} aten::add(%2653, %259, %258), scope=aten::add.298, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2655 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2654), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2656 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2655), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2657 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2656), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2658 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2657), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2659 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2658), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2660 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2659), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2661 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2662 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2663 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2662), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2664 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2663), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2665 = bf16[28,29,128]{2,1,0} aten::view(%2664), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2666 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2667 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2668 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2669 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2670 = s64[1,29]{1,0} aten::expand(%2669), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2671 = s64[1,29]{1,0} aten::add(%628, %2670), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2672 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2673 = pred[1,29]{1,0} aten::lt(%628, %2672), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2674 = s64[1,29]{1,0} aten::where(%2673, %2671, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2675 = s64[1,29,1]{2,1,0} aten::stack(%2674), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2676 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2677 = bf16[29,128]{1,0} xla::select(%2676), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2678 = bf16[1,29,128]{2,1,0} aten::index(%2677, %2675), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2679 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2678), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2680 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2681 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2682 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2683 = bf16[3584,512]{0,1} aten::permute(%2682), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2684 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2685 = bf16[29,512]{1,0} aten::mm(%2684, %2683), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2686 = bf16[1,29,512]{2,1,0} aten::view(%2685), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2687 = bf16[1,29,512]{2,1,0} aten::add(%2686, %2681, %2680), scope=aten::add.297, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2688 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2687), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2689 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2688), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2690 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2689), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2691 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2689), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2692 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2691), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2693 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2692, %2690), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2694 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2693, %2679), scope=aten::mul.303, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2695 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2696 = s64[1,29]{1,0} aten::expand(%2695), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2697 = s64[1,29]{1,0} aten::add(%628, %2696), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2698 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2699 = pred[1,29]{1,0} aten::lt(%628, %2698), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2700 = s64[1,29]{1,0} aten::where(%2699, %2697, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2701 = s64[1,29,1]{2,1,0} aten::stack(%2700), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2702 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2703 = bf16[29,128]{1,0} xla::select(%2702), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2704 = bf16[1,29,128]{2,1,0} aten::index(%2703, %2701), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2705 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2704), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2706 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2689, %2705), scope=aten::mul.302, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2707 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2706, %2694, %2668), scope=aten::add.304, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2708 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2707), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2709 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2710 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2711 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2710), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2712 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2711), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2713 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2712), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2714 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2713), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2715 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2714), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2716 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2715), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2717 = bf16[28,128,29]{2,1,0} aten::view(%2716), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2718 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2719 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2720 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2721 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2722 = bf16[3584,3584]{0,1} aten::permute(%2721), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2723 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2724 = bf16[29,3584]{1,0} aten::mm(%2723, %2722), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2725 = bf16[1,29,3584]{2,1,0} aten::view(%2724), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2726 = bf16[1,29,3584]{2,1,0} aten::add(%2725, %2720, %2719), scope=aten::add.296, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2727 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2726), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2728 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2727), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2729 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2728), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2730 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2728), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2731 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2730), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2732 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2731, %2729), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2733 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2732, %2679), scope=aten::mul.300, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2734 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2728, %2705), scope=aten::mul.299, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2735 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2734, %2733, %2718), scope=aten::add.301, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2736 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2735), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2737 = bf16[28,29,128]{2,1,0} aten::view(%2736), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2738 = bf16[28,29,29]{2,1,0} aten::matmul(%2737, %2717), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2739 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2738), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2740 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2739, %2667), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2741 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2740, %617, %2666), scope=aten::add.305, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2742 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2741), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2743 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2742), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2744 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2743), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2745 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2744), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2746 = bf16[28,29,29]{2,1,0} aten::view(%2745), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2747 = bf16[28,29,128]{2,1,0} aten::matmul(%2746, %2665), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2748 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2747), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2749 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2748), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2750 = bf16[1,29,3584]{2,1,0} aten::view(%2749), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2751 = bf16[29,3584]{1,0} aten::view(%2750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2752 = bf16[29,3584]{1,0} aten::mm(%2751, %257), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2753 = bf16[1,29,3584]{2,1,0} aten::view(%2752), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2754 = bf16[1,29,3584]{2,1,0} aten::add(%2641, %2753, %255), scope=aten::add.306, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2755 = f32[1,29,3584]{2,1,0} xla::cast(%2754), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2756 = f32[1,29,3584]{2,1,0} aten::pow(%2755, %254), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2757 = f32[1,29,1]{2,1,0} aten::mean(%2756), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2758 = f32[1,29,1]{2,1,0} aten::add(%2757, %253, %252), scope=aten::add.307, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2759 = f32[1,29,1]{2,1,0} aten::rsqrt(%2758), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2760 = f32[1,29,3584]{2,1,0} aten::mul(%2755, %2759), scope=aten::mul.308, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2761 = bf16[1,29,3584]{2,1,0} xla::cast(%2760), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2762 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2763 = bf16[1,29,3584]{2,1,0} aten::mul(%2762, %2761), scope=aten::mul.309, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2764 = bf16[29,3584]{1,0} aten::view(%2763), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2765 = bf16[29,18944]{1,0} aten::mm(%2764, %251), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2766 = bf16[1,29,18944]{2,1,0} aten::view(%2765), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2767 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2768 = bf16[3584,18944]{0,1} aten::permute(%2767), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2769 = bf16[29,3584]{1,0} aten::view(%2763), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2770 = bf16[29,18944]{1,0} aten::mm(%2769, %2768), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2771 = bf16[1,29,18944]{2,1,0} aten::view(%2770), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2772 = bf16[1,29,18944]{2,1,0} aten::silu(%2771), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2773 = bf16[1,29,18944]{2,1,0} aten::mul(%2772, %2766), scope=aten::mul.310, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2774 = bf16[29,18944]{1,0} aten::view(%2773), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2775 = bf16[29,3584]{1,0} aten::mm(%2774, %249), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2776 = bf16[1,29,3584]{2,1,0} aten::view(%2775), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2777 = bf16[1,29,3584]{2,1,0} aten::add(%2754, %2776, %247), scope=aten::add.311, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2778 = f32[1,29,3584]{2,1,0} xla::cast(%2777), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2779 = f32[1,29,3584]{2,1,0} aten::pow(%2778, %246), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2780 = f32[1,29,1]{2,1,0} aten::mean(%2779), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2781 = f32[1,29,1]{2,1,0} aten::add(%2780, %245, %244), scope=aten::add.312, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2782 = f32[1,29,1]{2,1,0} aten::rsqrt(%2781), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2783 = f32[1,29,3584]{2,1,0} aten::mul(%2778, %2782), scope=aten::mul.313, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2784 = bf16[1,29,3584]{2,1,0} xla::cast(%2783), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2785 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2786 = bf16[1,29,3584]{2,1,0} aten::mul(%2785, %2784), scope=aten::mul.314, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2787 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2788 = bf16[29,512]{1,0} aten::mm(%2787, %243), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2789 = bf16[1,29,512]{2,1,0} aten::view(%2788), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2790 = bf16[1,29,512]{2,1,0} aten::add(%2789, %241, %240), scope=aten::add.317, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2791 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2790), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2792 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2791), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2793 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2792), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2794 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2793), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2795 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2794), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2796 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2795), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2797 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2798 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2799 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2798), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2800 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2799), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2801 = bf16[28,29,128]{2,1,0} aten::view(%2800), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2802 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2803 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2804 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2805 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2806 = s64[1,29]{1,0} aten::expand(%2805), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2807 = s64[1,29]{1,0} aten::add(%628, %2806), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2808 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2809 = pred[1,29]{1,0} aten::lt(%628, %2808), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2810 = s64[1,29]{1,0} aten::where(%2809, %2807, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2811 = s64[1,29,1]{2,1,0} aten::stack(%2810), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2812 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2813 = bf16[29,128]{1,0} xla::select(%2812), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2814 = bf16[1,29,128]{2,1,0} aten::index(%2813, %2811), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2815 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2814), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2816 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2817 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2818 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2819 = bf16[3584,512]{0,1} aten::permute(%2818), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2820 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2821 = bf16[29,512]{1,0} aten::mm(%2820, %2819), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2822 = bf16[1,29,512]{2,1,0} aten::view(%2821), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2823 = bf16[1,29,512]{2,1,0} aten::add(%2822, %2817, %2816), scope=aten::add.316, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2824 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2823), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2825 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2824), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2826 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2825), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2827 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2825), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2828 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2827), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2829 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2828, %2826), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2830 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2829, %2815), scope=aten::mul.322, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2831 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2832 = s64[1,29]{1,0} aten::expand(%2831), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2833 = s64[1,29]{1,0} aten::add(%628, %2832), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2834 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2835 = pred[1,29]{1,0} aten::lt(%628, %2834), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2836 = s64[1,29]{1,0} aten::where(%2835, %2833, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2837 = s64[1,29,1]{2,1,0} aten::stack(%2836), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2838 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2839 = bf16[29,128]{1,0} xla::select(%2838), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2840 = bf16[1,29,128]{2,1,0} aten::index(%2839, %2837), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2841 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2840), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2842 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2825, %2841), scope=aten::mul.321, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2843 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2842, %2830, %2804), scope=aten::add.323, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2844 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2843), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2845 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2846 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2847 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2846), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2848 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2847), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2849 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2848), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2850 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2849), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2851 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2850), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2852 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2851), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2853 = bf16[28,128,29]{2,1,0} aten::view(%2852), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2854 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2855 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2856 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2857 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2858 = bf16[3584,3584]{0,1} aten::permute(%2857), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2859 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2860 = bf16[29,3584]{1,0} aten::mm(%2859, %2858), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2861 = bf16[1,29,3584]{2,1,0} aten::view(%2860), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2862 = bf16[1,29,3584]{2,1,0} aten::add(%2861, %2856, %2855), scope=aten::add.315, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2863 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2862), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2864 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2863), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2865 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2864), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2866 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2864), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2867 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2866), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2868 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2867, %2865), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2869 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2868, %2815), scope=aten::mul.319, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2870 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2864, %2841), scope=aten::mul.318, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2871 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2870, %2869, %2854), scope=aten::add.320, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2872 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2871), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2873 = bf16[28,29,128]{2,1,0} aten::view(%2872), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2874 = bf16[28,29,29]{2,1,0} aten::matmul(%2873, %2853), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2875 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2874), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2876 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2875, %2803), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2877 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2876, %617, %2802), scope=aten::add.324, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2878 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2877), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2879 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2878), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2880 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2879), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2881 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2880), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2882 = bf16[28,29,29]{2,1,0} aten::view(%2881), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2883 = bf16[28,29,128]{2,1,0} aten::matmul(%2882, %2801), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2884 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2883), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2885 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2884), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2886 = bf16[1,29,3584]{2,1,0} aten::view(%2885), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2887 = bf16[29,3584]{1,0} aten::view(%2886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2888 = bf16[29,3584]{1,0} aten::mm(%2887, %239), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2889 = bf16[1,29,3584]{2,1,0} aten::view(%2888), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2890 = bf16[1,29,3584]{2,1,0} aten::add(%2777, %2889, %237), scope=aten::add.325, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2891 = f32[1,29,3584]{2,1,0} xla::cast(%2890), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2892 = f32[1,29,3584]{2,1,0} aten::pow(%2891, %236), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2893 = f32[1,29,1]{2,1,0} aten::mean(%2892), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2894 = f32[1,29,1]{2,1,0} aten::add(%2893, %235, %234), scope=aten::add.326, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2895 = f32[1,29,1]{2,1,0} aten::rsqrt(%2894), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2896 = f32[1,29,3584]{2,1,0} aten::mul(%2891, %2895), scope=aten::mul.327, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2897 = bf16[1,29,3584]{2,1,0} xla::cast(%2896), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2898 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2899 = bf16[1,29,3584]{2,1,0} aten::mul(%2898, %2897), scope=aten::mul.328, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2900 = bf16[29,3584]{1,0} aten::view(%2899), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2901 = bf16[29,18944]{1,0} aten::mm(%2900, %233), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2902 = bf16[1,29,18944]{2,1,0} aten::view(%2901), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2903 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2904 = bf16[3584,18944]{0,1} aten::permute(%2903), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2905 = bf16[29,3584]{1,0} aten::view(%2899), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2906 = bf16[29,18944]{1,0} aten::mm(%2905, %2904), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2907 = bf16[1,29,18944]{2,1,0} aten::view(%2906), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2908 = bf16[1,29,18944]{2,1,0} aten::silu(%2907), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2909 = bf16[1,29,18944]{2,1,0} aten::mul(%2908, %2902), scope=aten::mul.329, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2910 = bf16[29,18944]{1,0} aten::view(%2909), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2911 = bf16[29,3584]{1,0} aten::mm(%2910, %231), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2912 = bf16[1,29,3584]{2,1,0} aten::view(%2911), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2913 = bf16[1,29,3584]{2,1,0} aten::add(%2890, %2912, %229), scope=aten::add.330, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2914 = f32[1,29,3584]{2,1,0} xla::cast(%2913), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2915 = f32[1,29,3584]{2,1,0} aten::pow(%2914, %228), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2916 = f32[1,29,1]{2,1,0} aten::mean(%2915), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2917 = f32[1,29,1]{2,1,0} aten::add(%2916, %227, %226), scope=aten::add.331, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2918 = f32[1,29,1]{2,1,0} aten::rsqrt(%2917), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2919 = f32[1,29,3584]{2,1,0} aten::mul(%2914, %2918), scope=aten::mul.332, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2920 = bf16[1,29,3584]{2,1,0} xla::cast(%2919), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2921 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2922 = bf16[1,29,3584]{2,1,0} aten::mul(%2921, %2920), scope=aten::mul.333, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2923 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2924 = bf16[29,512]{1,0} aten::mm(%2923, %225), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2925 = bf16[1,29,512]{2,1,0} aten::view(%2924), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2926 = bf16[1,29,512]{2,1,0} aten::add(%2925, %223, %222), scope=aten::add.336, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2927 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2926), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2928 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2927), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2929 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2928), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2930 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2929), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2931 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2930), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2932 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2931), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2933 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2934 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2935 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2934), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2936 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2935), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2937 = bf16[28,29,128]{2,1,0} aten::view(%2936), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2938 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2939 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2940 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2941 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2942 = s64[1,29]{1,0} aten::expand(%2941), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2943 = s64[1,29]{1,0} aten::add(%628, %2942), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2944 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2945 = pred[1,29]{1,0} aten::lt(%628, %2944), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2946 = s64[1,29]{1,0} aten::where(%2945, %2943, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2947 = s64[1,29,1]{2,1,0} aten::stack(%2946), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2948 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2949 = bf16[29,128]{1,0} xla::select(%2948), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2950 = bf16[1,29,128]{2,1,0} aten::index(%2949, %2947), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2951 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2950), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2952 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2953 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2954 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2955 = bf16[3584,512]{0,1} aten::permute(%2954), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2956 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2957 = bf16[29,512]{1,0} aten::mm(%2956, %2955), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2958 = bf16[1,29,512]{2,1,0} aten::view(%2957), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2959 = bf16[1,29,512]{2,1,0} aten::add(%2958, %2953, %2952), scope=aten::add.335, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2960 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2959), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2961 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2960), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2962 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2961), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2963 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2961), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2964 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2963), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2965 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2964, %2962), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2966 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2965, %2951), scope=aten::mul.341, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2967 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2968 = s64[1,29]{1,0} aten::expand(%2967), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2969 = s64[1,29]{1,0} aten::add(%628, %2968), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2970 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2971 = pred[1,29]{1,0} aten::lt(%628, %2970), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2972 = s64[1,29]{1,0} aten::where(%2971, %2969, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2973 = s64[1,29,1]{2,1,0} aten::stack(%2972), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2974 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2975 = bf16[29,128]{1,0} xla::select(%2974), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2976 = bf16[1,29,128]{2,1,0} aten::index(%2975, %2973), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2977 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2976), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2978 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2961, %2977), scope=aten::mul.340, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2979 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2978, %2966, %2940), scope=aten::add.342, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2980 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2979), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2981 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2982 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2983 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2982), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2984 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2983), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2985 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2984), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2986 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2985), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2987 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2986), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2988 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2987), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2989 = bf16[28,128,29]{2,1,0} aten::view(%2988), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2990 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2991 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2992 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2993 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2994 = bf16[3584,3584]{0,1} aten::permute(%2993), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2995 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2996 = bf16[29,3584]{1,0} aten::mm(%2995, %2994), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2997 = bf16[1,29,3584]{2,1,0} aten::view(%2996), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2998 = bf16[1,29,3584]{2,1,0} aten::add(%2997, %2992, %2991), scope=aten::add.334, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2999 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2998), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3000 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2999), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3001 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3000), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3002 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3000), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3003 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3002), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3004 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3003, %3001), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3005 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3004, %2951), scope=aten::mul.338, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3006 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3000, %2977), scope=aten::mul.337, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3007 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3006, %3005, %2990), scope=aten::add.339, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3008 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3007), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3009 = bf16[28,29,128]{2,1,0} aten::view(%3008), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3010 = bf16[28,29,29]{2,1,0} aten::matmul(%3009, %2989), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3011 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3010), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3012 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3011, %2939), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3013 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3012, %617, %2938), scope=aten::add.343, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3014 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3013), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3015 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3014), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3016 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3015), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3017 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3016), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3018 = bf16[28,29,29]{2,1,0} aten::view(%3017), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3019 = bf16[28,29,128]{2,1,0} aten::matmul(%3018, %2937), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3020 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3019), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3021 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3020), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3022 = bf16[1,29,3584]{2,1,0} aten::view(%3021), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3023 = bf16[29,3584]{1,0} aten::view(%3022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3024 = bf16[29,3584]{1,0} aten::mm(%3023, %221), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3025 = bf16[1,29,3584]{2,1,0} aten::view(%3024), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3026 = bf16[1,29,3584]{2,1,0} aten::add(%2913, %3025, %219), scope=aten::add.344, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3027 = f32[1,29,3584]{2,1,0} xla::cast(%3026), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3028 = f32[1,29,3584]{2,1,0} aten::pow(%3027, %218), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3029 = f32[1,29,1]{2,1,0} aten::mean(%3028), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3030 = f32[1,29,1]{2,1,0} aten::add(%3029, %217, %216), scope=aten::add.345, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3031 = f32[1,29,1]{2,1,0} aten::rsqrt(%3030), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3032 = f32[1,29,3584]{2,1,0} aten::mul(%3027, %3031), scope=aten::mul.346, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3033 = bf16[1,29,3584]{2,1,0} xla::cast(%3032), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3034 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3035 = bf16[1,29,3584]{2,1,0} aten::mul(%3034, %3033), scope=aten::mul.347, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3036 = bf16[29,3584]{1,0} aten::view(%3035), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3037 = bf16[29,18944]{1,0} aten::mm(%3036, %215), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3038 = bf16[1,29,18944]{2,1,0} aten::view(%3037), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3039 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3040 = bf16[3584,18944]{0,1} aten::permute(%3039), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3041 = bf16[29,3584]{1,0} aten::view(%3035), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3042 = bf16[29,18944]{1,0} aten::mm(%3041, %3040), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3043 = bf16[1,29,18944]{2,1,0} aten::view(%3042), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3044 = bf16[1,29,18944]{2,1,0} aten::silu(%3043), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3045 = bf16[1,29,18944]{2,1,0} aten::mul(%3044, %3038), scope=aten::mul.348, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3046 = bf16[29,18944]{1,0} aten::view(%3045), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3047 = bf16[29,3584]{1,0} aten::mm(%3046, %213), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3048 = bf16[1,29,3584]{2,1,0} aten::view(%3047), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3049 = bf16[1,29,3584]{2,1,0} aten::add(%3026, %3048, %211), scope=aten::add.349, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3050 = f32[1,29,3584]{2,1,0} xla::cast(%3049), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3051 = f32[1,29,3584]{2,1,0} aten::pow(%3050, %210), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3052 = f32[1,29,1]{2,1,0} aten::mean(%3051), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3053 = f32[1,29,1]{2,1,0} aten::add(%3052, %209, %208), scope=aten::add.350, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3054 = f32[1,29,1]{2,1,0} aten::rsqrt(%3053), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3055 = f32[1,29,3584]{2,1,0} aten::mul(%3050, %3054), scope=aten::mul.351, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3056 = bf16[1,29,3584]{2,1,0} xla::cast(%3055), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3057 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3058 = bf16[1,29,3584]{2,1,0} aten::mul(%3057, %3056), scope=aten::mul.352, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3059 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3060 = bf16[29,512]{1,0} aten::mm(%3059, %207), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3061 = bf16[1,29,512]{2,1,0} aten::view(%3060), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3062 = bf16[1,29,512]{2,1,0} aten::add(%3061, %205, %204), scope=aten::add.355, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3063 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3062), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3064 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3063), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3065 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3064), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3066 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3065), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3067 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3066), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3068 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3067), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3069 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3070 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3071 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3070), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3072 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3071), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3073 = bf16[28,29,128]{2,1,0} aten::view(%3072), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3074 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3075 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3076 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3077 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3078 = s64[1,29]{1,0} aten::expand(%3077), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3079 = s64[1,29]{1,0} aten::add(%628, %3078), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3080 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3081 = pred[1,29]{1,0} aten::lt(%628, %3080), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3082 = s64[1,29]{1,0} aten::where(%3081, %3079, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3083 = s64[1,29,1]{2,1,0} aten::stack(%3082), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3084 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3085 = bf16[29,128]{1,0} xla::select(%3084), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3086 = bf16[1,29,128]{2,1,0} aten::index(%3085, %3083), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3087 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3086), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3088 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3089 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3090 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3091 = bf16[3584,512]{0,1} aten::permute(%3090), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3092 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3093 = bf16[29,512]{1,0} aten::mm(%3092, %3091), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3094 = bf16[1,29,512]{2,1,0} aten::view(%3093), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3095 = bf16[1,29,512]{2,1,0} aten::add(%3094, %3089, %3088), scope=aten::add.354, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3096 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3095), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3097 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3096), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3098 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3097), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3099 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3097), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3100 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3099), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3101 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3100, %3098), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3102 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3101, %3087), scope=aten::mul.360, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3103 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3104 = s64[1,29]{1,0} aten::expand(%3103), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3105 = s64[1,29]{1,0} aten::add(%628, %3104), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3106 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3107 = pred[1,29]{1,0} aten::lt(%628, %3106), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3108 = s64[1,29]{1,0} aten::where(%3107, %3105, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3109 = s64[1,29,1]{2,1,0} aten::stack(%3108), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3110 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3111 = bf16[29,128]{1,0} xla::select(%3110), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3112 = bf16[1,29,128]{2,1,0} aten::index(%3111, %3109), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3113 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3112), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3114 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3097, %3113), scope=aten::mul.359, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3115 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3114, %3102, %3076), scope=aten::add.361, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3116 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3115), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3117 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3118 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3119 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3118), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3120 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3119), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3121 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3120), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3122 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3121), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3123 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3122), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3124 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3123), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3125 = bf16[28,128,29]{2,1,0} aten::view(%3124), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3126 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3127 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3128 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3129 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3130 = bf16[3584,3584]{0,1} aten::permute(%3129), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3131 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3132 = bf16[29,3584]{1,0} aten::mm(%3131, %3130), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3133 = bf16[1,29,3584]{2,1,0} aten::view(%3132), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3134 = bf16[1,29,3584]{2,1,0} aten::add(%3133, %3128, %3127), scope=aten::add.353, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3135 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3134), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3136 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3135), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3137 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3136), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3138 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3136), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3139 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3138), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3140 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3139, %3137), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3141 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3140, %3087), scope=aten::mul.357, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3142 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3136, %3113), scope=aten::mul.356, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3143 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3142, %3141, %3126), scope=aten::add.358, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3144 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3143), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3145 = bf16[28,29,128]{2,1,0} aten::view(%3144), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3146 = bf16[28,29,29]{2,1,0} aten::matmul(%3145, %3125), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3147 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3146), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3148 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3147, %3075), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3149 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3148, %617, %3074), scope=aten::add.362, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3150 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3149), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3151 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3150), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3152 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3151), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3153 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3152), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3154 = bf16[28,29,29]{2,1,0} aten::view(%3153), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3155 = bf16[28,29,128]{2,1,0} aten::matmul(%3154, %3073), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3156 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3155), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3157 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3156), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3158 = bf16[1,29,3584]{2,1,0} aten::view(%3157), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3159 = bf16[29,3584]{1,0} aten::view(%3158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3160 = bf16[29,3584]{1,0} aten::mm(%3159, %203), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3161 = bf16[1,29,3584]{2,1,0} aten::view(%3160), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3162 = bf16[1,29,3584]{2,1,0} aten::add(%3049, %3161, %201), scope=aten::add.363, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3163 = f32[1,29,3584]{2,1,0} xla::cast(%3162), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3164 = f32[1,29,3584]{2,1,0} aten::pow(%3163, %200), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3165 = f32[1,29,1]{2,1,0} aten::mean(%3164), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3166 = f32[1,29,1]{2,1,0} aten::add(%3165, %199, %198), scope=aten::add.364, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3167 = f32[1,29,1]{2,1,0} aten::rsqrt(%3166), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3168 = f32[1,29,3584]{2,1,0} aten::mul(%3163, %3167), scope=aten::mul.365, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3169 = bf16[1,29,3584]{2,1,0} xla::cast(%3168), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3170 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3171 = bf16[1,29,3584]{2,1,0} aten::mul(%3170, %3169), scope=aten::mul.366, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3172 = bf16[29,3584]{1,0} aten::view(%3171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3173 = bf16[29,18944]{1,0} aten::mm(%3172, %197), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3174 = bf16[1,29,18944]{2,1,0} aten::view(%3173), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3175 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3176 = bf16[3584,18944]{0,1} aten::permute(%3175), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3177 = bf16[29,3584]{1,0} aten::view(%3171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3178 = bf16[29,18944]{1,0} aten::mm(%3177, %3176), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3179 = bf16[1,29,18944]{2,1,0} aten::view(%3178), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3180 = bf16[1,29,18944]{2,1,0} aten::silu(%3179), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3181 = bf16[1,29,18944]{2,1,0} aten::mul(%3180, %3174), scope=aten::mul.367, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3182 = bf16[29,18944]{1,0} aten::view(%3181), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3183 = bf16[29,3584]{1,0} aten::mm(%3182, %195), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3184 = bf16[1,29,3584]{2,1,0} aten::view(%3183), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3185 = bf16[1,29,3584]{2,1,0} aten::add(%3162, %3184, %193), scope=aten::add.368, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3186 = f32[1,29,3584]{2,1,0} xla::cast(%3185), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3187 = f32[1,29,3584]{2,1,0} aten::pow(%3186, %192), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3188 = f32[1,29,1]{2,1,0} aten::mean(%3187), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3189 = f32[1,29,1]{2,1,0} aten::add(%3188, %191, %190), scope=aten::add.369, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3190 = f32[1,29,1]{2,1,0} aten::rsqrt(%3189), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3191 = f32[1,29,3584]{2,1,0} aten::mul(%3186, %3190), scope=aten::mul.370, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3192 = bf16[1,29,3584]{2,1,0} xla::cast(%3191), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3193 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3194 = bf16[1,29,3584]{2,1,0} aten::mul(%3193, %3192), scope=aten::mul.371, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3195 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3196 = bf16[29,512]{1,0} aten::mm(%3195, %189), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3197 = bf16[1,29,512]{2,1,0} aten::view(%3196), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3198 = bf16[1,29,512]{2,1,0} aten::add(%3197, %187, %186), scope=aten::add.374, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3199 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3198), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3200 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3199), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3201 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3200), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3202 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3201), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3203 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3202), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3204 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3203), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3205 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3206 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3207 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3206), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3208 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3207), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3209 = bf16[28,29,128]{2,1,0} aten::view(%3208), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3210 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3211 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3212 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3213 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3214 = s64[1,29]{1,0} aten::expand(%3213), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3215 = s64[1,29]{1,0} aten::add(%628, %3214), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3216 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3217 = pred[1,29]{1,0} aten::lt(%628, %3216), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3218 = s64[1,29]{1,0} aten::where(%3217, %3215, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3219 = s64[1,29,1]{2,1,0} aten::stack(%3218), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3220 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3221 = bf16[29,128]{1,0} xla::select(%3220), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3222 = bf16[1,29,128]{2,1,0} aten::index(%3221, %3219), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3223 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3222), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3224 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3225 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3226 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3227 = bf16[3584,512]{0,1} aten::permute(%3226), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3228 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3229 = bf16[29,512]{1,0} aten::mm(%3228, %3227), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3230 = bf16[1,29,512]{2,1,0} aten::view(%3229), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3231 = bf16[1,29,512]{2,1,0} aten::add(%3230, %3225, %3224), scope=aten::add.373, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3232 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3231), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3233 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3232), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3234 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3233), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3235 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3233), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3236 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3235), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3237 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3236, %3234), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3238 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3237, %3223), scope=aten::mul.379, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3239 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3240 = s64[1,29]{1,0} aten::expand(%3239), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3241 = s64[1,29]{1,0} aten::add(%628, %3240), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3242 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3243 = pred[1,29]{1,0} aten::lt(%628, %3242), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3244 = s64[1,29]{1,0} aten::where(%3243, %3241, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3245 = s64[1,29,1]{2,1,0} aten::stack(%3244), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3246 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3247 = bf16[29,128]{1,0} xla::select(%3246), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3248 = bf16[1,29,128]{2,1,0} aten::index(%3247, %3245), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3249 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3248), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3250 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3233, %3249), scope=aten::mul.378, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3251 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3250, %3238, %3212), scope=aten::add.380, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3252 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3251), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3253 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3254 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3255 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3254), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3256 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3255), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3257 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3256), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3258 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3257), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3259 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3258), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3260 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3259), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3261 = bf16[28,128,29]{2,1,0} aten::view(%3260), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3262 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3263 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3264 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3265 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3266 = bf16[3584,3584]{0,1} aten::permute(%3265), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3267 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3268 = bf16[29,3584]{1,0} aten::mm(%3267, %3266), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3269 = bf16[1,29,3584]{2,1,0} aten::view(%3268), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3270 = bf16[1,29,3584]{2,1,0} aten::add(%3269, %3264, %3263), scope=aten::add.372, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3271 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3270), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3272 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3271), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3273 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3272), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3274 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3272), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3275 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3274), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3276 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3275, %3273), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3277 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3276, %3223), scope=aten::mul.376, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3278 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3272, %3249), scope=aten::mul.375, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3279 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3278, %3277, %3262), scope=aten::add.377, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3280 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3279), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3281 = bf16[28,29,128]{2,1,0} aten::view(%3280), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3282 = bf16[28,29,29]{2,1,0} aten::matmul(%3281, %3261), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3283 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3282), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3284 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3283, %3211), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3285 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3284, %617, %3210), scope=aten::add.381, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3286 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3285), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3287 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3286), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3288 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3287), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3289 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3288), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3290 = bf16[28,29,29]{2,1,0} aten::view(%3289), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3291 = bf16[28,29,128]{2,1,0} aten::matmul(%3290, %3209), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3292 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3291), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3293 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3292), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3294 = bf16[1,29,3584]{2,1,0} aten::view(%3293), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3295 = bf16[29,3584]{1,0} aten::view(%3294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3296 = bf16[29,3584]{1,0} aten::mm(%3295, %185), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3297 = bf16[1,29,3584]{2,1,0} aten::view(%3296), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3298 = bf16[1,29,3584]{2,1,0} aten::add(%3185, %3297, %183), scope=aten::add.382, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3299 = f32[1,29,3584]{2,1,0} xla::cast(%3298), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3300 = f32[1,29,3584]{2,1,0} aten::pow(%3299, %182), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3301 = f32[1,29,1]{2,1,0} aten::mean(%3300), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3302 = f32[1,29,1]{2,1,0} aten::add(%3301, %181, %180), scope=aten::add.383, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3303 = f32[1,29,1]{2,1,0} aten::rsqrt(%3302), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3304 = f32[1,29,3584]{2,1,0} aten::mul(%3299, %3303), scope=aten::mul.384, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3305 = bf16[1,29,3584]{2,1,0} xla::cast(%3304), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3306 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3307 = bf16[1,29,3584]{2,1,0} aten::mul(%3306, %3305), scope=aten::mul.385, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3308 = bf16[29,3584]{1,0} aten::view(%3307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3309 = bf16[29,18944]{1,0} aten::mm(%3308, %179), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3310 = bf16[1,29,18944]{2,1,0} aten::view(%3309), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3311 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3312 = bf16[3584,18944]{0,1} aten::permute(%3311), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3313 = bf16[29,3584]{1,0} aten::view(%3307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3314 = bf16[29,18944]{1,0} aten::mm(%3313, %3312), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3315 = bf16[1,29,18944]{2,1,0} aten::view(%3314), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3316 = bf16[1,29,18944]{2,1,0} aten::silu(%3315), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3317 = bf16[1,29,18944]{2,1,0} aten::mul(%3316, %3310), scope=aten::mul.386, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3318 = bf16[29,18944]{1,0} aten::view(%3317), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3319 = bf16[29,3584]{1,0} aten::mm(%3318, %177), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3320 = bf16[1,29,3584]{2,1,0} aten::view(%3319), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3321 = bf16[1,29,3584]{2,1,0} aten::add(%3298, %3320, %175), scope=aten::add.387, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3322 = f32[1,29,3584]{2,1,0} xla::cast(%3321), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3323 = f32[1,29,3584]{2,1,0} aten::pow(%3322, %174), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3324 = f32[1,29,1]{2,1,0} aten::mean(%3323), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3325 = f32[1,29,1]{2,1,0} aten::add(%3324, %173, %172), scope=aten::add.388, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3326 = f32[1,29,1]{2,1,0} aten::rsqrt(%3325), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3327 = f32[1,29,3584]{2,1,0} aten::mul(%3322, %3326), scope=aten::mul.389, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3328 = bf16[1,29,3584]{2,1,0} xla::cast(%3327), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3329 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3330 = bf16[1,29,3584]{2,1,0} aten::mul(%3329, %3328), scope=aten::mul.390, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3331 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3332 = bf16[29,512]{1,0} aten::mm(%3331, %171), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3333 = bf16[1,29,512]{2,1,0} aten::view(%3332), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3334 = bf16[1,29,512]{2,1,0} aten::add(%3333, %169, %168), scope=aten::add.393, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3335 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3334), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3336 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3335), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3337 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3336), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3338 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3337), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3339 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3338), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3340 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3339), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3341 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3342 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3343 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3342), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3344 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3343), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3345 = bf16[28,29,128]{2,1,0} aten::view(%3344), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3346 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3347 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3348 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3349 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3350 = s64[1,29]{1,0} aten::expand(%3349), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3351 = s64[1,29]{1,0} aten::add(%628, %3350), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3352 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3353 = pred[1,29]{1,0} aten::lt(%628, %3352), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3354 = s64[1,29]{1,0} aten::where(%3353, %3351, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3355 = s64[1,29,1]{2,1,0} aten::stack(%3354), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3356 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3357 = bf16[29,128]{1,0} xla::select(%3356), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3358 = bf16[1,29,128]{2,1,0} aten::index(%3357, %3355), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3359 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3358), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3360 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3361 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3362 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3363 = bf16[3584,512]{0,1} aten::permute(%3362), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3364 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3365 = bf16[29,512]{1,0} aten::mm(%3364, %3363), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3366 = bf16[1,29,512]{2,1,0} aten::view(%3365), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3367 = bf16[1,29,512]{2,1,0} aten::add(%3366, %3361, %3360), scope=aten::add.392, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3368 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3367), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3369 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3368), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3370 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3369), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3371 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3369), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3372 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3371), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3373 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3372, %3370), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3374 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3373, %3359), scope=aten::mul.398, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3375 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3376 = s64[1,29]{1,0} aten::expand(%3375), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3377 = s64[1,29]{1,0} aten::add(%628, %3376), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3378 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3379 = pred[1,29]{1,0} aten::lt(%628, %3378), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3380 = s64[1,29]{1,0} aten::where(%3379, %3377, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3381 = s64[1,29,1]{2,1,0} aten::stack(%3380), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3382 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3383 = bf16[29,128]{1,0} xla::select(%3382), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3384 = bf16[1,29,128]{2,1,0} aten::index(%3383, %3381), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3385 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3384), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3386 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3369, %3385), scope=aten::mul.397, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3387 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3386, %3374, %3348), scope=aten::add.399, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3388 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3387), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3389 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3390 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3391 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3390), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3392 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3391), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3393 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3392), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3394 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3393), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3395 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3394), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3396 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3395), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3397 = bf16[28,128,29]{2,1,0} aten::view(%3396), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3398 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3399 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3400 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3401 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3402 = bf16[3584,3584]{0,1} aten::permute(%3401), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3403 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3404 = bf16[29,3584]{1,0} aten::mm(%3403, %3402), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3405 = bf16[1,29,3584]{2,1,0} aten::view(%3404), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3406 = bf16[1,29,3584]{2,1,0} aten::add(%3405, %3400, %3399), scope=aten::add.391, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3407 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3406), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3408 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3407), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3409 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3408), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3410 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3408), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3411 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3410), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3412 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3411, %3409), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3413 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3412, %3359), scope=aten::mul.395, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3414 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3408, %3385), scope=aten::mul.394, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3415 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3414, %3413, %3398), scope=aten::add.396, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3416 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3415), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3417 = bf16[28,29,128]{2,1,0} aten::view(%3416), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3418 = bf16[28,29,29]{2,1,0} aten::matmul(%3417, %3397), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3419 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3418), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3420 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3419, %3347), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3421 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3420, %617, %3346), scope=aten::add.400, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3422 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3421), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3423 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3422), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3424 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3423), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3425 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3424), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3426 = bf16[28,29,29]{2,1,0} aten::view(%3425), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3427 = bf16[28,29,128]{2,1,0} aten::matmul(%3426, %3345), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3428 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3427), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3429 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3428), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3430 = bf16[1,29,3584]{2,1,0} aten::view(%3429), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3431 = bf16[29,3584]{1,0} aten::view(%3430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3432 = bf16[29,3584]{1,0} aten::mm(%3431, %167), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3433 = bf16[1,29,3584]{2,1,0} aten::view(%3432), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3434 = bf16[1,29,3584]{2,1,0} aten::add(%3321, %3433, %165), scope=aten::add.401, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3435 = f32[1,29,3584]{2,1,0} xla::cast(%3434), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3436 = f32[1,29,3584]{2,1,0} aten::pow(%3435, %164), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3437 = f32[1,29,1]{2,1,0} aten::mean(%3436), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3438 = f32[1,29,1]{2,1,0} aten::add(%3437, %163, %162), scope=aten::add.402, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3439 = f32[1,29,1]{2,1,0} aten::rsqrt(%3438), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3440 = f32[1,29,3584]{2,1,0} aten::mul(%3435, %3439), scope=aten::mul.403, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3441 = bf16[1,29,3584]{2,1,0} xla::cast(%3440), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3442 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3443 = bf16[1,29,3584]{2,1,0} aten::mul(%3442, %3441), scope=aten::mul.404, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3444 = bf16[29,3584]{1,0} aten::view(%3443), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3445 = bf16[29,18944]{1,0} aten::mm(%3444, %161), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3446 = bf16[1,29,18944]{2,1,0} aten::view(%3445), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3447 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3448 = bf16[3584,18944]{0,1} aten::permute(%3447), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3449 = bf16[29,3584]{1,0} aten::view(%3443), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3450 = bf16[29,18944]{1,0} aten::mm(%3449, %3448), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3451 = bf16[1,29,18944]{2,1,0} aten::view(%3450), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3452 = bf16[1,29,18944]{2,1,0} aten::silu(%3451), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3453 = bf16[1,29,18944]{2,1,0} aten::mul(%3452, %3446), scope=aten::mul.405, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3454 = bf16[29,18944]{1,0} aten::view(%3453), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3455 = bf16[29,3584]{1,0} aten::mm(%3454, %159), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3456 = bf16[1,29,3584]{2,1,0} aten::view(%3455), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3457 = bf16[1,29,3584]{2,1,0} aten::add(%3434, %3456, %157), scope=aten::add.406, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3458 = f32[1,29,3584]{2,1,0} xla::cast(%3457), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3459 = f32[1,29,3584]{2,1,0} aten::pow(%3458, %156), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3460 = f32[1,29,1]{2,1,0} aten::mean(%3459), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3461 = f32[1,29,1]{2,1,0} aten::add(%3460, %155, %154), scope=aten::add.407, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3462 = f32[1,29,1]{2,1,0} aten::rsqrt(%3461), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3463 = f32[1,29,3584]{2,1,0} aten::mul(%3458, %3462), scope=aten::mul.408, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3464 = bf16[1,29,3584]{2,1,0} xla::cast(%3463), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3465 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3466 = bf16[1,29,3584]{2,1,0} aten::mul(%3465, %3464), scope=aten::mul.409, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3467 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3468 = bf16[29,512]{1,0} aten::mm(%3467, %153), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3469 = bf16[1,29,512]{2,1,0} aten::view(%3468), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3470 = bf16[1,29,512]{2,1,0} aten::add(%3469, %151, %150), scope=aten::add.412, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3471 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3470), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3472 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3471), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3473 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3472), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3474 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3473), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3475 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3474), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3476 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3475), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3477 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3476), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3478 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3477), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3479 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3478), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3480 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3479), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3481 = bf16[28,29,128]{2,1,0} aten::view(%3480), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3482 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3483 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3484 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3485 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3486 = s64[1,29]{1,0} aten::expand(%3485), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3487 = s64[1,29]{1,0} aten::add(%628, %3486), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3488 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3489 = pred[1,29]{1,0} aten::lt(%628, %3488), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3490 = s64[1,29]{1,0} aten::where(%3489, %3487, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3491 = s64[1,29,1]{2,1,0} aten::stack(%3490), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3492 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3493 = bf16[29,128]{1,0} xla::select(%3492), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3494 = bf16[1,29,128]{2,1,0} aten::index(%3493, %3491), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3495 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3494), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3496 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3497 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3498 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3499 = bf16[3584,512]{0,1} aten::permute(%3498), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3500 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3501 = bf16[29,512]{1,0} aten::mm(%3500, %3499), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3502 = bf16[1,29,512]{2,1,0} aten::view(%3501), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3503 = bf16[1,29,512]{2,1,0} aten::add(%3502, %3497, %3496), scope=aten::add.411, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3504 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3503), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3505 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3504), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3506 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3505), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3507 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3505), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3508 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3507), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3509 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3508, %3506), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3510 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3509, %3495), scope=aten::mul.417, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3511 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3512 = s64[1,29]{1,0} aten::expand(%3511), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3513 = s64[1,29]{1,0} aten::add(%628, %3512), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3514 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3515 = pred[1,29]{1,0} aten::lt(%628, %3514), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3516 = s64[1,29]{1,0} aten::where(%3515, %3513, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3517 = s64[1,29,1]{2,1,0} aten::stack(%3516), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3518 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3519 = bf16[29,128]{1,0} xla::select(%3518), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3520 = bf16[1,29,128]{2,1,0} aten::index(%3519, %3517), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3521 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3520), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3522 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3505, %3521), scope=aten::mul.416, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3523 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3522, %3510, %3484), scope=aten::add.418, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3524 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3523), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3525 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3526 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3527 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3526), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3528 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3527), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3529 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3528), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3530 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3529), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3531 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3530), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3532 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3531), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3533 = bf16[28,128,29]{2,1,0} aten::view(%3532), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3534 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3535 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3536 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3537 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3538 = bf16[3584,3584]{0,1} aten::permute(%3537), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3539 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3540 = bf16[29,3584]{1,0} aten::mm(%3539, %3538), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3541 = bf16[1,29,3584]{2,1,0} aten::view(%3540), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3542 = bf16[1,29,3584]{2,1,0} aten::add(%3541, %3536, %3535), scope=aten::add.410, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3543 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3542), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3544 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3543), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3545 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3544), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3546 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3544), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3547 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3546), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3548 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3547, %3545), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3549 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3548, %3495), scope=aten::mul.414, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3550 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3544, %3521), scope=aten::mul.413, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3551 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3550, %3549, %3534), scope=aten::add.415, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3552 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3551), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3553 = bf16[28,29,128]{2,1,0} aten::view(%3552), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3554 = bf16[28,29,29]{2,1,0} aten::matmul(%3553, %3533), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3555 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3554), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3556 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3555, %3483), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3557 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3556, %617, %3482), scope=aten::add.419, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3558 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3557), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3559 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3558), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3560 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3559), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3561 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3560), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3562 = bf16[28,29,29]{2,1,0} aten::view(%3561), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3563 = bf16[28,29,128]{2,1,0} aten::matmul(%3562, %3481), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3564 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3563), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3565 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3564), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3566 = bf16[1,29,3584]{2,1,0} aten::view(%3565), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3567 = bf16[29,3584]{1,0} aten::view(%3566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3568 = bf16[29,3584]{1,0} aten::mm(%3567, %149), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3569 = bf16[1,29,3584]{2,1,0} aten::view(%3568), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3570 = bf16[1,29,3584]{2,1,0} aten::add(%3457, %3569, %147), scope=aten::add.420, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3571 = f32[1,29,3584]{2,1,0} xla::cast(%3570), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3572 = f32[1,29,3584]{2,1,0} aten::pow(%3571, %146), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3573 = f32[1,29,1]{2,1,0} aten::mean(%3572), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3574 = f32[1,29,1]{2,1,0} aten::add(%3573, %145, %144), scope=aten::add.421, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3575 = f32[1,29,1]{2,1,0} aten::rsqrt(%3574), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3576 = f32[1,29,3584]{2,1,0} aten::mul(%3571, %3575), scope=aten::mul.422, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3577 = bf16[1,29,3584]{2,1,0} xla::cast(%3576), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3578 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3579 = bf16[1,29,3584]{2,1,0} aten::mul(%3578, %3577), scope=aten::mul.423, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3580 = bf16[29,3584]{1,0} aten::view(%3579), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3581 = bf16[29,18944]{1,0} aten::mm(%3580, %143), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3582 = bf16[1,29,18944]{2,1,0} aten::view(%3581), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3583 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3584 = bf16[3584,18944]{0,1} aten::permute(%3583), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3585 = bf16[29,3584]{1,0} aten::view(%3579), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3586 = bf16[29,18944]{1,0} aten::mm(%3585, %3584), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3587 = bf16[1,29,18944]{2,1,0} aten::view(%3586), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3588 = bf16[1,29,18944]{2,1,0} aten::silu(%3587), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3589 = bf16[1,29,18944]{2,1,0} aten::mul(%3588, %3582), scope=aten::mul.424, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3590 = bf16[29,18944]{1,0} aten::view(%3589), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3591 = bf16[29,3584]{1,0} aten::mm(%3590, %141), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3592 = bf16[1,29,3584]{2,1,0} aten::view(%3591), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3593 = bf16[1,29,3584]{2,1,0} aten::add(%3570, %3592, %139), scope=aten::add.425, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3594 = f32[1,29,3584]{2,1,0} xla::cast(%3593), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3595 = f32[1,29,3584]{2,1,0} aten::pow(%3594, %138), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3596 = f32[1,29,1]{2,1,0} aten::mean(%3595), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3597 = f32[1,29,1]{2,1,0} aten::add(%3596, %137, %136), scope=aten::add.426, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3598 = f32[1,29,1]{2,1,0} aten::rsqrt(%3597), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3599 = f32[1,29,3584]{2,1,0} aten::mul(%3594, %3598), scope=aten::mul.427, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3600 = bf16[1,29,3584]{2,1,0} xla::cast(%3599), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3601 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3602 = bf16[1,29,3584]{2,1,0} aten::mul(%3601, %3600), scope=aten::mul.428, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3603 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3604 = bf16[29,512]{1,0} aten::mm(%3603, %135), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3605 = bf16[1,29,512]{2,1,0} aten::view(%3604), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3606 = bf16[1,29,512]{2,1,0} aten::add(%3605, %133, %132), scope=aten::add.431, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3607 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3606), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3608 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3607), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3609 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3608), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3610 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3609), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3611 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3610), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3612 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3611), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3613 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3612), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3614 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3613), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3615 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3614), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3616 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3615), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3617 = bf16[28,29,128]{2,1,0} aten::view(%3616), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3618 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3619 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3620 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3621 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3622 = s64[1,29]{1,0} aten::expand(%3621), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3623 = s64[1,29]{1,0} aten::add(%628, %3622), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3624 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3625 = pred[1,29]{1,0} aten::lt(%628, %3624), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3626 = s64[1,29]{1,0} aten::where(%3625, %3623, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3627 = s64[1,29,1]{2,1,0} aten::stack(%3626), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3628 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3629 = bf16[29,128]{1,0} xla::select(%3628), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3630 = bf16[1,29,128]{2,1,0} aten::index(%3629, %3627), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3631 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3632 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3633 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3634 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3635 = bf16[3584,512]{0,1} aten::permute(%3634), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3636 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3637 = bf16[29,512]{1,0} aten::mm(%3636, %3635), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3638 = bf16[1,29,512]{2,1,0} aten::view(%3637), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3639 = bf16[1,29,512]{2,1,0} aten::add(%3638, %3633, %3632), scope=aten::add.430, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3640 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3639), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3641 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3640), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3642 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3641), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3643 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3641), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3644 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3643), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3645 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3644, %3642), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3646 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3645, %3631), scope=aten::mul.436, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3647 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3648 = s64[1,29]{1,0} aten::expand(%3647), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3649 = s64[1,29]{1,0} aten::add(%628, %3648), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3650 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3651 = pred[1,29]{1,0} aten::lt(%628, %3650), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3652 = s64[1,29]{1,0} aten::where(%3651, %3649, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3653 = s64[1,29,1]{2,1,0} aten::stack(%3652), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3654 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3655 = bf16[29,128]{1,0} xla::select(%3654), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3656 = bf16[1,29,128]{2,1,0} aten::index(%3655, %3653), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3657 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3658 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3641, %3657), scope=aten::mul.435, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3659 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3658, %3646, %3620), scope=aten::add.437, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3660 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3659), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3661 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3662 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3663 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3662), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3664 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3663), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3665 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3664), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3666 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3665), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3667 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3666), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3668 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3667), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3669 = bf16[28,128,29]{2,1,0} aten::view(%3668), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3670 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3671 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3672 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3673 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3674 = bf16[3584,3584]{0,1} aten::permute(%3673), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3675 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3676 = bf16[29,3584]{1,0} aten::mm(%3675, %3674), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3677 = bf16[1,29,3584]{2,1,0} aten::view(%3676), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3678 = bf16[1,29,3584]{2,1,0} aten::add(%3677, %3672, %3671), scope=aten::add.429, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3679 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3678), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3680 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3679), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3681 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3680), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3682 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3680), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3683 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3682), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3684 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3683, %3681), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3685 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3684, %3631), scope=aten::mul.433, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3686 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3680, %3657), scope=aten::mul.432, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3687 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3686, %3685, %3670), scope=aten::add.434, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3688 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3687), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3689 = bf16[28,29,128]{2,1,0} aten::view(%3688), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3690 = bf16[28,29,29]{2,1,0} aten::matmul(%3689, %3669), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3691 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3690), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3692 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3691, %3619), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3693 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3692, %617, %3618), scope=aten::add.438, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3694 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3693), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3695 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3694), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3696 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3695), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3697 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3696), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3698 = bf16[28,29,29]{2,1,0} aten::view(%3697), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3699 = bf16[28,29,128]{2,1,0} aten::matmul(%3698, %3617), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3700 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3699), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3701 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3700), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3702 = bf16[1,29,3584]{2,1,0} aten::view(%3701), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3703 = bf16[29,3584]{1,0} aten::view(%3702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3704 = bf16[29,3584]{1,0} aten::mm(%3703, %131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3705 = bf16[1,29,3584]{2,1,0} aten::view(%3704), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3706 = bf16[1,29,3584]{2,1,0} aten::add(%3593, %3705, %129), scope=aten::add.439, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3707 = f32[1,29,3584]{2,1,0} xla::cast(%3706), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3708 = f32[1,29,3584]{2,1,0} aten::pow(%3707, %128), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3709 = f32[1,29,1]{2,1,0} aten::mean(%3708), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3710 = f32[1,29,1]{2,1,0} aten::add(%3709, %127, %126), scope=aten::add.440, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3711 = f32[1,29,1]{2,1,0} aten::rsqrt(%3710), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3712 = f32[1,29,3584]{2,1,0} aten::mul(%3707, %3711), scope=aten::mul.441, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3713 = bf16[1,29,3584]{2,1,0} xla::cast(%3712), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3714 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3715 = bf16[1,29,3584]{2,1,0} aten::mul(%3714, %3713), scope=aten::mul.442, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3716 = bf16[29,3584]{1,0} aten::view(%3715), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3717 = bf16[29,18944]{1,0} aten::mm(%3716, %125), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3718 = bf16[1,29,18944]{2,1,0} aten::view(%3717), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3719 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3720 = bf16[3584,18944]{0,1} aten::permute(%3719), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3721 = bf16[29,3584]{1,0} aten::view(%3715), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3722 = bf16[29,18944]{1,0} aten::mm(%3721, %3720), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3723 = bf16[1,29,18944]{2,1,0} aten::view(%3722), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3724 = bf16[1,29,18944]{2,1,0} aten::silu(%3723), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3725 = bf16[1,29,18944]{2,1,0} aten::mul(%3724, %3718), scope=aten::mul.443, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3726 = bf16[29,18944]{1,0} aten::view(%3725), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3727 = bf16[29,3584]{1,0} aten::mm(%3726, %123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3728 = bf16[1,29,3584]{2,1,0} aten::view(%3727), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3729 = bf16[1,29,3584]{2,1,0} aten::add(%3706, %3728, %121), scope=aten::add.444, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3730 = f32[1,29,3584]{2,1,0} xla::cast(%3729), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3731 = f32[1,29,3584]{2,1,0} aten::pow(%3730, %120), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3732 = f32[1,29,1]{2,1,0} aten::mean(%3731), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3733 = f32[1,29,1]{2,1,0} aten::add(%3732, %119, %118), scope=aten::add.445, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3734 = f32[1,29,1]{2,1,0} aten::rsqrt(%3733), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3735 = f32[1,29,3584]{2,1,0} aten::mul(%3730, %3734), scope=aten::mul.446, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3736 = bf16[1,29,3584]{2,1,0} xla::cast(%3735), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3737 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3738 = bf16[1,29,3584]{2,1,0} aten::mul(%3737, %3736), scope=aten::mul.447, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3739 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3740 = bf16[29,512]{1,0} aten::mm(%3739, %117), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3741 = bf16[1,29,512]{2,1,0} aten::view(%3740), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3742 = bf16[1,29,512]{2,1,0} aten::add(%3741, %115, %114), scope=aten::add.450, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3743 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3742), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3744 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3743), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3745 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3744), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3746 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3745), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3747 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3746), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3748 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3747), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3749 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3748), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3750 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3749), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3751 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3750), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3752 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3751), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3753 = bf16[28,29,128]{2,1,0} aten::view(%3752), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3754 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3755 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3756 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3757 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3758 = s64[1,29]{1,0} aten::expand(%3757), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3759 = s64[1,29]{1,0} aten::add(%628, %3758), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3760 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3761 = pred[1,29]{1,0} aten::lt(%628, %3760), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3762 = s64[1,29]{1,0} aten::where(%3761, %3759, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3763 = s64[1,29,1]{2,1,0} aten::stack(%3762), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3764 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3765 = bf16[29,128]{1,0} xla::select(%3764), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3766 = bf16[1,29,128]{2,1,0} aten::index(%3765, %3763), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3767 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3768 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3769 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3770 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3771 = bf16[3584,512]{0,1} aten::permute(%3770), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3772 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3773 = bf16[29,512]{1,0} aten::mm(%3772, %3771), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3774 = bf16[1,29,512]{2,1,0} aten::view(%3773), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3775 = bf16[1,29,512]{2,1,0} aten::add(%3774, %3769, %3768), scope=aten::add.449, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3776 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3775), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3777 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3776), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3778 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3777), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3779 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3777), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3780 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3779), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3781 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3780, %3778), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3782 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3781, %3767), scope=aten::mul.455, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3783 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3784 = s64[1,29]{1,0} aten::expand(%3783), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3785 = s64[1,29]{1,0} aten::add(%628, %3784), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3786 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3787 = pred[1,29]{1,0} aten::lt(%628, %3786), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3788 = s64[1,29]{1,0} aten::where(%3787, %3785, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3789 = s64[1,29,1]{2,1,0} aten::stack(%3788), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3790 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3791 = bf16[29,128]{1,0} xla::select(%3790), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3792 = bf16[1,29,128]{2,1,0} aten::index(%3791, %3789), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3793 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3794 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3777, %3793), scope=aten::mul.454, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3795 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3794, %3782, %3756), scope=aten::add.456, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3796 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3795), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3797 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3798 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3799 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3798), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3800 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3799), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3801 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3800), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3802 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3801), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3803 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3802), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3804 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3803), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3805 = bf16[28,128,29]{2,1,0} aten::view(%3804), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3806 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3807 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3808 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3809 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3810 = bf16[3584,3584]{0,1} aten::permute(%3809), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3811 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3812 = bf16[29,3584]{1,0} aten::mm(%3811, %3810), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3813 = bf16[1,29,3584]{2,1,0} aten::view(%3812), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3814 = bf16[1,29,3584]{2,1,0} aten::add(%3813, %3808, %3807), scope=aten::add.448, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3815 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3814), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3816 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3815), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3817 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3816), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3818 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3816), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3819 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3818), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3820 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3819, %3817), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3821 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3820, %3767), scope=aten::mul.452, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3822 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3816, %3793), scope=aten::mul.451, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3823 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3822, %3821, %3806), scope=aten::add.453, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3824 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3823), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3825 = bf16[28,29,128]{2,1,0} aten::view(%3824), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3826 = bf16[28,29,29]{2,1,0} aten::matmul(%3825, %3805), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3827 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3826), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3828 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3827, %3755), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3829 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3828, %617, %3754), scope=aten::add.457, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3830 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3829), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3831 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3830), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3832 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3831), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3833 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3832), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3834 = bf16[28,29,29]{2,1,0} aten::view(%3833), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3835 = bf16[28,29,128]{2,1,0} aten::matmul(%3834, %3753), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3836 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3835), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3837 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3836), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3838 = bf16[1,29,3584]{2,1,0} aten::view(%3837), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3839 = bf16[29,3584]{1,0} aten::view(%3838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3840 = bf16[29,3584]{1,0} aten::mm(%3839, %113), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3841 = bf16[1,29,3584]{2,1,0} aten::view(%3840), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3842 = bf16[1,29,3584]{2,1,0} aten::add(%3729, %3841, %111), scope=aten::add.458, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3843 = f32[1,29,3584]{2,1,0} xla::cast(%3842), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3844 = f32[1,29,3584]{2,1,0} aten::pow(%3843, %110), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3845 = f32[1,29,1]{2,1,0} aten::mean(%3844), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3846 = f32[1,29,1]{2,1,0} aten::add(%3845, %109, %108), scope=aten::add.459, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3847 = f32[1,29,1]{2,1,0} aten::rsqrt(%3846), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3848 = f32[1,29,3584]{2,1,0} aten::mul(%3843, %3847), scope=aten::mul.460, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3849 = bf16[1,29,3584]{2,1,0} xla::cast(%3848), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3850 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3851 = bf16[1,29,3584]{2,1,0} aten::mul(%3850, %3849), scope=aten::mul.461, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3852 = bf16[29,3584]{1,0} aten::view(%3851), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3853 = bf16[29,18944]{1,0} aten::mm(%3852, %107), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3854 = bf16[1,29,18944]{2,1,0} aten::view(%3853), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3855 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3856 = bf16[3584,18944]{0,1} aten::permute(%3855), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3857 = bf16[29,3584]{1,0} aten::view(%3851), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3858 = bf16[29,18944]{1,0} aten::mm(%3857, %3856), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3859 = bf16[1,29,18944]{2,1,0} aten::view(%3858), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3860 = bf16[1,29,18944]{2,1,0} aten::silu(%3859), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3861 = bf16[1,29,18944]{2,1,0} aten::mul(%3860, %3854), scope=aten::mul.462, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3862 = bf16[29,18944]{1,0} aten::view(%3861), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3863 = bf16[29,3584]{1,0} aten::mm(%3862, %105), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3864 = bf16[1,29,3584]{2,1,0} aten::view(%3863), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3865 = bf16[1,29,3584]{2,1,0} aten::add(%3842, %3864, %103), scope=aten::add.463, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3866 = f32[1,29,3584]{2,1,0} xla::cast(%3865), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3867 = f32[1,29,3584]{2,1,0} aten::pow(%3866, %102), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3868 = f32[1,29,1]{2,1,0} aten::mean(%3867), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3869 = f32[1,29,1]{2,1,0} aten::add(%3868, %101, %100), scope=aten::add.464, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3870 = f32[1,29,1]{2,1,0} aten::rsqrt(%3869), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3871 = f32[1,29,3584]{2,1,0} aten::mul(%3866, %3870), scope=aten::mul.465, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3872 = bf16[1,29,3584]{2,1,0} xla::cast(%3871), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3873 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3874 = bf16[1,29,3584]{2,1,0} aten::mul(%3873, %3872), scope=aten::mul.466, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3875 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3876 = bf16[29,512]{1,0} aten::mm(%3875, %99), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3877 = bf16[1,29,512]{2,1,0} aten::view(%3876), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3878 = bf16[1,29,512]{2,1,0} aten::add(%3877, %97, %96), scope=aten::add.469, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3879 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3878), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3880 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3879), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3881 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3880), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3882 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3881), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3883 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3882), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3884 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3883), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3885 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3884), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3886 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3885), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3887 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3886), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3888 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3887), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3889 = bf16[28,29,128]{2,1,0} aten::view(%3888), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3890 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3891 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3892 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3893 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3894 = s64[1,29]{1,0} aten::expand(%3893), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3895 = s64[1,29]{1,0} aten::add(%628, %3894), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3896 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3897 = pred[1,29]{1,0} aten::lt(%628, %3896), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3898 = s64[1,29]{1,0} aten::where(%3897, %3895, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3899 = s64[1,29,1]{2,1,0} aten::stack(%3898), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3900 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3901 = bf16[29,128]{1,0} xla::select(%3900), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3902 = bf16[1,29,128]{2,1,0} aten::index(%3901, %3899), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3903 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3904 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3905 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3906 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3907 = bf16[3584,512]{0,1} aten::permute(%3906), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3908 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3909 = bf16[29,512]{1,0} aten::mm(%3908, %3907), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3910 = bf16[1,29,512]{2,1,0} aten::view(%3909), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3911 = bf16[1,29,512]{2,1,0} aten::add(%3910, %3905, %3904), scope=aten::add.468, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3912 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3911), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3913 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3912), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3914 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3913), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3915 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3913), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3916 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3915), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3917 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3916, %3914), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3918 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3917, %3903), scope=aten::mul.474, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3919 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3920 = s64[1,29]{1,0} aten::expand(%3919), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3921 = s64[1,29]{1,0} aten::add(%628, %3920), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3922 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3923 = pred[1,29]{1,0} aten::lt(%628, %3922), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3924 = s64[1,29]{1,0} aten::where(%3923, %3921, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3925 = s64[1,29,1]{2,1,0} aten::stack(%3924), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3926 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3927 = bf16[29,128]{1,0} xla::select(%3926), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3928 = bf16[1,29,128]{2,1,0} aten::index(%3927, %3925), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3929 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3930 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3913, %3929), scope=aten::mul.473, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3931 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3930, %3918, %3892), scope=aten::add.475, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3932 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3931), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3933 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3934 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3935 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3934), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3936 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3935), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3937 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3936), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3938 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3937), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3939 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3938), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3940 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3939), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3941 = bf16[28,128,29]{2,1,0} aten::view(%3940), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3942 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3943 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3944 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3945 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3946 = bf16[3584,3584]{0,1} aten::permute(%3945), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3947 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3948 = bf16[29,3584]{1,0} aten::mm(%3947, %3946), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3949 = bf16[1,29,3584]{2,1,0} aten::view(%3948), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3950 = bf16[1,29,3584]{2,1,0} aten::add(%3949, %3944, %3943), scope=aten::add.467, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3951 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3950), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3952 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3951), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3953 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3952), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3954 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3952), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3955 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3954), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3956 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3955, %3953), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3957 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3956, %3903), scope=aten::mul.471, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3958 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3952, %3929), scope=aten::mul.470, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3959 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3958, %3957, %3942), scope=aten::add.472, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3960 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3959), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3961 = bf16[28,29,128]{2,1,0} aten::view(%3960), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3962 = bf16[28,29,29]{2,1,0} aten::matmul(%3961, %3941), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3963 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3962), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3964 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3963, %3891), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3965 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3964, %617, %3890), scope=aten::add.476, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3966 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3965), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3967 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3966), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3968 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3967), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3969 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3968), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3970 = bf16[28,29,29]{2,1,0} aten::view(%3969), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3971 = bf16[28,29,128]{2,1,0} aten::matmul(%3970, %3889), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3972 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3971), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3973 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3972), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3974 = bf16[1,29,3584]{2,1,0} aten::view(%3973), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3975 = bf16[29,3584]{1,0} aten::view(%3974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3976 = bf16[29,3584]{1,0} aten::mm(%3975, %95), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3977 = bf16[1,29,3584]{2,1,0} aten::view(%3976), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3978 = bf16[1,29,3584]{2,1,0} aten::add(%3865, %3977, %93), scope=aten::add.477, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3979 = f32[1,29,3584]{2,1,0} xla::cast(%3978), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3980 = f32[1,29,3584]{2,1,0} aten::pow(%3979, %92), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3981 = f32[1,29,1]{2,1,0} aten::mean(%3980), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3982 = f32[1,29,1]{2,1,0} aten::add(%3981, %91, %90), scope=aten::add.478, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3983 = f32[1,29,1]{2,1,0} aten::rsqrt(%3982), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3984 = f32[1,29,3584]{2,1,0} aten::mul(%3979, %3983), scope=aten::mul.479, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3985 = bf16[1,29,3584]{2,1,0} xla::cast(%3984), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3986 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3987 = bf16[1,29,3584]{2,1,0} aten::mul(%3986, %3985), scope=aten::mul.480, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3988 = bf16[29,3584]{1,0} aten::view(%3987), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3989 = bf16[29,18944]{1,0} aten::mm(%3988, %89), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3990 = bf16[1,29,18944]{2,1,0} aten::view(%3989), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3991 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3992 = bf16[3584,18944]{0,1} aten::permute(%3991), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3993 = bf16[29,3584]{1,0} aten::view(%3987), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3994 = bf16[29,18944]{1,0} aten::mm(%3993, %3992), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3995 = bf16[1,29,18944]{2,1,0} aten::view(%3994), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3996 = bf16[1,29,18944]{2,1,0} aten::silu(%3995), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3997 = bf16[1,29,18944]{2,1,0} aten::mul(%3996, %3990), scope=aten::mul.481, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3998 = bf16[29,18944]{1,0} aten::view(%3997), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3999 = bf16[29,3584]{1,0} aten::mm(%3998, %87), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4000 = bf16[1,29,3584]{2,1,0} aten::view(%3999), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4001 = bf16[1,29,3584]{2,1,0} aten::add(%3978, %4000, %85), scope=aten::add.482, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4002 = f32[1,29,3584]{2,1,0} xla::cast(%4001), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4003 = f32[1,29,3584]{2,1,0} aten::pow(%4002, %84), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4004 = f32[1,29,1]{2,1,0} aten::mean(%4003), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4005 = f32[1,29,1]{2,1,0} aten::add(%4004, %83, %82), scope=aten::add.483, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4006 = f32[1,29,1]{2,1,0} aten::rsqrt(%4005), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4007 = f32[1,29,3584]{2,1,0} aten::mul(%4002, %4006), scope=aten::mul.484, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4008 = bf16[1,29,3584]{2,1,0} xla::cast(%4007), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4009 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4010 = bf16[1,29,3584]{2,1,0} aten::mul(%4009, %4008), scope=aten::mul.485, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4011 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4012 = bf16[29,512]{1,0} aten::mm(%4011, %81), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4013 = bf16[1,29,512]{2,1,0} aten::view(%4012), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4014 = bf16[1,29,512]{2,1,0} aten::add(%4013, %79, %78), scope=aten::add.488, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4015 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4014), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4016 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4015), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4017 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4016), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4018 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4017), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4019 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4018), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4020 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4019), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4021 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4020), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4022 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4021), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4023 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4022), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4024 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4023), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4025 = bf16[28,29,128]{2,1,0} aten::view(%4024), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4026 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4027 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4028 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4029 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4030 = s64[1,29]{1,0} aten::expand(%4029), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4031 = s64[1,29]{1,0} aten::add(%628, %4030), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4032 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4033 = pred[1,29]{1,0} aten::lt(%628, %4032), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4034 = s64[1,29]{1,0} aten::where(%4033, %4031, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4035 = s64[1,29,1]{2,1,0} aten::stack(%4034), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4036 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4037 = bf16[29,128]{1,0} xla::select(%4036), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4038 = bf16[1,29,128]{2,1,0} aten::index(%4037, %4035), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4039 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4040 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4041 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4042 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4043 = bf16[3584,512]{0,1} aten::permute(%4042), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4044 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4045 = bf16[29,512]{1,0} aten::mm(%4044, %4043), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4046 = bf16[1,29,512]{2,1,0} aten::view(%4045), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4047 = bf16[1,29,512]{2,1,0} aten::add(%4046, %4041, %4040), scope=aten::add.487, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4048 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4047), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4049 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4048), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4050 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4049), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4051 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4049), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4052 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4051), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4053 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4052, %4050), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4054 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4053, %4039), scope=aten::mul.493, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4055 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4056 = s64[1,29]{1,0} aten::expand(%4055), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4057 = s64[1,29]{1,0} aten::add(%628, %4056), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4058 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4059 = pred[1,29]{1,0} aten::lt(%628, %4058), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4060 = s64[1,29]{1,0} aten::where(%4059, %4057, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4061 = s64[1,29,1]{2,1,0} aten::stack(%4060), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4062 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4063 = bf16[29,128]{1,0} xla::select(%4062), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4064 = bf16[1,29,128]{2,1,0} aten::index(%4063, %4061), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4065 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4066 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4049, %4065), scope=aten::mul.492, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4067 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4066, %4054, %4028), scope=aten::add.494, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4068 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4067), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4069 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4070 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4071 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4070), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4072 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4071), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4073 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4072), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4074 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4073), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4075 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4074), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4076 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4075), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4077 = bf16[28,128,29]{2,1,0} aten::view(%4076), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4078 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4079 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4080 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4081 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4082 = bf16[3584,3584]{0,1} aten::permute(%4081), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4083 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4084 = bf16[29,3584]{1,0} aten::mm(%4083, %4082), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4085 = bf16[1,29,3584]{2,1,0} aten::view(%4084), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4086 = bf16[1,29,3584]{2,1,0} aten::add(%4085, %4080, %4079), scope=aten::add.486, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4087 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4086), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4088 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4087), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4089 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4088), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4090 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4088), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4091 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4090), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4092 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4091, %4089), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4093 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4092, %4039), scope=aten::mul.490, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4094 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4088, %4065), scope=aten::mul.489, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4095 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4094, %4093, %4078), scope=aten::add.491, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4096 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4095), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4097 = bf16[28,29,128]{2,1,0} aten::view(%4096), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4098 = bf16[28,29,29]{2,1,0} aten::matmul(%4097, %4077), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4099 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4098), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4100 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4099, %4027), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4101 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4100, %617, %4026), scope=aten::add.495, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4102 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4101), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4103 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4102), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4104 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4103), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4105 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4104), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4106 = bf16[28,29,29]{2,1,0} aten::view(%4105), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4107 = bf16[28,29,128]{2,1,0} aten::matmul(%4106, %4025), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4108 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4107), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4109 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4108), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4110 = bf16[1,29,3584]{2,1,0} aten::view(%4109), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4111 = bf16[29,3584]{1,0} aten::view(%4110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4112 = bf16[29,3584]{1,0} aten::mm(%4111, %77), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4113 = bf16[1,29,3584]{2,1,0} aten::view(%4112), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4114 = bf16[1,29,3584]{2,1,0} aten::add(%4001, %4113, %75), scope=aten::add.496, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4115 = f32[1,29,3584]{2,1,0} xla::cast(%4114), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4116 = f32[1,29,3584]{2,1,0} aten::pow(%4115, %74), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4117 = f32[1,29,1]{2,1,0} aten::mean(%4116), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4118 = f32[1,29,1]{2,1,0} aten::add(%4117, %73, %72), scope=aten::add.497, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4119 = f32[1,29,1]{2,1,0} aten::rsqrt(%4118), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4120 = f32[1,29,3584]{2,1,0} aten::mul(%4115, %4119), scope=aten::mul.498, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4121 = bf16[1,29,3584]{2,1,0} xla::cast(%4120), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4122 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4123 = bf16[1,29,3584]{2,1,0} aten::mul(%4122, %4121), scope=aten::mul.499, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4124 = bf16[29,3584]{1,0} aten::view(%4123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4125 = bf16[29,18944]{1,0} aten::mm(%4124, %71), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4126 = bf16[1,29,18944]{2,1,0} aten::view(%4125), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4127 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4128 = bf16[3584,18944]{0,1} aten::permute(%4127), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4129 = bf16[29,3584]{1,0} aten::view(%4123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4130 = bf16[29,18944]{1,0} aten::mm(%4129, %4128), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4131 = bf16[1,29,18944]{2,1,0} aten::view(%4130), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4132 = bf16[1,29,18944]{2,1,0} aten::silu(%4131), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4133 = bf16[1,29,18944]{2,1,0} aten::mul(%4132, %4126), scope=aten::mul.500, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4134 = bf16[29,18944]{1,0} aten::view(%4133), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4135 = bf16[29,3584]{1,0} aten::mm(%4134, %69), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4136 = bf16[1,29,3584]{2,1,0} aten::view(%4135), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4137 = bf16[1,29,3584]{2,1,0} aten::add(%4114, %4136, %67), scope=aten::add.501, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4138 = f32[1,29,3584]{2,1,0} xla::cast(%4137), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4139 = f32[1,29,3584]{2,1,0} aten::pow(%4138, %66), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4140 = f32[1,29,1]{2,1,0} aten::mean(%4139), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4141 = f32[1,29,1]{2,1,0} aten::add(%4140, %65, %64), scope=aten::add.502, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4142 = f32[1,29,1]{2,1,0} aten::rsqrt(%4141), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4143 = f32[1,29,3584]{2,1,0} aten::mul(%4138, %4142), scope=aten::mul.503, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4144 = bf16[1,29,3584]{2,1,0} xla::cast(%4143), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4145 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4146 = bf16[1,29,3584]{2,1,0} aten::mul(%4145, %4144), scope=aten::mul.504, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4147 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4148 = bf16[29,512]{1,0} aten::mm(%4147, %63), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4149 = bf16[1,29,512]{2,1,0} aten::view(%4148), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4150 = bf16[1,29,512]{2,1,0} aten::add(%4149, %61, %60), scope=aten::add.507, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4151 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4150), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4152 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4151), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4153 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4152), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4154 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4153), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4155 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4154), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4156 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4155), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4157 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4156), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4158 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4157), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4159 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4158), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4160 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4159), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4161 = bf16[28,29,128]{2,1,0} aten::view(%4160), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4162 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4163 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4164 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4165 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4166 = s64[1,29]{1,0} aten::expand(%4165), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4167 = s64[1,29]{1,0} aten::add(%628, %4166), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4168 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4169 = pred[1,29]{1,0} aten::lt(%628, %4168), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4170 = s64[1,29]{1,0} aten::where(%4169, %4167, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4171 = s64[1,29,1]{2,1,0} aten::stack(%4170), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4172 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4173 = bf16[29,128]{1,0} xla::select(%4172), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4174 = bf16[1,29,128]{2,1,0} aten::index(%4173, %4171), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4175 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4176 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4177 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4178 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4179 = bf16[3584,512]{0,1} aten::permute(%4178), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4180 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4181 = bf16[29,512]{1,0} aten::mm(%4180, %4179), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4182 = bf16[1,29,512]{2,1,0} aten::view(%4181), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4183 = bf16[1,29,512]{2,1,0} aten::add(%4182, %4177, %4176), scope=aten::add.506, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4184 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4183), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4185 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4184), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4186 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4185), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4187 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4185), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4188 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4187), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4189 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4188, %4186), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4190 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4189, %4175), scope=aten::mul.512, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4191 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4192 = s64[1,29]{1,0} aten::expand(%4191), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4193 = s64[1,29]{1,0} aten::add(%628, %4192), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4194 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4195 = pred[1,29]{1,0} aten::lt(%628, %4194), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4196 = s64[1,29]{1,0} aten::where(%4195, %4193, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4197 = s64[1,29,1]{2,1,0} aten::stack(%4196), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4198 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4199 = bf16[29,128]{1,0} xla::select(%4198), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4200 = bf16[1,29,128]{2,1,0} aten::index(%4199, %4197), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4201 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4202 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4185, %4201), scope=aten::mul.511, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4203 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4202, %4190, %4164), scope=aten::add.513, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4204 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4203), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4205 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4206 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4207 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4206), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4208 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4207), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4209 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4208), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4210 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4209), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4211 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4210), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4212 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4211), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4213 = bf16[28,128,29]{2,1,0} aten::view(%4212), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4214 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4215 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4216 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4217 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4218 = bf16[3584,3584]{0,1} aten::permute(%4217), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4219 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4220 = bf16[29,3584]{1,0} aten::mm(%4219, %4218), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4221 = bf16[1,29,3584]{2,1,0} aten::view(%4220), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4222 = bf16[1,29,3584]{2,1,0} aten::add(%4221, %4216, %4215), scope=aten::add.505, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4223 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4222), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4224 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4223), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4225 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4224), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4226 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4224), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4227 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4226), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4228 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4227, %4225), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4229 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4228, %4175), scope=aten::mul.509, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4230 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4224, %4201), scope=aten::mul.508, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4231 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4230, %4229, %4214), scope=aten::add.510, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4232 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4231), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4233 = bf16[28,29,128]{2,1,0} aten::view(%4232), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4234 = bf16[28,29,29]{2,1,0} aten::matmul(%4233, %4213), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4235 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4234), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4236 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4235, %4163), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4237 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4236, %617, %4162), scope=aten::add.514, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4238 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4237), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4239 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4238), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4240 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4239), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4241 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4240), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4242 = bf16[28,29,29]{2,1,0} aten::view(%4241), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4243 = bf16[28,29,128]{2,1,0} aten::matmul(%4242, %4161), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4244 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4243), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4245 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4244), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4246 = bf16[1,29,3584]{2,1,0} aten::view(%4245), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4247 = bf16[29,3584]{1,0} aten::view(%4246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4248 = bf16[29,3584]{1,0} aten::mm(%4247, %59), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4249 = bf16[1,29,3584]{2,1,0} aten::view(%4248), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4250 = bf16[1,29,3584]{2,1,0} aten::add(%4137, %4249, %57), scope=aten::add.515, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4251 = f32[1,29,3584]{2,1,0} xla::cast(%4250), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4252 = f32[1,29,3584]{2,1,0} aten::pow(%4251, %56), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4253 = f32[1,29,1]{2,1,0} aten::mean(%4252), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4254 = f32[1,29,1]{2,1,0} aten::add(%4253, %55, %54), scope=aten::add.516, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4255 = f32[1,29,1]{2,1,0} aten::rsqrt(%4254), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4256 = f32[1,29,3584]{2,1,0} aten::mul(%4251, %4255), scope=aten::mul.517, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4257 = bf16[1,29,3584]{2,1,0} xla::cast(%4256), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4258 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4259 = bf16[1,29,3584]{2,1,0} aten::mul(%4258, %4257), scope=aten::mul.518, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4260 = bf16[29,3584]{1,0} aten::view(%4259), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4261 = bf16[29,18944]{1,0} aten::mm(%4260, %53), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4262 = bf16[1,29,18944]{2,1,0} aten::view(%4261), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4263 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4264 = bf16[3584,18944]{0,1} aten::permute(%4263), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4265 = bf16[29,3584]{1,0} aten::view(%4259), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4266 = bf16[29,18944]{1,0} aten::mm(%4265, %4264), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4267 = bf16[1,29,18944]{2,1,0} aten::view(%4266), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4268 = bf16[1,29,18944]{2,1,0} aten::silu(%4267), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4269 = bf16[1,29,18944]{2,1,0} aten::mul(%4268, %4262), scope=aten::mul.519, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4270 = bf16[29,18944]{1,0} aten::view(%4269), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4271 = bf16[29,3584]{1,0} aten::mm(%4270, %51), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4272 = bf16[1,29,3584]{2,1,0} aten::view(%4271), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4273 = bf16[1,29,3584]{2,1,0} aten::add(%4250, %4272, %49), scope=aten::add.520, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4274 = f32[1,29,3584]{2,1,0} xla::cast(%4273), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4275 = f32[1,29,3584]{2,1,0} aten::pow(%4274, %48), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4276 = f32[1,29,1]{2,1,0} aten::mean(%4275), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4277 = f32[1,29,1]{2,1,0} aten::add(%4276, %47, %46), scope=aten::add.521, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4278 = f32[1,29,1]{2,1,0} aten::rsqrt(%4277), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4279 = f32[1,29,3584]{2,1,0} aten::mul(%4274, %4278), scope=aten::mul.522, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4280 = bf16[1,29,3584]{2,1,0} xla::cast(%4279), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4281 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4282 = bf16[1,29,3584]{2,1,0} aten::mul(%4281, %4280), scope=aten::mul.523, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4283 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4284 = bf16[29,512]{1,0} aten::mm(%4283, %45), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4285 = bf16[1,29,512]{2,1,0} aten::view(%4284), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4286 = bf16[1,29,512]{2,1,0} aten::add(%4285, %43, %42), scope=aten::add.526, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4287 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4286), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4288 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4287), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4289 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4288), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4290 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4289), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4291 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4290), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4292 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4291), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4293 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4292), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4294 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4293), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4295 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4294), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4296 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4295), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4297 = bf16[28,29,128]{2,1,0} aten::view(%4296), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4298 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4299 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4300 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4301 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4302 = s64[1,29]{1,0} aten::expand(%4301), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4303 = s64[1,29]{1,0} aten::add(%628, %4302), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4304 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4305 = pred[1,29]{1,0} aten::lt(%628, %4304), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4306 = s64[1,29]{1,0} aten::where(%4305, %4303, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4307 = s64[1,29,1]{2,1,0} aten::stack(%4306), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4308 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4309 = bf16[29,128]{1,0} xla::select(%4308), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4310 = bf16[1,29,128]{2,1,0} aten::index(%4309, %4307), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4311 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4312 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4313 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4314 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4315 = bf16[3584,512]{0,1} aten::permute(%4314), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4316 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4317 = bf16[29,512]{1,0} aten::mm(%4316, %4315), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4318 = bf16[1,29,512]{2,1,0} aten::view(%4317), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4319 = bf16[1,29,512]{2,1,0} aten::add(%4318, %4313, %4312), scope=aten::add.525, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4320 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4319), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4321 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4320), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4322 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4321), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4323 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4321), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4324 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4323), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4325 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4324, %4322), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4326 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4325, %4311), scope=aten::mul.531, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4327 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4328 = s64[1,29]{1,0} aten::expand(%4327), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4329 = s64[1,29]{1,0} aten::add(%628, %4328), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4330 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4331 = pred[1,29]{1,0} aten::lt(%628, %4330), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4332 = s64[1,29]{1,0} aten::where(%4331, %4329, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4333 = s64[1,29,1]{2,1,0} aten::stack(%4332), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4334 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4335 = bf16[29,128]{1,0} xla::select(%4334), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4336 = bf16[1,29,128]{2,1,0} aten::index(%4335, %4333), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4337 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4338 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4321, %4337), scope=aten::mul.530, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4339 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4338, %4326, %4300), scope=aten::add.532, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4340 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4339), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4341 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4342 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4343 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4342), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4344 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4343), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4345 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4344), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4346 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4345), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4347 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4346), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4348 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4347), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4349 = bf16[28,128,29]{2,1,0} aten::view(%4348), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4350 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4351 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4352 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4353 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4354 = bf16[3584,3584]{0,1} aten::permute(%4353), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4355 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4356 = bf16[29,3584]{1,0} aten::mm(%4355, %4354), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4357 = bf16[1,29,3584]{2,1,0} aten::view(%4356), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4358 = bf16[1,29,3584]{2,1,0} aten::add(%4357, %4352, %4351), scope=aten::add.524, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4359 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4358), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4360 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4359), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4361 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4360), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4362 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4360), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4363 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4362), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4364 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4363, %4361), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4365 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4364, %4311), scope=aten::mul.528, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4366 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4360, %4337), scope=aten::mul.527, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4367 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4366, %4365, %4350), scope=aten::add.529, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4368 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4367), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4369 = bf16[28,29,128]{2,1,0} aten::view(%4368), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4370 = bf16[28,29,29]{2,1,0} aten::matmul(%4369, %4349), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4371 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4370), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4372 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4371, %4299), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4373 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4372, %617, %4298), scope=aten::add.533, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4374 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4373), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4375 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4374), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4376 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4375), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4377 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4376), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4378 = bf16[28,29,29]{2,1,0} aten::view(%4377), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4379 = bf16[28,29,128]{2,1,0} aten::matmul(%4378, %4297), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4380 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4379), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4381 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4380), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4382 = bf16[1,29,3584]{2,1,0} aten::view(%4381), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4383 = bf16[29,3584]{1,0} aten::view(%4382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4384 = bf16[29,3584]{1,0} aten::mm(%4383, %41), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4385 = bf16[1,29,3584]{2,1,0} aten::view(%4384), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4386 = bf16[1,29,3584]{2,1,0} aten::add(%4273, %4385, %39), scope=aten::add.534, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4387 = f32[1,29,3584]{2,1,0} xla::cast(%4386), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4388 = f32[1,29,3584]{2,1,0} aten::pow(%4387, %38), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4389 = f32[1,29,1]{2,1,0} aten::mean(%4388), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4390 = f32[1,29,1]{2,1,0} aten::add(%4389, %37, %36), scope=aten::add.535, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4391 = f32[1,29,1]{2,1,0} aten::rsqrt(%4390), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4392 = f32[1,29,3584]{2,1,0} aten::mul(%4387, %4391), scope=aten::mul.536, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4393 = bf16[1,29,3584]{2,1,0} xla::cast(%4392), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4394 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4395 = bf16[1,29,3584]{2,1,0} aten::mul(%4394, %4393), scope=aten::mul.537, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4396 = bf16[29,3584]{1,0} aten::view(%4395), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4397 = bf16[29,18944]{1,0} aten::mm(%4396, %35), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4398 = bf16[1,29,18944]{2,1,0} aten::view(%4397), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4399 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4400 = bf16[3584,18944]{0,1} aten::permute(%4399), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4401 = bf16[29,3584]{1,0} aten::view(%4395), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4402 = bf16[29,18944]{1,0} aten::mm(%4401, %4400), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4403 = bf16[1,29,18944]{2,1,0} aten::view(%4402), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4404 = bf16[1,29,18944]{2,1,0} aten::silu(%4403), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4405 = bf16[1,29,18944]{2,1,0} aten::mul(%4404, %4398), scope=aten::mul.538, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4406 = bf16[29,18944]{1,0} aten::view(%4405), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4407 = bf16[29,3584]{1,0} aten::mm(%4406, %33), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4408 = bf16[1,29,3584]{2,1,0} aten::view(%4407), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4409 = bf16[1,29,3584]{2,1,0} aten::add(%4386, %4408, %31), scope=aten::add.539, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4410 = f32[1,29,3584]{2,1,0} xla::cast(%4409), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4411 = f32[1,29,3584]{2,1,0} aten::pow(%4410, %30), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4412 = f32[1,29,1]{2,1,0} aten::mean(%4411), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4413 = f32[1,29,1]{2,1,0} aten::add(%4412, %29, %28), scope=aten::add.540, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4414 = f32[1,29,1]{2,1,0} aten::rsqrt(%4413), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4415 = f32[1,29,3584]{2,1,0} aten::mul(%4410, %4414), scope=aten::mul.541, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4416 = bf16[1,29,3584]{2,1,0} xla::cast(%4415), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4417 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4418 = bf16[1,29,3584]{2,1,0} aten::mul(%4417, %4416), scope=aten::mul.542, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4419 = bf16[29,3584]{1,0} aten::view(%4418), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4420 = bf16[29,152064]{1,0} aten::mm(%4419, %27), location=forward@linear.py:117, xla_shape=bf16[29,152064]{1,0}
  %4421 = bf16[1,29,152064]{2,1,0} aten::view(%4420), location=forward@linear.py:117, xla_shape=bf16[1,29,152064]{2,1,0}
  %4422 = f32[1,29,152064]{2,1,0} xla::cast(%4421), location=forward@modeling_qwen2.py:1163, xla_shape=f32[1,29,152064]{2,1,0}
  %4423 = f32[1,29,152064]{2,1,0} xla::select(%4422), location=_sample@utils.py:2407, xla_shape=f32[1,29,152064]{2,1,0}
  %4424 = f32[1,1,152064]{2,1,0} xla::generic_slice(%4423), location=_sample@utils.py:2407, xla_shape=f32[1,1,152064]{2,1,0}
  %4425 = f32[1,152064]{1,0} aten::view(%4424), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4426 = f32[1,152064]{1,0} xla::select(%4425), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4427 = f32[1,29]{1,0} aten::gather(%4426, %25), location=__call__@logits_process.py:341, xla_shape=f32[1,29]{1,0}
  %4428 = f32[1,29]{1,0} aten::div(%4427, %21), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4429 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %4430 = f32[1,29]{1,0} aten::mul(%4427, %4429), scope=aten::mul.543, location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4431 = s64[] prim::Constant(), location=__call__@logits_process.py:344, xla_shape=s64[]
  %4432 = pred[1,29]{1,0} aten::lt(%4427, %4431), location=__call__@logits_process.py:344, xla_shape=pred[1,29]{1,0}
  %4433 = f32[1,29]{1,0} aten::where(%4432, %4430, %4428), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4434 = f32[1,152064]{1,0} aten::scatter(%4426, %25, %4433), location=__call__@logits_process.py:346, xla_shape=f32[1,152064]{1,0}
  %4435 = f32[1,152064]{1,0} aten::div(%4434, %20), location=__call__@logits_process.py:292, xla_shape=f32[1,152064]{1,0}
  %4436 = (f32[1,20]{1,0}, s64[1,20]{1,0}) aten::topk(%4435), num_outputs=2, location=__call__@logits_process.py:520, xla_shape=(f32[1,20]{1,0}, s64[1,20]{1,0})
  %4437 = f32[1,1]{1,0} xla::generic_slice(%4436.0), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4438 = f32[1]{0} aten::view(%4437), location=__call__@logits_process.py:520, xla_shape=f32[1]{0}
  %4439 = f32[1,1]{1,0} aten::view(%4438), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4440 = pred[1,152064]{1,0} aten::lt(%4435, %4439), location=__call__@logits_process.py:520, xla_shape=pred[1,152064]{1,0}
  %4441 = f32[1,152064]{1,0} aten::masked_fill(%4435, %4440, %19), location=__call__@logits_process.py:521, xla_shape=f32[1,152064]{1,0}
  %4442 = (f32[1,152064]{1,0}, s64[1,152064]{1,0}) aten::topk(%4441), num_outputs=2, location=__call__@logits_process.py:458, xla_shape=(f32[1,152064]{1,0}, s64[1,152064]{1,0})
  %4443 = f32[1,152064]{1,0} aten::softmax(%4442.0), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4444 = f32[1,152064]{1,0} aten::cumsum(%4443), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4445 = pred[1,152064]{1,0} aten::le(%4444, %18), location=__call__@logits_process.py:462, xla_shape=pred[1,152064]{1,0}
  %4446 = pred[1,152064]{1,0} xla::unselect(%4445, %17), location=__call__@logits_process.py:464, xla_shape=pred[1,152064]{1,0}
  %4447 = pred[1,152064]{1,0} aten::scatter(%4446, %4442.1, %4446), location=__call__@logits_process.py:467, xla_shape=pred[1,152064]{1,0}
  %4448 = f32[1,152064]{1,0} aten::masked_fill(%4441, %4447, %13), location=__call__@logits_process.py:468, xla_shape=f32[1,152064]{1,0}
  %4449 = f32[1,152064]{1,0} aten::softmax(%4448), location=softmax@functional.py:1888, xla_shape=f32[1,152064]{1,0}
  %4450 = s64[1,1]{1,0} aten::multinomial(%4449, %12), location=_sample@utils.py:2437, xla_shape=s64[1,1]{1,0}
  %4451 = s64[1]{0} aten::view(%4450), location=_sample@utils.py:2437, xla_shape=s64[1]{0}
  %4452 = s64[1]{0} aten::mul(%4451, %4), scope=aten::mul.544, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4453 = s64[1]{0} aten::add(%4452, %7, %0), scope=aten::add.547, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4454 = s64[1]{0} xla::select(%4453), location=_sample@utils.py:2446, xla_shape=s64[1]{0}
  %4455 = s64[1,1]{1,0} aten::view(%4454), location=_sample@utils.py:2446, xla_shape=s64[1,1]{1,0}
  %4456 = s64[1,30]{1,0} aten::cat(%25, %4455), location=_sample@utils.py:2446, xla_shape=s64[1,30]{1,0}
  %4457 = s64[1,30]{1,0} xla::select(%4456), location=__call__@stopping_criteria.py:534, xla_shape=s64[1,30]{1,0}
  %4458 = s64[1,1]{1,0} xla::generic_slice(%4457), location=__call__@stopping_criteria.py:534, xla_shape=s64[1,1]{1,0}
  %4459 = s64[1]{0} aten::view(%4458), location=__call__@stopping_criteria.py:534, xla_shape=s64[1]{0}, ROOT=0
}

Graph Hash: 5378f29ba5c1c833dcf50e774376a9cb

## END_GRAPH

[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  _has_unfinished_sequences (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1922)
  _sample (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:2392)
  generate (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1758)
  decorate_context (/workspaces/hug/hug/lib/python3.10/site-packages/torch/utils/_contextlib.py:116)
  <module> (/tmp/ipykernel_1456554/2982293035.py:14)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (b43a080c251b62cde4cfe98c840c63c4)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_sample@utils.py:2456, xla_shape=s64[]
  %1 = pred[1]{0} xla::device_data(), location=__call__@stopping_criteria.py:534, xla_shape=pred[1]{0}
  %2 = pred[] xla::device_data(), location=__call__@stopping_criteria.py:82, xla_shape=pred[]
  %3 = pred[1]{0} aten::expand(%2), location=__call__@stopping_criteria.py:82, xla_shape=pred[1]{0}
  %4 = pred[] xla::device_data(), location=__call__@stopping_criteria.py:542, xla_shape=pred[]
  %5 = pred[1]{0} aten::expand(%4), location=__call__@stopping_criteria.py:542, xla_shape=pred[1]{0}
  %6 = pred[1]{0} aten::bitwise_or(%5, %3), location=__call__@stopping_criteria.py:546, xla_shape=pred[1]{0}
  %7 = pred[1]{0} aten::bitwise_or(%6, %1), location=__call__@stopping_criteria.py:546, xla_shape=pred[1]{0}
  %8 = pred[1]{0} aten::bitwise_not(%7), location=_sample@utils.py:2455, xla_shape=pred[1]{0}
  %9 = s64[] prim::Constant(), location=_sample@utils.py:2389, xla_shape=s64[]
  %10 = s64[1]{0} aten::expand(%9), location=_sample@utils.py:2389, xla_shape=s64[1]{0}
  %11 = s64[1]{0} aten::bitwise_and(%10, %8), location=_sample@utils.py:2455, xla_shape=s64[1]{0}
  %12 = s64[] aten::max(%11), location=_sample@utils.py:2456, xla_shape=s64[]
  %13 = pred[] aten::eq(%12, %0), location=_sample@utils.py:2456, xla_shape=pred[], ROOT=0
}

Graph Hash: aa649370a67c9feb3603953c7b4c93a6

## END_GRAPH

[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  <lambda> (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/utils/generic.py:259)
  to_py_obj (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/utils/generic.py:274)
  decode (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:3834)
  <listcomp> (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:3797)
  batch_decode (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:3796)
  <module> (/tmp/ipykernel_1456554/2982293035.py:20)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (959cbae58dea04d605c82f22ecf1a030)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_sample@utils.py:2443, xla_shape=s64[]
  %1 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %2 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %3 = s64[] prim::Constant(), location=_sample@utils.py:2389, xla_shape=s64[]
  %4 = s64[1]{0} aten::expand(%3), location=_sample@utils.py:2389, xla_shape=s64[1]{0}
  %5 = s64[1]{0} aten::rsub(%4, %2, %1), scope=aten::rsub.545, location=__rsub__@_tensor.py:962, xla_shape=s64[1]{0}
  %6 = s64[] xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[]
  %7 = s64[1]{0} aten::mul(%6, %5), scope=aten::mul.546, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %8 = s64[] xla::device_data(), location=_sample@utils.py:2437, xla_shape=s64[]
  %9 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %10 = s64[] aten::mul(%9, %8), location=_sample@utils.py:2437, xla_shape=s64[]
  %11 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %12 = s64[] aten::add(%11, %10), location=_sample@utils.py:2437, xla_shape=s64[]
  %13 = f64[] xla::device_data(), location=__call__@logits_process.py:468, xla_shape=f64[]
  %14 = pred[] prim::Constant(), location=__call__@logits_process.py:464, xla_shape=pred[]
  %15 = pred[] aten::expand(%14), location=__call__@logits_process.py:464, xla_shape=pred[]
  %16 = pred[] aten::view(%15), location=__call__@logits_process.py:464, xla_shape=pred[]
  %17 = pred[1,1]{1,0} aten::expand(%16), location=__call__@logits_process.py:464, xla_shape=pred[1,1]{1,0}
  %18 = f64[] xla::device_data(), location=__call__@logits_process.py:462, xla_shape=f64[]
  %19 = f64[] xla::device_data(), location=__call__@logits_process.py:521, xla_shape=f64[]
  %20 = f32[] xla::device_data(), location=__call__@logits_process.py:292, xla_shape=f32[]
  %21 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %22 = s64[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %23 = s64[1,1,29]{2,1,0} aten::view(%22), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %24 = s64[1,1,29]{2,1,0} aten::expand(%23), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %25 = s64[1,29]{1,0} aten::view(%24), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,29]{1,0}
  %26 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %27 = bf16[3584,152064]{0,1} aten::permute(%26), location=forward@linear.py:117, xla_shape=bf16[3584,152064]{0,1}
  %28 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %29 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %30 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %31 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %32 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %33 = bf16[18944,3584]{0,1} aten::permute(%32), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %34 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %35 = bf16[3584,18944]{0,1} aten::permute(%34), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %36 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %37 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %38 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %39 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %40 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %41 = bf16[3584,3584]{0,1} aten::permute(%40), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %42 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %43 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %44 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %45 = bf16[3584,512]{0,1} aten::permute(%44), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %46 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %47 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %48 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %49 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %50 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %51 = bf16[18944,3584]{0,1} aten::permute(%50), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %52 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %53 = bf16[3584,18944]{0,1} aten::permute(%52), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %54 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %55 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %56 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %57 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %58 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %59 = bf16[3584,3584]{0,1} aten::permute(%58), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %60 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %61 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %62 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %63 = bf16[3584,512]{0,1} aten::permute(%62), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %64 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %65 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %66 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %67 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %68 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %69 = bf16[18944,3584]{0,1} aten::permute(%68), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %70 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %71 = bf16[3584,18944]{0,1} aten::permute(%70), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %72 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %73 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %74 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %75 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %76 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %77 = bf16[3584,3584]{0,1} aten::permute(%76), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %78 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %79 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %80 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %81 = bf16[3584,512]{0,1} aten::permute(%80), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %82 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %83 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %84 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %85 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %86 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %87 = bf16[18944,3584]{0,1} aten::permute(%86), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %88 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %89 = bf16[3584,18944]{0,1} aten::permute(%88), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %90 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %91 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %92 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %93 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %94 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %95 = bf16[3584,3584]{0,1} aten::permute(%94), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %96 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %97 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %98 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %99 = bf16[3584,512]{0,1} aten::permute(%98), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %100 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %101 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %102 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %103 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %104 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %105 = bf16[18944,3584]{0,1} aten::permute(%104), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %106 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %107 = bf16[3584,18944]{0,1} aten::permute(%106), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %108 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %109 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %110 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %111 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %112 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %113 = bf16[3584,3584]{0,1} aten::permute(%112), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %114 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %115 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %116 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %117 = bf16[3584,512]{0,1} aten::permute(%116), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %118 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %119 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %120 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %121 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %122 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %123 = bf16[18944,3584]{0,1} aten::permute(%122), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %124 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %125 = bf16[3584,18944]{0,1} aten::permute(%124), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %126 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %127 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %128 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %129 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %130 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %131 = bf16[3584,3584]{0,1} aten::permute(%130), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %132 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %133 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %134 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %135 = bf16[3584,512]{0,1} aten::permute(%134), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %136 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %137 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %138 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %139 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %140 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %141 = bf16[18944,3584]{0,1} aten::permute(%140), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %142 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %143 = bf16[3584,18944]{0,1} aten::permute(%142), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %144 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %145 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %146 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %147 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %148 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %149 = bf16[3584,3584]{0,1} aten::permute(%148), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %150 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %151 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %152 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %153 = bf16[3584,512]{0,1} aten::permute(%152), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %154 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %155 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %156 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %157 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %158 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %159 = bf16[18944,3584]{0,1} aten::permute(%158), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %160 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %161 = bf16[3584,18944]{0,1} aten::permute(%160), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %162 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %163 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %164 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %165 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %166 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %167 = bf16[3584,3584]{0,1} aten::permute(%166), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %168 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %169 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %170 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %171 = bf16[3584,512]{0,1} aten::permute(%170), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %172 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %173 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %174 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %175 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %176 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %177 = bf16[18944,3584]{0,1} aten::permute(%176), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %178 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %179 = bf16[3584,18944]{0,1} aten::permute(%178), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %180 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %181 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %182 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %183 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %184 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %185 = bf16[3584,3584]{0,1} aten::permute(%184), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %186 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %187 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %188 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %189 = bf16[3584,512]{0,1} aten::permute(%188), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %190 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %191 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %192 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %193 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %194 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %195 = bf16[18944,3584]{0,1} aten::permute(%194), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %196 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %197 = bf16[3584,18944]{0,1} aten::permute(%196), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %198 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %199 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %200 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %201 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %202 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %203 = bf16[3584,3584]{0,1} aten::permute(%202), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %204 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %205 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %206 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %207 = bf16[3584,512]{0,1} aten::permute(%206), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %208 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %209 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %210 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %211 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %212 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %213 = bf16[18944,3584]{0,1} aten::permute(%212), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %214 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %215 = bf16[3584,18944]{0,1} aten::permute(%214), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %216 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %217 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %218 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %219 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %220 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %221 = bf16[3584,3584]{0,1} aten::permute(%220), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %222 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %223 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %224 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %225 = bf16[3584,512]{0,1} aten::permute(%224), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %226 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %227 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %228 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %229 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %230 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %231 = bf16[18944,3584]{0,1} aten::permute(%230), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %232 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %233 = bf16[3584,18944]{0,1} aten::permute(%232), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %234 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %235 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %236 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %237 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %238 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %239 = bf16[3584,3584]{0,1} aten::permute(%238), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %240 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %241 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %242 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %243 = bf16[3584,512]{0,1} aten::permute(%242), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %244 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %245 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %246 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %247 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %248 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %249 = bf16[18944,3584]{0,1} aten::permute(%248), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %250 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %251 = bf16[3584,18944]{0,1} aten::permute(%250), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %252 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %253 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %254 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %255 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %256 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %257 = bf16[3584,3584]{0,1} aten::permute(%256), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %258 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %259 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %260 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %261 = bf16[3584,512]{0,1} aten::permute(%260), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %262 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %263 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %264 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %265 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %266 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %267 = bf16[18944,3584]{0,1} aten::permute(%266), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %268 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %269 = bf16[3584,18944]{0,1} aten::permute(%268), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %270 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %271 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %272 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %273 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %274 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %275 = bf16[3584,3584]{0,1} aten::permute(%274), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %276 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %277 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %278 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %279 = bf16[3584,512]{0,1} aten::permute(%278), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %280 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %281 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %282 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %283 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %284 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %285 = bf16[18944,3584]{0,1} aten::permute(%284), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %286 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %287 = bf16[3584,18944]{0,1} aten::permute(%286), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %288 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %289 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %290 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %291 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %292 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %293 = bf16[3584,3584]{0,1} aten::permute(%292), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %294 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %295 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %296 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %297 = bf16[3584,512]{0,1} aten::permute(%296), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %298 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %299 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %300 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %301 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %302 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %303 = bf16[18944,3584]{0,1} aten::permute(%302), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %304 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %305 = bf16[3584,18944]{0,1} aten::permute(%304), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %306 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %307 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %308 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %309 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %310 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %311 = bf16[3584,3584]{0,1} aten::permute(%310), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %312 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %313 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %314 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %315 = bf16[3584,512]{0,1} aten::permute(%314), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %316 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %317 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %318 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %319 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %320 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %321 = bf16[18944,3584]{0,1} aten::permute(%320), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %322 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %323 = bf16[3584,18944]{0,1} aten::permute(%322), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %324 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %325 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %326 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %327 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %328 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %329 = bf16[3584,3584]{0,1} aten::permute(%328), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %330 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %331 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %332 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %333 = bf16[3584,512]{0,1} aten::permute(%332), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %334 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %335 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %336 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %337 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %338 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %339 = bf16[18944,3584]{0,1} aten::permute(%338), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %340 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %341 = bf16[3584,18944]{0,1} aten::permute(%340), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %342 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %343 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %344 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %345 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %346 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %347 = bf16[3584,3584]{0,1} aten::permute(%346), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %348 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %349 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %350 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %351 = bf16[3584,512]{0,1} aten::permute(%350), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %352 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %353 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %354 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %355 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %356 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %357 = bf16[18944,3584]{0,1} aten::permute(%356), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %358 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %359 = bf16[3584,18944]{0,1} aten::permute(%358), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %360 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %361 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %362 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %363 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %364 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %365 = bf16[3584,3584]{0,1} aten::permute(%364), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %366 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %367 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %368 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %369 = bf16[3584,512]{0,1} aten::permute(%368), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %370 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %371 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %372 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %373 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %374 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %375 = bf16[18944,3584]{0,1} aten::permute(%374), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %376 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %377 = bf16[3584,18944]{0,1} aten::permute(%376), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %378 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %379 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %380 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %381 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %382 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %383 = bf16[3584,3584]{0,1} aten::permute(%382), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %384 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %385 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %386 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %387 = bf16[3584,512]{0,1} aten::permute(%386), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %388 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %389 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %390 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %391 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %392 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %393 = bf16[18944,3584]{0,1} aten::permute(%392), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %394 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %395 = bf16[3584,18944]{0,1} aten::permute(%394), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %396 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %397 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %398 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %399 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %400 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %401 = bf16[3584,3584]{0,1} aten::permute(%400), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %402 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %403 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %404 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %405 = bf16[3584,512]{0,1} aten::permute(%404), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %406 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %407 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %408 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %409 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %410 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %411 = bf16[18944,3584]{0,1} aten::permute(%410), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %412 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %413 = bf16[3584,18944]{0,1} aten::permute(%412), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %414 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %415 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %416 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %417 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %418 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %419 = bf16[3584,3584]{0,1} aten::permute(%418), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %420 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %421 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %422 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %423 = bf16[3584,512]{0,1} aten::permute(%422), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %424 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %425 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %426 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %427 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %428 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %429 = bf16[18944,3584]{0,1} aten::permute(%428), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %430 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %431 = bf16[3584,18944]{0,1} aten::permute(%430), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %432 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %433 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %434 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %435 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %436 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %437 = bf16[3584,3584]{0,1} aten::permute(%436), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %438 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %439 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %440 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %441 = bf16[3584,512]{0,1} aten::permute(%440), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %442 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %443 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %444 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %445 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %446 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %447 = bf16[18944,3584]{0,1} aten::permute(%446), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %448 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %449 = bf16[3584,18944]{0,1} aten::permute(%448), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %450 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %451 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %452 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %453 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %454 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %455 = bf16[3584,3584]{0,1} aten::permute(%454), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %456 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %457 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %458 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %459 = bf16[3584,512]{0,1} aten::permute(%458), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %460 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %461 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %462 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %463 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %464 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %465 = bf16[18944,3584]{0,1} aten::permute(%464), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %466 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %467 = bf16[3584,18944]{0,1} aten::permute(%466), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %468 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %469 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %470 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %471 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %472 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %473 = bf16[3584,3584]{0,1} aten::permute(%472), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %474 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %475 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %476 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %477 = bf16[3584,512]{0,1} aten::permute(%476), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %478 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %479 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %480 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %481 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %482 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %483 = bf16[18944,3584]{0,1} aten::permute(%482), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %484 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %485 = bf16[3584,18944]{0,1} aten::permute(%484), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %486 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %487 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %488 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %489 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %490 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %491 = bf16[3584,3584]{0,1} aten::permute(%490), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %492 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %493 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %494 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %495 = bf16[3584,512]{0,1} aten::permute(%494), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %496 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %497 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %498 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %499 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %500 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %501 = bf16[18944,3584]{0,1} aten::permute(%500), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %502 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %503 = bf16[3584,18944]{0,1} aten::permute(%502), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %504 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %505 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %506 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %507 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %508 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %509 = bf16[3584,3584]{0,1} aten::permute(%508), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %510 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %511 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %512 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %513 = bf16[3584,512]{0,1} aten::permute(%512), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %514 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %515 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %516 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %517 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %518 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %519 = bf16[18944,3584]{0,1} aten::permute(%518), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %520 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %521 = bf16[3584,18944]{0,1} aten::permute(%520), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %522 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %523 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %524 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %525 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %526 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %527 = bf16[3584,3584]{0,1} aten::permute(%526), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %528 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %529 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %530 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %531 = bf16[3584,512]{0,1} aten::permute(%530), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %532 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %533 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %534 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %535 = s64[29]{0} aten::view(%25), location=embedding@functional.py:2267, xla_shape=s64[29]{0}
  %536 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %537 = bf16[29,3584]{1,0} aten::index_select(%536, %535), location=embedding@functional.py:2267, xla_shape=bf16[29,3584]{1,0}
  %538 = bf16[1,29,3584]{2,1,0} aten::view(%537), location=embedding@functional.py:2267, xla_shape=bf16[1,29,3584]{2,1,0}
  %539 = f32[1,29,3584]{2,1,0} xla::cast(%538), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %540 = f32[1,29,3584]{2,1,0} aten::pow(%539, %534), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %541 = f32[1,29,1]{2,1,0} aten::mean(%540), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %542 = f32[1,29,1]{2,1,0} aten::add(%541, %533, %532), scope=aten::add.8, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %543 = f32[1,29,1]{2,1,0} aten::rsqrt(%542), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %544 = f32[1,29,3584]{2,1,0} aten::mul(%539, %543), scope=aten::mul.9, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %545 = bf16[1,29,3584]{2,1,0} xla::cast(%544), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %546 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %547 = bf16[1,29,3584]{2,1,0} aten::mul(%546, %545), scope=aten::mul.10, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %548 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %549 = bf16[29,512]{1,0} aten::mm(%548, %531), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %550 = bf16[1,29,512]{2,1,0} aten::view(%549), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %551 = bf16[1,29,512]{2,1,0} aten::add(%550, %529, %528), scope=aten::add.13, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %552 = bf16[1,29,4,128]{3,2,1,0} aten::view(%551), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %553 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%552), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %554 = bf16[1,4,29,128]{3,1,2,0} xla::select(%553), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %555 = bf16[1,4,29,128]{3,1,2,0} xla::select(%554), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %556 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%555), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %557 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%556), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %558 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%557), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %559 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%558), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %560 = bf16[1,28,29,128]{3,2,1,0} aten::view(%559), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %561 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%560), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %562 = bf16[28,29,128]{2,1,0} aten::view(%561), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %563 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %564 = f64[] xla::device_data(), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=f64[]
  %565 = f64[] xla::device_data(), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=f64[]
  %566 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %567 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %568 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[]
  %569 = pred[2]{0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[2]{0}
  %570 = pred[] aten::any(%569), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[]
  %571 = pred[] aten::bitwise_not(%570), location=_prepare_attention_mask_for_generation@utils.py:475, xla_shape=pred[]
  %572 = pred[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[1,29]{1,0}
  %573 = pred[] aten::any(%572), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[]
  %574 = pred[] aten::mul(%573, %571), scope=aten::mul.1, location=_prepare_attention_mask_for_generation@utils.py:478, xla_shape=pred[]
  %575 = pred[] aten::bitwise_not(%574), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=pred[]
  %576 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[]
  %577 = s64[1,29]{1,0} aten::expand(%576), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[1,29]{1,0}
  %578 = s64[1,29]{1,0} aten::mul(%577, %575), scope=aten::mul.3, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %579 = pred[1,29]{1,0} aten::ne(%22, %6), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=pred[1,29]{1,0}
  %580 = s64[1,29]{1,0} xla::cast(%579), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %581 = s64[1,29]{1,0} aten::mul(%580, %574), scope=aten::mul.2, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %582 = s64[1,29]{1,0} aten::add(%581, %578, %568), scope=aten::add.4, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %583 = s64[1,1,29]{2,1,0} aten::view(%582), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %584 = s64[1,1,29]{2,1,0} aten::expand(%583), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %585 = s64[1,29]{1,0} aten::view(%584), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,29]{1,0}
  %586 = s64[1,29]{1,0} xla::select(%585), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,29]{1,0}
  %587 = s64[1,1,29]{2,1,0} aten::view(%586), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29]{2,1,0}
  %588 = s64[1,1,1,29]{3,2,1,0} aten::view(%587), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %589 = s64[1,1,1,29]{3,2,1,0} xla::select(%588), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %590 = s64[1,1,29,29]{3,2,1,0} aten::expand(%589), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29,29]{3,2,1,0}
  %591 = bf16[1,1,29,29]{3,2,1,0} xla::cast(%590), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %592 = bf16[1,1,29,29]{3,2,1,0} aten::rsub(%591, %567, %566), scope=aten::rsub.7, location=__rsub__@_tensor.py:962, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %593 = pred[1,1,29,29]{3,2,1,0} xla::cast(%592), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %594 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%592, %593, %565), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %595 = pred[1,1,29,29]{3,2,1,0} xla::cast(%594), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %596 = f64[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=f64[]
  %597 = pred[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[]
  %598 = pred[29,29]{1,0} aten::expand(%597), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %599 = pred[29,29]{1,0} aten::tril(%598), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %600 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %601 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %602 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %603 = s64[29]{0} prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:157, xla_shape=s64[29]{0}
  %604 = s64[29]{0} aten::add(%603, %602, %601), scope=aten::add.6, location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29]{0}
  %605 = s64[29,1]{1,0} aten::view(%604), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29,1]{1,0}
  %606 = pred[29,29]{1,0} aten::lt(%603, %605), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=pred[29,29]{1,0}
  %607 = f32[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[]
  %608 = f32[29,29]{1,0} aten::expand(%607), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[29,29]{1,0}
  %609 = f32[29,29]{1,0} aten::masked_fill(%608, %606, %600), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=f32[29,29]{1,0}
  %610 = bf16[29,29]{1,0} xla::cast(%609), location=_make_causal_mask@modeling_attn_mask_utils.py:160, xla_shape=bf16[29,29]{1,0}
  %611 = bf16[29,29]{1,0} aten::masked_fill(%610, %599, %596), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=bf16[29,29]{1,0}
  %612 = bf16[1,29,29]{2,1,0} aten::view(%611), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,29,29]{2,1,0}
  %613 = bf16[1,1,29,29]{3,2,1,0} aten::view(%612), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %614 = bf16[1,1,29,29]{3,2,1,0} xla::select(%613), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %615 = bf16[1,1,29,29]{3,2,1,0} xla::select(%614), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %616 = bf16[1,1,29,29]{3,2,1,0} aten::expand(%615), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %617 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%616, %595, %564), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %618 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %619 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %620 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %621 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %622 = pred[1,29]{1,0} aten::eq(%585, %621), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=pred[1,29]{1,0}
  %623 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %624 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %625 = s64[1,29]{1,0} aten::cumsum(%585), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %626 = s64[1,29]{1,0} aten::sub(%625, %624, %623), scope=aten::sub.5, location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %627 = s64[1,29]{1,0} aten::masked_fill(%626, %622, %620), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[1,29]{1,0}
  %628 = s64[1,29]{1,0} aten::view(%627), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %629 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %630 = s64[1,29]{1,0} aten::expand(%629), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %631 = s64[1,29]{1,0} aten::add(%628, %630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %632 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %633 = pred[1,29]{1,0} aten::lt(%628, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %634 = s64[1,29]{1,0} aten::where(%633, %631, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %635 = s64[1,29,1]{2,1,0} aten::stack(%634), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %636 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %637 = bf16[29,128]{1,0} xla::select(%636), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %638 = bf16[1,29,128]{2,1,0} aten::index(%637, %635), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %639 = bf16[1,1,29,128]{3,2,1,0} aten::view(%638), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %640 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %641 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %642 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %643 = bf16[3584,512]{0,1} aten::permute(%642), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %644 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %645 = bf16[29,512]{1,0} aten::mm(%644, %643), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %646 = bf16[1,29,512]{2,1,0} aten::view(%645), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %647 = bf16[1,29,512]{2,1,0} aten::add(%646, %641, %640), scope=aten::add.12, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %648 = bf16[1,29,4,128]{3,2,1,0} aten::view(%647), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %649 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%648), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %650 = bf16[1,4,29,64]{3,1,2,0} xla::select(%649), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %651 = bf16[1,4,29,64]{3,1,2,0} xla::select(%649), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %652 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%651), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %653 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%652, %650), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %654 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%653, %639), scope=aten::mul.18, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %655 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %656 = s64[1,29]{1,0} aten::expand(%655), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %657 = s64[1,29]{1,0} aten::add(%628, %656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %658 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %659 = pred[1,29]{1,0} aten::lt(%628, %658), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %660 = s64[1,29]{1,0} aten::where(%659, %657, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %661 = s64[1,29,1]{2,1,0} aten::stack(%660), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %662 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %663 = bf16[29,128]{1,0} xla::select(%662), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %664 = bf16[1,29,128]{2,1,0} aten::index(%663, %661), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %665 = bf16[1,1,29,128]{3,2,1,0} aten::view(%664), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %666 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%649, %665), scope=aten::mul.17, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %667 = bf16[1,4,29,128]{3,2,1,0} aten::add(%666, %654, %619), scope=aten::add.19, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %668 = bf16[1,4,29,128]{3,2,1,0} xla::select(%667), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %669 = bf16[1,4,29,128]{3,2,1,0} xla::select(%668), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %670 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%669), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %671 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%670), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %672 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%671), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %673 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%672), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %674 = bf16[1,28,29,128]{3,2,1,0} aten::view(%673), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %675 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%674), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %676 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%675), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %677 = bf16[28,128,29]{2,1,0} aten::view(%676), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %678 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %679 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %680 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %681 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %682 = bf16[3584,3584]{0,1} aten::permute(%681), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %683 = bf16[29,3584]{1,0} aten::view(%547), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %684 = bf16[29,3584]{1,0} aten::mm(%683, %682), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %685 = bf16[1,29,3584]{2,1,0} aten::view(%684), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %686 = bf16[1,29,3584]{2,1,0} aten::add(%685, %680, %679), scope=aten::add.11, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %687 = bf16[1,29,28,128]{3,2,1,0} aten::view(%686), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %688 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%687), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %689 = bf16[1,28,29,64]{3,1,2,0} xla::select(%688), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %690 = bf16[1,28,29,64]{3,1,2,0} xla::select(%688), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %691 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%690), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %692 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%691, %689), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %693 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%692, %639), scope=aten::mul.15, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %694 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%688, %665), scope=aten::mul.14, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %695 = bf16[1,28,29,128]{3,2,1,0} aten::add(%694, %693, %678), scope=aten::add.16, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %696 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%695), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %697 = bf16[28,29,128]{2,1,0} aten::view(%696), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %698 = bf16[28,29,29]{2,1,0} aten::matmul(%697, %677), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %699 = bf16[1,28,29,29]{3,2,1,0} aten::view(%698), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %700 = bf16[1,28,29,29]{3,2,1,0} aten::div(%699, %618), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %701 = bf16[1,28,29,29]{3,2,1,0} aten::add(%700, %617, %563), scope=aten::add.20, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %702 = f32[1,28,29,29]{3,2,1,0} xla::cast(%701), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %703 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%702), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %704 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%703), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %705 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%704), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %706 = bf16[28,29,29]{2,1,0} aten::view(%705), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %707 = bf16[28,29,128]{2,1,0} aten::matmul(%706, %562), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %708 = bf16[1,28,29,128]{3,2,1,0} aten::view(%707), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %709 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%708), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %710 = bf16[1,29,3584]{2,1,0} aten::view(%709), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %711 = bf16[29,3584]{1,0} aten::view(%710), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %712 = bf16[29,3584]{1,0} aten::mm(%711, %527), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %713 = bf16[1,29,3584]{2,1,0} aten::view(%712), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %714 = bf16[1,29,3584]{2,1,0} aten::add(%538, %713, %525), scope=aten::add.21, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %715 = f32[1,29,3584]{2,1,0} xla::cast(%714), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %716 = f32[1,29,3584]{2,1,0} aten::pow(%715, %524), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %717 = f32[1,29,1]{2,1,0} aten::mean(%716), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %718 = f32[1,29,1]{2,1,0} aten::add(%717, %523, %522), scope=aten::add.22, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %719 = f32[1,29,1]{2,1,0} aten::rsqrt(%718), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %720 = f32[1,29,3584]{2,1,0} aten::mul(%715, %719), scope=aten::mul.23, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %721 = bf16[1,29,3584]{2,1,0} xla::cast(%720), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %722 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %723 = bf16[1,29,3584]{2,1,0} aten::mul(%722, %721), scope=aten::mul.24, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %724 = bf16[29,3584]{1,0} aten::view(%723), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %725 = bf16[29,18944]{1,0} aten::mm(%724, %521), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %726 = bf16[1,29,18944]{2,1,0} aten::view(%725), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %727 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %728 = bf16[3584,18944]{0,1} aten::permute(%727), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %729 = bf16[29,3584]{1,0} aten::view(%723), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %730 = bf16[29,18944]{1,0} aten::mm(%729, %728), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %731 = bf16[1,29,18944]{2,1,0} aten::view(%730), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %732 = bf16[1,29,18944]{2,1,0} aten::silu(%731), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %733 = bf16[1,29,18944]{2,1,0} aten::mul(%732, %726), scope=aten::mul.25, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %734 = bf16[29,18944]{1,0} aten::view(%733), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %735 = bf16[29,3584]{1,0} aten::mm(%734, %519), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %736 = bf16[1,29,3584]{2,1,0} aten::view(%735), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %737 = bf16[1,29,3584]{2,1,0} aten::add(%714, %736, %517), scope=aten::add.26, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %738 = f32[1,29,3584]{2,1,0} xla::cast(%737), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %739 = f32[1,29,3584]{2,1,0} aten::pow(%738, %516), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %740 = f32[1,29,1]{2,1,0} aten::mean(%739), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %741 = f32[1,29,1]{2,1,0} aten::add(%740, %515, %514), scope=aten::add.27, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %742 = f32[1,29,1]{2,1,0} aten::rsqrt(%741), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %743 = f32[1,29,3584]{2,1,0} aten::mul(%738, %742), scope=aten::mul.28, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %744 = bf16[1,29,3584]{2,1,0} xla::cast(%743), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %745 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %746 = bf16[1,29,3584]{2,1,0} aten::mul(%745, %744), scope=aten::mul.29, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %747 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %748 = bf16[29,512]{1,0} aten::mm(%747, %513), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %749 = bf16[1,29,512]{2,1,0} aten::view(%748), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %750 = bf16[1,29,512]{2,1,0} aten::add(%749, %511, %510), scope=aten::add.32, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %751 = bf16[1,29,4,128]{3,2,1,0} aten::view(%750), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %752 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%751), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %753 = bf16[1,4,29,128]{3,1,2,0} xla::select(%752), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %754 = bf16[1,4,29,128]{3,1,2,0} xla::select(%753), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %755 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%754), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %756 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%755), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %757 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %758 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %759 = bf16[1,28,29,128]{3,2,1,0} aten::view(%758), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %760 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%759), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %761 = bf16[28,29,128]{2,1,0} aten::view(%760), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %762 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %763 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %764 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %765 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %766 = s64[1,29]{1,0} aten::expand(%765), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %767 = s64[1,29]{1,0} aten::add(%628, %766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %768 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %769 = pred[1,29]{1,0} aten::lt(%628, %768), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %770 = s64[1,29]{1,0} aten::where(%769, %767, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %771 = s64[1,29,1]{2,1,0} aten::stack(%770), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %772 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %773 = bf16[29,128]{1,0} xla::select(%772), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %774 = bf16[1,29,128]{2,1,0} aten::index(%773, %771), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %775 = bf16[1,1,29,128]{3,2,1,0} aten::view(%774), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %776 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %777 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %778 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %779 = bf16[3584,512]{0,1} aten::permute(%778), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %780 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %781 = bf16[29,512]{1,0} aten::mm(%780, %779), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %782 = bf16[1,29,512]{2,1,0} aten::view(%781), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %783 = bf16[1,29,512]{2,1,0} aten::add(%782, %777, %776), scope=aten::add.31, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %784 = bf16[1,29,4,128]{3,2,1,0} aten::view(%783), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %785 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%784), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %786 = bf16[1,4,29,64]{3,1,2,0} xla::select(%785), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %787 = bf16[1,4,29,64]{3,1,2,0} xla::select(%785), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %788 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%787), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %789 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%788, %786), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %790 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%789, %775), scope=aten::mul.37, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %791 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %792 = s64[1,29]{1,0} aten::expand(%791), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %793 = s64[1,29]{1,0} aten::add(%628, %792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %794 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %795 = pred[1,29]{1,0} aten::lt(%628, %794), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %796 = s64[1,29]{1,0} aten::where(%795, %793, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %797 = s64[1,29,1]{2,1,0} aten::stack(%796), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %798 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %799 = bf16[29,128]{1,0} xla::select(%798), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %800 = bf16[1,29,128]{2,1,0} aten::index(%799, %797), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %801 = bf16[1,1,29,128]{3,2,1,0} aten::view(%800), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %802 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%785, %801), scope=aten::mul.36, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %803 = bf16[1,4,29,128]{3,2,1,0} aten::add(%802, %790, %764), scope=aten::add.38, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %804 = bf16[1,4,29,128]{3,2,1,0} xla::select(%803), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %805 = bf16[1,4,29,128]{3,2,1,0} xla::select(%804), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %806 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%805), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %807 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%806), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %808 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%807), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %809 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%808), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %810 = bf16[1,28,29,128]{3,2,1,0} aten::view(%809), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %811 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%810), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %812 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%811), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %813 = bf16[28,128,29]{2,1,0} aten::view(%812), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %814 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %815 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %816 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %817 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %818 = bf16[3584,3584]{0,1} aten::permute(%817), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %819 = bf16[29,3584]{1,0} aten::view(%746), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %820 = bf16[29,3584]{1,0} aten::mm(%819, %818), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %821 = bf16[1,29,3584]{2,1,0} aten::view(%820), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %822 = bf16[1,29,3584]{2,1,0} aten::add(%821, %816, %815), scope=aten::add.30, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %823 = bf16[1,29,28,128]{3,2,1,0} aten::view(%822), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %824 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%823), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %825 = bf16[1,28,29,64]{3,1,2,0} xla::select(%824), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %826 = bf16[1,28,29,64]{3,1,2,0} xla::select(%824), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %827 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%826), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %828 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%827, %825), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %829 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%828, %775), scope=aten::mul.34, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %830 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%824, %801), scope=aten::mul.33, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %831 = bf16[1,28,29,128]{3,2,1,0} aten::add(%830, %829, %814), scope=aten::add.35, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %832 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%831), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %833 = bf16[28,29,128]{2,1,0} aten::view(%832), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %834 = bf16[28,29,29]{2,1,0} aten::matmul(%833, %813), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %835 = bf16[1,28,29,29]{3,2,1,0} aten::view(%834), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %836 = bf16[1,28,29,29]{3,2,1,0} aten::div(%835, %763), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %837 = bf16[1,28,29,29]{3,2,1,0} aten::add(%836, %617, %762), scope=aten::add.39, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %838 = f32[1,28,29,29]{3,2,1,0} xla::cast(%837), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %839 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%838), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %840 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%839), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %841 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%840), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %842 = bf16[28,29,29]{2,1,0} aten::view(%841), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %843 = bf16[28,29,128]{2,1,0} aten::matmul(%842, %761), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %844 = bf16[1,28,29,128]{3,2,1,0} aten::view(%843), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %845 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%844), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %846 = bf16[1,29,3584]{2,1,0} aten::view(%845), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %847 = bf16[29,3584]{1,0} aten::view(%846), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %848 = bf16[29,3584]{1,0} aten::mm(%847, %509), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %849 = bf16[1,29,3584]{2,1,0} aten::view(%848), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %850 = bf16[1,29,3584]{2,1,0} aten::add(%737, %849, %507), scope=aten::add.40, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %851 = f32[1,29,3584]{2,1,0} xla::cast(%850), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %852 = f32[1,29,3584]{2,1,0} aten::pow(%851, %506), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %853 = f32[1,29,1]{2,1,0} aten::mean(%852), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %854 = f32[1,29,1]{2,1,0} aten::add(%853, %505, %504), scope=aten::add.41, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %855 = f32[1,29,1]{2,1,0} aten::rsqrt(%854), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %856 = f32[1,29,3584]{2,1,0} aten::mul(%851, %855), scope=aten::mul.42, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %857 = bf16[1,29,3584]{2,1,0} xla::cast(%856), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %858 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %859 = bf16[1,29,3584]{2,1,0} aten::mul(%858, %857), scope=aten::mul.43, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %860 = bf16[29,3584]{1,0} aten::view(%859), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %861 = bf16[29,18944]{1,0} aten::mm(%860, %503), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %862 = bf16[1,29,18944]{2,1,0} aten::view(%861), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %863 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %864 = bf16[3584,18944]{0,1} aten::permute(%863), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %865 = bf16[29,3584]{1,0} aten::view(%859), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %866 = bf16[29,18944]{1,0} aten::mm(%865, %864), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %867 = bf16[1,29,18944]{2,1,0} aten::view(%866), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %868 = bf16[1,29,18944]{2,1,0} aten::silu(%867), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %869 = bf16[1,29,18944]{2,1,0} aten::mul(%868, %862), scope=aten::mul.44, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %870 = bf16[29,18944]{1,0} aten::view(%869), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %871 = bf16[29,3584]{1,0} aten::mm(%870, %501), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %872 = bf16[1,29,3584]{2,1,0} aten::view(%871), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %873 = bf16[1,29,3584]{2,1,0} aten::add(%850, %872, %499), scope=aten::add.45, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %874 = f32[1,29,3584]{2,1,0} xla::cast(%873), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %875 = f32[1,29,3584]{2,1,0} aten::pow(%874, %498), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %876 = f32[1,29,1]{2,1,0} aten::mean(%875), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %877 = f32[1,29,1]{2,1,0} aten::add(%876, %497, %496), scope=aten::add.46, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %878 = f32[1,29,1]{2,1,0} aten::rsqrt(%877), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %879 = f32[1,29,3584]{2,1,0} aten::mul(%874, %878), scope=aten::mul.47, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %880 = bf16[1,29,3584]{2,1,0} xla::cast(%879), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %881 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %882 = bf16[1,29,3584]{2,1,0} aten::mul(%881, %880), scope=aten::mul.48, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %883 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %884 = bf16[29,512]{1,0} aten::mm(%883, %495), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %885 = bf16[1,29,512]{2,1,0} aten::view(%884), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %886 = bf16[1,29,512]{2,1,0} aten::add(%885, %493, %492), scope=aten::add.51, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %887 = bf16[1,29,4,128]{3,2,1,0} aten::view(%886), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %888 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%887), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %889 = bf16[1,4,29,128]{3,1,2,0} xla::select(%888), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %890 = bf16[1,4,29,128]{3,1,2,0} xla::select(%889), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %891 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%890), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %892 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%891), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %893 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %894 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %895 = bf16[1,28,29,128]{3,2,1,0} aten::view(%894), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %896 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%895), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %897 = bf16[28,29,128]{2,1,0} aten::view(%896), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %898 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %899 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %900 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %901 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %902 = s64[1,29]{1,0} aten::expand(%901), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %903 = s64[1,29]{1,0} aten::add(%628, %902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %904 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %905 = pred[1,29]{1,0} aten::lt(%628, %904), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %906 = s64[1,29]{1,0} aten::where(%905, %903, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %907 = s64[1,29,1]{2,1,0} aten::stack(%906), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %908 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %909 = bf16[29,128]{1,0} xla::select(%908), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %910 = bf16[1,29,128]{2,1,0} aten::index(%909, %907), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %911 = bf16[1,1,29,128]{3,2,1,0} aten::view(%910), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %912 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %913 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %914 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %915 = bf16[3584,512]{0,1} aten::permute(%914), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %916 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %917 = bf16[29,512]{1,0} aten::mm(%916, %915), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %918 = bf16[1,29,512]{2,1,0} aten::view(%917), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %919 = bf16[1,29,512]{2,1,0} aten::add(%918, %913, %912), scope=aten::add.50, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %920 = bf16[1,29,4,128]{3,2,1,0} aten::view(%919), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %921 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%920), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %922 = bf16[1,4,29,64]{3,1,2,0} xla::select(%921), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %923 = bf16[1,4,29,64]{3,1,2,0} xla::select(%921), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %924 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%923), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %925 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%924, %922), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %926 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%925, %911), scope=aten::mul.56, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %927 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %928 = s64[1,29]{1,0} aten::expand(%927), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %929 = s64[1,29]{1,0} aten::add(%628, %928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %930 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %931 = pred[1,29]{1,0} aten::lt(%628, %930), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %932 = s64[1,29]{1,0} aten::where(%931, %929, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %933 = s64[1,29,1]{2,1,0} aten::stack(%932), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %934 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %935 = bf16[29,128]{1,0} xla::select(%934), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %936 = bf16[1,29,128]{2,1,0} aten::index(%935, %933), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %937 = bf16[1,1,29,128]{3,2,1,0} aten::view(%936), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %938 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%921, %937), scope=aten::mul.55, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %939 = bf16[1,4,29,128]{3,2,1,0} aten::add(%938, %926, %900), scope=aten::add.57, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %940 = bf16[1,4,29,128]{3,2,1,0} xla::select(%939), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %941 = bf16[1,4,29,128]{3,2,1,0} xla::select(%940), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %942 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%941), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %943 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%942), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %944 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%943), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %945 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%944), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %946 = bf16[1,28,29,128]{3,2,1,0} aten::view(%945), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %947 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%946), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %948 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%947), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %949 = bf16[28,128,29]{2,1,0} aten::view(%948), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %950 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %951 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %952 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %953 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %954 = bf16[3584,3584]{0,1} aten::permute(%953), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %955 = bf16[29,3584]{1,0} aten::view(%882), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %956 = bf16[29,3584]{1,0} aten::mm(%955, %954), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %957 = bf16[1,29,3584]{2,1,0} aten::view(%956), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %958 = bf16[1,29,3584]{2,1,0} aten::add(%957, %952, %951), scope=aten::add.49, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %959 = bf16[1,29,28,128]{3,2,1,0} aten::view(%958), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %960 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%959), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %961 = bf16[1,28,29,64]{3,1,2,0} xla::select(%960), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %962 = bf16[1,28,29,64]{3,1,2,0} xla::select(%960), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %963 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%962), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %964 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%963, %961), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %965 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%964, %911), scope=aten::mul.53, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %966 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%960, %937), scope=aten::mul.52, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %967 = bf16[1,28,29,128]{3,2,1,0} aten::add(%966, %965, %950), scope=aten::add.54, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %968 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%967), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %969 = bf16[28,29,128]{2,1,0} aten::view(%968), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %970 = bf16[28,29,29]{2,1,0} aten::matmul(%969, %949), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %971 = bf16[1,28,29,29]{3,2,1,0} aten::view(%970), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %972 = bf16[1,28,29,29]{3,2,1,0} aten::div(%971, %899), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %973 = bf16[1,28,29,29]{3,2,1,0} aten::add(%972, %617, %898), scope=aten::add.58, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %974 = f32[1,28,29,29]{3,2,1,0} xla::cast(%973), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %975 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%974), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %976 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%975), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %977 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%976), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %978 = bf16[28,29,29]{2,1,0} aten::view(%977), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %979 = bf16[28,29,128]{2,1,0} aten::matmul(%978, %897), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %980 = bf16[1,28,29,128]{3,2,1,0} aten::view(%979), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %981 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%980), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %982 = bf16[1,29,3584]{2,1,0} aten::view(%981), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %983 = bf16[29,3584]{1,0} aten::view(%982), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %984 = bf16[29,3584]{1,0} aten::mm(%983, %491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %985 = bf16[1,29,3584]{2,1,0} aten::view(%984), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %986 = bf16[1,29,3584]{2,1,0} aten::add(%873, %985, %489), scope=aten::add.59, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %987 = f32[1,29,3584]{2,1,0} xla::cast(%986), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %988 = f32[1,29,3584]{2,1,0} aten::pow(%987, %488), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %989 = f32[1,29,1]{2,1,0} aten::mean(%988), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %990 = f32[1,29,1]{2,1,0} aten::add(%989, %487, %486), scope=aten::add.60, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %991 = f32[1,29,1]{2,1,0} aten::rsqrt(%990), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %992 = f32[1,29,3584]{2,1,0} aten::mul(%987, %991), scope=aten::mul.61, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %993 = bf16[1,29,3584]{2,1,0} xla::cast(%992), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %994 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %995 = bf16[1,29,3584]{2,1,0} aten::mul(%994, %993), scope=aten::mul.62, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %996 = bf16[29,3584]{1,0} aten::view(%995), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %997 = bf16[29,18944]{1,0} aten::mm(%996, %485), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %998 = bf16[1,29,18944]{2,1,0} aten::view(%997), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %999 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1000 = bf16[3584,18944]{0,1} aten::permute(%999), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1001 = bf16[29,3584]{1,0} aten::view(%995), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1002 = bf16[29,18944]{1,0} aten::mm(%1001, %1000), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1003 = bf16[1,29,18944]{2,1,0} aten::view(%1002), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1004 = bf16[1,29,18944]{2,1,0} aten::silu(%1003), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1005 = bf16[1,29,18944]{2,1,0} aten::mul(%1004, %998), scope=aten::mul.63, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1006 = bf16[29,18944]{1,0} aten::view(%1005), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1007 = bf16[29,3584]{1,0} aten::mm(%1006, %483), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1008 = bf16[1,29,3584]{2,1,0} aten::view(%1007), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1009 = bf16[1,29,3584]{2,1,0} aten::add(%986, %1008, %481), scope=aten::add.64, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1010 = f32[1,29,3584]{2,1,0} xla::cast(%1009), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1011 = f32[1,29,3584]{2,1,0} aten::pow(%1010, %480), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1012 = f32[1,29,1]{2,1,0} aten::mean(%1011), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1013 = f32[1,29,1]{2,1,0} aten::add(%1012, %479, %478), scope=aten::add.65, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1014 = f32[1,29,1]{2,1,0} aten::rsqrt(%1013), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1015 = f32[1,29,3584]{2,1,0} aten::mul(%1010, %1014), scope=aten::mul.66, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1016 = bf16[1,29,3584]{2,1,0} xla::cast(%1015), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1017 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1018 = bf16[1,29,3584]{2,1,0} aten::mul(%1017, %1016), scope=aten::mul.67, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1019 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1020 = bf16[29,512]{1,0} aten::mm(%1019, %477), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1021 = bf16[1,29,512]{2,1,0} aten::view(%1020), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1022 = bf16[1,29,512]{2,1,0} aten::add(%1021, %475, %474), scope=aten::add.70, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1023 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1022), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1024 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1023), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1025 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1024), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1026 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1025), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1027 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1026), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1028 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1027), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1029 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1030 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1031 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1030), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1032 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1031), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1033 = bf16[28,29,128]{2,1,0} aten::view(%1032), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1034 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1035 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1036 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1037 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1038 = s64[1,29]{1,0} aten::expand(%1037), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1039 = s64[1,29]{1,0} aten::add(%628, %1038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1040 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1041 = pred[1,29]{1,0} aten::lt(%628, %1040), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1042 = s64[1,29]{1,0} aten::where(%1041, %1039, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1043 = s64[1,29,1]{2,1,0} aten::stack(%1042), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1044 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1045 = bf16[29,128]{1,0} xla::select(%1044), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1046 = bf16[1,29,128]{2,1,0} aten::index(%1045, %1043), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1047 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1046), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1048 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1049 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1050 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1051 = bf16[3584,512]{0,1} aten::permute(%1050), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1052 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1053 = bf16[29,512]{1,0} aten::mm(%1052, %1051), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1054 = bf16[1,29,512]{2,1,0} aten::view(%1053), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1055 = bf16[1,29,512]{2,1,0} aten::add(%1054, %1049, %1048), scope=aten::add.69, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1056 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1055), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1057 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1056), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1058 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1057), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1059 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1057), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1060 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1059), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1061 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1060, %1058), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1062 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1061, %1047), scope=aten::mul.75, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1063 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1064 = s64[1,29]{1,0} aten::expand(%1063), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1065 = s64[1,29]{1,0} aten::add(%628, %1064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1066 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1067 = pred[1,29]{1,0} aten::lt(%628, %1066), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1068 = s64[1,29]{1,0} aten::where(%1067, %1065, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1069 = s64[1,29,1]{2,1,0} aten::stack(%1068), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1070 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1071 = bf16[29,128]{1,0} xla::select(%1070), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1072 = bf16[1,29,128]{2,1,0} aten::index(%1071, %1069), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1073 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1072), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1074 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1057, %1073), scope=aten::mul.74, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1075 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1074, %1062, %1036), scope=aten::add.76, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1076 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1075), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1077 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1076), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1078 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1077), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1079 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1078), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1080 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1079), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1081 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1080), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1082 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1081), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1083 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1082), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1084 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1083), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1085 = bf16[28,128,29]{2,1,0} aten::view(%1084), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1086 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1087 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1088 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1089 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1090 = bf16[3584,3584]{0,1} aten::permute(%1089), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1091 = bf16[29,3584]{1,0} aten::view(%1018), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1092 = bf16[29,3584]{1,0} aten::mm(%1091, %1090), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1093 = bf16[1,29,3584]{2,1,0} aten::view(%1092), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1094 = bf16[1,29,3584]{2,1,0} aten::add(%1093, %1088, %1087), scope=aten::add.68, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1095 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1094), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1096 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1095), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1097 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1096), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1098 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1096), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1099 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1098), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1100 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1099, %1097), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1101 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1100, %1047), scope=aten::mul.72, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1102 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1096, %1073), scope=aten::mul.71, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1103 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1102, %1101, %1086), scope=aten::add.73, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1104 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1103), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1105 = bf16[28,29,128]{2,1,0} aten::view(%1104), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1106 = bf16[28,29,29]{2,1,0} aten::matmul(%1105, %1085), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1107 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1106), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1108 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1107, %1035), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1109 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1108, %617, %1034), scope=aten::add.77, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1110 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1109), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1111 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1110), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1112 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1111), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1113 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1112), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1114 = bf16[28,29,29]{2,1,0} aten::view(%1113), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1115 = bf16[28,29,128]{2,1,0} aten::matmul(%1114, %1033), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1116 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1115), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1117 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1116), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1118 = bf16[1,29,3584]{2,1,0} aten::view(%1117), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1119 = bf16[29,3584]{1,0} aten::view(%1118), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1120 = bf16[29,3584]{1,0} aten::mm(%1119, %473), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1121 = bf16[1,29,3584]{2,1,0} aten::view(%1120), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1122 = bf16[1,29,3584]{2,1,0} aten::add(%1009, %1121, %471), scope=aten::add.78, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1123 = f32[1,29,3584]{2,1,0} xla::cast(%1122), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1124 = f32[1,29,3584]{2,1,0} aten::pow(%1123, %470), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1125 = f32[1,29,1]{2,1,0} aten::mean(%1124), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1126 = f32[1,29,1]{2,1,0} aten::add(%1125, %469, %468), scope=aten::add.79, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1127 = f32[1,29,1]{2,1,0} aten::rsqrt(%1126), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1128 = f32[1,29,3584]{2,1,0} aten::mul(%1123, %1127), scope=aten::mul.80, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1129 = bf16[1,29,3584]{2,1,0} xla::cast(%1128), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1130 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1131 = bf16[1,29,3584]{2,1,0} aten::mul(%1130, %1129), scope=aten::mul.81, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1132 = bf16[29,3584]{1,0} aten::view(%1131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1133 = bf16[29,18944]{1,0} aten::mm(%1132, %467), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1134 = bf16[1,29,18944]{2,1,0} aten::view(%1133), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1135 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1136 = bf16[3584,18944]{0,1} aten::permute(%1135), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1137 = bf16[29,3584]{1,0} aten::view(%1131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1138 = bf16[29,18944]{1,0} aten::mm(%1137, %1136), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1139 = bf16[1,29,18944]{2,1,0} aten::view(%1138), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1140 = bf16[1,29,18944]{2,1,0} aten::silu(%1139), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1141 = bf16[1,29,18944]{2,1,0} aten::mul(%1140, %1134), scope=aten::mul.82, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1142 = bf16[29,18944]{1,0} aten::view(%1141), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1143 = bf16[29,3584]{1,0} aten::mm(%1142, %465), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1144 = bf16[1,29,3584]{2,1,0} aten::view(%1143), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1145 = bf16[1,29,3584]{2,1,0} aten::add(%1122, %1144, %463), scope=aten::add.83, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1146 = f32[1,29,3584]{2,1,0} xla::cast(%1145), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1147 = f32[1,29,3584]{2,1,0} aten::pow(%1146, %462), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1148 = f32[1,29,1]{2,1,0} aten::mean(%1147), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1149 = f32[1,29,1]{2,1,0} aten::add(%1148, %461, %460), scope=aten::add.84, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1150 = f32[1,29,1]{2,1,0} aten::rsqrt(%1149), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1151 = f32[1,29,3584]{2,1,0} aten::mul(%1146, %1150), scope=aten::mul.85, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1152 = bf16[1,29,3584]{2,1,0} xla::cast(%1151), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1153 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1154 = bf16[1,29,3584]{2,1,0} aten::mul(%1153, %1152), scope=aten::mul.86, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1155 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1156 = bf16[29,512]{1,0} aten::mm(%1155, %459), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1157 = bf16[1,29,512]{2,1,0} aten::view(%1156), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1158 = bf16[1,29,512]{2,1,0} aten::add(%1157, %457, %456), scope=aten::add.89, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1159 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1158), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1160 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1159), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1161 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1160), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1162 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1161), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1163 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1162), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1164 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1163), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1165 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1166 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1167 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1166), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1168 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1167), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1169 = bf16[28,29,128]{2,1,0} aten::view(%1168), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1170 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1171 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1172 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1173 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1174 = s64[1,29]{1,0} aten::expand(%1173), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1175 = s64[1,29]{1,0} aten::add(%628, %1174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1176 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1177 = pred[1,29]{1,0} aten::lt(%628, %1176), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1178 = s64[1,29]{1,0} aten::where(%1177, %1175, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1179 = s64[1,29,1]{2,1,0} aten::stack(%1178), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1180 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1181 = bf16[29,128]{1,0} xla::select(%1180), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1182 = bf16[1,29,128]{2,1,0} aten::index(%1181, %1179), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1183 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1182), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1184 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1185 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1186 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1187 = bf16[3584,512]{0,1} aten::permute(%1186), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1188 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1189 = bf16[29,512]{1,0} aten::mm(%1188, %1187), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1190 = bf16[1,29,512]{2,1,0} aten::view(%1189), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1191 = bf16[1,29,512]{2,1,0} aten::add(%1190, %1185, %1184), scope=aten::add.88, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1192 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1191), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1193 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1192), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1194 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1193), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1195 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1193), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1196 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1195), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1197 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1196, %1194), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1198 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1197, %1183), scope=aten::mul.94, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1199 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1200 = s64[1,29]{1,0} aten::expand(%1199), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1201 = s64[1,29]{1,0} aten::add(%628, %1200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1202 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1203 = pred[1,29]{1,0} aten::lt(%628, %1202), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1204 = s64[1,29]{1,0} aten::where(%1203, %1201, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1205 = s64[1,29,1]{2,1,0} aten::stack(%1204), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1206 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1207 = bf16[29,128]{1,0} xla::select(%1206), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1208 = bf16[1,29,128]{2,1,0} aten::index(%1207, %1205), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1209 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1208), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1210 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1193, %1209), scope=aten::mul.93, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1211 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1210, %1198, %1172), scope=aten::add.95, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1212 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1211), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1213 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1212), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1214 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1213), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1215 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1214), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1216 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1215), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1217 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1216), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1218 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1217), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1219 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1218), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1220 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1219), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1221 = bf16[28,128,29]{2,1,0} aten::view(%1220), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1222 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1223 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1224 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1225 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1226 = bf16[3584,3584]{0,1} aten::permute(%1225), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1227 = bf16[29,3584]{1,0} aten::view(%1154), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1228 = bf16[29,3584]{1,0} aten::mm(%1227, %1226), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1229 = bf16[1,29,3584]{2,1,0} aten::view(%1228), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1230 = bf16[1,29,3584]{2,1,0} aten::add(%1229, %1224, %1223), scope=aten::add.87, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1231 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1230), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1232 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1231), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1233 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1232), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1234 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1232), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1235 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1234), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1236 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1235, %1233), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1237 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1236, %1183), scope=aten::mul.91, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1238 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1232, %1209), scope=aten::mul.90, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1239 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1238, %1237, %1222), scope=aten::add.92, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1240 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1239), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1241 = bf16[28,29,128]{2,1,0} aten::view(%1240), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1242 = bf16[28,29,29]{2,1,0} aten::matmul(%1241, %1221), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1243 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1242), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1244 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1243, %1171), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1245 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1244, %617, %1170), scope=aten::add.96, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1246 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1245), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1247 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1246), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1248 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1247), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1249 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1248), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1250 = bf16[28,29,29]{2,1,0} aten::view(%1249), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1251 = bf16[28,29,128]{2,1,0} aten::matmul(%1250, %1169), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1252 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1251), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1253 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1252), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1254 = bf16[1,29,3584]{2,1,0} aten::view(%1253), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1255 = bf16[29,3584]{1,0} aten::view(%1254), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1256 = bf16[29,3584]{1,0} aten::mm(%1255, %455), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1257 = bf16[1,29,3584]{2,1,0} aten::view(%1256), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1258 = bf16[1,29,3584]{2,1,0} aten::add(%1145, %1257, %453), scope=aten::add.97, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1259 = f32[1,29,3584]{2,1,0} xla::cast(%1258), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1260 = f32[1,29,3584]{2,1,0} aten::pow(%1259, %452), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1261 = f32[1,29,1]{2,1,0} aten::mean(%1260), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1262 = f32[1,29,1]{2,1,0} aten::add(%1261, %451, %450), scope=aten::add.98, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1263 = f32[1,29,1]{2,1,0} aten::rsqrt(%1262), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1264 = f32[1,29,3584]{2,1,0} aten::mul(%1259, %1263), scope=aten::mul.99, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1265 = bf16[1,29,3584]{2,1,0} xla::cast(%1264), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1266 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1267 = bf16[1,29,3584]{2,1,0} aten::mul(%1266, %1265), scope=aten::mul.100, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1268 = bf16[29,3584]{1,0} aten::view(%1267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1269 = bf16[29,18944]{1,0} aten::mm(%1268, %449), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1270 = bf16[1,29,18944]{2,1,0} aten::view(%1269), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1271 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1272 = bf16[3584,18944]{0,1} aten::permute(%1271), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1273 = bf16[29,3584]{1,0} aten::view(%1267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1274 = bf16[29,18944]{1,0} aten::mm(%1273, %1272), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1275 = bf16[1,29,18944]{2,1,0} aten::view(%1274), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1276 = bf16[1,29,18944]{2,1,0} aten::silu(%1275), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1277 = bf16[1,29,18944]{2,1,0} aten::mul(%1276, %1270), scope=aten::mul.101, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1278 = bf16[29,18944]{1,0} aten::view(%1277), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1279 = bf16[29,3584]{1,0} aten::mm(%1278, %447), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1280 = bf16[1,29,3584]{2,1,0} aten::view(%1279), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1281 = bf16[1,29,3584]{2,1,0} aten::add(%1258, %1280, %445), scope=aten::add.102, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1282 = f32[1,29,3584]{2,1,0} xla::cast(%1281), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1283 = f32[1,29,3584]{2,1,0} aten::pow(%1282, %444), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1284 = f32[1,29,1]{2,1,0} aten::mean(%1283), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1285 = f32[1,29,1]{2,1,0} aten::add(%1284, %443, %442), scope=aten::add.103, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1286 = f32[1,29,1]{2,1,0} aten::rsqrt(%1285), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1287 = f32[1,29,3584]{2,1,0} aten::mul(%1282, %1286), scope=aten::mul.104, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1288 = bf16[1,29,3584]{2,1,0} xla::cast(%1287), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1289 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1290 = bf16[1,29,3584]{2,1,0} aten::mul(%1289, %1288), scope=aten::mul.105, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1291 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1292 = bf16[29,512]{1,0} aten::mm(%1291, %441), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1293 = bf16[1,29,512]{2,1,0} aten::view(%1292), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1294 = bf16[1,29,512]{2,1,0} aten::add(%1293, %439, %438), scope=aten::add.108, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1295 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1294), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1296 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1295), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1297 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1296), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1298 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1297), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1299 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1298), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1300 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1299), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1301 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1302 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1303 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1302), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1304 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1303), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1305 = bf16[28,29,128]{2,1,0} aten::view(%1304), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1306 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1307 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1308 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1309 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1310 = s64[1,29]{1,0} aten::expand(%1309), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1311 = s64[1,29]{1,0} aten::add(%628, %1310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1312 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1313 = pred[1,29]{1,0} aten::lt(%628, %1312), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1314 = s64[1,29]{1,0} aten::where(%1313, %1311, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1315 = s64[1,29,1]{2,1,0} aten::stack(%1314), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1316 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1317 = bf16[29,128]{1,0} xla::select(%1316), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1318 = bf16[1,29,128]{2,1,0} aten::index(%1317, %1315), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1319 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1318), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1320 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1321 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1322 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1323 = bf16[3584,512]{0,1} aten::permute(%1322), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1324 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1325 = bf16[29,512]{1,0} aten::mm(%1324, %1323), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1326 = bf16[1,29,512]{2,1,0} aten::view(%1325), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1327 = bf16[1,29,512]{2,1,0} aten::add(%1326, %1321, %1320), scope=aten::add.107, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1328 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1327), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1329 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1328), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1330 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1329), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1331 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1329), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1332 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1331), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1333 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1332, %1330), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1334 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1333, %1319), scope=aten::mul.113, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1335 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1336 = s64[1,29]{1,0} aten::expand(%1335), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1337 = s64[1,29]{1,0} aten::add(%628, %1336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1338 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1339 = pred[1,29]{1,0} aten::lt(%628, %1338), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1340 = s64[1,29]{1,0} aten::where(%1339, %1337, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1341 = s64[1,29,1]{2,1,0} aten::stack(%1340), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1342 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1343 = bf16[29,128]{1,0} xla::select(%1342), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1344 = bf16[1,29,128]{2,1,0} aten::index(%1343, %1341), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1345 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1344), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1346 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1329, %1345), scope=aten::mul.112, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1347 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1346, %1334, %1308), scope=aten::add.114, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1348 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1347), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1349 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1348), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1350 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1349), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1351 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1350), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1352 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1351), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1353 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1352), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1354 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1353), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1355 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1354), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1356 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1355), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1357 = bf16[28,128,29]{2,1,0} aten::view(%1356), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1358 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1359 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1360 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1361 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1362 = bf16[3584,3584]{0,1} aten::permute(%1361), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1363 = bf16[29,3584]{1,0} aten::view(%1290), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1364 = bf16[29,3584]{1,0} aten::mm(%1363, %1362), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1365 = bf16[1,29,3584]{2,1,0} aten::view(%1364), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1366 = bf16[1,29,3584]{2,1,0} aten::add(%1365, %1360, %1359), scope=aten::add.106, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1367 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1366), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1368 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1367), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1369 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1368), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1370 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1368), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1371 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1370), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1372 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1371, %1369), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1373 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1372, %1319), scope=aten::mul.110, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1374 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1368, %1345), scope=aten::mul.109, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1375 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1374, %1373, %1358), scope=aten::add.111, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1376 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1375), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1377 = bf16[28,29,128]{2,1,0} aten::view(%1376), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1378 = bf16[28,29,29]{2,1,0} aten::matmul(%1377, %1357), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1379 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1378), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1380 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1379, %1307), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1381 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1380, %617, %1306), scope=aten::add.115, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1382 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1381), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1383 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1382), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1384 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1383), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1385 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1384), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1386 = bf16[28,29,29]{2,1,0} aten::view(%1385), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1387 = bf16[28,29,128]{2,1,0} aten::matmul(%1386, %1305), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1388 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1387), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1389 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1388), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1390 = bf16[1,29,3584]{2,1,0} aten::view(%1389), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1391 = bf16[29,3584]{1,0} aten::view(%1390), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1392 = bf16[29,3584]{1,0} aten::mm(%1391, %437), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1393 = bf16[1,29,3584]{2,1,0} aten::view(%1392), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1394 = bf16[1,29,3584]{2,1,0} aten::add(%1281, %1393, %435), scope=aten::add.116, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1395 = f32[1,29,3584]{2,1,0} xla::cast(%1394), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1396 = f32[1,29,3584]{2,1,0} aten::pow(%1395, %434), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1397 = f32[1,29,1]{2,1,0} aten::mean(%1396), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1398 = f32[1,29,1]{2,1,0} aten::add(%1397, %433, %432), scope=aten::add.117, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1399 = f32[1,29,1]{2,1,0} aten::rsqrt(%1398), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1400 = f32[1,29,3584]{2,1,0} aten::mul(%1395, %1399), scope=aten::mul.118, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1401 = bf16[1,29,3584]{2,1,0} xla::cast(%1400), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1402 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1403 = bf16[1,29,3584]{2,1,0} aten::mul(%1402, %1401), scope=aten::mul.119, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1404 = bf16[29,3584]{1,0} aten::view(%1403), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1405 = bf16[29,18944]{1,0} aten::mm(%1404, %431), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1406 = bf16[1,29,18944]{2,1,0} aten::view(%1405), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1407 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1408 = bf16[3584,18944]{0,1} aten::permute(%1407), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1409 = bf16[29,3584]{1,0} aten::view(%1403), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1410 = bf16[29,18944]{1,0} aten::mm(%1409, %1408), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1411 = bf16[1,29,18944]{2,1,0} aten::view(%1410), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1412 = bf16[1,29,18944]{2,1,0} aten::silu(%1411), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1413 = bf16[1,29,18944]{2,1,0} aten::mul(%1412, %1406), scope=aten::mul.120, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1414 = bf16[29,18944]{1,0} aten::view(%1413), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1415 = bf16[29,3584]{1,0} aten::mm(%1414, %429), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1416 = bf16[1,29,3584]{2,1,0} aten::view(%1415), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1417 = bf16[1,29,3584]{2,1,0} aten::add(%1394, %1416, %427), scope=aten::add.121, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1418 = f32[1,29,3584]{2,1,0} xla::cast(%1417), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1419 = f32[1,29,3584]{2,1,0} aten::pow(%1418, %426), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1420 = f32[1,29,1]{2,1,0} aten::mean(%1419), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1421 = f32[1,29,1]{2,1,0} aten::add(%1420, %425, %424), scope=aten::add.122, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1422 = f32[1,29,1]{2,1,0} aten::rsqrt(%1421), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1423 = f32[1,29,3584]{2,1,0} aten::mul(%1418, %1422), scope=aten::mul.123, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1424 = bf16[1,29,3584]{2,1,0} xla::cast(%1423), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1425 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1426 = bf16[1,29,3584]{2,1,0} aten::mul(%1425, %1424), scope=aten::mul.124, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1427 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1428 = bf16[29,512]{1,0} aten::mm(%1427, %423), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1429 = bf16[1,29,512]{2,1,0} aten::view(%1428), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1430 = bf16[1,29,512]{2,1,0} aten::add(%1429, %421, %420), scope=aten::add.127, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1431 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1430), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1432 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1431), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1433 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1432), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1434 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1433), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1435 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1434), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1436 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1435), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1437 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1438 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1439 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1438), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1440 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1439), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1441 = bf16[28,29,128]{2,1,0} aten::view(%1440), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1442 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1443 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1444 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1445 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1446 = s64[1,29]{1,0} aten::expand(%1445), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1447 = s64[1,29]{1,0} aten::add(%628, %1446), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1448 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1449 = pred[1,29]{1,0} aten::lt(%628, %1448), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1450 = s64[1,29]{1,0} aten::where(%1449, %1447, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1451 = s64[1,29,1]{2,1,0} aten::stack(%1450), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1452 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1453 = bf16[29,128]{1,0} xla::select(%1452), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1454 = bf16[1,29,128]{2,1,0} aten::index(%1453, %1451), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1455 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1454), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1456 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1457 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1458 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1459 = bf16[3584,512]{0,1} aten::permute(%1458), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1460 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1461 = bf16[29,512]{1,0} aten::mm(%1460, %1459), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1462 = bf16[1,29,512]{2,1,0} aten::view(%1461), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1463 = bf16[1,29,512]{2,1,0} aten::add(%1462, %1457, %1456), scope=aten::add.126, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1464 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1463), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1465 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1464), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1466 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1465), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1467 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1465), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1468 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1467), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1469 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1468, %1466), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1470 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1469, %1455), scope=aten::mul.132, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1471 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1472 = s64[1,29]{1,0} aten::expand(%1471), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1473 = s64[1,29]{1,0} aten::add(%628, %1472), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1474 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1475 = pred[1,29]{1,0} aten::lt(%628, %1474), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1476 = s64[1,29]{1,0} aten::where(%1475, %1473, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1477 = s64[1,29,1]{2,1,0} aten::stack(%1476), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1478 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1479 = bf16[29,128]{1,0} xla::select(%1478), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1480 = bf16[1,29,128]{2,1,0} aten::index(%1479, %1477), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1481 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1480), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1482 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1465, %1481), scope=aten::mul.131, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1483 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1482, %1470, %1444), scope=aten::add.133, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1484 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1483), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1485 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1484), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1486 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1485), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1487 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1486), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1488 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1487), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1489 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1488), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1490 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1489), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1491 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1490), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1492 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1491), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1493 = bf16[28,128,29]{2,1,0} aten::view(%1492), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1494 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1495 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1496 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1497 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1498 = bf16[3584,3584]{0,1} aten::permute(%1497), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1499 = bf16[29,3584]{1,0} aten::view(%1426), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1500 = bf16[29,3584]{1,0} aten::mm(%1499, %1498), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1501 = bf16[1,29,3584]{2,1,0} aten::view(%1500), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1502 = bf16[1,29,3584]{2,1,0} aten::add(%1501, %1496, %1495), scope=aten::add.125, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1503 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1502), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1504 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1503), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1505 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1504), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1506 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1504), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1507 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1506), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1508 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1507, %1505), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1509 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1508, %1455), scope=aten::mul.129, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1510 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1504, %1481), scope=aten::mul.128, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1511 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1510, %1509, %1494), scope=aten::add.130, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1512 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1511), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1513 = bf16[28,29,128]{2,1,0} aten::view(%1512), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1514 = bf16[28,29,29]{2,1,0} aten::matmul(%1513, %1493), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1515 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1514), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1516 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1515, %1443), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1517 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1516, %617, %1442), scope=aten::add.134, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1518 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1517), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1519 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1518), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1520 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1519), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1521 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1520), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1522 = bf16[28,29,29]{2,1,0} aten::view(%1521), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1523 = bf16[28,29,128]{2,1,0} aten::matmul(%1522, %1441), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1524 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1523), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1525 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1524), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1526 = bf16[1,29,3584]{2,1,0} aten::view(%1525), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1527 = bf16[29,3584]{1,0} aten::view(%1526), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1528 = bf16[29,3584]{1,0} aten::mm(%1527, %419), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1529 = bf16[1,29,3584]{2,1,0} aten::view(%1528), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1530 = bf16[1,29,3584]{2,1,0} aten::add(%1417, %1529, %417), scope=aten::add.135, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1531 = f32[1,29,3584]{2,1,0} xla::cast(%1530), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1532 = f32[1,29,3584]{2,1,0} aten::pow(%1531, %416), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1533 = f32[1,29,1]{2,1,0} aten::mean(%1532), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1534 = f32[1,29,1]{2,1,0} aten::add(%1533, %415, %414), scope=aten::add.136, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1535 = f32[1,29,1]{2,1,0} aten::rsqrt(%1534), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1536 = f32[1,29,3584]{2,1,0} aten::mul(%1531, %1535), scope=aten::mul.137, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1537 = bf16[1,29,3584]{2,1,0} xla::cast(%1536), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1538 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1539 = bf16[1,29,3584]{2,1,0} aten::mul(%1538, %1537), scope=aten::mul.138, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1540 = bf16[29,3584]{1,0} aten::view(%1539), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1541 = bf16[29,18944]{1,0} aten::mm(%1540, %413), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1542 = bf16[1,29,18944]{2,1,0} aten::view(%1541), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1543 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1544 = bf16[3584,18944]{0,1} aten::permute(%1543), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1545 = bf16[29,3584]{1,0} aten::view(%1539), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1546 = bf16[29,18944]{1,0} aten::mm(%1545, %1544), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1547 = bf16[1,29,18944]{2,1,0} aten::view(%1546), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1548 = bf16[1,29,18944]{2,1,0} aten::silu(%1547), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1549 = bf16[1,29,18944]{2,1,0} aten::mul(%1548, %1542), scope=aten::mul.139, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1550 = bf16[29,18944]{1,0} aten::view(%1549), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1551 = bf16[29,3584]{1,0} aten::mm(%1550, %411), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1552 = bf16[1,29,3584]{2,1,0} aten::view(%1551), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1553 = bf16[1,29,3584]{2,1,0} aten::add(%1530, %1552, %409), scope=aten::add.140, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1554 = f32[1,29,3584]{2,1,0} xla::cast(%1553), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1555 = f32[1,29,3584]{2,1,0} aten::pow(%1554, %408), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1556 = f32[1,29,1]{2,1,0} aten::mean(%1555), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1557 = f32[1,29,1]{2,1,0} aten::add(%1556, %407, %406), scope=aten::add.141, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1558 = f32[1,29,1]{2,1,0} aten::rsqrt(%1557), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1559 = f32[1,29,3584]{2,1,0} aten::mul(%1554, %1558), scope=aten::mul.142, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1560 = bf16[1,29,3584]{2,1,0} xla::cast(%1559), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1561 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1562 = bf16[1,29,3584]{2,1,0} aten::mul(%1561, %1560), scope=aten::mul.143, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1563 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1564 = bf16[29,512]{1,0} aten::mm(%1563, %405), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1565 = bf16[1,29,512]{2,1,0} aten::view(%1564), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1566 = bf16[1,29,512]{2,1,0} aten::add(%1565, %403, %402), scope=aten::add.146, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1567 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1566), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1568 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1567), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1569 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1568), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1570 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1569), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1571 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1570), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1572 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1571), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1573 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1574 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1575 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1574), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1576 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1575), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1577 = bf16[28,29,128]{2,1,0} aten::view(%1576), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1578 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1579 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1580 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1581 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1582 = s64[1,29]{1,0} aten::expand(%1581), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1583 = s64[1,29]{1,0} aten::add(%628, %1582), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1584 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1585 = pred[1,29]{1,0} aten::lt(%628, %1584), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1586 = s64[1,29]{1,0} aten::where(%1585, %1583, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1587 = s64[1,29,1]{2,1,0} aten::stack(%1586), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1588 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1589 = bf16[29,128]{1,0} xla::select(%1588), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1590 = bf16[1,29,128]{2,1,0} aten::index(%1589, %1587), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1591 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1590), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1592 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1593 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1594 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1595 = bf16[3584,512]{0,1} aten::permute(%1594), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1596 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1597 = bf16[29,512]{1,0} aten::mm(%1596, %1595), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1598 = bf16[1,29,512]{2,1,0} aten::view(%1597), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1599 = bf16[1,29,512]{2,1,0} aten::add(%1598, %1593, %1592), scope=aten::add.145, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1600 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1599), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1601 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1600), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1602 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1601), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1603 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1601), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1604 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1603), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1605 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1604, %1602), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1606 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1605, %1591), scope=aten::mul.151, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1607 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1608 = s64[1,29]{1,0} aten::expand(%1607), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1609 = s64[1,29]{1,0} aten::add(%628, %1608), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1610 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1611 = pred[1,29]{1,0} aten::lt(%628, %1610), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1612 = s64[1,29]{1,0} aten::where(%1611, %1609, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1613 = s64[1,29,1]{2,1,0} aten::stack(%1612), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1614 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1615 = bf16[29,128]{1,0} xla::select(%1614), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1616 = bf16[1,29,128]{2,1,0} aten::index(%1615, %1613), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1617 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1616), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1618 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1601, %1617), scope=aten::mul.150, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1619 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1618, %1606, %1580), scope=aten::add.152, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1620 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1619), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1621 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1620), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1622 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1621), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1623 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1622), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1624 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1623), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1625 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1624), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1626 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1625), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1627 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1626), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1628 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1627), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1629 = bf16[28,128,29]{2,1,0} aten::view(%1628), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1630 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1631 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1632 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1633 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1634 = bf16[3584,3584]{0,1} aten::permute(%1633), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1635 = bf16[29,3584]{1,0} aten::view(%1562), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1636 = bf16[29,3584]{1,0} aten::mm(%1635, %1634), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1637 = bf16[1,29,3584]{2,1,0} aten::view(%1636), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1638 = bf16[1,29,3584]{2,1,0} aten::add(%1637, %1632, %1631), scope=aten::add.144, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1639 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1638), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1640 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1639), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1641 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1640), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1642 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1640), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1643 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1642), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1644 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1643, %1641), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1645 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1644, %1591), scope=aten::mul.148, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1646 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1640, %1617), scope=aten::mul.147, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1647 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1646, %1645, %1630), scope=aten::add.149, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1648 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1647), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1649 = bf16[28,29,128]{2,1,0} aten::view(%1648), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1650 = bf16[28,29,29]{2,1,0} aten::matmul(%1649, %1629), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1651 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1650), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1652 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1651, %1579), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1653 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1652, %617, %1578), scope=aten::add.153, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1654 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1653), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1655 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1654), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1656 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1655), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1657 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1656), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1658 = bf16[28,29,29]{2,1,0} aten::view(%1657), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1659 = bf16[28,29,128]{2,1,0} aten::matmul(%1658, %1577), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1660 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1659), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1661 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1660), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1662 = bf16[1,29,3584]{2,1,0} aten::view(%1661), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1663 = bf16[29,3584]{1,0} aten::view(%1662), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1664 = bf16[29,3584]{1,0} aten::mm(%1663, %401), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1665 = bf16[1,29,3584]{2,1,0} aten::view(%1664), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1666 = bf16[1,29,3584]{2,1,0} aten::add(%1553, %1665, %399), scope=aten::add.154, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1667 = f32[1,29,3584]{2,1,0} xla::cast(%1666), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1668 = f32[1,29,3584]{2,1,0} aten::pow(%1667, %398), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1669 = f32[1,29,1]{2,1,0} aten::mean(%1668), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1670 = f32[1,29,1]{2,1,0} aten::add(%1669, %397, %396), scope=aten::add.155, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1671 = f32[1,29,1]{2,1,0} aten::rsqrt(%1670), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1672 = f32[1,29,3584]{2,1,0} aten::mul(%1667, %1671), scope=aten::mul.156, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1673 = bf16[1,29,3584]{2,1,0} xla::cast(%1672), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1674 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1675 = bf16[1,29,3584]{2,1,0} aten::mul(%1674, %1673), scope=aten::mul.157, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1676 = bf16[29,3584]{1,0} aten::view(%1675), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1677 = bf16[29,18944]{1,0} aten::mm(%1676, %395), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1678 = bf16[1,29,18944]{2,1,0} aten::view(%1677), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1679 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1680 = bf16[3584,18944]{0,1} aten::permute(%1679), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1681 = bf16[29,3584]{1,0} aten::view(%1675), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1682 = bf16[29,18944]{1,0} aten::mm(%1681, %1680), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1683 = bf16[1,29,18944]{2,1,0} aten::view(%1682), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1684 = bf16[1,29,18944]{2,1,0} aten::silu(%1683), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1685 = bf16[1,29,18944]{2,1,0} aten::mul(%1684, %1678), scope=aten::mul.158, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1686 = bf16[29,18944]{1,0} aten::view(%1685), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1687 = bf16[29,3584]{1,0} aten::mm(%1686, %393), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1688 = bf16[1,29,3584]{2,1,0} aten::view(%1687), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1689 = bf16[1,29,3584]{2,1,0} aten::add(%1666, %1688, %391), scope=aten::add.159, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1690 = f32[1,29,3584]{2,1,0} xla::cast(%1689), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1691 = f32[1,29,3584]{2,1,0} aten::pow(%1690, %390), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1692 = f32[1,29,1]{2,1,0} aten::mean(%1691), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1693 = f32[1,29,1]{2,1,0} aten::add(%1692, %389, %388), scope=aten::add.160, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1694 = f32[1,29,1]{2,1,0} aten::rsqrt(%1693), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1695 = f32[1,29,3584]{2,1,0} aten::mul(%1690, %1694), scope=aten::mul.161, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1696 = bf16[1,29,3584]{2,1,0} xla::cast(%1695), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1697 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1698 = bf16[1,29,3584]{2,1,0} aten::mul(%1697, %1696), scope=aten::mul.162, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1699 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1700 = bf16[29,512]{1,0} aten::mm(%1699, %387), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1701 = bf16[1,29,512]{2,1,0} aten::view(%1700), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1702 = bf16[1,29,512]{2,1,0} aten::add(%1701, %385, %384), scope=aten::add.165, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1703 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1702), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1704 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1703), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1705 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1704), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1706 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1705), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1707 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1706), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1708 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1707), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1709 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1710 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1711 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1710), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1712 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1711), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1713 = bf16[28,29,128]{2,1,0} aten::view(%1712), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1714 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1715 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1716 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1717 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1718 = s64[1,29]{1,0} aten::expand(%1717), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1719 = s64[1,29]{1,0} aten::add(%628, %1718), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1720 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1721 = pred[1,29]{1,0} aten::lt(%628, %1720), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1722 = s64[1,29]{1,0} aten::where(%1721, %1719, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1723 = s64[1,29,1]{2,1,0} aten::stack(%1722), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1724 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1725 = bf16[29,128]{1,0} xla::select(%1724), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1726 = bf16[1,29,128]{2,1,0} aten::index(%1725, %1723), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1727 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1726), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1728 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1729 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1730 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1731 = bf16[3584,512]{0,1} aten::permute(%1730), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1732 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1733 = bf16[29,512]{1,0} aten::mm(%1732, %1731), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1734 = bf16[1,29,512]{2,1,0} aten::view(%1733), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1735 = bf16[1,29,512]{2,1,0} aten::add(%1734, %1729, %1728), scope=aten::add.164, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1736 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1735), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1737 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1736), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1738 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1737), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1739 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1737), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1740 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1739), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1741 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1740, %1738), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1742 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1741, %1727), scope=aten::mul.170, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1743 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1744 = s64[1,29]{1,0} aten::expand(%1743), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1745 = s64[1,29]{1,0} aten::add(%628, %1744), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1746 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1747 = pred[1,29]{1,0} aten::lt(%628, %1746), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1748 = s64[1,29]{1,0} aten::where(%1747, %1745, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1749 = s64[1,29,1]{2,1,0} aten::stack(%1748), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1750 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1751 = bf16[29,128]{1,0} xla::select(%1750), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1752 = bf16[1,29,128]{2,1,0} aten::index(%1751, %1749), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1753 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1752), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1754 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1737, %1753), scope=aten::mul.169, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1755 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1754, %1742, %1716), scope=aten::add.171, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1756 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1755), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1757 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1758 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1759 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1758), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1760 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1759), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1761 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1760), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1762 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1761), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1763 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1762), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1764 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1763), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1765 = bf16[28,128,29]{2,1,0} aten::view(%1764), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1766 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1767 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1768 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1769 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1770 = bf16[3584,3584]{0,1} aten::permute(%1769), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1771 = bf16[29,3584]{1,0} aten::view(%1698), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1772 = bf16[29,3584]{1,0} aten::mm(%1771, %1770), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1773 = bf16[1,29,3584]{2,1,0} aten::view(%1772), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1774 = bf16[1,29,3584]{2,1,0} aten::add(%1773, %1768, %1767), scope=aten::add.163, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1775 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1774), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1776 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1775), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1777 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1776), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1778 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1776), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1779 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1778), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1780 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1779, %1777), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1781 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1780, %1727), scope=aten::mul.167, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1782 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1776, %1753), scope=aten::mul.166, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1783 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1782, %1781, %1766), scope=aten::add.168, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1784 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1783), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1785 = bf16[28,29,128]{2,1,0} aten::view(%1784), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1786 = bf16[28,29,29]{2,1,0} aten::matmul(%1785, %1765), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1787 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1786), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1788 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1787, %1715), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1789 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1788, %617, %1714), scope=aten::add.172, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1790 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1789), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1791 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1790), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1792 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1791), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1793 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1792), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1794 = bf16[28,29,29]{2,1,0} aten::view(%1793), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1795 = bf16[28,29,128]{2,1,0} aten::matmul(%1794, %1713), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1796 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1795), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1797 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1796), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1798 = bf16[1,29,3584]{2,1,0} aten::view(%1797), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1799 = bf16[29,3584]{1,0} aten::view(%1798), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1800 = bf16[29,3584]{1,0} aten::mm(%1799, %383), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1801 = bf16[1,29,3584]{2,1,0} aten::view(%1800), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1802 = bf16[1,29,3584]{2,1,0} aten::add(%1689, %1801, %381), scope=aten::add.173, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1803 = f32[1,29,3584]{2,1,0} xla::cast(%1802), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1804 = f32[1,29,3584]{2,1,0} aten::pow(%1803, %380), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1805 = f32[1,29,1]{2,1,0} aten::mean(%1804), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1806 = f32[1,29,1]{2,1,0} aten::add(%1805, %379, %378), scope=aten::add.174, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1807 = f32[1,29,1]{2,1,0} aten::rsqrt(%1806), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1808 = f32[1,29,3584]{2,1,0} aten::mul(%1803, %1807), scope=aten::mul.175, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1809 = bf16[1,29,3584]{2,1,0} xla::cast(%1808), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1810 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1811 = bf16[1,29,3584]{2,1,0} aten::mul(%1810, %1809), scope=aten::mul.176, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1812 = bf16[29,3584]{1,0} aten::view(%1811), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1813 = bf16[29,18944]{1,0} aten::mm(%1812, %377), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1814 = bf16[1,29,18944]{2,1,0} aten::view(%1813), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1815 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1816 = bf16[3584,18944]{0,1} aten::permute(%1815), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1817 = bf16[29,3584]{1,0} aten::view(%1811), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1818 = bf16[29,18944]{1,0} aten::mm(%1817, %1816), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1819 = bf16[1,29,18944]{2,1,0} aten::view(%1818), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1820 = bf16[1,29,18944]{2,1,0} aten::silu(%1819), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1821 = bf16[1,29,18944]{2,1,0} aten::mul(%1820, %1814), scope=aten::mul.177, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1822 = bf16[29,18944]{1,0} aten::view(%1821), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1823 = bf16[29,3584]{1,0} aten::mm(%1822, %375), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1824 = bf16[1,29,3584]{2,1,0} aten::view(%1823), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1825 = bf16[1,29,3584]{2,1,0} aten::add(%1802, %1824, %373), scope=aten::add.178, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1826 = f32[1,29,3584]{2,1,0} xla::cast(%1825), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1827 = f32[1,29,3584]{2,1,0} aten::pow(%1826, %372), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1828 = f32[1,29,1]{2,1,0} aten::mean(%1827), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1829 = f32[1,29,1]{2,1,0} aten::add(%1828, %371, %370), scope=aten::add.179, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1830 = f32[1,29,1]{2,1,0} aten::rsqrt(%1829), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1831 = f32[1,29,3584]{2,1,0} aten::mul(%1826, %1830), scope=aten::mul.180, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1832 = bf16[1,29,3584]{2,1,0} xla::cast(%1831), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1833 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1834 = bf16[1,29,3584]{2,1,0} aten::mul(%1833, %1832), scope=aten::mul.181, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1835 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1836 = bf16[29,512]{1,0} aten::mm(%1835, %369), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1837 = bf16[1,29,512]{2,1,0} aten::view(%1836), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1838 = bf16[1,29,512]{2,1,0} aten::add(%1837, %367, %366), scope=aten::add.184, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1839 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1838), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1840 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1839), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1841 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1840), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1842 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1841), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1843 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1842), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1844 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1843), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1845 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1846 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1847 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1846), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1848 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1847), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1849 = bf16[28,29,128]{2,1,0} aten::view(%1848), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1850 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1851 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1852 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1853 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1854 = s64[1,29]{1,0} aten::expand(%1853), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1855 = s64[1,29]{1,0} aten::add(%628, %1854), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1856 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1857 = pred[1,29]{1,0} aten::lt(%628, %1856), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1858 = s64[1,29]{1,0} aten::where(%1857, %1855, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1859 = s64[1,29,1]{2,1,0} aten::stack(%1858), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1860 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1861 = bf16[29,128]{1,0} xla::select(%1860), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1862 = bf16[1,29,128]{2,1,0} aten::index(%1861, %1859), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1863 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1862), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1864 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1865 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1866 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1867 = bf16[3584,512]{0,1} aten::permute(%1866), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1868 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1869 = bf16[29,512]{1,0} aten::mm(%1868, %1867), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1870 = bf16[1,29,512]{2,1,0} aten::view(%1869), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1871 = bf16[1,29,512]{2,1,0} aten::add(%1870, %1865, %1864), scope=aten::add.183, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1872 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1871), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1873 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1872), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1874 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1873), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1875 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1873), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1876 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1875), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1877 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1876, %1874), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1878 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1877, %1863), scope=aten::mul.189, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1879 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1880 = s64[1,29]{1,0} aten::expand(%1879), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1881 = s64[1,29]{1,0} aten::add(%628, %1880), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1882 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1883 = pred[1,29]{1,0} aten::lt(%628, %1882), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1884 = s64[1,29]{1,0} aten::where(%1883, %1881, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1885 = s64[1,29,1]{2,1,0} aten::stack(%1884), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1886 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1887 = bf16[29,128]{1,0} xla::select(%1886), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1888 = bf16[1,29,128]{2,1,0} aten::index(%1887, %1885), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1889 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1888), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1890 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1873, %1889), scope=aten::mul.188, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1891 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1890, %1878, %1852), scope=aten::add.190, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1892 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1891), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1893 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1894 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1895 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1894), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1896 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1895), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1897 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1896), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1898 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1897), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1899 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1898), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1900 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1899), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1901 = bf16[28,128,29]{2,1,0} aten::view(%1900), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1902 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1903 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1904 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1905 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1906 = bf16[3584,3584]{0,1} aten::permute(%1905), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1907 = bf16[29,3584]{1,0} aten::view(%1834), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1908 = bf16[29,3584]{1,0} aten::mm(%1907, %1906), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1909 = bf16[1,29,3584]{2,1,0} aten::view(%1908), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1910 = bf16[1,29,3584]{2,1,0} aten::add(%1909, %1904, %1903), scope=aten::add.182, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1911 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1910), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1912 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1911), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1913 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1912), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1914 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1912), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1915 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1914), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1916 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1915, %1913), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1917 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1916, %1863), scope=aten::mul.186, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1918 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1912, %1889), scope=aten::mul.185, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1919 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1918, %1917, %1902), scope=aten::add.187, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1920 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1919), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1921 = bf16[28,29,128]{2,1,0} aten::view(%1920), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1922 = bf16[28,29,29]{2,1,0} aten::matmul(%1921, %1901), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1923 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1922), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1924 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1923, %1851), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1925 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1924, %617, %1850), scope=aten::add.191, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1926 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1925), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1927 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1926), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1928 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1927), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1929 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1928), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1930 = bf16[28,29,29]{2,1,0} aten::view(%1929), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1931 = bf16[28,29,128]{2,1,0} aten::matmul(%1930, %1849), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1932 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1931), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1933 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1932), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1934 = bf16[1,29,3584]{2,1,0} aten::view(%1933), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1935 = bf16[29,3584]{1,0} aten::view(%1934), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1936 = bf16[29,3584]{1,0} aten::mm(%1935, %365), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1937 = bf16[1,29,3584]{2,1,0} aten::view(%1936), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1938 = bf16[1,29,3584]{2,1,0} aten::add(%1825, %1937, %363), scope=aten::add.192, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1939 = f32[1,29,3584]{2,1,0} xla::cast(%1938), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1940 = f32[1,29,3584]{2,1,0} aten::pow(%1939, %362), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1941 = f32[1,29,1]{2,1,0} aten::mean(%1940), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1942 = f32[1,29,1]{2,1,0} aten::add(%1941, %361, %360), scope=aten::add.193, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1943 = f32[1,29,1]{2,1,0} aten::rsqrt(%1942), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1944 = f32[1,29,3584]{2,1,0} aten::mul(%1939, %1943), scope=aten::mul.194, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1945 = bf16[1,29,3584]{2,1,0} xla::cast(%1944), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1946 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1947 = bf16[1,29,3584]{2,1,0} aten::mul(%1946, %1945), scope=aten::mul.195, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1948 = bf16[29,3584]{1,0} aten::view(%1947), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1949 = bf16[29,18944]{1,0} aten::mm(%1948, %359), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1950 = bf16[1,29,18944]{2,1,0} aten::view(%1949), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1951 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1952 = bf16[3584,18944]{0,1} aten::permute(%1951), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1953 = bf16[29,3584]{1,0} aten::view(%1947), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1954 = bf16[29,18944]{1,0} aten::mm(%1953, %1952), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1955 = bf16[1,29,18944]{2,1,0} aten::view(%1954), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1956 = bf16[1,29,18944]{2,1,0} aten::silu(%1955), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1957 = bf16[1,29,18944]{2,1,0} aten::mul(%1956, %1950), scope=aten::mul.196, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1958 = bf16[29,18944]{1,0} aten::view(%1957), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1959 = bf16[29,3584]{1,0} aten::mm(%1958, %357), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1960 = bf16[1,29,3584]{2,1,0} aten::view(%1959), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1961 = bf16[1,29,3584]{2,1,0} aten::add(%1938, %1960, %355), scope=aten::add.197, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1962 = f32[1,29,3584]{2,1,0} xla::cast(%1961), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1963 = f32[1,29,3584]{2,1,0} aten::pow(%1962, %354), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1964 = f32[1,29,1]{2,1,0} aten::mean(%1963), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1965 = f32[1,29,1]{2,1,0} aten::add(%1964, %353, %352), scope=aten::add.198, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1966 = f32[1,29,1]{2,1,0} aten::rsqrt(%1965), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1967 = f32[1,29,3584]{2,1,0} aten::mul(%1962, %1966), scope=aten::mul.199, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1968 = bf16[1,29,3584]{2,1,0} xla::cast(%1967), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1969 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1970 = bf16[1,29,3584]{2,1,0} aten::mul(%1969, %1968), scope=aten::mul.200, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1971 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1972 = bf16[29,512]{1,0} aten::mm(%1971, %351), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1973 = bf16[1,29,512]{2,1,0} aten::view(%1972), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1974 = bf16[1,29,512]{2,1,0} aten::add(%1973, %349, %348), scope=aten::add.203, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1975 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1974), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1976 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1975), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1977 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1976), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1978 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1977), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1979 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1978), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1980 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1979), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1981 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1982 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1983 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1982), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1984 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1983), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1985 = bf16[28,29,128]{2,1,0} aten::view(%1984), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1986 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1987 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1988 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1989 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1990 = s64[1,29]{1,0} aten::expand(%1989), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1991 = s64[1,29]{1,0} aten::add(%628, %1990), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1992 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1993 = pred[1,29]{1,0} aten::lt(%628, %1992), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1994 = s64[1,29]{1,0} aten::where(%1993, %1991, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1995 = s64[1,29,1]{2,1,0} aten::stack(%1994), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1996 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1997 = bf16[29,128]{1,0} xla::select(%1996), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1998 = bf16[1,29,128]{2,1,0} aten::index(%1997, %1995), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1999 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1998), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2000 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2001 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2002 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2003 = bf16[3584,512]{0,1} aten::permute(%2002), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2004 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2005 = bf16[29,512]{1,0} aten::mm(%2004, %2003), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2006 = bf16[1,29,512]{2,1,0} aten::view(%2005), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2007 = bf16[1,29,512]{2,1,0} aten::add(%2006, %2001, %2000), scope=aten::add.202, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2008 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2007), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2009 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2008), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2010 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2009), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2011 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2009), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2012 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2011), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2013 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2012, %2010), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2014 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2013, %1999), scope=aten::mul.208, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2015 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2016 = s64[1,29]{1,0} aten::expand(%2015), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2017 = s64[1,29]{1,0} aten::add(%628, %2016), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2018 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2019 = pred[1,29]{1,0} aten::lt(%628, %2018), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2020 = s64[1,29]{1,0} aten::where(%2019, %2017, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2021 = s64[1,29,1]{2,1,0} aten::stack(%2020), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2022 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2023 = bf16[29,128]{1,0} xla::select(%2022), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2024 = bf16[1,29,128]{2,1,0} aten::index(%2023, %2021), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2025 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2024), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2026 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2009, %2025), scope=aten::mul.207, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2027 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2026, %2014, %1988), scope=aten::add.209, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2028 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2027), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2029 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2030 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2031 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2030), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2032 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2031), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2033 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2032), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2034 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2033), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2035 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2034), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2036 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2035), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2037 = bf16[28,128,29]{2,1,0} aten::view(%2036), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2038 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2039 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2040 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2041 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2042 = bf16[3584,3584]{0,1} aten::permute(%2041), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2043 = bf16[29,3584]{1,0} aten::view(%1970), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2044 = bf16[29,3584]{1,0} aten::mm(%2043, %2042), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2045 = bf16[1,29,3584]{2,1,0} aten::view(%2044), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2046 = bf16[1,29,3584]{2,1,0} aten::add(%2045, %2040, %2039), scope=aten::add.201, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2047 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2046), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2048 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2047), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2049 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2048), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2050 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2048), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2051 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2050), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2052 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2051, %2049), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2053 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2052, %1999), scope=aten::mul.205, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2054 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2048, %2025), scope=aten::mul.204, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2055 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2054, %2053, %2038), scope=aten::add.206, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2056 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2055), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2057 = bf16[28,29,128]{2,1,0} aten::view(%2056), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2058 = bf16[28,29,29]{2,1,0} aten::matmul(%2057, %2037), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2059 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2058), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2060 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2059, %1987), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2061 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2060, %617, %1986), scope=aten::add.210, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2062 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2061), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2063 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2062), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2064 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2063), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2065 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2064), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2066 = bf16[28,29,29]{2,1,0} aten::view(%2065), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2067 = bf16[28,29,128]{2,1,0} aten::matmul(%2066, %1985), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2068 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2067), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2069 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2068), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2070 = bf16[1,29,3584]{2,1,0} aten::view(%2069), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2071 = bf16[29,3584]{1,0} aten::view(%2070), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2072 = bf16[29,3584]{1,0} aten::mm(%2071, %347), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2073 = bf16[1,29,3584]{2,1,0} aten::view(%2072), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2074 = bf16[1,29,3584]{2,1,0} aten::add(%1961, %2073, %345), scope=aten::add.211, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2075 = f32[1,29,3584]{2,1,0} xla::cast(%2074), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2076 = f32[1,29,3584]{2,1,0} aten::pow(%2075, %344), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2077 = f32[1,29,1]{2,1,0} aten::mean(%2076), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2078 = f32[1,29,1]{2,1,0} aten::add(%2077, %343, %342), scope=aten::add.212, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2079 = f32[1,29,1]{2,1,0} aten::rsqrt(%2078), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2080 = f32[1,29,3584]{2,1,0} aten::mul(%2075, %2079), scope=aten::mul.213, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2081 = bf16[1,29,3584]{2,1,0} xla::cast(%2080), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2082 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2083 = bf16[1,29,3584]{2,1,0} aten::mul(%2082, %2081), scope=aten::mul.214, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2084 = bf16[29,3584]{1,0} aten::view(%2083), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2085 = bf16[29,18944]{1,0} aten::mm(%2084, %341), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2086 = bf16[1,29,18944]{2,1,0} aten::view(%2085), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2087 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2088 = bf16[3584,18944]{0,1} aten::permute(%2087), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2089 = bf16[29,3584]{1,0} aten::view(%2083), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2090 = bf16[29,18944]{1,0} aten::mm(%2089, %2088), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2091 = bf16[1,29,18944]{2,1,0} aten::view(%2090), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2092 = bf16[1,29,18944]{2,1,0} aten::silu(%2091), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2093 = bf16[1,29,18944]{2,1,0} aten::mul(%2092, %2086), scope=aten::mul.215, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2094 = bf16[29,18944]{1,0} aten::view(%2093), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2095 = bf16[29,3584]{1,0} aten::mm(%2094, %339), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2096 = bf16[1,29,3584]{2,1,0} aten::view(%2095), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2097 = bf16[1,29,3584]{2,1,0} aten::add(%2074, %2096, %337), scope=aten::add.216, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2098 = f32[1,29,3584]{2,1,0} xla::cast(%2097), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2099 = f32[1,29,3584]{2,1,0} aten::pow(%2098, %336), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2100 = f32[1,29,1]{2,1,0} aten::mean(%2099), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2101 = f32[1,29,1]{2,1,0} aten::add(%2100, %335, %334), scope=aten::add.217, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2102 = f32[1,29,1]{2,1,0} aten::rsqrt(%2101), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2103 = f32[1,29,3584]{2,1,0} aten::mul(%2098, %2102), scope=aten::mul.218, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2104 = bf16[1,29,3584]{2,1,0} xla::cast(%2103), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2105 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2106 = bf16[1,29,3584]{2,1,0} aten::mul(%2105, %2104), scope=aten::mul.219, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2107 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2108 = bf16[29,512]{1,0} aten::mm(%2107, %333), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2109 = bf16[1,29,512]{2,1,0} aten::view(%2108), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2110 = bf16[1,29,512]{2,1,0} aten::add(%2109, %331, %330), scope=aten::add.222, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2111 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2110), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2112 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2111), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2113 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2112), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2114 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2113), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2115 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2114), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2116 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2115), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2117 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2118 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2119 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2118), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2120 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2119), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2121 = bf16[28,29,128]{2,1,0} aten::view(%2120), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2122 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2123 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2124 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2125 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2126 = s64[1,29]{1,0} aten::expand(%2125), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2127 = s64[1,29]{1,0} aten::add(%628, %2126), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2128 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2129 = pred[1,29]{1,0} aten::lt(%628, %2128), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2130 = s64[1,29]{1,0} aten::where(%2129, %2127, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2131 = s64[1,29,1]{2,1,0} aten::stack(%2130), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2132 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2133 = bf16[29,128]{1,0} xla::select(%2132), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2134 = bf16[1,29,128]{2,1,0} aten::index(%2133, %2131), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2135 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2134), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2136 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2137 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2138 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2139 = bf16[3584,512]{0,1} aten::permute(%2138), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2140 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2141 = bf16[29,512]{1,0} aten::mm(%2140, %2139), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2142 = bf16[1,29,512]{2,1,0} aten::view(%2141), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2143 = bf16[1,29,512]{2,1,0} aten::add(%2142, %2137, %2136), scope=aten::add.221, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2144 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2143), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2145 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2144), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2146 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2145), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2147 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2145), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2148 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2147), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2149 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2148, %2146), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2150 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2149, %2135), scope=aten::mul.227, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2151 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2152 = s64[1,29]{1,0} aten::expand(%2151), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2153 = s64[1,29]{1,0} aten::add(%628, %2152), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2154 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2155 = pred[1,29]{1,0} aten::lt(%628, %2154), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2156 = s64[1,29]{1,0} aten::where(%2155, %2153, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2157 = s64[1,29,1]{2,1,0} aten::stack(%2156), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2158 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2159 = bf16[29,128]{1,0} xla::select(%2158), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2160 = bf16[1,29,128]{2,1,0} aten::index(%2159, %2157), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2161 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2160), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2162 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2145, %2161), scope=aten::mul.226, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2163 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2162, %2150, %2124), scope=aten::add.228, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2164 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2163), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2165 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2166 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2167 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2166), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2168 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2167), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2169 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2168), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2170 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2169), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2171 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2170), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2172 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2171), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2173 = bf16[28,128,29]{2,1,0} aten::view(%2172), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2174 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2175 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2176 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2177 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2178 = bf16[3584,3584]{0,1} aten::permute(%2177), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2179 = bf16[29,3584]{1,0} aten::view(%2106), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2180 = bf16[29,3584]{1,0} aten::mm(%2179, %2178), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2181 = bf16[1,29,3584]{2,1,0} aten::view(%2180), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2182 = bf16[1,29,3584]{2,1,0} aten::add(%2181, %2176, %2175), scope=aten::add.220, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2183 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2182), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2184 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2183), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2185 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2184), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2186 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2184), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2187 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2186), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2188 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2187, %2185), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2189 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2188, %2135), scope=aten::mul.224, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2190 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2184, %2161), scope=aten::mul.223, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2191 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2190, %2189, %2174), scope=aten::add.225, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2192 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2191), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2193 = bf16[28,29,128]{2,1,0} aten::view(%2192), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2194 = bf16[28,29,29]{2,1,0} aten::matmul(%2193, %2173), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2195 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2194), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2196 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2195, %2123), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2197 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2196, %617, %2122), scope=aten::add.229, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2198 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2197), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2199 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2198), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2200 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2199), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2201 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2200), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2202 = bf16[28,29,29]{2,1,0} aten::view(%2201), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2203 = bf16[28,29,128]{2,1,0} aten::matmul(%2202, %2121), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2204 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2203), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2205 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2204), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2206 = bf16[1,29,3584]{2,1,0} aten::view(%2205), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2207 = bf16[29,3584]{1,0} aten::view(%2206), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2208 = bf16[29,3584]{1,0} aten::mm(%2207, %329), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2209 = bf16[1,29,3584]{2,1,0} aten::view(%2208), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2210 = bf16[1,29,3584]{2,1,0} aten::add(%2097, %2209, %327), scope=aten::add.230, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2211 = f32[1,29,3584]{2,1,0} xla::cast(%2210), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2212 = f32[1,29,3584]{2,1,0} aten::pow(%2211, %326), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2213 = f32[1,29,1]{2,1,0} aten::mean(%2212), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2214 = f32[1,29,1]{2,1,0} aten::add(%2213, %325, %324), scope=aten::add.231, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2215 = f32[1,29,1]{2,1,0} aten::rsqrt(%2214), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2216 = f32[1,29,3584]{2,1,0} aten::mul(%2211, %2215), scope=aten::mul.232, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2217 = bf16[1,29,3584]{2,1,0} xla::cast(%2216), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2218 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2219 = bf16[1,29,3584]{2,1,0} aten::mul(%2218, %2217), scope=aten::mul.233, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2220 = bf16[29,3584]{1,0} aten::view(%2219), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2221 = bf16[29,18944]{1,0} aten::mm(%2220, %323), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2222 = bf16[1,29,18944]{2,1,0} aten::view(%2221), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2223 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2224 = bf16[3584,18944]{0,1} aten::permute(%2223), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2225 = bf16[29,3584]{1,0} aten::view(%2219), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2226 = bf16[29,18944]{1,0} aten::mm(%2225, %2224), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2227 = bf16[1,29,18944]{2,1,0} aten::view(%2226), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2228 = bf16[1,29,18944]{2,1,0} aten::silu(%2227), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2229 = bf16[1,29,18944]{2,1,0} aten::mul(%2228, %2222), scope=aten::mul.234, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2230 = bf16[29,18944]{1,0} aten::view(%2229), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2231 = bf16[29,3584]{1,0} aten::mm(%2230, %321), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2232 = bf16[1,29,3584]{2,1,0} aten::view(%2231), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2233 = bf16[1,29,3584]{2,1,0} aten::add(%2210, %2232, %319), scope=aten::add.235, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2234 = f32[1,29,3584]{2,1,0} xla::cast(%2233), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2235 = f32[1,29,3584]{2,1,0} aten::pow(%2234, %318), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2236 = f32[1,29,1]{2,1,0} aten::mean(%2235), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2237 = f32[1,29,1]{2,1,0} aten::add(%2236, %317, %316), scope=aten::add.236, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2238 = f32[1,29,1]{2,1,0} aten::rsqrt(%2237), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2239 = f32[1,29,3584]{2,1,0} aten::mul(%2234, %2238), scope=aten::mul.237, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2240 = bf16[1,29,3584]{2,1,0} xla::cast(%2239), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2241 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2242 = bf16[1,29,3584]{2,1,0} aten::mul(%2241, %2240), scope=aten::mul.238, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2243 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2244 = bf16[29,512]{1,0} aten::mm(%2243, %315), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2245 = bf16[1,29,512]{2,1,0} aten::view(%2244), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2246 = bf16[1,29,512]{2,1,0} aten::add(%2245, %313, %312), scope=aten::add.241, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2247 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2246), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2248 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2247), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2249 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2248), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2250 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2249), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2251 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2250), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2252 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2251), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2253 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2254 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2255 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2254), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2256 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2255), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2257 = bf16[28,29,128]{2,1,0} aten::view(%2256), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2258 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2259 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2260 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2261 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2262 = s64[1,29]{1,0} aten::expand(%2261), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2263 = s64[1,29]{1,0} aten::add(%628, %2262), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2264 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2265 = pred[1,29]{1,0} aten::lt(%628, %2264), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2266 = s64[1,29]{1,0} aten::where(%2265, %2263, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2267 = s64[1,29,1]{2,1,0} aten::stack(%2266), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2268 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2269 = bf16[29,128]{1,0} xla::select(%2268), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2270 = bf16[1,29,128]{2,1,0} aten::index(%2269, %2267), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2271 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2270), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2272 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2273 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2274 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2275 = bf16[3584,512]{0,1} aten::permute(%2274), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2276 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2277 = bf16[29,512]{1,0} aten::mm(%2276, %2275), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2278 = bf16[1,29,512]{2,1,0} aten::view(%2277), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2279 = bf16[1,29,512]{2,1,0} aten::add(%2278, %2273, %2272), scope=aten::add.240, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2280 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2279), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2281 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2280), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2282 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2281), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2283 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2281), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2284 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2283), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2285 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2284, %2282), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2286 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2285, %2271), scope=aten::mul.246, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2287 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2288 = s64[1,29]{1,0} aten::expand(%2287), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2289 = s64[1,29]{1,0} aten::add(%628, %2288), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2290 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2291 = pred[1,29]{1,0} aten::lt(%628, %2290), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2292 = s64[1,29]{1,0} aten::where(%2291, %2289, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2293 = s64[1,29,1]{2,1,0} aten::stack(%2292), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2294 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2295 = bf16[29,128]{1,0} xla::select(%2294), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2296 = bf16[1,29,128]{2,1,0} aten::index(%2295, %2293), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2297 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2296), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2298 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2281, %2297), scope=aten::mul.245, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2299 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2298, %2286, %2260), scope=aten::add.247, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2300 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2299), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2301 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2302 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2303 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2302), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2304 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2303), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2305 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2304), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2306 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2305), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2307 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2306), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2308 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2307), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2309 = bf16[28,128,29]{2,1,0} aten::view(%2308), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2310 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2311 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2312 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2313 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2314 = bf16[3584,3584]{0,1} aten::permute(%2313), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2315 = bf16[29,3584]{1,0} aten::view(%2242), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2316 = bf16[29,3584]{1,0} aten::mm(%2315, %2314), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2317 = bf16[1,29,3584]{2,1,0} aten::view(%2316), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2318 = bf16[1,29,3584]{2,1,0} aten::add(%2317, %2312, %2311), scope=aten::add.239, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2319 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2318), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2320 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2319), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2321 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2320), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2322 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2320), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2323 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2322), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2324 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2323, %2321), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2325 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2324, %2271), scope=aten::mul.243, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2326 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2320, %2297), scope=aten::mul.242, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2327 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2326, %2325, %2310), scope=aten::add.244, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2328 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2327), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2329 = bf16[28,29,128]{2,1,0} aten::view(%2328), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2330 = bf16[28,29,29]{2,1,0} aten::matmul(%2329, %2309), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2331 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2330), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2332 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2331, %2259), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2333 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2332, %617, %2258), scope=aten::add.248, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2334 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2333), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2335 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2334), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2336 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2335), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2337 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2336), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2338 = bf16[28,29,29]{2,1,0} aten::view(%2337), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2339 = bf16[28,29,128]{2,1,0} aten::matmul(%2338, %2257), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2340 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2339), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2341 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2340), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2342 = bf16[1,29,3584]{2,1,0} aten::view(%2341), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2343 = bf16[29,3584]{1,0} aten::view(%2342), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2344 = bf16[29,3584]{1,0} aten::mm(%2343, %311), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2345 = bf16[1,29,3584]{2,1,0} aten::view(%2344), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2346 = bf16[1,29,3584]{2,1,0} aten::add(%2233, %2345, %309), scope=aten::add.249, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2347 = f32[1,29,3584]{2,1,0} xla::cast(%2346), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2348 = f32[1,29,3584]{2,1,0} aten::pow(%2347, %308), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2349 = f32[1,29,1]{2,1,0} aten::mean(%2348), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2350 = f32[1,29,1]{2,1,0} aten::add(%2349, %307, %306), scope=aten::add.250, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2351 = f32[1,29,1]{2,1,0} aten::rsqrt(%2350), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2352 = f32[1,29,3584]{2,1,0} aten::mul(%2347, %2351), scope=aten::mul.251, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2353 = bf16[1,29,3584]{2,1,0} xla::cast(%2352), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2354 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2355 = bf16[1,29,3584]{2,1,0} aten::mul(%2354, %2353), scope=aten::mul.252, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2356 = bf16[29,3584]{1,0} aten::view(%2355), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2357 = bf16[29,18944]{1,0} aten::mm(%2356, %305), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2358 = bf16[1,29,18944]{2,1,0} aten::view(%2357), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2359 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2360 = bf16[3584,18944]{0,1} aten::permute(%2359), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2361 = bf16[29,3584]{1,0} aten::view(%2355), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2362 = bf16[29,18944]{1,0} aten::mm(%2361, %2360), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2363 = bf16[1,29,18944]{2,1,0} aten::view(%2362), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2364 = bf16[1,29,18944]{2,1,0} aten::silu(%2363), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2365 = bf16[1,29,18944]{2,1,0} aten::mul(%2364, %2358), scope=aten::mul.253, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2366 = bf16[29,18944]{1,0} aten::view(%2365), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2367 = bf16[29,3584]{1,0} aten::mm(%2366, %303), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2368 = bf16[1,29,3584]{2,1,0} aten::view(%2367), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2369 = bf16[1,29,3584]{2,1,0} aten::add(%2346, %2368, %301), scope=aten::add.254, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2370 = f32[1,29,3584]{2,1,0} xla::cast(%2369), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2371 = f32[1,29,3584]{2,1,0} aten::pow(%2370, %300), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2372 = f32[1,29,1]{2,1,0} aten::mean(%2371), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2373 = f32[1,29,1]{2,1,0} aten::add(%2372, %299, %298), scope=aten::add.255, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2374 = f32[1,29,1]{2,1,0} aten::rsqrt(%2373), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2375 = f32[1,29,3584]{2,1,0} aten::mul(%2370, %2374), scope=aten::mul.256, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2376 = bf16[1,29,3584]{2,1,0} xla::cast(%2375), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2377 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2378 = bf16[1,29,3584]{2,1,0} aten::mul(%2377, %2376), scope=aten::mul.257, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2379 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2380 = bf16[29,512]{1,0} aten::mm(%2379, %297), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2381 = bf16[1,29,512]{2,1,0} aten::view(%2380), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2382 = bf16[1,29,512]{2,1,0} aten::add(%2381, %295, %294), scope=aten::add.260, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2383 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2382), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2384 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2383), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2385 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2384), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2386 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2385), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2387 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2386), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2388 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2387), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2389 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2390 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2391 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2390), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2392 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2391), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2393 = bf16[28,29,128]{2,1,0} aten::view(%2392), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2394 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2395 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2396 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2397 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2398 = s64[1,29]{1,0} aten::expand(%2397), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2399 = s64[1,29]{1,0} aten::add(%628, %2398), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2400 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2401 = pred[1,29]{1,0} aten::lt(%628, %2400), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2402 = s64[1,29]{1,0} aten::where(%2401, %2399, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2403 = s64[1,29,1]{2,1,0} aten::stack(%2402), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2404 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2405 = bf16[29,128]{1,0} xla::select(%2404), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2406 = bf16[1,29,128]{2,1,0} aten::index(%2405, %2403), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2407 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2406), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2408 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2409 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2410 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2411 = bf16[3584,512]{0,1} aten::permute(%2410), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2412 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2413 = bf16[29,512]{1,0} aten::mm(%2412, %2411), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2414 = bf16[1,29,512]{2,1,0} aten::view(%2413), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2415 = bf16[1,29,512]{2,1,0} aten::add(%2414, %2409, %2408), scope=aten::add.259, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2416 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2415), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2417 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2416), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2418 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2417), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2419 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2417), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2420 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2419), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2421 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2420, %2418), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2422 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2421, %2407), scope=aten::mul.265, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2423 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2424 = s64[1,29]{1,0} aten::expand(%2423), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2425 = s64[1,29]{1,0} aten::add(%628, %2424), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2426 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2427 = pred[1,29]{1,0} aten::lt(%628, %2426), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2428 = s64[1,29]{1,0} aten::where(%2427, %2425, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2429 = s64[1,29,1]{2,1,0} aten::stack(%2428), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2430 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2431 = bf16[29,128]{1,0} xla::select(%2430), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2432 = bf16[1,29,128]{2,1,0} aten::index(%2431, %2429), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2433 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2432), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2434 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2417, %2433), scope=aten::mul.264, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2435 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2434, %2422, %2396), scope=aten::add.266, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2436 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2435), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2437 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2438 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2439 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2438), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2440 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2439), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2441 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2440), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2442 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2441), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2443 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2442), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2444 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2443), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2445 = bf16[28,128,29]{2,1,0} aten::view(%2444), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2446 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2447 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2448 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2449 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2450 = bf16[3584,3584]{0,1} aten::permute(%2449), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2451 = bf16[29,3584]{1,0} aten::view(%2378), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2452 = bf16[29,3584]{1,0} aten::mm(%2451, %2450), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2453 = bf16[1,29,3584]{2,1,0} aten::view(%2452), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2454 = bf16[1,29,3584]{2,1,0} aten::add(%2453, %2448, %2447), scope=aten::add.258, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2455 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2454), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2456 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2455), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2457 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2456), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2458 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2456), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2459 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2458), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2460 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2459, %2457), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2461 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2460, %2407), scope=aten::mul.262, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2462 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2456, %2433), scope=aten::mul.261, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2463 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2462, %2461, %2446), scope=aten::add.263, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2464 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2463), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2465 = bf16[28,29,128]{2,1,0} aten::view(%2464), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2466 = bf16[28,29,29]{2,1,0} aten::matmul(%2465, %2445), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2467 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2466), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2468 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2467, %2395), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2469 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2468, %617, %2394), scope=aten::add.267, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2470 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2469), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2471 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2470), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2472 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2471), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2473 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2472), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2474 = bf16[28,29,29]{2,1,0} aten::view(%2473), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2475 = bf16[28,29,128]{2,1,0} aten::matmul(%2474, %2393), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2476 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2475), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2477 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2476), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2478 = bf16[1,29,3584]{2,1,0} aten::view(%2477), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2479 = bf16[29,3584]{1,0} aten::view(%2478), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2480 = bf16[29,3584]{1,0} aten::mm(%2479, %293), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2481 = bf16[1,29,3584]{2,1,0} aten::view(%2480), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2482 = bf16[1,29,3584]{2,1,0} aten::add(%2369, %2481, %291), scope=aten::add.268, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2483 = f32[1,29,3584]{2,1,0} xla::cast(%2482), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2484 = f32[1,29,3584]{2,1,0} aten::pow(%2483, %290), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2485 = f32[1,29,1]{2,1,0} aten::mean(%2484), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2486 = f32[1,29,1]{2,1,0} aten::add(%2485, %289, %288), scope=aten::add.269, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2487 = f32[1,29,1]{2,1,0} aten::rsqrt(%2486), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2488 = f32[1,29,3584]{2,1,0} aten::mul(%2483, %2487), scope=aten::mul.270, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2489 = bf16[1,29,3584]{2,1,0} xla::cast(%2488), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2490 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2491 = bf16[1,29,3584]{2,1,0} aten::mul(%2490, %2489), scope=aten::mul.271, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2492 = bf16[29,3584]{1,0} aten::view(%2491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2493 = bf16[29,18944]{1,0} aten::mm(%2492, %287), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2494 = bf16[1,29,18944]{2,1,0} aten::view(%2493), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2495 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2496 = bf16[3584,18944]{0,1} aten::permute(%2495), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2497 = bf16[29,3584]{1,0} aten::view(%2491), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2498 = bf16[29,18944]{1,0} aten::mm(%2497, %2496), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2499 = bf16[1,29,18944]{2,1,0} aten::view(%2498), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2500 = bf16[1,29,18944]{2,1,0} aten::silu(%2499), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2501 = bf16[1,29,18944]{2,1,0} aten::mul(%2500, %2494), scope=aten::mul.272, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2502 = bf16[29,18944]{1,0} aten::view(%2501), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2503 = bf16[29,3584]{1,0} aten::mm(%2502, %285), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2504 = bf16[1,29,3584]{2,1,0} aten::view(%2503), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2505 = bf16[1,29,3584]{2,1,0} aten::add(%2482, %2504, %283), scope=aten::add.273, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2506 = f32[1,29,3584]{2,1,0} xla::cast(%2505), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2507 = f32[1,29,3584]{2,1,0} aten::pow(%2506, %282), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2508 = f32[1,29,1]{2,1,0} aten::mean(%2507), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2509 = f32[1,29,1]{2,1,0} aten::add(%2508, %281, %280), scope=aten::add.274, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2510 = f32[1,29,1]{2,1,0} aten::rsqrt(%2509), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2511 = f32[1,29,3584]{2,1,0} aten::mul(%2506, %2510), scope=aten::mul.275, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2512 = bf16[1,29,3584]{2,1,0} xla::cast(%2511), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2513 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2514 = bf16[1,29,3584]{2,1,0} aten::mul(%2513, %2512), scope=aten::mul.276, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2515 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2516 = bf16[29,512]{1,0} aten::mm(%2515, %279), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2517 = bf16[1,29,512]{2,1,0} aten::view(%2516), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2518 = bf16[1,29,512]{2,1,0} aten::add(%2517, %277, %276), scope=aten::add.279, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2519 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2518), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2520 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2519), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2521 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2520), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2522 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2521), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2523 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2522), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2524 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2523), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2525 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2526 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2527 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2526), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2528 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2527), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2529 = bf16[28,29,128]{2,1,0} aten::view(%2528), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2530 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2531 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2532 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2533 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2534 = s64[1,29]{1,0} aten::expand(%2533), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2535 = s64[1,29]{1,0} aten::add(%628, %2534), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2536 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2537 = pred[1,29]{1,0} aten::lt(%628, %2536), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2538 = s64[1,29]{1,0} aten::where(%2537, %2535, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2539 = s64[1,29,1]{2,1,0} aten::stack(%2538), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2540 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2541 = bf16[29,128]{1,0} xla::select(%2540), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2542 = bf16[1,29,128]{2,1,0} aten::index(%2541, %2539), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2543 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2542), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2544 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2545 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2546 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2547 = bf16[3584,512]{0,1} aten::permute(%2546), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2548 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2549 = bf16[29,512]{1,0} aten::mm(%2548, %2547), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2550 = bf16[1,29,512]{2,1,0} aten::view(%2549), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2551 = bf16[1,29,512]{2,1,0} aten::add(%2550, %2545, %2544), scope=aten::add.278, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2552 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2551), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2553 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2552), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2554 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2553), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2555 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2553), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2556 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2555), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2557 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2556, %2554), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2558 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2557, %2543), scope=aten::mul.284, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2559 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2560 = s64[1,29]{1,0} aten::expand(%2559), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2561 = s64[1,29]{1,0} aten::add(%628, %2560), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2562 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2563 = pred[1,29]{1,0} aten::lt(%628, %2562), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2564 = s64[1,29]{1,0} aten::where(%2563, %2561, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2565 = s64[1,29,1]{2,1,0} aten::stack(%2564), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2566 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2567 = bf16[29,128]{1,0} xla::select(%2566), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2568 = bf16[1,29,128]{2,1,0} aten::index(%2567, %2565), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2569 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2568), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2570 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2553, %2569), scope=aten::mul.283, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2571 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2570, %2558, %2532), scope=aten::add.285, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2572 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2571), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2573 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2574 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2575 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2574), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2576 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2575), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2577 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2576), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2578 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2577), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2579 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2578), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2580 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2579), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2581 = bf16[28,128,29]{2,1,0} aten::view(%2580), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2582 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2583 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2584 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2585 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2586 = bf16[3584,3584]{0,1} aten::permute(%2585), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2587 = bf16[29,3584]{1,0} aten::view(%2514), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2588 = bf16[29,3584]{1,0} aten::mm(%2587, %2586), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2589 = bf16[1,29,3584]{2,1,0} aten::view(%2588), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2590 = bf16[1,29,3584]{2,1,0} aten::add(%2589, %2584, %2583), scope=aten::add.277, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2591 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2590), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2592 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2591), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2593 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2592), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2594 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2592), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2595 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2594), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2596 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2595, %2593), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2597 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2596, %2543), scope=aten::mul.281, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2598 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2592, %2569), scope=aten::mul.280, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2599 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2598, %2597, %2582), scope=aten::add.282, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2600 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2599), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2601 = bf16[28,29,128]{2,1,0} aten::view(%2600), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2602 = bf16[28,29,29]{2,1,0} aten::matmul(%2601, %2581), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2603 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2602), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2604 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2603, %2531), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2605 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2604, %617, %2530), scope=aten::add.286, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2606 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2605), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2607 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2606), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2608 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2607), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2609 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2608), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2610 = bf16[28,29,29]{2,1,0} aten::view(%2609), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2611 = bf16[28,29,128]{2,1,0} aten::matmul(%2610, %2529), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2612 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2611), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2613 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2612), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2614 = bf16[1,29,3584]{2,1,0} aten::view(%2613), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2615 = bf16[29,3584]{1,0} aten::view(%2614), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2616 = bf16[29,3584]{1,0} aten::mm(%2615, %275), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2617 = bf16[1,29,3584]{2,1,0} aten::view(%2616), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2618 = bf16[1,29,3584]{2,1,0} aten::add(%2505, %2617, %273), scope=aten::add.287, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2619 = f32[1,29,3584]{2,1,0} xla::cast(%2618), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2620 = f32[1,29,3584]{2,1,0} aten::pow(%2619, %272), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2621 = f32[1,29,1]{2,1,0} aten::mean(%2620), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2622 = f32[1,29,1]{2,1,0} aten::add(%2621, %271, %270), scope=aten::add.288, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2623 = f32[1,29,1]{2,1,0} aten::rsqrt(%2622), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2624 = f32[1,29,3584]{2,1,0} aten::mul(%2619, %2623), scope=aten::mul.289, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2625 = bf16[1,29,3584]{2,1,0} xla::cast(%2624), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2626 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2627 = bf16[1,29,3584]{2,1,0} aten::mul(%2626, %2625), scope=aten::mul.290, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2628 = bf16[29,3584]{1,0} aten::view(%2627), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2629 = bf16[29,18944]{1,0} aten::mm(%2628, %269), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2630 = bf16[1,29,18944]{2,1,0} aten::view(%2629), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2631 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2632 = bf16[3584,18944]{0,1} aten::permute(%2631), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2633 = bf16[29,3584]{1,0} aten::view(%2627), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2634 = bf16[29,18944]{1,0} aten::mm(%2633, %2632), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2635 = bf16[1,29,18944]{2,1,0} aten::view(%2634), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2636 = bf16[1,29,18944]{2,1,0} aten::silu(%2635), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2637 = bf16[1,29,18944]{2,1,0} aten::mul(%2636, %2630), scope=aten::mul.291, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2638 = bf16[29,18944]{1,0} aten::view(%2637), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2639 = bf16[29,3584]{1,0} aten::mm(%2638, %267), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2640 = bf16[1,29,3584]{2,1,0} aten::view(%2639), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2641 = bf16[1,29,3584]{2,1,0} aten::add(%2618, %2640, %265), scope=aten::add.292, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2642 = f32[1,29,3584]{2,1,0} xla::cast(%2641), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2643 = f32[1,29,3584]{2,1,0} aten::pow(%2642, %264), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2644 = f32[1,29,1]{2,1,0} aten::mean(%2643), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2645 = f32[1,29,1]{2,1,0} aten::add(%2644, %263, %262), scope=aten::add.293, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2646 = f32[1,29,1]{2,1,0} aten::rsqrt(%2645), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2647 = f32[1,29,3584]{2,1,0} aten::mul(%2642, %2646), scope=aten::mul.294, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2648 = bf16[1,29,3584]{2,1,0} xla::cast(%2647), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2649 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2650 = bf16[1,29,3584]{2,1,0} aten::mul(%2649, %2648), scope=aten::mul.295, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2651 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2652 = bf16[29,512]{1,0} aten::mm(%2651, %261), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2653 = bf16[1,29,512]{2,1,0} aten::view(%2652), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2654 = bf16[1,29,512]{2,1,0} aten::add(%2653, %259, %258), scope=aten::add.298, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2655 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2654), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2656 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2655), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2657 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2656), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2658 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2657), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2659 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2658), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2660 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2659), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2661 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2662 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2663 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2662), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2664 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2663), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2665 = bf16[28,29,128]{2,1,0} aten::view(%2664), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2666 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2667 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2668 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2669 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2670 = s64[1,29]{1,0} aten::expand(%2669), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2671 = s64[1,29]{1,0} aten::add(%628, %2670), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2672 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2673 = pred[1,29]{1,0} aten::lt(%628, %2672), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2674 = s64[1,29]{1,0} aten::where(%2673, %2671, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2675 = s64[1,29,1]{2,1,0} aten::stack(%2674), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2676 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2677 = bf16[29,128]{1,0} xla::select(%2676), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2678 = bf16[1,29,128]{2,1,0} aten::index(%2677, %2675), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2679 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2678), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2680 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2681 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2682 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2683 = bf16[3584,512]{0,1} aten::permute(%2682), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2684 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2685 = bf16[29,512]{1,0} aten::mm(%2684, %2683), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2686 = bf16[1,29,512]{2,1,0} aten::view(%2685), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2687 = bf16[1,29,512]{2,1,0} aten::add(%2686, %2681, %2680), scope=aten::add.297, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2688 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2687), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2689 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2688), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2690 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2689), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2691 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2689), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2692 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2691), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2693 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2692, %2690), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2694 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2693, %2679), scope=aten::mul.303, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2695 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2696 = s64[1,29]{1,0} aten::expand(%2695), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2697 = s64[1,29]{1,0} aten::add(%628, %2696), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2698 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2699 = pred[1,29]{1,0} aten::lt(%628, %2698), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2700 = s64[1,29]{1,0} aten::where(%2699, %2697, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2701 = s64[1,29,1]{2,1,0} aten::stack(%2700), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2702 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2703 = bf16[29,128]{1,0} xla::select(%2702), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2704 = bf16[1,29,128]{2,1,0} aten::index(%2703, %2701), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2705 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2704), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2706 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2689, %2705), scope=aten::mul.302, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2707 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2706, %2694, %2668), scope=aten::add.304, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2708 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2707), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2709 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2710 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2711 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2710), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2712 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2711), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2713 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2712), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2714 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2713), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2715 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2714), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2716 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2715), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2717 = bf16[28,128,29]{2,1,0} aten::view(%2716), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2718 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2719 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2720 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2721 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2722 = bf16[3584,3584]{0,1} aten::permute(%2721), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2723 = bf16[29,3584]{1,0} aten::view(%2650), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2724 = bf16[29,3584]{1,0} aten::mm(%2723, %2722), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2725 = bf16[1,29,3584]{2,1,0} aten::view(%2724), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2726 = bf16[1,29,3584]{2,1,0} aten::add(%2725, %2720, %2719), scope=aten::add.296, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2727 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2726), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2728 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2727), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2729 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2728), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2730 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2728), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2731 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2730), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2732 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2731, %2729), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2733 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2732, %2679), scope=aten::mul.300, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2734 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2728, %2705), scope=aten::mul.299, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2735 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2734, %2733, %2718), scope=aten::add.301, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2736 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2735), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2737 = bf16[28,29,128]{2,1,0} aten::view(%2736), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2738 = bf16[28,29,29]{2,1,0} aten::matmul(%2737, %2717), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2739 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2738), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2740 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2739, %2667), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2741 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2740, %617, %2666), scope=aten::add.305, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2742 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2741), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2743 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2742), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2744 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2743), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2745 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2744), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2746 = bf16[28,29,29]{2,1,0} aten::view(%2745), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2747 = bf16[28,29,128]{2,1,0} aten::matmul(%2746, %2665), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2748 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2747), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2749 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2748), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2750 = bf16[1,29,3584]{2,1,0} aten::view(%2749), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2751 = bf16[29,3584]{1,0} aten::view(%2750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2752 = bf16[29,3584]{1,0} aten::mm(%2751, %257), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2753 = bf16[1,29,3584]{2,1,0} aten::view(%2752), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2754 = bf16[1,29,3584]{2,1,0} aten::add(%2641, %2753, %255), scope=aten::add.306, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2755 = f32[1,29,3584]{2,1,0} xla::cast(%2754), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2756 = f32[1,29,3584]{2,1,0} aten::pow(%2755, %254), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2757 = f32[1,29,1]{2,1,0} aten::mean(%2756), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2758 = f32[1,29,1]{2,1,0} aten::add(%2757, %253, %252), scope=aten::add.307, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2759 = f32[1,29,1]{2,1,0} aten::rsqrt(%2758), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2760 = f32[1,29,3584]{2,1,0} aten::mul(%2755, %2759), scope=aten::mul.308, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2761 = bf16[1,29,3584]{2,1,0} xla::cast(%2760), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2762 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2763 = bf16[1,29,3584]{2,1,0} aten::mul(%2762, %2761), scope=aten::mul.309, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2764 = bf16[29,3584]{1,0} aten::view(%2763), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2765 = bf16[29,18944]{1,0} aten::mm(%2764, %251), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2766 = bf16[1,29,18944]{2,1,0} aten::view(%2765), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2767 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2768 = bf16[3584,18944]{0,1} aten::permute(%2767), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2769 = bf16[29,3584]{1,0} aten::view(%2763), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2770 = bf16[29,18944]{1,0} aten::mm(%2769, %2768), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2771 = bf16[1,29,18944]{2,1,0} aten::view(%2770), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2772 = bf16[1,29,18944]{2,1,0} aten::silu(%2771), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2773 = bf16[1,29,18944]{2,1,0} aten::mul(%2772, %2766), scope=aten::mul.310, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2774 = bf16[29,18944]{1,0} aten::view(%2773), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2775 = bf16[29,3584]{1,0} aten::mm(%2774, %249), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2776 = bf16[1,29,3584]{2,1,0} aten::view(%2775), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2777 = bf16[1,29,3584]{2,1,0} aten::add(%2754, %2776, %247), scope=aten::add.311, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2778 = f32[1,29,3584]{2,1,0} xla::cast(%2777), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2779 = f32[1,29,3584]{2,1,0} aten::pow(%2778, %246), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2780 = f32[1,29,1]{2,1,0} aten::mean(%2779), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2781 = f32[1,29,1]{2,1,0} aten::add(%2780, %245, %244), scope=aten::add.312, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2782 = f32[1,29,1]{2,1,0} aten::rsqrt(%2781), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2783 = f32[1,29,3584]{2,1,0} aten::mul(%2778, %2782), scope=aten::mul.313, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2784 = bf16[1,29,3584]{2,1,0} xla::cast(%2783), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2785 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2786 = bf16[1,29,3584]{2,1,0} aten::mul(%2785, %2784), scope=aten::mul.314, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2787 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2788 = bf16[29,512]{1,0} aten::mm(%2787, %243), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2789 = bf16[1,29,512]{2,1,0} aten::view(%2788), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2790 = bf16[1,29,512]{2,1,0} aten::add(%2789, %241, %240), scope=aten::add.317, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2791 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2790), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2792 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2791), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2793 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2792), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2794 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2793), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2795 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2794), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2796 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2795), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2797 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2798 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2799 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2798), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2800 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2799), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2801 = bf16[28,29,128]{2,1,0} aten::view(%2800), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2802 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2803 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2804 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2805 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2806 = s64[1,29]{1,0} aten::expand(%2805), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2807 = s64[1,29]{1,0} aten::add(%628, %2806), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2808 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2809 = pred[1,29]{1,0} aten::lt(%628, %2808), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2810 = s64[1,29]{1,0} aten::where(%2809, %2807, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2811 = s64[1,29,1]{2,1,0} aten::stack(%2810), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2812 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2813 = bf16[29,128]{1,0} xla::select(%2812), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2814 = bf16[1,29,128]{2,1,0} aten::index(%2813, %2811), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2815 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2814), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2816 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2817 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2818 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2819 = bf16[3584,512]{0,1} aten::permute(%2818), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2820 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2821 = bf16[29,512]{1,0} aten::mm(%2820, %2819), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2822 = bf16[1,29,512]{2,1,0} aten::view(%2821), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2823 = bf16[1,29,512]{2,1,0} aten::add(%2822, %2817, %2816), scope=aten::add.316, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2824 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2823), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2825 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2824), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2826 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2825), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2827 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2825), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2828 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2827), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2829 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2828, %2826), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2830 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2829, %2815), scope=aten::mul.322, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2831 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2832 = s64[1,29]{1,0} aten::expand(%2831), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2833 = s64[1,29]{1,0} aten::add(%628, %2832), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2834 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2835 = pred[1,29]{1,0} aten::lt(%628, %2834), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2836 = s64[1,29]{1,0} aten::where(%2835, %2833, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2837 = s64[1,29,1]{2,1,0} aten::stack(%2836), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2838 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2839 = bf16[29,128]{1,0} xla::select(%2838), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2840 = bf16[1,29,128]{2,1,0} aten::index(%2839, %2837), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2841 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2840), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2842 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2825, %2841), scope=aten::mul.321, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2843 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2842, %2830, %2804), scope=aten::add.323, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2844 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2843), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2845 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2846 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2847 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2846), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2848 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2847), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2849 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2848), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2850 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2849), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2851 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2850), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2852 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2851), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2853 = bf16[28,128,29]{2,1,0} aten::view(%2852), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2854 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2855 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2856 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2857 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2858 = bf16[3584,3584]{0,1} aten::permute(%2857), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2859 = bf16[29,3584]{1,0} aten::view(%2786), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2860 = bf16[29,3584]{1,0} aten::mm(%2859, %2858), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2861 = bf16[1,29,3584]{2,1,0} aten::view(%2860), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2862 = bf16[1,29,3584]{2,1,0} aten::add(%2861, %2856, %2855), scope=aten::add.315, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2863 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2862), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2864 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2863), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2865 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2864), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2866 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2864), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2867 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2866), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2868 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2867, %2865), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2869 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2868, %2815), scope=aten::mul.319, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2870 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2864, %2841), scope=aten::mul.318, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2871 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2870, %2869, %2854), scope=aten::add.320, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2872 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2871), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2873 = bf16[28,29,128]{2,1,0} aten::view(%2872), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2874 = bf16[28,29,29]{2,1,0} aten::matmul(%2873, %2853), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2875 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2874), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2876 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2875, %2803), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2877 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2876, %617, %2802), scope=aten::add.324, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2878 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2877), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2879 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2878), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2880 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2879), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2881 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2880), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2882 = bf16[28,29,29]{2,1,0} aten::view(%2881), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2883 = bf16[28,29,128]{2,1,0} aten::matmul(%2882, %2801), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2884 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2883), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2885 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2884), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2886 = bf16[1,29,3584]{2,1,0} aten::view(%2885), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2887 = bf16[29,3584]{1,0} aten::view(%2886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2888 = bf16[29,3584]{1,0} aten::mm(%2887, %239), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2889 = bf16[1,29,3584]{2,1,0} aten::view(%2888), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2890 = bf16[1,29,3584]{2,1,0} aten::add(%2777, %2889, %237), scope=aten::add.325, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2891 = f32[1,29,3584]{2,1,0} xla::cast(%2890), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2892 = f32[1,29,3584]{2,1,0} aten::pow(%2891, %236), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2893 = f32[1,29,1]{2,1,0} aten::mean(%2892), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2894 = f32[1,29,1]{2,1,0} aten::add(%2893, %235, %234), scope=aten::add.326, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2895 = f32[1,29,1]{2,1,0} aten::rsqrt(%2894), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2896 = f32[1,29,3584]{2,1,0} aten::mul(%2891, %2895), scope=aten::mul.327, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2897 = bf16[1,29,3584]{2,1,0} xla::cast(%2896), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2898 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2899 = bf16[1,29,3584]{2,1,0} aten::mul(%2898, %2897), scope=aten::mul.328, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2900 = bf16[29,3584]{1,0} aten::view(%2899), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2901 = bf16[29,18944]{1,0} aten::mm(%2900, %233), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2902 = bf16[1,29,18944]{2,1,0} aten::view(%2901), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2903 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2904 = bf16[3584,18944]{0,1} aten::permute(%2903), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2905 = bf16[29,3584]{1,0} aten::view(%2899), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2906 = bf16[29,18944]{1,0} aten::mm(%2905, %2904), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2907 = bf16[1,29,18944]{2,1,0} aten::view(%2906), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2908 = bf16[1,29,18944]{2,1,0} aten::silu(%2907), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2909 = bf16[1,29,18944]{2,1,0} aten::mul(%2908, %2902), scope=aten::mul.329, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2910 = bf16[29,18944]{1,0} aten::view(%2909), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2911 = bf16[29,3584]{1,0} aten::mm(%2910, %231), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2912 = bf16[1,29,3584]{2,1,0} aten::view(%2911), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2913 = bf16[1,29,3584]{2,1,0} aten::add(%2890, %2912, %229), scope=aten::add.330, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2914 = f32[1,29,3584]{2,1,0} xla::cast(%2913), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2915 = f32[1,29,3584]{2,1,0} aten::pow(%2914, %228), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2916 = f32[1,29,1]{2,1,0} aten::mean(%2915), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2917 = f32[1,29,1]{2,1,0} aten::add(%2916, %227, %226), scope=aten::add.331, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2918 = f32[1,29,1]{2,1,0} aten::rsqrt(%2917), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2919 = f32[1,29,3584]{2,1,0} aten::mul(%2914, %2918), scope=aten::mul.332, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2920 = bf16[1,29,3584]{2,1,0} xla::cast(%2919), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2921 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2922 = bf16[1,29,3584]{2,1,0} aten::mul(%2921, %2920), scope=aten::mul.333, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2923 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2924 = bf16[29,512]{1,0} aten::mm(%2923, %225), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2925 = bf16[1,29,512]{2,1,0} aten::view(%2924), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2926 = bf16[1,29,512]{2,1,0} aten::add(%2925, %223, %222), scope=aten::add.336, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2927 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2926), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2928 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2927), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2929 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2928), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2930 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2929), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2931 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2930), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2932 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2931), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2933 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2934 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2935 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2934), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2936 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2935), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2937 = bf16[28,29,128]{2,1,0} aten::view(%2936), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2938 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2939 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2940 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2941 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2942 = s64[1,29]{1,0} aten::expand(%2941), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2943 = s64[1,29]{1,0} aten::add(%628, %2942), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2944 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2945 = pred[1,29]{1,0} aten::lt(%628, %2944), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2946 = s64[1,29]{1,0} aten::where(%2945, %2943, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2947 = s64[1,29,1]{2,1,0} aten::stack(%2946), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2948 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2949 = bf16[29,128]{1,0} xla::select(%2948), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2950 = bf16[1,29,128]{2,1,0} aten::index(%2949, %2947), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2951 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2950), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2952 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2953 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2954 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2955 = bf16[3584,512]{0,1} aten::permute(%2954), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2956 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2957 = bf16[29,512]{1,0} aten::mm(%2956, %2955), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2958 = bf16[1,29,512]{2,1,0} aten::view(%2957), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2959 = bf16[1,29,512]{2,1,0} aten::add(%2958, %2953, %2952), scope=aten::add.335, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2960 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2959), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2961 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2960), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2962 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2961), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2963 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2961), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2964 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2963), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2965 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2964, %2962), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2966 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2965, %2951), scope=aten::mul.341, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2967 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2968 = s64[1,29]{1,0} aten::expand(%2967), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2969 = s64[1,29]{1,0} aten::add(%628, %2968), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2970 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2971 = pred[1,29]{1,0} aten::lt(%628, %2970), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2972 = s64[1,29]{1,0} aten::where(%2971, %2969, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2973 = s64[1,29,1]{2,1,0} aten::stack(%2972), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2974 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2975 = bf16[29,128]{1,0} xla::select(%2974), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2976 = bf16[1,29,128]{2,1,0} aten::index(%2975, %2973), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2977 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2976), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2978 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2961, %2977), scope=aten::mul.340, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2979 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2978, %2966, %2940), scope=aten::add.342, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2980 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2979), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2981 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2982 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2983 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2982), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2984 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2983), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2985 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2984), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2986 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2985), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2987 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2986), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2988 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2987), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2989 = bf16[28,128,29]{2,1,0} aten::view(%2988), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2990 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2991 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2992 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2993 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2994 = bf16[3584,3584]{0,1} aten::permute(%2993), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2995 = bf16[29,3584]{1,0} aten::view(%2922), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2996 = bf16[29,3584]{1,0} aten::mm(%2995, %2994), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2997 = bf16[1,29,3584]{2,1,0} aten::view(%2996), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2998 = bf16[1,29,3584]{2,1,0} aten::add(%2997, %2992, %2991), scope=aten::add.334, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2999 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2998), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3000 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2999), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3001 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3000), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3002 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3000), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3003 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3002), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3004 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3003, %3001), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3005 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3004, %2951), scope=aten::mul.338, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3006 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3000, %2977), scope=aten::mul.337, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3007 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3006, %3005, %2990), scope=aten::add.339, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3008 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3007), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3009 = bf16[28,29,128]{2,1,0} aten::view(%3008), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3010 = bf16[28,29,29]{2,1,0} aten::matmul(%3009, %2989), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3011 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3010), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3012 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3011, %2939), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3013 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3012, %617, %2938), scope=aten::add.343, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3014 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3013), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3015 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3014), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3016 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3015), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3017 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3016), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3018 = bf16[28,29,29]{2,1,0} aten::view(%3017), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3019 = bf16[28,29,128]{2,1,0} aten::matmul(%3018, %2937), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3020 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3019), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3021 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3020), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3022 = bf16[1,29,3584]{2,1,0} aten::view(%3021), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3023 = bf16[29,3584]{1,0} aten::view(%3022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3024 = bf16[29,3584]{1,0} aten::mm(%3023, %221), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3025 = bf16[1,29,3584]{2,1,0} aten::view(%3024), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3026 = bf16[1,29,3584]{2,1,0} aten::add(%2913, %3025, %219), scope=aten::add.344, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3027 = f32[1,29,3584]{2,1,0} xla::cast(%3026), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3028 = f32[1,29,3584]{2,1,0} aten::pow(%3027, %218), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3029 = f32[1,29,1]{2,1,0} aten::mean(%3028), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3030 = f32[1,29,1]{2,1,0} aten::add(%3029, %217, %216), scope=aten::add.345, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3031 = f32[1,29,1]{2,1,0} aten::rsqrt(%3030), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3032 = f32[1,29,3584]{2,1,0} aten::mul(%3027, %3031), scope=aten::mul.346, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3033 = bf16[1,29,3584]{2,1,0} xla::cast(%3032), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3034 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3035 = bf16[1,29,3584]{2,1,0} aten::mul(%3034, %3033), scope=aten::mul.347, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3036 = bf16[29,3584]{1,0} aten::view(%3035), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3037 = bf16[29,18944]{1,0} aten::mm(%3036, %215), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3038 = bf16[1,29,18944]{2,1,0} aten::view(%3037), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3039 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3040 = bf16[3584,18944]{0,1} aten::permute(%3039), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3041 = bf16[29,3584]{1,0} aten::view(%3035), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3042 = bf16[29,18944]{1,0} aten::mm(%3041, %3040), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3043 = bf16[1,29,18944]{2,1,0} aten::view(%3042), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3044 = bf16[1,29,18944]{2,1,0} aten::silu(%3043), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3045 = bf16[1,29,18944]{2,1,0} aten::mul(%3044, %3038), scope=aten::mul.348, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3046 = bf16[29,18944]{1,0} aten::view(%3045), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3047 = bf16[29,3584]{1,0} aten::mm(%3046, %213), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3048 = bf16[1,29,3584]{2,1,0} aten::view(%3047), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3049 = bf16[1,29,3584]{2,1,0} aten::add(%3026, %3048, %211), scope=aten::add.349, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3050 = f32[1,29,3584]{2,1,0} xla::cast(%3049), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3051 = f32[1,29,3584]{2,1,0} aten::pow(%3050, %210), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3052 = f32[1,29,1]{2,1,0} aten::mean(%3051), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3053 = f32[1,29,1]{2,1,0} aten::add(%3052, %209, %208), scope=aten::add.350, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3054 = f32[1,29,1]{2,1,0} aten::rsqrt(%3053), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3055 = f32[1,29,3584]{2,1,0} aten::mul(%3050, %3054), scope=aten::mul.351, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3056 = bf16[1,29,3584]{2,1,0} xla::cast(%3055), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3057 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3058 = bf16[1,29,3584]{2,1,0} aten::mul(%3057, %3056), scope=aten::mul.352, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3059 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3060 = bf16[29,512]{1,0} aten::mm(%3059, %207), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3061 = bf16[1,29,512]{2,1,0} aten::view(%3060), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3062 = bf16[1,29,512]{2,1,0} aten::add(%3061, %205, %204), scope=aten::add.355, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3063 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3062), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3064 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3063), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3065 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3064), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3066 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3065), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3067 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3066), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3068 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3067), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3069 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3070 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3071 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3070), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3072 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3071), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3073 = bf16[28,29,128]{2,1,0} aten::view(%3072), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3074 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3075 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3076 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3077 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3078 = s64[1,29]{1,0} aten::expand(%3077), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3079 = s64[1,29]{1,0} aten::add(%628, %3078), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3080 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3081 = pred[1,29]{1,0} aten::lt(%628, %3080), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3082 = s64[1,29]{1,0} aten::where(%3081, %3079, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3083 = s64[1,29,1]{2,1,0} aten::stack(%3082), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3084 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3085 = bf16[29,128]{1,0} xla::select(%3084), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3086 = bf16[1,29,128]{2,1,0} aten::index(%3085, %3083), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3087 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3086), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3088 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3089 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3090 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3091 = bf16[3584,512]{0,1} aten::permute(%3090), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3092 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3093 = bf16[29,512]{1,0} aten::mm(%3092, %3091), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3094 = bf16[1,29,512]{2,1,0} aten::view(%3093), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3095 = bf16[1,29,512]{2,1,0} aten::add(%3094, %3089, %3088), scope=aten::add.354, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3096 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3095), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3097 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3096), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3098 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3097), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3099 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3097), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3100 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3099), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3101 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3100, %3098), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3102 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3101, %3087), scope=aten::mul.360, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3103 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3104 = s64[1,29]{1,0} aten::expand(%3103), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3105 = s64[1,29]{1,0} aten::add(%628, %3104), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3106 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3107 = pred[1,29]{1,0} aten::lt(%628, %3106), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3108 = s64[1,29]{1,0} aten::where(%3107, %3105, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3109 = s64[1,29,1]{2,1,0} aten::stack(%3108), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3110 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3111 = bf16[29,128]{1,0} xla::select(%3110), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3112 = bf16[1,29,128]{2,1,0} aten::index(%3111, %3109), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3113 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3112), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3114 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3097, %3113), scope=aten::mul.359, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3115 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3114, %3102, %3076), scope=aten::add.361, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3116 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3115), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3117 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3118 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3119 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3118), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3120 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3119), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3121 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3120), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3122 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3121), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3123 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3122), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3124 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3123), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3125 = bf16[28,128,29]{2,1,0} aten::view(%3124), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3126 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3127 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3128 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3129 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3130 = bf16[3584,3584]{0,1} aten::permute(%3129), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3131 = bf16[29,3584]{1,0} aten::view(%3058), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3132 = bf16[29,3584]{1,0} aten::mm(%3131, %3130), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3133 = bf16[1,29,3584]{2,1,0} aten::view(%3132), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3134 = bf16[1,29,3584]{2,1,0} aten::add(%3133, %3128, %3127), scope=aten::add.353, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3135 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3134), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3136 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3135), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3137 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3136), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3138 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3136), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3139 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3138), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3140 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3139, %3137), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3141 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3140, %3087), scope=aten::mul.357, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3142 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3136, %3113), scope=aten::mul.356, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3143 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3142, %3141, %3126), scope=aten::add.358, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3144 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3143), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3145 = bf16[28,29,128]{2,1,0} aten::view(%3144), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3146 = bf16[28,29,29]{2,1,0} aten::matmul(%3145, %3125), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3147 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3146), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3148 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3147, %3075), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3149 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3148, %617, %3074), scope=aten::add.362, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3150 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3149), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3151 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3150), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3152 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3151), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3153 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3152), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3154 = bf16[28,29,29]{2,1,0} aten::view(%3153), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3155 = bf16[28,29,128]{2,1,0} aten::matmul(%3154, %3073), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3156 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3155), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3157 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3156), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3158 = bf16[1,29,3584]{2,1,0} aten::view(%3157), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3159 = bf16[29,3584]{1,0} aten::view(%3158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3160 = bf16[29,3584]{1,0} aten::mm(%3159, %203), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3161 = bf16[1,29,3584]{2,1,0} aten::view(%3160), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3162 = bf16[1,29,3584]{2,1,0} aten::add(%3049, %3161, %201), scope=aten::add.363, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3163 = f32[1,29,3584]{2,1,0} xla::cast(%3162), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3164 = f32[1,29,3584]{2,1,0} aten::pow(%3163, %200), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3165 = f32[1,29,1]{2,1,0} aten::mean(%3164), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3166 = f32[1,29,1]{2,1,0} aten::add(%3165, %199, %198), scope=aten::add.364, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3167 = f32[1,29,1]{2,1,0} aten::rsqrt(%3166), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3168 = f32[1,29,3584]{2,1,0} aten::mul(%3163, %3167), scope=aten::mul.365, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3169 = bf16[1,29,3584]{2,1,0} xla::cast(%3168), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3170 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3171 = bf16[1,29,3584]{2,1,0} aten::mul(%3170, %3169), scope=aten::mul.366, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3172 = bf16[29,3584]{1,0} aten::view(%3171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3173 = bf16[29,18944]{1,0} aten::mm(%3172, %197), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3174 = bf16[1,29,18944]{2,1,0} aten::view(%3173), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3175 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3176 = bf16[3584,18944]{0,1} aten::permute(%3175), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3177 = bf16[29,3584]{1,0} aten::view(%3171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3178 = bf16[29,18944]{1,0} aten::mm(%3177, %3176), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3179 = bf16[1,29,18944]{2,1,0} aten::view(%3178), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3180 = bf16[1,29,18944]{2,1,0} aten::silu(%3179), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3181 = bf16[1,29,18944]{2,1,0} aten::mul(%3180, %3174), scope=aten::mul.367, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3182 = bf16[29,18944]{1,0} aten::view(%3181), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3183 = bf16[29,3584]{1,0} aten::mm(%3182, %195), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3184 = bf16[1,29,3584]{2,1,0} aten::view(%3183), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3185 = bf16[1,29,3584]{2,1,0} aten::add(%3162, %3184, %193), scope=aten::add.368, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3186 = f32[1,29,3584]{2,1,0} xla::cast(%3185), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3187 = f32[1,29,3584]{2,1,0} aten::pow(%3186, %192), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3188 = f32[1,29,1]{2,1,0} aten::mean(%3187), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3189 = f32[1,29,1]{2,1,0} aten::add(%3188, %191, %190), scope=aten::add.369, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3190 = f32[1,29,1]{2,1,0} aten::rsqrt(%3189), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3191 = f32[1,29,3584]{2,1,0} aten::mul(%3186, %3190), scope=aten::mul.370, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3192 = bf16[1,29,3584]{2,1,0} xla::cast(%3191), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3193 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3194 = bf16[1,29,3584]{2,1,0} aten::mul(%3193, %3192), scope=aten::mul.371, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3195 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3196 = bf16[29,512]{1,0} aten::mm(%3195, %189), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3197 = bf16[1,29,512]{2,1,0} aten::view(%3196), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3198 = bf16[1,29,512]{2,1,0} aten::add(%3197, %187, %186), scope=aten::add.374, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3199 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3198), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3200 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3199), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3201 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3200), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3202 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3201), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3203 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3202), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3204 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3203), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3205 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3206 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3207 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3206), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3208 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3207), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3209 = bf16[28,29,128]{2,1,0} aten::view(%3208), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3210 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3211 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3212 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3213 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3214 = s64[1,29]{1,0} aten::expand(%3213), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3215 = s64[1,29]{1,0} aten::add(%628, %3214), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3216 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3217 = pred[1,29]{1,0} aten::lt(%628, %3216), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3218 = s64[1,29]{1,0} aten::where(%3217, %3215, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3219 = s64[1,29,1]{2,1,0} aten::stack(%3218), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3220 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3221 = bf16[29,128]{1,0} xla::select(%3220), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3222 = bf16[1,29,128]{2,1,0} aten::index(%3221, %3219), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3223 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3222), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3224 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3225 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3226 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3227 = bf16[3584,512]{0,1} aten::permute(%3226), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3228 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3229 = bf16[29,512]{1,0} aten::mm(%3228, %3227), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3230 = bf16[1,29,512]{2,1,0} aten::view(%3229), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3231 = bf16[1,29,512]{2,1,0} aten::add(%3230, %3225, %3224), scope=aten::add.373, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3232 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3231), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3233 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3232), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3234 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3233), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3235 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3233), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3236 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3235), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3237 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3236, %3234), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3238 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3237, %3223), scope=aten::mul.379, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3239 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3240 = s64[1,29]{1,0} aten::expand(%3239), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3241 = s64[1,29]{1,0} aten::add(%628, %3240), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3242 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3243 = pred[1,29]{1,0} aten::lt(%628, %3242), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3244 = s64[1,29]{1,0} aten::where(%3243, %3241, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3245 = s64[1,29,1]{2,1,0} aten::stack(%3244), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3246 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3247 = bf16[29,128]{1,0} xla::select(%3246), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3248 = bf16[1,29,128]{2,1,0} aten::index(%3247, %3245), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3249 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3248), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3250 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3233, %3249), scope=aten::mul.378, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3251 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3250, %3238, %3212), scope=aten::add.380, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3252 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3251), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3253 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3254 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3255 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3254), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3256 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3255), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3257 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3256), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3258 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3257), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3259 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3258), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3260 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3259), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3261 = bf16[28,128,29]{2,1,0} aten::view(%3260), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3262 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3263 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3264 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3265 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3266 = bf16[3584,3584]{0,1} aten::permute(%3265), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3267 = bf16[29,3584]{1,0} aten::view(%3194), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3268 = bf16[29,3584]{1,0} aten::mm(%3267, %3266), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3269 = bf16[1,29,3584]{2,1,0} aten::view(%3268), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3270 = bf16[1,29,3584]{2,1,0} aten::add(%3269, %3264, %3263), scope=aten::add.372, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3271 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3270), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3272 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3271), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3273 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3272), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3274 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3272), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3275 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3274), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3276 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3275, %3273), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3277 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3276, %3223), scope=aten::mul.376, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3278 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3272, %3249), scope=aten::mul.375, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3279 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3278, %3277, %3262), scope=aten::add.377, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3280 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3279), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3281 = bf16[28,29,128]{2,1,0} aten::view(%3280), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3282 = bf16[28,29,29]{2,1,0} aten::matmul(%3281, %3261), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3283 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3282), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3284 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3283, %3211), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3285 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3284, %617, %3210), scope=aten::add.381, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3286 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3285), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3287 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3286), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3288 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3287), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3289 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3288), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3290 = bf16[28,29,29]{2,1,0} aten::view(%3289), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3291 = bf16[28,29,128]{2,1,0} aten::matmul(%3290, %3209), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3292 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3291), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3293 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3292), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3294 = bf16[1,29,3584]{2,1,0} aten::view(%3293), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3295 = bf16[29,3584]{1,0} aten::view(%3294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3296 = bf16[29,3584]{1,0} aten::mm(%3295, %185), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3297 = bf16[1,29,3584]{2,1,0} aten::view(%3296), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3298 = bf16[1,29,3584]{2,1,0} aten::add(%3185, %3297, %183), scope=aten::add.382, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3299 = f32[1,29,3584]{2,1,0} xla::cast(%3298), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3300 = f32[1,29,3584]{2,1,0} aten::pow(%3299, %182), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3301 = f32[1,29,1]{2,1,0} aten::mean(%3300), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3302 = f32[1,29,1]{2,1,0} aten::add(%3301, %181, %180), scope=aten::add.383, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3303 = f32[1,29,1]{2,1,0} aten::rsqrt(%3302), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3304 = f32[1,29,3584]{2,1,0} aten::mul(%3299, %3303), scope=aten::mul.384, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3305 = bf16[1,29,3584]{2,1,0} xla::cast(%3304), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3306 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3307 = bf16[1,29,3584]{2,1,0} aten::mul(%3306, %3305), scope=aten::mul.385, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3308 = bf16[29,3584]{1,0} aten::view(%3307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3309 = bf16[29,18944]{1,0} aten::mm(%3308, %179), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3310 = bf16[1,29,18944]{2,1,0} aten::view(%3309), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3311 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3312 = bf16[3584,18944]{0,1} aten::permute(%3311), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3313 = bf16[29,3584]{1,0} aten::view(%3307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3314 = bf16[29,18944]{1,0} aten::mm(%3313, %3312), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3315 = bf16[1,29,18944]{2,1,0} aten::view(%3314), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3316 = bf16[1,29,18944]{2,1,0} aten::silu(%3315), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3317 = bf16[1,29,18944]{2,1,0} aten::mul(%3316, %3310), scope=aten::mul.386, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3318 = bf16[29,18944]{1,0} aten::view(%3317), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3319 = bf16[29,3584]{1,0} aten::mm(%3318, %177), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3320 = bf16[1,29,3584]{2,1,0} aten::view(%3319), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3321 = bf16[1,29,3584]{2,1,0} aten::add(%3298, %3320, %175), scope=aten::add.387, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3322 = f32[1,29,3584]{2,1,0} xla::cast(%3321), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3323 = f32[1,29,3584]{2,1,0} aten::pow(%3322, %174), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3324 = f32[1,29,1]{2,1,0} aten::mean(%3323), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3325 = f32[1,29,1]{2,1,0} aten::add(%3324, %173, %172), scope=aten::add.388, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3326 = f32[1,29,1]{2,1,0} aten::rsqrt(%3325), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3327 = f32[1,29,3584]{2,1,0} aten::mul(%3322, %3326), scope=aten::mul.389, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3328 = bf16[1,29,3584]{2,1,0} xla::cast(%3327), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3329 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3330 = bf16[1,29,3584]{2,1,0} aten::mul(%3329, %3328), scope=aten::mul.390, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3331 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3332 = bf16[29,512]{1,0} aten::mm(%3331, %171), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3333 = bf16[1,29,512]{2,1,0} aten::view(%3332), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3334 = bf16[1,29,512]{2,1,0} aten::add(%3333, %169, %168), scope=aten::add.393, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3335 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3334), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3336 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3335), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3337 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3336), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3338 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3337), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3339 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3338), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3340 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3339), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3341 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3342 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3343 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3342), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3344 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3343), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3345 = bf16[28,29,128]{2,1,0} aten::view(%3344), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3346 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3347 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3348 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3349 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3350 = s64[1,29]{1,0} aten::expand(%3349), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3351 = s64[1,29]{1,0} aten::add(%628, %3350), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3352 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3353 = pred[1,29]{1,0} aten::lt(%628, %3352), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3354 = s64[1,29]{1,0} aten::where(%3353, %3351, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3355 = s64[1,29,1]{2,1,0} aten::stack(%3354), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3356 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3357 = bf16[29,128]{1,0} xla::select(%3356), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3358 = bf16[1,29,128]{2,1,0} aten::index(%3357, %3355), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3359 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3358), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3360 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3361 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3362 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3363 = bf16[3584,512]{0,1} aten::permute(%3362), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3364 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3365 = bf16[29,512]{1,0} aten::mm(%3364, %3363), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3366 = bf16[1,29,512]{2,1,0} aten::view(%3365), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3367 = bf16[1,29,512]{2,1,0} aten::add(%3366, %3361, %3360), scope=aten::add.392, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3368 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3367), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3369 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3368), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3370 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3369), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3371 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3369), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3372 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3371), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3373 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3372, %3370), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3374 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3373, %3359), scope=aten::mul.398, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3375 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3376 = s64[1,29]{1,0} aten::expand(%3375), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3377 = s64[1,29]{1,0} aten::add(%628, %3376), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3378 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3379 = pred[1,29]{1,0} aten::lt(%628, %3378), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3380 = s64[1,29]{1,0} aten::where(%3379, %3377, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3381 = s64[1,29,1]{2,1,0} aten::stack(%3380), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3382 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3383 = bf16[29,128]{1,0} xla::select(%3382), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3384 = bf16[1,29,128]{2,1,0} aten::index(%3383, %3381), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3385 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3384), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3386 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3369, %3385), scope=aten::mul.397, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3387 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3386, %3374, %3348), scope=aten::add.399, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3388 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3387), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3389 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3390 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3391 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3390), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3392 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3391), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3393 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3392), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3394 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3393), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3395 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3394), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3396 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3395), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3397 = bf16[28,128,29]{2,1,0} aten::view(%3396), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3398 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3399 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3400 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3401 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3402 = bf16[3584,3584]{0,1} aten::permute(%3401), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3403 = bf16[29,3584]{1,0} aten::view(%3330), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3404 = bf16[29,3584]{1,0} aten::mm(%3403, %3402), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3405 = bf16[1,29,3584]{2,1,0} aten::view(%3404), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3406 = bf16[1,29,3584]{2,1,0} aten::add(%3405, %3400, %3399), scope=aten::add.391, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3407 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3406), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3408 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3407), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3409 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3408), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3410 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3408), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3411 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3410), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3412 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3411, %3409), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3413 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3412, %3359), scope=aten::mul.395, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3414 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3408, %3385), scope=aten::mul.394, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3415 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3414, %3413, %3398), scope=aten::add.396, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3416 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3415), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3417 = bf16[28,29,128]{2,1,0} aten::view(%3416), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3418 = bf16[28,29,29]{2,1,0} aten::matmul(%3417, %3397), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3419 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3418), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3420 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3419, %3347), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3421 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3420, %617, %3346), scope=aten::add.400, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3422 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3421), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3423 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3422), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3424 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3423), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3425 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3424), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3426 = bf16[28,29,29]{2,1,0} aten::view(%3425), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3427 = bf16[28,29,128]{2,1,0} aten::matmul(%3426, %3345), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3428 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3427), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3429 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3428), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3430 = bf16[1,29,3584]{2,1,0} aten::view(%3429), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3431 = bf16[29,3584]{1,0} aten::view(%3430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3432 = bf16[29,3584]{1,0} aten::mm(%3431, %167), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3433 = bf16[1,29,3584]{2,1,0} aten::view(%3432), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3434 = bf16[1,29,3584]{2,1,0} aten::add(%3321, %3433, %165), scope=aten::add.401, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3435 = f32[1,29,3584]{2,1,0} xla::cast(%3434), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3436 = f32[1,29,3584]{2,1,0} aten::pow(%3435, %164), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3437 = f32[1,29,1]{2,1,0} aten::mean(%3436), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3438 = f32[1,29,1]{2,1,0} aten::add(%3437, %163, %162), scope=aten::add.402, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3439 = f32[1,29,1]{2,1,0} aten::rsqrt(%3438), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3440 = f32[1,29,3584]{2,1,0} aten::mul(%3435, %3439), scope=aten::mul.403, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3441 = bf16[1,29,3584]{2,1,0} xla::cast(%3440), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3442 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3443 = bf16[1,29,3584]{2,1,0} aten::mul(%3442, %3441), scope=aten::mul.404, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3444 = bf16[29,3584]{1,0} aten::view(%3443), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3445 = bf16[29,18944]{1,0} aten::mm(%3444, %161), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3446 = bf16[1,29,18944]{2,1,0} aten::view(%3445), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3447 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3448 = bf16[3584,18944]{0,1} aten::permute(%3447), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3449 = bf16[29,3584]{1,0} aten::view(%3443), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3450 = bf16[29,18944]{1,0} aten::mm(%3449, %3448), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3451 = bf16[1,29,18944]{2,1,0} aten::view(%3450), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3452 = bf16[1,29,18944]{2,1,0} aten::silu(%3451), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3453 = bf16[1,29,18944]{2,1,0} aten::mul(%3452, %3446), scope=aten::mul.405, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3454 = bf16[29,18944]{1,0} aten::view(%3453), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3455 = bf16[29,3584]{1,0} aten::mm(%3454, %159), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3456 = bf16[1,29,3584]{2,1,0} aten::view(%3455), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3457 = bf16[1,29,3584]{2,1,0} aten::add(%3434, %3456, %157), scope=aten::add.406, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3458 = f32[1,29,3584]{2,1,0} xla::cast(%3457), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3459 = f32[1,29,3584]{2,1,0} aten::pow(%3458, %156), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3460 = f32[1,29,1]{2,1,0} aten::mean(%3459), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3461 = f32[1,29,1]{2,1,0} aten::add(%3460, %155, %154), scope=aten::add.407, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3462 = f32[1,29,1]{2,1,0} aten::rsqrt(%3461), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3463 = f32[1,29,3584]{2,1,0} aten::mul(%3458, %3462), scope=aten::mul.408, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3464 = bf16[1,29,3584]{2,1,0} xla::cast(%3463), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3465 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3466 = bf16[1,29,3584]{2,1,0} aten::mul(%3465, %3464), scope=aten::mul.409, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3467 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3468 = bf16[29,512]{1,0} aten::mm(%3467, %153), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3469 = bf16[1,29,512]{2,1,0} aten::view(%3468), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3470 = bf16[1,29,512]{2,1,0} aten::add(%3469, %151, %150), scope=aten::add.412, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3471 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3470), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3472 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3471), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3473 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3472), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3474 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3473), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3475 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3474), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3476 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3475), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3477 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3476), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3478 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3477), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3479 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3478), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3480 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3479), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3481 = bf16[28,29,128]{2,1,0} aten::view(%3480), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3482 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3483 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3484 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3485 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3486 = s64[1,29]{1,0} aten::expand(%3485), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3487 = s64[1,29]{1,0} aten::add(%628, %3486), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3488 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3489 = pred[1,29]{1,0} aten::lt(%628, %3488), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3490 = s64[1,29]{1,0} aten::where(%3489, %3487, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3491 = s64[1,29,1]{2,1,0} aten::stack(%3490), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3492 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3493 = bf16[29,128]{1,0} xla::select(%3492), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3494 = bf16[1,29,128]{2,1,0} aten::index(%3493, %3491), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3495 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3494), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3496 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3497 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3498 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3499 = bf16[3584,512]{0,1} aten::permute(%3498), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3500 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3501 = bf16[29,512]{1,0} aten::mm(%3500, %3499), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3502 = bf16[1,29,512]{2,1,0} aten::view(%3501), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3503 = bf16[1,29,512]{2,1,0} aten::add(%3502, %3497, %3496), scope=aten::add.411, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3504 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3503), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3505 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3504), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3506 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3505), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3507 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3505), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3508 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3507), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3509 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3508, %3506), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3510 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3509, %3495), scope=aten::mul.417, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3511 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3512 = s64[1,29]{1,0} aten::expand(%3511), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3513 = s64[1,29]{1,0} aten::add(%628, %3512), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3514 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3515 = pred[1,29]{1,0} aten::lt(%628, %3514), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3516 = s64[1,29]{1,0} aten::where(%3515, %3513, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3517 = s64[1,29,1]{2,1,0} aten::stack(%3516), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3518 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3519 = bf16[29,128]{1,0} xla::select(%3518), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3520 = bf16[1,29,128]{2,1,0} aten::index(%3519, %3517), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3521 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3520), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3522 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3505, %3521), scope=aten::mul.416, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3523 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3522, %3510, %3484), scope=aten::add.418, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3524 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3523), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3525 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3526 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3527 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3526), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3528 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3527), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3529 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3528), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3530 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3529), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3531 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3530), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3532 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3531), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3533 = bf16[28,128,29]{2,1,0} aten::view(%3532), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3534 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3535 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3536 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3537 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3538 = bf16[3584,3584]{0,1} aten::permute(%3537), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3539 = bf16[29,3584]{1,0} aten::view(%3466), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3540 = bf16[29,3584]{1,0} aten::mm(%3539, %3538), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3541 = bf16[1,29,3584]{2,1,0} aten::view(%3540), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3542 = bf16[1,29,3584]{2,1,0} aten::add(%3541, %3536, %3535), scope=aten::add.410, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3543 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3542), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3544 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3543), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3545 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3544), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3546 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3544), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3547 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3546), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3548 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3547, %3545), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3549 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3548, %3495), scope=aten::mul.414, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3550 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3544, %3521), scope=aten::mul.413, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3551 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3550, %3549, %3534), scope=aten::add.415, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3552 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3551), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3553 = bf16[28,29,128]{2,1,0} aten::view(%3552), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3554 = bf16[28,29,29]{2,1,0} aten::matmul(%3553, %3533), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3555 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3554), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3556 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3555, %3483), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3557 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3556, %617, %3482), scope=aten::add.419, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3558 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3557), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3559 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3558), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3560 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3559), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3561 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3560), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3562 = bf16[28,29,29]{2,1,0} aten::view(%3561), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3563 = bf16[28,29,128]{2,1,0} aten::matmul(%3562, %3481), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3564 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3563), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3565 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3564), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3566 = bf16[1,29,3584]{2,1,0} aten::view(%3565), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3567 = bf16[29,3584]{1,0} aten::view(%3566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3568 = bf16[29,3584]{1,0} aten::mm(%3567, %149), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3569 = bf16[1,29,3584]{2,1,0} aten::view(%3568), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3570 = bf16[1,29,3584]{2,1,0} aten::add(%3457, %3569, %147), scope=aten::add.420, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3571 = f32[1,29,3584]{2,1,0} xla::cast(%3570), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3572 = f32[1,29,3584]{2,1,0} aten::pow(%3571, %146), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3573 = f32[1,29,1]{2,1,0} aten::mean(%3572), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3574 = f32[1,29,1]{2,1,0} aten::add(%3573, %145, %144), scope=aten::add.421, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3575 = f32[1,29,1]{2,1,0} aten::rsqrt(%3574), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3576 = f32[1,29,3584]{2,1,0} aten::mul(%3571, %3575), scope=aten::mul.422, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3577 = bf16[1,29,3584]{2,1,0} xla::cast(%3576), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3578 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3579 = bf16[1,29,3584]{2,1,0} aten::mul(%3578, %3577), scope=aten::mul.423, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3580 = bf16[29,3584]{1,0} aten::view(%3579), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3581 = bf16[29,18944]{1,0} aten::mm(%3580, %143), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3582 = bf16[1,29,18944]{2,1,0} aten::view(%3581), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3583 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3584 = bf16[3584,18944]{0,1} aten::permute(%3583), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3585 = bf16[29,3584]{1,0} aten::view(%3579), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3586 = bf16[29,18944]{1,0} aten::mm(%3585, %3584), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3587 = bf16[1,29,18944]{2,1,0} aten::view(%3586), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3588 = bf16[1,29,18944]{2,1,0} aten::silu(%3587), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3589 = bf16[1,29,18944]{2,1,0} aten::mul(%3588, %3582), scope=aten::mul.424, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3590 = bf16[29,18944]{1,0} aten::view(%3589), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3591 = bf16[29,3584]{1,0} aten::mm(%3590, %141), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3592 = bf16[1,29,3584]{2,1,0} aten::view(%3591), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3593 = bf16[1,29,3584]{2,1,0} aten::add(%3570, %3592, %139), scope=aten::add.425, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3594 = f32[1,29,3584]{2,1,0} xla::cast(%3593), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3595 = f32[1,29,3584]{2,1,0} aten::pow(%3594, %138), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3596 = f32[1,29,1]{2,1,0} aten::mean(%3595), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3597 = f32[1,29,1]{2,1,0} aten::add(%3596, %137, %136), scope=aten::add.426, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3598 = f32[1,29,1]{2,1,0} aten::rsqrt(%3597), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3599 = f32[1,29,3584]{2,1,0} aten::mul(%3594, %3598), scope=aten::mul.427, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3600 = bf16[1,29,3584]{2,1,0} xla::cast(%3599), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3601 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3602 = bf16[1,29,3584]{2,1,0} aten::mul(%3601, %3600), scope=aten::mul.428, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3603 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3604 = bf16[29,512]{1,0} aten::mm(%3603, %135), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3605 = bf16[1,29,512]{2,1,0} aten::view(%3604), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3606 = bf16[1,29,512]{2,1,0} aten::add(%3605, %133, %132), scope=aten::add.431, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3607 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3606), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3608 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3607), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3609 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3608), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3610 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3609), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3611 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3610), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3612 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3611), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3613 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3612), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3614 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3613), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3615 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3614), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3616 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3615), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3617 = bf16[28,29,128]{2,1,0} aten::view(%3616), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3618 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3619 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3620 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3621 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3622 = s64[1,29]{1,0} aten::expand(%3621), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3623 = s64[1,29]{1,0} aten::add(%628, %3622), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3624 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3625 = pred[1,29]{1,0} aten::lt(%628, %3624), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3626 = s64[1,29]{1,0} aten::where(%3625, %3623, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3627 = s64[1,29,1]{2,1,0} aten::stack(%3626), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3628 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3629 = bf16[29,128]{1,0} xla::select(%3628), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3630 = bf16[1,29,128]{2,1,0} aten::index(%3629, %3627), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3631 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3632 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3633 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3634 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3635 = bf16[3584,512]{0,1} aten::permute(%3634), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3636 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3637 = bf16[29,512]{1,0} aten::mm(%3636, %3635), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3638 = bf16[1,29,512]{2,1,0} aten::view(%3637), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3639 = bf16[1,29,512]{2,1,0} aten::add(%3638, %3633, %3632), scope=aten::add.430, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3640 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3639), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3641 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3640), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3642 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3641), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3643 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3641), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3644 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3643), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3645 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3644, %3642), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3646 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3645, %3631), scope=aten::mul.436, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3647 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3648 = s64[1,29]{1,0} aten::expand(%3647), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3649 = s64[1,29]{1,0} aten::add(%628, %3648), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3650 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3651 = pred[1,29]{1,0} aten::lt(%628, %3650), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3652 = s64[1,29]{1,0} aten::where(%3651, %3649, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3653 = s64[1,29,1]{2,1,0} aten::stack(%3652), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3654 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3655 = bf16[29,128]{1,0} xla::select(%3654), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3656 = bf16[1,29,128]{2,1,0} aten::index(%3655, %3653), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3657 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3658 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3641, %3657), scope=aten::mul.435, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3659 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3658, %3646, %3620), scope=aten::add.437, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3660 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3659), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3661 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3662 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3663 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3662), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3664 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3663), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3665 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3664), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3666 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3665), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3667 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3666), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3668 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3667), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3669 = bf16[28,128,29]{2,1,0} aten::view(%3668), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3670 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3671 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3672 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3673 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3674 = bf16[3584,3584]{0,1} aten::permute(%3673), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3675 = bf16[29,3584]{1,0} aten::view(%3602), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3676 = bf16[29,3584]{1,0} aten::mm(%3675, %3674), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3677 = bf16[1,29,3584]{2,1,0} aten::view(%3676), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3678 = bf16[1,29,3584]{2,1,0} aten::add(%3677, %3672, %3671), scope=aten::add.429, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3679 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3678), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3680 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3679), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3681 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3680), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3682 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3680), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3683 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3682), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3684 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3683, %3681), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3685 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3684, %3631), scope=aten::mul.433, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3686 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3680, %3657), scope=aten::mul.432, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3687 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3686, %3685, %3670), scope=aten::add.434, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3688 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3687), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3689 = bf16[28,29,128]{2,1,0} aten::view(%3688), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3690 = bf16[28,29,29]{2,1,0} aten::matmul(%3689, %3669), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3691 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3690), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3692 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3691, %3619), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3693 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3692, %617, %3618), scope=aten::add.438, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3694 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3693), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3695 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3694), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3696 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3695), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3697 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3696), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3698 = bf16[28,29,29]{2,1,0} aten::view(%3697), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3699 = bf16[28,29,128]{2,1,0} aten::matmul(%3698, %3617), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3700 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3699), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3701 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3700), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3702 = bf16[1,29,3584]{2,1,0} aten::view(%3701), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3703 = bf16[29,3584]{1,0} aten::view(%3702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3704 = bf16[29,3584]{1,0} aten::mm(%3703, %131), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3705 = bf16[1,29,3584]{2,1,0} aten::view(%3704), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3706 = bf16[1,29,3584]{2,1,0} aten::add(%3593, %3705, %129), scope=aten::add.439, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3707 = f32[1,29,3584]{2,1,0} xla::cast(%3706), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3708 = f32[1,29,3584]{2,1,0} aten::pow(%3707, %128), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3709 = f32[1,29,1]{2,1,0} aten::mean(%3708), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3710 = f32[1,29,1]{2,1,0} aten::add(%3709, %127, %126), scope=aten::add.440, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3711 = f32[1,29,1]{2,1,0} aten::rsqrt(%3710), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3712 = f32[1,29,3584]{2,1,0} aten::mul(%3707, %3711), scope=aten::mul.441, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3713 = bf16[1,29,3584]{2,1,0} xla::cast(%3712), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3714 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3715 = bf16[1,29,3584]{2,1,0} aten::mul(%3714, %3713), scope=aten::mul.442, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3716 = bf16[29,3584]{1,0} aten::view(%3715), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3717 = bf16[29,18944]{1,0} aten::mm(%3716, %125), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3718 = bf16[1,29,18944]{2,1,0} aten::view(%3717), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3719 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3720 = bf16[3584,18944]{0,1} aten::permute(%3719), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3721 = bf16[29,3584]{1,0} aten::view(%3715), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3722 = bf16[29,18944]{1,0} aten::mm(%3721, %3720), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3723 = bf16[1,29,18944]{2,1,0} aten::view(%3722), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3724 = bf16[1,29,18944]{2,1,0} aten::silu(%3723), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3725 = bf16[1,29,18944]{2,1,0} aten::mul(%3724, %3718), scope=aten::mul.443, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3726 = bf16[29,18944]{1,0} aten::view(%3725), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3727 = bf16[29,3584]{1,0} aten::mm(%3726, %123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3728 = bf16[1,29,3584]{2,1,0} aten::view(%3727), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3729 = bf16[1,29,3584]{2,1,0} aten::add(%3706, %3728, %121), scope=aten::add.444, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3730 = f32[1,29,3584]{2,1,0} xla::cast(%3729), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3731 = f32[1,29,3584]{2,1,0} aten::pow(%3730, %120), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3732 = f32[1,29,1]{2,1,0} aten::mean(%3731), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3733 = f32[1,29,1]{2,1,0} aten::add(%3732, %119, %118), scope=aten::add.445, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3734 = f32[1,29,1]{2,1,0} aten::rsqrt(%3733), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3735 = f32[1,29,3584]{2,1,0} aten::mul(%3730, %3734), scope=aten::mul.446, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3736 = bf16[1,29,3584]{2,1,0} xla::cast(%3735), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3737 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3738 = bf16[1,29,3584]{2,1,0} aten::mul(%3737, %3736), scope=aten::mul.447, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3739 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3740 = bf16[29,512]{1,0} aten::mm(%3739, %117), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3741 = bf16[1,29,512]{2,1,0} aten::view(%3740), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3742 = bf16[1,29,512]{2,1,0} aten::add(%3741, %115, %114), scope=aten::add.450, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3743 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3742), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3744 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3743), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3745 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3744), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3746 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3745), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3747 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3746), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3748 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3747), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3749 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3748), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3750 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3749), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3751 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3750), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3752 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3751), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3753 = bf16[28,29,128]{2,1,0} aten::view(%3752), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3754 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3755 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3756 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3757 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3758 = s64[1,29]{1,0} aten::expand(%3757), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3759 = s64[1,29]{1,0} aten::add(%628, %3758), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3760 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3761 = pred[1,29]{1,0} aten::lt(%628, %3760), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3762 = s64[1,29]{1,0} aten::where(%3761, %3759, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3763 = s64[1,29,1]{2,1,0} aten::stack(%3762), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3764 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3765 = bf16[29,128]{1,0} xla::select(%3764), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3766 = bf16[1,29,128]{2,1,0} aten::index(%3765, %3763), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3767 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3768 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3769 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3770 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3771 = bf16[3584,512]{0,1} aten::permute(%3770), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3772 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3773 = bf16[29,512]{1,0} aten::mm(%3772, %3771), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3774 = bf16[1,29,512]{2,1,0} aten::view(%3773), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3775 = bf16[1,29,512]{2,1,0} aten::add(%3774, %3769, %3768), scope=aten::add.449, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3776 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3775), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3777 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3776), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3778 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3777), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3779 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3777), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3780 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3779), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3781 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3780, %3778), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3782 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3781, %3767), scope=aten::mul.455, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3783 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3784 = s64[1,29]{1,0} aten::expand(%3783), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3785 = s64[1,29]{1,0} aten::add(%628, %3784), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3786 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3787 = pred[1,29]{1,0} aten::lt(%628, %3786), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3788 = s64[1,29]{1,0} aten::where(%3787, %3785, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3789 = s64[1,29,1]{2,1,0} aten::stack(%3788), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3790 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3791 = bf16[29,128]{1,0} xla::select(%3790), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3792 = bf16[1,29,128]{2,1,0} aten::index(%3791, %3789), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3793 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3794 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3777, %3793), scope=aten::mul.454, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3795 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3794, %3782, %3756), scope=aten::add.456, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3796 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3795), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3797 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3798 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3799 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3798), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3800 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3799), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3801 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3800), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3802 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3801), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3803 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3802), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3804 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3803), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3805 = bf16[28,128,29]{2,1,0} aten::view(%3804), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3806 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3807 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3808 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3809 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3810 = bf16[3584,3584]{0,1} aten::permute(%3809), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3811 = bf16[29,3584]{1,0} aten::view(%3738), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3812 = bf16[29,3584]{1,0} aten::mm(%3811, %3810), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3813 = bf16[1,29,3584]{2,1,0} aten::view(%3812), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3814 = bf16[1,29,3584]{2,1,0} aten::add(%3813, %3808, %3807), scope=aten::add.448, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3815 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3814), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3816 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3815), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3817 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3816), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3818 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3816), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3819 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3818), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3820 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3819, %3817), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3821 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3820, %3767), scope=aten::mul.452, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3822 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3816, %3793), scope=aten::mul.451, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3823 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3822, %3821, %3806), scope=aten::add.453, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3824 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3823), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3825 = bf16[28,29,128]{2,1,0} aten::view(%3824), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3826 = bf16[28,29,29]{2,1,0} aten::matmul(%3825, %3805), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3827 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3826), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3828 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3827, %3755), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3829 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3828, %617, %3754), scope=aten::add.457, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3830 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3829), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3831 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3830), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3832 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3831), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3833 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3832), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3834 = bf16[28,29,29]{2,1,0} aten::view(%3833), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3835 = bf16[28,29,128]{2,1,0} aten::matmul(%3834, %3753), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3836 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3835), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3837 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3836), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3838 = bf16[1,29,3584]{2,1,0} aten::view(%3837), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3839 = bf16[29,3584]{1,0} aten::view(%3838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3840 = bf16[29,3584]{1,0} aten::mm(%3839, %113), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3841 = bf16[1,29,3584]{2,1,0} aten::view(%3840), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3842 = bf16[1,29,3584]{2,1,0} aten::add(%3729, %3841, %111), scope=aten::add.458, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3843 = f32[1,29,3584]{2,1,0} xla::cast(%3842), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3844 = f32[1,29,3584]{2,1,0} aten::pow(%3843, %110), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3845 = f32[1,29,1]{2,1,0} aten::mean(%3844), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3846 = f32[1,29,1]{2,1,0} aten::add(%3845, %109, %108), scope=aten::add.459, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3847 = f32[1,29,1]{2,1,0} aten::rsqrt(%3846), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3848 = f32[1,29,3584]{2,1,0} aten::mul(%3843, %3847), scope=aten::mul.460, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3849 = bf16[1,29,3584]{2,1,0} xla::cast(%3848), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3850 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3851 = bf16[1,29,3584]{2,1,0} aten::mul(%3850, %3849), scope=aten::mul.461, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3852 = bf16[29,3584]{1,0} aten::view(%3851), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3853 = bf16[29,18944]{1,0} aten::mm(%3852, %107), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3854 = bf16[1,29,18944]{2,1,0} aten::view(%3853), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3855 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3856 = bf16[3584,18944]{0,1} aten::permute(%3855), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3857 = bf16[29,3584]{1,0} aten::view(%3851), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3858 = bf16[29,18944]{1,0} aten::mm(%3857, %3856), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3859 = bf16[1,29,18944]{2,1,0} aten::view(%3858), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3860 = bf16[1,29,18944]{2,1,0} aten::silu(%3859), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3861 = bf16[1,29,18944]{2,1,0} aten::mul(%3860, %3854), scope=aten::mul.462, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3862 = bf16[29,18944]{1,0} aten::view(%3861), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3863 = bf16[29,3584]{1,0} aten::mm(%3862, %105), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3864 = bf16[1,29,3584]{2,1,0} aten::view(%3863), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3865 = bf16[1,29,3584]{2,1,0} aten::add(%3842, %3864, %103), scope=aten::add.463, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3866 = f32[1,29,3584]{2,1,0} xla::cast(%3865), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3867 = f32[1,29,3584]{2,1,0} aten::pow(%3866, %102), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3868 = f32[1,29,1]{2,1,0} aten::mean(%3867), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3869 = f32[1,29,1]{2,1,0} aten::add(%3868, %101, %100), scope=aten::add.464, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3870 = f32[1,29,1]{2,1,0} aten::rsqrt(%3869), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3871 = f32[1,29,3584]{2,1,0} aten::mul(%3866, %3870), scope=aten::mul.465, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3872 = bf16[1,29,3584]{2,1,0} xla::cast(%3871), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3873 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3874 = bf16[1,29,3584]{2,1,0} aten::mul(%3873, %3872), scope=aten::mul.466, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3875 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3876 = bf16[29,512]{1,0} aten::mm(%3875, %99), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3877 = bf16[1,29,512]{2,1,0} aten::view(%3876), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3878 = bf16[1,29,512]{2,1,0} aten::add(%3877, %97, %96), scope=aten::add.469, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3879 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3878), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3880 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3879), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3881 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3880), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3882 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3881), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3883 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3882), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3884 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3883), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3885 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3884), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3886 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3885), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3887 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3886), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3888 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3887), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3889 = bf16[28,29,128]{2,1,0} aten::view(%3888), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3890 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3891 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3892 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3893 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3894 = s64[1,29]{1,0} aten::expand(%3893), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3895 = s64[1,29]{1,0} aten::add(%628, %3894), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3896 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3897 = pred[1,29]{1,0} aten::lt(%628, %3896), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3898 = s64[1,29]{1,0} aten::where(%3897, %3895, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3899 = s64[1,29,1]{2,1,0} aten::stack(%3898), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3900 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3901 = bf16[29,128]{1,0} xla::select(%3900), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3902 = bf16[1,29,128]{2,1,0} aten::index(%3901, %3899), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3903 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3904 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3905 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3906 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3907 = bf16[3584,512]{0,1} aten::permute(%3906), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3908 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3909 = bf16[29,512]{1,0} aten::mm(%3908, %3907), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3910 = bf16[1,29,512]{2,1,0} aten::view(%3909), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3911 = bf16[1,29,512]{2,1,0} aten::add(%3910, %3905, %3904), scope=aten::add.468, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3912 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3911), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3913 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3912), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3914 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3913), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3915 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3913), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3916 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3915), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3917 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3916, %3914), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3918 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3917, %3903), scope=aten::mul.474, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3919 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3920 = s64[1,29]{1,0} aten::expand(%3919), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3921 = s64[1,29]{1,0} aten::add(%628, %3920), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3922 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3923 = pred[1,29]{1,0} aten::lt(%628, %3922), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3924 = s64[1,29]{1,0} aten::where(%3923, %3921, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3925 = s64[1,29,1]{2,1,0} aten::stack(%3924), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3926 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3927 = bf16[29,128]{1,0} xla::select(%3926), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3928 = bf16[1,29,128]{2,1,0} aten::index(%3927, %3925), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3929 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3930 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3913, %3929), scope=aten::mul.473, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3931 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3930, %3918, %3892), scope=aten::add.475, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3932 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3931), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3933 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3934 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3935 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3934), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3936 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3935), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3937 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3936), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3938 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3937), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3939 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3938), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3940 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3939), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3941 = bf16[28,128,29]{2,1,0} aten::view(%3940), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3942 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3943 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3944 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3945 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3946 = bf16[3584,3584]{0,1} aten::permute(%3945), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3947 = bf16[29,3584]{1,0} aten::view(%3874), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3948 = bf16[29,3584]{1,0} aten::mm(%3947, %3946), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3949 = bf16[1,29,3584]{2,1,0} aten::view(%3948), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3950 = bf16[1,29,3584]{2,1,0} aten::add(%3949, %3944, %3943), scope=aten::add.467, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3951 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3950), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3952 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3951), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3953 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3952), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3954 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3952), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3955 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3954), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3956 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3955, %3953), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3957 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3956, %3903), scope=aten::mul.471, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3958 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3952, %3929), scope=aten::mul.470, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3959 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3958, %3957, %3942), scope=aten::add.472, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3960 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3959), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3961 = bf16[28,29,128]{2,1,0} aten::view(%3960), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3962 = bf16[28,29,29]{2,1,0} aten::matmul(%3961, %3941), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3963 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3962), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3964 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3963, %3891), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3965 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3964, %617, %3890), scope=aten::add.476, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3966 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3965), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3967 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3966), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3968 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3967), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3969 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3968), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3970 = bf16[28,29,29]{2,1,0} aten::view(%3969), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3971 = bf16[28,29,128]{2,1,0} aten::matmul(%3970, %3889), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3972 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3971), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3973 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3972), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3974 = bf16[1,29,3584]{2,1,0} aten::view(%3973), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3975 = bf16[29,3584]{1,0} aten::view(%3974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3976 = bf16[29,3584]{1,0} aten::mm(%3975, %95), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3977 = bf16[1,29,3584]{2,1,0} aten::view(%3976), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3978 = bf16[1,29,3584]{2,1,0} aten::add(%3865, %3977, %93), scope=aten::add.477, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3979 = f32[1,29,3584]{2,1,0} xla::cast(%3978), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3980 = f32[1,29,3584]{2,1,0} aten::pow(%3979, %92), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3981 = f32[1,29,1]{2,1,0} aten::mean(%3980), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3982 = f32[1,29,1]{2,1,0} aten::add(%3981, %91, %90), scope=aten::add.478, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3983 = f32[1,29,1]{2,1,0} aten::rsqrt(%3982), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3984 = f32[1,29,3584]{2,1,0} aten::mul(%3979, %3983), scope=aten::mul.479, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3985 = bf16[1,29,3584]{2,1,0} xla::cast(%3984), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3986 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3987 = bf16[1,29,3584]{2,1,0} aten::mul(%3986, %3985), scope=aten::mul.480, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3988 = bf16[29,3584]{1,0} aten::view(%3987), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3989 = bf16[29,18944]{1,0} aten::mm(%3988, %89), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3990 = bf16[1,29,18944]{2,1,0} aten::view(%3989), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3991 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3992 = bf16[3584,18944]{0,1} aten::permute(%3991), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3993 = bf16[29,3584]{1,0} aten::view(%3987), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3994 = bf16[29,18944]{1,0} aten::mm(%3993, %3992), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3995 = bf16[1,29,18944]{2,1,0} aten::view(%3994), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3996 = bf16[1,29,18944]{2,1,0} aten::silu(%3995), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3997 = bf16[1,29,18944]{2,1,0} aten::mul(%3996, %3990), scope=aten::mul.481, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3998 = bf16[29,18944]{1,0} aten::view(%3997), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3999 = bf16[29,3584]{1,0} aten::mm(%3998, %87), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4000 = bf16[1,29,3584]{2,1,0} aten::view(%3999), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4001 = bf16[1,29,3584]{2,1,0} aten::add(%3978, %4000, %85), scope=aten::add.482, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4002 = f32[1,29,3584]{2,1,0} xla::cast(%4001), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4003 = f32[1,29,3584]{2,1,0} aten::pow(%4002, %84), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4004 = f32[1,29,1]{2,1,0} aten::mean(%4003), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4005 = f32[1,29,1]{2,1,0} aten::add(%4004, %83, %82), scope=aten::add.483, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4006 = f32[1,29,1]{2,1,0} aten::rsqrt(%4005), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4007 = f32[1,29,3584]{2,1,0} aten::mul(%4002, %4006), scope=aten::mul.484, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4008 = bf16[1,29,3584]{2,1,0} xla::cast(%4007), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4009 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4010 = bf16[1,29,3584]{2,1,0} aten::mul(%4009, %4008), scope=aten::mul.485, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4011 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4012 = bf16[29,512]{1,0} aten::mm(%4011, %81), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4013 = bf16[1,29,512]{2,1,0} aten::view(%4012), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4014 = bf16[1,29,512]{2,1,0} aten::add(%4013, %79, %78), scope=aten::add.488, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4015 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4014), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4016 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4015), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4017 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4016), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4018 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4017), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4019 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4018), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4020 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4019), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4021 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4020), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4022 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4021), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4023 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4022), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4024 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4023), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4025 = bf16[28,29,128]{2,1,0} aten::view(%4024), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4026 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4027 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4028 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4029 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4030 = s64[1,29]{1,0} aten::expand(%4029), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4031 = s64[1,29]{1,0} aten::add(%628, %4030), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4032 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4033 = pred[1,29]{1,0} aten::lt(%628, %4032), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4034 = s64[1,29]{1,0} aten::where(%4033, %4031, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4035 = s64[1,29,1]{2,1,0} aten::stack(%4034), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4036 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4037 = bf16[29,128]{1,0} xla::select(%4036), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4038 = bf16[1,29,128]{2,1,0} aten::index(%4037, %4035), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4039 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4040 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4041 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4042 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4043 = bf16[3584,512]{0,1} aten::permute(%4042), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4044 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4045 = bf16[29,512]{1,0} aten::mm(%4044, %4043), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4046 = bf16[1,29,512]{2,1,0} aten::view(%4045), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4047 = bf16[1,29,512]{2,1,0} aten::add(%4046, %4041, %4040), scope=aten::add.487, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4048 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4047), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4049 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4048), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4050 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4049), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4051 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4049), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4052 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4051), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4053 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4052, %4050), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4054 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4053, %4039), scope=aten::mul.493, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4055 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4056 = s64[1,29]{1,0} aten::expand(%4055), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4057 = s64[1,29]{1,0} aten::add(%628, %4056), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4058 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4059 = pred[1,29]{1,0} aten::lt(%628, %4058), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4060 = s64[1,29]{1,0} aten::where(%4059, %4057, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4061 = s64[1,29,1]{2,1,0} aten::stack(%4060), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4062 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4063 = bf16[29,128]{1,0} xla::select(%4062), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4064 = bf16[1,29,128]{2,1,0} aten::index(%4063, %4061), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4065 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4066 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4049, %4065), scope=aten::mul.492, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4067 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4066, %4054, %4028), scope=aten::add.494, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4068 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4067), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4069 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4070 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4071 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4070), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4072 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4071), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4073 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4072), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4074 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4073), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4075 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4074), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4076 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4075), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4077 = bf16[28,128,29]{2,1,0} aten::view(%4076), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4078 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4079 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4080 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4081 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4082 = bf16[3584,3584]{0,1} aten::permute(%4081), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4083 = bf16[29,3584]{1,0} aten::view(%4010), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4084 = bf16[29,3584]{1,0} aten::mm(%4083, %4082), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4085 = bf16[1,29,3584]{2,1,0} aten::view(%4084), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4086 = bf16[1,29,3584]{2,1,0} aten::add(%4085, %4080, %4079), scope=aten::add.486, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4087 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4086), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4088 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4087), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4089 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4088), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4090 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4088), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4091 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4090), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4092 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4091, %4089), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4093 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4092, %4039), scope=aten::mul.490, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4094 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4088, %4065), scope=aten::mul.489, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4095 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4094, %4093, %4078), scope=aten::add.491, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4096 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4095), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4097 = bf16[28,29,128]{2,1,0} aten::view(%4096), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4098 = bf16[28,29,29]{2,1,0} aten::matmul(%4097, %4077), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4099 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4098), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4100 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4099, %4027), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4101 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4100, %617, %4026), scope=aten::add.495, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4102 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4101), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4103 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4102), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4104 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4103), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4105 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4104), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4106 = bf16[28,29,29]{2,1,0} aten::view(%4105), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4107 = bf16[28,29,128]{2,1,0} aten::matmul(%4106, %4025), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4108 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4107), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4109 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4108), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4110 = bf16[1,29,3584]{2,1,0} aten::view(%4109), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4111 = bf16[29,3584]{1,0} aten::view(%4110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4112 = bf16[29,3584]{1,0} aten::mm(%4111, %77), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4113 = bf16[1,29,3584]{2,1,0} aten::view(%4112), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4114 = bf16[1,29,3584]{2,1,0} aten::add(%4001, %4113, %75), scope=aten::add.496, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4115 = f32[1,29,3584]{2,1,0} xla::cast(%4114), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4116 = f32[1,29,3584]{2,1,0} aten::pow(%4115, %74), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4117 = f32[1,29,1]{2,1,0} aten::mean(%4116), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4118 = f32[1,29,1]{2,1,0} aten::add(%4117, %73, %72), scope=aten::add.497, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4119 = f32[1,29,1]{2,1,0} aten::rsqrt(%4118), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4120 = f32[1,29,3584]{2,1,0} aten::mul(%4115, %4119), scope=aten::mul.498, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4121 = bf16[1,29,3584]{2,1,0} xla::cast(%4120), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4122 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4123 = bf16[1,29,3584]{2,1,0} aten::mul(%4122, %4121), scope=aten::mul.499, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4124 = bf16[29,3584]{1,0} aten::view(%4123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4125 = bf16[29,18944]{1,0} aten::mm(%4124, %71), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4126 = bf16[1,29,18944]{2,1,0} aten::view(%4125), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4127 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4128 = bf16[3584,18944]{0,1} aten::permute(%4127), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4129 = bf16[29,3584]{1,0} aten::view(%4123), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4130 = bf16[29,18944]{1,0} aten::mm(%4129, %4128), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4131 = bf16[1,29,18944]{2,1,0} aten::view(%4130), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4132 = bf16[1,29,18944]{2,1,0} aten::silu(%4131), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4133 = bf16[1,29,18944]{2,1,0} aten::mul(%4132, %4126), scope=aten::mul.500, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4134 = bf16[29,18944]{1,0} aten::view(%4133), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4135 = bf16[29,3584]{1,0} aten::mm(%4134, %69), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4136 = bf16[1,29,3584]{2,1,0} aten::view(%4135), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4137 = bf16[1,29,3584]{2,1,0} aten::add(%4114, %4136, %67), scope=aten::add.501, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4138 = f32[1,29,3584]{2,1,0} xla::cast(%4137), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4139 = f32[1,29,3584]{2,1,0} aten::pow(%4138, %66), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4140 = f32[1,29,1]{2,1,0} aten::mean(%4139), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4141 = f32[1,29,1]{2,1,0} aten::add(%4140, %65, %64), scope=aten::add.502, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4142 = f32[1,29,1]{2,1,0} aten::rsqrt(%4141), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4143 = f32[1,29,3584]{2,1,0} aten::mul(%4138, %4142), scope=aten::mul.503, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4144 = bf16[1,29,3584]{2,1,0} xla::cast(%4143), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4145 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4146 = bf16[1,29,3584]{2,1,0} aten::mul(%4145, %4144), scope=aten::mul.504, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4147 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4148 = bf16[29,512]{1,0} aten::mm(%4147, %63), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4149 = bf16[1,29,512]{2,1,0} aten::view(%4148), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4150 = bf16[1,29,512]{2,1,0} aten::add(%4149, %61, %60), scope=aten::add.507, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4151 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4150), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4152 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4151), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4153 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4152), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4154 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4153), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4155 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4154), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4156 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4155), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4157 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4156), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4158 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4157), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4159 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4158), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4160 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4159), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4161 = bf16[28,29,128]{2,1,0} aten::view(%4160), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4162 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4163 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4164 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4165 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4166 = s64[1,29]{1,0} aten::expand(%4165), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4167 = s64[1,29]{1,0} aten::add(%628, %4166), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4168 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4169 = pred[1,29]{1,0} aten::lt(%628, %4168), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4170 = s64[1,29]{1,0} aten::where(%4169, %4167, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4171 = s64[1,29,1]{2,1,0} aten::stack(%4170), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4172 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4173 = bf16[29,128]{1,0} xla::select(%4172), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4174 = bf16[1,29,128]{2,1,0} aten::index(%4173, %4171), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4175 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4176 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4177 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4178 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4179 = bf16[3584,512]{0,1} aten::permute(%4178), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4180 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4181 = bf16[29,512]{1,0} aten::mm(%4180, %4179), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4182 = bf16[1,29,512]{2,1,0} aten::view(%4181), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4183 = bf16[1,29,512]{2,1,0} aten::add(%4182, %4177, %4176), scope=aten::add.506, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4184 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4183), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4185 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4184), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4186 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4185), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4187 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4185), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4188 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4187), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4189 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4188, %4186), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4190 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4189, %4175), scope=aten::mul.512, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4191 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4192 = s64[1,29]{1,0} aten::expand(%4191), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4193 = s64[1,29]{1,0} aten::add(%628, %4192), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4194 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4195 = pred[1,29]{1,0} aten::lt(%628, %4194), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4196 = s64[1,29]{1,0} aten::where(%4195, %4193, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4197 = s64[1,29,1]{2,1,0} aten::stack(%4196), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4198 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4199 = bf16[29,128]{1,0} xla::select(%4198), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4200 = bf16[1,29,128]{2,1,0} aten::index(%4199, %4197), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4201 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4202 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4185, %4201), scope=aten::mul.511, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4203 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4202, %4190, %4164), scope=aten::add.513, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4204 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4203), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4205 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4206 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4207 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4206), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4208 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4207), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4209 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4208), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4210 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4209), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4211 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4210), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4212 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4211), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4213 = bf16[28,128,29]{2,1,0} aten::view(%4212), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4214 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4215 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4216 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4217 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4218 = bf16[3584,3584]{0,1} aten::permute(%4217), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4219 = bf16[29,3584]{1,0} aten::view(%4146), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4220 = bf16[29,3584]{1,0} aten::mm(%4219, %4218), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4221 = bf16[1,29,3584]{2,1,0} aten::view(%4220), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4222 = bf16[1,29,3584]{2,1,0} aten::add(%4221, %4216, %4215), scope=aten::add.505, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4223 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4222), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4224 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4223), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4225 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4224), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4226 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4224), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4227 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4226), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4228 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4227, %4225), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4229 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4228, %4175), scope=aten::mul.509, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4230 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4224, %4201), scope=aten::mul.508, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4231 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4230, %4229, %4214), scope=aten::add.510, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4232 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4231), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4233 = bf16[28,29,128]{2,1,0} aten::view(%4232), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4234 = bf16[28,29,29]{2,1,0} aten::matmul(%4233, %4213), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4235 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4234), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4236 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4235, %4163), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4237 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4236, %617, %4162), scope=aten::add.514, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4238 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4237), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4239 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4238), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4240 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4239), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4241 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4240), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4242 = bf16[28,29,29]{2,1,0} aten::view(%4241), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4243 = bf16[28,29,128]{2,1,0} aten::matmul(%4242, %4161), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4244 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4243), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4245 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4244), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4246 = bf16[1,29,3584]{2,1,0} aten::view(%4245), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4247 = bf16[29,3584]{1,0} aten::view(%4246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4248 = bf16[29,3584]{1,0} aten::mm(%4247, %59), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4249 = bf16[1,29,3584]{2,1,0} aten::view(%4248), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4250 = bf16[1,29,3584]{2,1,0} aten::add(%4137, %4249, %57), scope=aten::add.515, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4251 = f32[1,29,3584]{2,1,0} xla::cast(%4250), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4252 = f32[1,29,3584]{2,1,0} aten::pow(%4251, %56), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4253 = f32[1,29,1]{2,1,0} aten::mean(%4252), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4254 = f32[1,29,1]{2,1,0} aten::add(%4253, %55, %54), scope=aten::add.516, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4255 = f32[1,29,1]{2,1,0} aten::rsqrt(%4254), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4256 = f32[1,29,3584]{2,1,0} aten::mul(%4251, %4255), scope=aten::mul.517, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4257 = bf16[1,29,3584]{2,1,0} xla::cast(%4256), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4258 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4259 = bf16[1,29,3584]{2,1,0} aten::mul(%4258, %4257), scope=aten::mul.518, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4260 = bf16[29,3584]{1,0} aten::view(%4259), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4261 = bf16[29,18944]{1,0} aten::mm(%4260, %53), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4262 = bf16[1,29,18944]{2,1,0} aten::view(%4261), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4263 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4264 = bf16[3584,18944]{0,1} aten::permute(%4263), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4265 = bf16[29,3584]{1,0} aten::view(%4259), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4266 = bf16[29,18944]{1,0} aten::mm(%4265, %4264), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4267 = bf16[1,29,18944]{2,1,0} aten::view(%4266), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4268 = bf16[1,29,18944]{2,1,0} aten::silu(%4267), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4269 = bf16[1,29,18944]{2,1,0} aten::mul(%4268, %4262), scope=aten::mul.519, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4270 = bf16[29,18944]{1,0} aten::view(%4269), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4271 = bf16[29,3584]{1,0} aten::mm(%4270, %51), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4272 = bf16[1,29,3584]{2,1,0} aten::view(%4271), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4273 = bf16[1,29,3584]{2,1,0} aten::add(%4250, %4272, %49), scope=aten::add.520, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4274 = f32[1,29,3584]{2,1,0} xla::cast(%4273), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4275 = f32[1,29,3584]{2,1,0} aten::pow(%4274, %48), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4276 = f32[1,29,1]{2,1,0} aten::mean(%4275), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4277 = f32[1,29,1]{2,1,0} aten::add(%4276, %47, %46), scope=aten::add.521, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4278 = f32[1,29,1]{2,1,0} aten::rsqrt(%4277), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4279 = f32[1,29,3584]{2,1,0} aten::mul(%4274, %4278), scope=aten::mul.522, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4280 = bf16[1,29,3584]{2,1,0} xla::cast(%4279), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4281 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4282 = bf16[1,29,3584]{2,1,0} aten::mul(%4281, %4280), scope=aten::mul.523, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4283 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4284 = bf16[29,512]{1,0} aten::mm(%4283, %45), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4285 = bf16[1,29,512]{2,1,0} aten::view(%4284), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4286 = bf16[1,29,512]{2,1,0} aten::add(%4285, %43, %42), scope=aten::add.526, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4287 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4286), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4288 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4287), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4289 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4288), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4290 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4289), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4291 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4290), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4292 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4291), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4293 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4292), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4294 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4293), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4295 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4294), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4296 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4295), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4297 = bf16[28,29,128]{2,1,0} aten::view(%4296), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4298 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4299 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4300 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4301 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4302 = s64[1,29]{1,0} aten::expand(%4301), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4303 = s64[1,29]{1,0} aten::add(%628, %4302), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4304 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4305 = pred[1,29]{1,0} aten::lt(%628, %4304), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4306 = s64[1,29]{1,0} aten::where(%4305, %4303, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4307 = s64[1,29,1]{2,1,0} aten::stack(%4306), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4308 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4309 = bf16[29,128]{1,0} xla::select(%4308), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4310 = bf16[1,29,128]{2,1,0} aten::index(%4309, %4307), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4311 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4312 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4313 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4314 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4315 = bf16[3584,512]{0,1} aten::permute(%4314), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4316 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4317 = bf16[29,512]{1,0} aten::mm(%4316, %4315), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4318 = bf16[1,29,512]{2,1,0} aten::view(%4317), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4319 = bf16[1,29,512]{2,1,0} aten::add(%4318, %4313, %4312), scope=aten::add.525, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4320 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4319), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4321 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4320), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4322 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4321), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4323 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4321), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4324 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4323), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4325 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4324, %4322), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4326 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4325, %4311), scope=aten::mul.531, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4327 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4328 = s64[1,29]{1,0} aten::expand(%4327), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4329 = s64[1,29]{1,0} aten::add(%628, %4328), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4330 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4331 = pred[1,29]{1,0} aten::lt(%628, %4330), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4332 = s64[1,29]{1,0} aten::where(%4331, %4329, %628), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4333 = s64[1,29,1]{2,1,0} aten::stack(%4332), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4334 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4335 = bf16[29,128]{1,0} xla::select(%4334), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4336 = bf16[1,29,128]{2,1,0} aten::index(%4335, %4333), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4337 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4338 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4321, %4337), scope=aten::mul.530, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4339 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4338, %4326, %4300), scope=aten::add.532, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4340 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4339), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4341 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4342 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4343 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4342), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4344 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4343), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4345 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4344), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4346 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4345), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4347 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4346), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4348 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4347), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4349 = bf16[28,128,29]{2,1,0} aten::view(%4348), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4350 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4351 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4352 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4353 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4354 = bf16[3584,3584]{0,1} aten::permute(%4353), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4355 = bf16[29,3584]{1,0} aten::view(%4282), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4356 = bf16[29,3584]{1,0} aten::mm(%4355, %4354), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4357 = bf16[1,29,3584]{2,1,0} aten::view(%4356), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4358 = bf16[1,29,3584]{2,1,0} aten::add(%4357, %4352, %4351), scope=aten::add.524, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4359 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4358), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4360 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4359), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4361 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4360), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4362 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4360), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4363 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4362), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4364 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4363, %4361), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4365 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4364, %4311), scope=aten::mul.528, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4366 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4360, %4337), scope=aten::mul.527, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4367 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4366, %4365, %4350), scope=aten::add.529, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4368 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4367), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4369 = bf16[28,29,128]{2,1,0} aten::view(%4368), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4370 = bf16[28,29,29]{2,1,0} aten::matmul(%4369, %4349), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4371 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4370), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4372 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4371, %4299), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4373 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4372, %617, %4298), scope=aten::add.533, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4374 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4373), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4375 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4374), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4376 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4375), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4377 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4376), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4378 = bf16[28,29,29]{2,1,0} aten::view(%4377), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4379 = bf16[28,29,128]{2,1,0} aten::matmul(%4378, %4297), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4380 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4379), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4381 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4380), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4382 = bf16[1,29,3584]{2,1,0} aten::view(%4381), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4383 = bf16[29,3584]{1,0} aten::view(%4382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4384 = bf16[29,3584]{1,0} aten::mm(%4383, %41), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4385 = bf16[1,29,3584]{2,1,0} aten::view(%4384), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4386 = bf16[1,29,3584]{2,1,0} aten::add(%4273, %4385, %39), scope=aten::add.534, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4387 = f32[1,29,3584]{2,1,0} xla::cast(%4386), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4388 = f32[1,29,3584]{2,1,0} aten::pow(%4387, %38), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4389 = f32[1,29,1]{2,1,0} aten::mean(%4388), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4390 = f32[1,29,1]{2,1,0} aten::add(%4389, %37, %36), scope=aten::add.535, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4391 = f32[1,29,1]{2,1,0} aten::rsqrt(%4390), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4392 = f32[1,29,3584]{2,1,0} aten::mul(%4387, %4391), scope=aten::mul.536, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4393 = bf16[1,29,3584]{2,1,0} xla::cast(%4392), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4394 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4395 = bf16[1,29,3584]{2,1,0} aten::mul(%4394, %4393), scope=aten::mul.537, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4396 = bf16[29,3584]{1,0} aten::view(%4395), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4397 = bf16[29,18944]{1,0} aten::mm(%4396, %35), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4398 = bf16[1,29,18944]{2,1,0} aten::view(%4397), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4399 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4400 = bf16[3584,18944]{0,1} aten::permute(%4399), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4401 = bf16[29,3584]{1,0} aten::view(%4395), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4402 = bf16[29,18944]{1,0} aten::mm(%4401, %4400), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4403 = bf16[1,29,18944]{2,1,0} aten::view(%4402), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4404 = bf16[1,29,18944]{2,1,0} aten::silu(%4403), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4405 = bf16[1,29,18944]{2,1,0} aten::mul(%4404, %4398), scope=aten::mul.538, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4406 = bf16[29,18944]{1,0} aten::view(%4405), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4407 = bf16[29,3584]{1,0} aten::mm(%4406, %33), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4408 = bf16[1,29,3584]{2,1,0} aten::view(%4407), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4409 = bf16[1,29,3584]{2,1,0} aten::add(%4386, %4408, %31), scope=aten::add.539, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4410 = f32[1,29,3584]{2,1,0} xla::cast(%4409), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4411 = f32[1,29,3584]{2,1,0} aten::pow(%4410, %30), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4412 = f32[1,29,1]{2,1,0} aten::mean(%4411), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4413 = f32[1,29,1]{2,1,0} aten::add(%4412, %29, %28), scope=aten::add.540, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4414 = f32[1,29,1]{2,1,0} aten::rsqrt(%4413), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4415 = f32[1,29,3584]{2,1,0} aten::mul(%4410, %4414), scope=aten::mul.541, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4416 = bf16[1,29,3584]{2,1,0} xla::cast(%4415), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4417 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4418 = bf16[1,29,3584]{2,1,0} aten::mul(%4417, %4416), scope=aten::mul.542, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4419 = bf16[29,3584]{1,0} aten::view(%4418), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4420 = bf16[29,152064]{1,0} aten::mm(%4419, %27), location=forward@linear.py:117, xla_shape=bf16[29,152064]{1,0}
  %4421 = bf16[1,29,152064]{2,1,0} aten::view(%4420), location=forward@linear.py:117, xla_shape=bf16[1,29,152064]{2,1,0}
  %4422 = f32[1,29,152064]{2,1,0} xla::cast(%4421), location=forward@modeling_qwen2.py:1163, xla_shape=f32[1,29,152064]{2,1,0}
  %4423 = f32[1,29,152064]{2,1,0} xla::select(%4422), location=_sample@utils.py:2407, xla_shape=f32[1,29,152064]{2,1,0}
  %4424 = f32[1,1,152064]{2,1,0} xla::generic_slice(%4423), location=_sample@utils.py:2407, xla_shape=f32[1,1,152064]{2,1,0}
  %4425 = f32[1,152064]{1,0} aten::view(%4424), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4426 = f32[1,152064]{1,0} xla::select(%4425), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4427 = f32[1,29]{1,0} aten::gather(%4426, %25), location=__call__@logits_process.py:341, xla_shape=f32[1,29]{1,0}
  %4428 = f32[1,29]{1,0} aten::div(%4427, %21), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4429 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %4430 = f32[1,29]{1,0} aten::mul(%4427, %4429), scope=aten::mul.543, location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4431 = s64[] prim::Constant(), location=__call__@logits_process.py:344, xla_shape=s64[]
  %4432 = pred[1,29]{1,0} aten::lt(%4427, %4431), location=__call__@logits_process.py:344, xla_shape=pred[1,29]{1,0}
  %4433 = f32[1,29]{1,0} aten::where(%4432, %4430, %4428), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4434 = f32[1,152064]{1,0} aten::scatter(%4426, %25, %4433), location=__call__@logits_process.py:346, xla_shape=f32[1,152064]{1,0}
  %4435 = f32[1,152064]{1,0} aten::div(%4434, %20), location=__call__@logits_process.py:292, xla_shape=f32[1,152064]{1,0}
  %4436 = (f32[1,20]{1,0}, s64[1,20]{1,0}) aten::topk(%4435), num_outputs=2, location=__call__@logits_process.py:520, xla_shape=(f32[1,20]{1,0}, s64[1,20]{1,0})
  %4437 = f32[1,1]{1,0} xla::generic_slice(%4436.0), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4438 = f32[1]{0} aten::view(%4437), location=__call__@logits_process.py:520, xla_shape=f32[1]{0}
  %4439 = f32[1,1]{1,0} aten::view(%4438), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4440 = pred[1,152064]{1,0} aten::lt(%4435, %4439), location=__call__@logits_process.py:520, xla_shape=pred[1,152064]{1,0}
  %4441 = f32[1,152064]{1,0} aten::masked_fill(%4435, %4440, %19), location=__call__@logits_process.py:521, xla_shape=f32[1,152064]{1,0}
  %4442 = (f32[1,152064]{1,0}, s64[1,152064]{1,0}) aten::topk(%4441), num_outputs=2, location=__call__@logits_process.py:458, xla_shape=(f32[1,152064]{1,0}, s64[1,152064]{1,0})
  %4443 = f32[1,152064]{1,0} aten::softmax(%4442.0), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4444 = f32[1,152064]{1,0} aten::cumsum(%4443), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4445 = pred[1,152064]{1,0} aten::le(%4444, %18), location=__call__@logits_process.py:462, xla_shape=pred[1,152064]{1,0}
  %4446 = pred[1,152064]{1,0} xla::unselect(%4445, %17), location=__call__@logits_process.py:464, xla_shape=pred[1,152064]{1,0}
  %4447 = pred[1,152064]{1,0} aten::scatter(%4446, %4442.1, %4446), location=__call__@logits_process.py:467, xla_shape=pred[1,152064]{1,0}
  %4448 = f32[1,152064]{1,0} aten::masked_fill(%4441, %4447, %13), location=__call__@logits_process.py:468, xla_shape=f32[1,152064]{1,0}
  %4449 = f32[1,152064]{1,0} aten::softmax(%4448), location=softmax@functional.py:1888, xla_shape=f32[1,152064]{1,0}
  %4450 = s64[1,1]{1,0} aten::multinomial(%4449, %12), location=_sample@utils.py:2437, xla_shape=s64[1,1]{1,0}
  %4451 = s64[1]{0} aten::view(%4450), location=_sample@utils.py:2437, xla_shape=s64[1]{0}
  %4452 = s64[1]{0} aten::mul(%4451, %4), scope=aten::mul.544, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4453 = s64[1]{0} aten::add(%4452, %7, %0), scope=aten::add.547, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4454 = s64[1]{0} xla::select(%4453), location=_sample@utils.py:2446, xla_shape=s64[1]{0}
  %4455 = s64[1,1]{1,0} aten::view(%4454), location=_sample@utils.py:2446, xla_shape=s64[1,1]{1,0}
  %4456 = s64[1,30]{1,0} aten::cat(%25, %4455), location=_sample@utils.py:2446, xla_shape=s64[1,30]{1,0}
  %4457 = s64[1,30]{1,0} xla::generic_slice(%4456), location=__iter__@_tensor.py:1053, xla_shape=s64[1,30]{1,0}
  %4458 = s64[30]{0} aten::view(%4457), location=__iter__@_tensor.py:1053, xla_shape=s64[30]{0}
  %4459 = s64[1]{0} xla::select(%4458), location=<listcomp>@2982293035.py:16, xla_shape=s64[1]{0}, ROOT=0
}

Graph Hash: 44794fa71dd24c3e5e5941df1438c87b

## END_GRAPH





---------------------------------------------------------------------------




























[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  _prepare_special_tokens (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1428)
  generate (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1565)
  decorate_context (/workspaces/hug/hug/lib/python3.10/site-packages/torch/utils/_contextlib.py:116)
  <module> (/tmp/ipykernel_1456554/2982293035.py:14)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (bbf9df5c1d27dd1092228df58f015d98)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_prepare_special_tokens@utils.py:1428, xla_shape=s64[]
  %1 = s64[2]{0} xla::device_data(), location=_tensor_or_none@utils.py:1396, xla_shape=s64[2]{0}
  %2 = pred[2]{0} aten::lt(%1, %0), location=_prepare_special_tokens@utils.py:1428, xla_shape=pred[2]{0}
  %3 = pred[] aten::any(%2), location=_prepare_special_tokens@utils.py:1428, xla_shape=pred[], ROOT=0
}

Graph Hash: ef9d710033ce30476429f94647442635

## END_GRAPH

[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  __call__ (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/stopping_criteria.py:534)
  __call__ (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/stopping_criteria.py:546)
  _sample (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:2455)
  generate (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1758)
  decorate_context (/workspaces/hug/hug/lib/python3.10/site-packages/torch/utils/_contextlib.py:116)
  <module> (/tmp/ipykernel_1456554/2982293035.py:14)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (1290a8ffea9a9ea7cea4c13195b00d13)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_sample@utils.py:2443, xla_shape=s64[]
  %1 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %2 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %3 = s64[] prim::Constant(), location=_sample@utils.py:2389, xla_shape=s64[]
  %4 = s64[1]{0} aten::expand(%3), location=_sample@utils.py:2389, xla_shape=s64[1]{0}
  %5 = s64[1]{0} aten::rsub(%4, %2, %1), scope=aten::rsub.1093, location=__rsub__@_tensor.py:962, xla_shape=s64[1]{0}
  %6 = s64[] xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[]
  %7 = s64[1]{0} aten::mul(%6, %5), scope=aten::mul.1094, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %8 = s64[] xla::device_data(), location=_sample@utils.py:2437, xla_shape=s64[]
  %9 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %10 = s64[] aten::mul(%9, %8), location=_sample@utils.py:2437, xla_shape=s64[]
  %11 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %12 = s64[] aten::add(%11, %10), location=_sample@utils.py:2437, xla_shape=s64[]
  %13 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %14 = s64[] aten::mul(%13, %12), location=_sample@utils.py:2437, xla_shape=s64[]
  %15 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %16 = s64[] aten::add(%15, %14), location=_sample@utils.py:2437, xla_shape=s64[]
  %17 = f64[] xla::device_data(), location=__call__@logits_process.py:468, xla_shape=f64[]
  %18 = pred[] prim::Constant(), location=__call__@logits_process.py:464, xla_shape=pred[]
  %19 = pred[] aten::expand(%18), location=__call__@logits_process.py:464, xla_shape=pred[]
  %20 = pred[] aten::view(%19), location=__call__@logits_process.py:464, xla_shape=pred[]
  %21 = pred[1,1]{1,0} aten::expand(%20), location=__call__@logits_process.py:464, xla_shape=pred[1,1]{1,0}
  %22 = f64[] xla::device_data(), location=__call__@logits_process.py:462, xla_shape=f64[]
  %23 = f64[] xla::device_data(), location=__call__@logits_process.py:521, xla_shape=f64[]
  %24 = f32[] xla::device_data(), location=__call__@logits_process.py:292, xla_shape=f32[]
  %25 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %26 = s64[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %27 = s64[1,1,29]{2,1,0} aten::view(%26), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %28 = s64[1,1,29]{2,1,0} aten::expand(%27), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %29 = s64[1,29]{1,0} aten::view(%28), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,29]{1,0}
  %30 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %31 = bf16[3584,152064]{0,1} aten::permute(%30), location=forward@linear.py:117, xla_shape=bf16[3584,152064]{0,1}
  %32 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %33 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %34 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %35 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %36 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %37 = bf16[18944,3584]{0,1} aten::permute(%36), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %38 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %39 = bf16[3584,18944]{0,1} aten::permute(%38), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %40 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %41 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %42 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %43 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %44 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %45 = bf16[3584,3584]{0,1} aten::permute(%44), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %46 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %47 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %48 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %49 = bf16[3584,512]{0,1} aten::permute(%48), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %50 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %51 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %52 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %53 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %54 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %55 = bf16[18944,3584]{0,1} aten::permute(%54), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %56 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %57 = bf16[3584,18944]{0,1} aten::permute(%56), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %58 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %59 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %60 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %61 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %62 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %63 = bf16[3584,3584]{0,1} aten::permute(%62), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %64 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %65 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %66 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %67 = bf16[3584,512]{0,1} aten::permute(%66), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %68 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %69 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %70 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %71 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %72 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %73 = bf16[18944,3584]{0,1} aten::permute(%72), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %74 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %75 = bf16[3584,18944]{0,1} aten::permute(%74), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %76 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %77 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %78 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %79 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %80 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %81 = bf16[3584,3584]{0,1} aten::permute(%80), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %82 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %83 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %84 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %85 = bf16[3584,512]{0,1} aten::permute(%84), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %86 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %87 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %88 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %89 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %90 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %91 = bf16[18944,3584]{0,1} aten::permute(%90), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %92 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %93 = bf16[3584,18944]{0,1} aten::permute(%92), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %94 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %95 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %96 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %97 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %98 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %99 = bf16[3584,3584]{0,1} aten::permute(%98), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %100 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %101 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %102 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %103 = bf16[3584,512]{0,1} aten::permute(%102), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %104 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %105 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %106 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %107 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %108 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %109 = bf16[18944,3584]{0,1} aten::permute(%108), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %110 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %111 = bf16[3584,18944]{0,1} aten::permute(%110), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %112 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %113 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %114 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %115 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %116 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %117 = bf16[3584,3584]{0,1} aten::permute(%116), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %118 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %119 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %120 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %121 = bf16[3584,512]{0,1} aten::permute(%120), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %122 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %123 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %124 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %125 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %126 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %127 = bf16[18944,3584]{0,1} aten::permute(%126), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %128 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %129 = bf16[3584,18944]{0,1} aten::permute(%128), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %130 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %131 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %132 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %133 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %134 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %135 = bf16[3584,3584]{0,1} aten::permute(%134), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %136 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %137 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %138 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %139 = bf16[3584,512]{0,1} aten::permute(%138), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %140 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %141 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %142 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %143 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %144 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %145 = bf16[18944,3584]{0,1} aten::permute(%144), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %146 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %147 = bf16[3584,18944]{0,1} aten::permute(%146), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %148 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %149 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %150 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %151 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %152 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %153 = bf16[3584,3584]{0,1} aten::permute(%152), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %154 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %155 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %156 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %157 = bf16[3584,512]{0,1} aten::permute(%156), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %158 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %159 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %160 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %161 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %162 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %163 = bf16[18944,3584]{0,1} aten::permute(%162), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %164 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %165 = bf16[3584,18944]{0,1} aten::permute(%164), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %166 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %167 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %168 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %169 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %170 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %171 = bf16[3584,3584]{0,1} aten::permute(%170), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %172 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %173 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %174 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %175 = bf16[3584,512]{0,1} aten::permute(%174), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %176 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %177 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %178 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %179 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %180 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %181 = bf16[18944,3584]{0,1} aten::permute(%180), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %182 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %183 = bf16[3584,18944]{0,1} aten::permute(%182), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %184 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %185 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %186 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %187 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %188 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %189 = bf16[3584,3584]{0,1} aten::permute(%188), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %190 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %191 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %192 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %193 = bf16[3584,512]{0,1} aten::permute(%192), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %194 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %195 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %196 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %197 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %198 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %199 = bf16[18944,3584]{0,1} aten::permute(%198), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %200 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %201 = bf16[3584,18944]{0,1} aten::permute(%200), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %202 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %203 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %204 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %205 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %206 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %207 = bf16[3584,3584]{0,1} aten::permute(%206), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %208 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %209 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %210 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %211 = bf16[3584,512]{0,1} aten::permute(%210), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %212 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %213 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %214 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %215 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %216 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %217 = bf16[18944,3584]{0,1} aten::permute(%216), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %218 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %219 = bf16[3584,18944]{0,1} aten::permute(%218), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %220 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %221 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %222 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %223 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %224 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %225 = bf16[3584,3584]{0,1} aten::permute(%224), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %226 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %227 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %228 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %229 = bf16[3584,512]{0,1} aten::permute(%228), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %230 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %231 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %232 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %233 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %234 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %235 = bf16[18944,3584]{0,1} aten::permute(%234), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %236 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %237 = bf16[3584,18944]{0,1} aten::permute(%236), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %238 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %239 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %240 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %241 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %242 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %243 = bf16[3584,3584]{0,1} aten::permute(%242), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %244 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %245 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %246 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %247 = bf16[3584,512]{0,1} aten::permute(%246), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %248 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %249 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %250 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %251 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %252 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %253 = bf16[18944,3584]{0,1} aten::permute(%252), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %254 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %255 = bf16[3584,18944]{0,1} aten::permute(%254), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %256 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %257 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %258 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %259 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %260 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %261 = bf16[3584,3584]{0,1} aten::permute(%260), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %262 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %263 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %264 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %265 = bf16[3584,512]{0,1} aten::permute(%264), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %266 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %267 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %268 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %269 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %270 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %271 = bf16[18944,3584]{0,1} aten::permute(%270), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %272 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %273 = bf16[3584,18944]{0,1} aten::permute(%272), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %274 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %275 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %276 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %277 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %278 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %279 = bf16[3584,3584]{0,1} aten::permute(%278), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %280 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %281 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %282 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %283 = bf16[3584,512]{0,1} aten::permute(%282), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %284 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %285 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %286 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %287 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %288 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %289 = bf16[18944,3584]{0,1} aten::permute(%288), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %290 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %291 = bf16[3584,18944]{0,1} aten::permute(%290), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %292 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %293 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %294 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %295 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %296 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %297 = bf16[3584,3584]{0,1} aten::permute(%296), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %298 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %299 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %300 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %301 = bf16[3584,512]{0,1} aten::permute(%300), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %302 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %303 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %304 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %305 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %306 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %307 = bf16[18944,3584]{0,1} aten::permute(%306), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %308 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %309 = bf16[3584,18944]{0,1} aten::permute(%308), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %310 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %311 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %312 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %313 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %314 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %315 = bf16[3584,3584]{0,1} aten::permute(%314), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %316 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %317 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %318 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %319 = bf16[3584,512]{0,1} aten::permute(%318), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %320 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %321 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %322 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %323 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %324 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %325 = bf16[18944,3584]{0,1} aten::permute(%324), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %326 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %327 = bf16[3584,18944]{0,1} aten::permute(%326), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %328 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %329 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %330 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %331 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %332 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %333 = bf16[3584,3584]{0,1} aten::permute(%332), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %334 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %335 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %336 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %337 = bf16[3584,512]{0,1} aten::permute(%336), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %338 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %339 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %340 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %341 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %342 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %343 = bf16[18944,3584]{0,1} aten::permute(%342), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %344 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %345 = bf16[3584,18944]{0,1} aten::permute(%344), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %346 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %347 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %348 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %349 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %350 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %351 = bf16[3584,3584]{0,1} aten::permute(%350), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %352 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %353 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %354 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %355 = bf16[3584,512]{0,1} aten::permute(%354), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %356 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %357 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %358 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %359 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %360 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %361 = bf16[18944,3584]{0,1} aten::permute(%360), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %362 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %363 = bf16[3584,18944]{0,1} aten::permute(%362), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %364 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %365 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %366 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %367 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %368 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %369 = bf16[3584,3584]{0,1} aten::permute(%368), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %370 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %371 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %372 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %373 = bf16[3584,512]{0,1} aten::permute(%372), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %374 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %375 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %376 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %377 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %378 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %379 = bf16[18944,3584]{0,1} aten::permute(%378), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %380 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %381 = bf16[3584,18944]{0,1} aten::permute(%380), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %382 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %383 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %384 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %385 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %386 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %387 = bf16[3584,3584]{0,1} aten::permute(%386), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %388 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %389 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %390 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %391 = bf16[3584,512]{0,1} aten::permute(%390), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %392 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %393 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %394 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %395 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %396 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %397 = bf16[18944,3584]{0,1} aten::permute(%396), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %398 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %399 = bf16[3584,18944]{0,1} aten::permute(%398), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %400 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %401 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %402 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %403 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %404 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %405 = bf16[3584,3584]{0,1} aten::permute(%404), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %406 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %407 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %408 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %409 = bf16[3584,512]{0,1} aten::permute(%408), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %410 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %411 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %412 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %413 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %414 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %415 = bf16[18944,3584]{0,1} aten::permute(%414), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %416 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %417 = bf16[3584,18944]{0,1} aten::permute(%416), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %418 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %419 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %420 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %421 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %422 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %423 = bf16[3584,3584]{0,1} aten::permute(%422), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %424 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %425 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %426 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %427 = bf16[3584,512]{0,1} aten::permute(%426), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %428 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %429 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %430 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %431 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %432 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %433 = bf16[18944,3584]{0,1} aten::permute(%432), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %434 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %435 = bf16[3584,18944]{0,1} aten::permute(%434), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %436 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %437 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %438 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %439 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %440 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %441 = bf16[3584,3584]{0,1} aten::permute(%440), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %442 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %443 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %444 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %445 = bf16[3584,512]{0,1} aten::permute(%444), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %446 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %447 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %448 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %449 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %450 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %451 = bf16[18944,3584]{0,1} aten::permute(%450), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %452 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %453 = bf16[3584,18944]{0,1} aten::permute(%452), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %454 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %455 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %456 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %457 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %458 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %459 = bf16[3584,3584]{0,1} aten::permute(%458), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %460 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %461 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %462 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %463 = bf16[3584,512]{0,1} aten::permute(%462), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %464 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %465 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %466 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %467 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %468 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %469 = bf16[18944,3584]{0,1} aten::permute(%468), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %470 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %471 = bf16[3584,18944]{0,1} aten::permute(%470), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %472 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %473 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %474 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %475 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %476 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %477 = bf16[3584,3584]{0,1} aten::permute(%476), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %478 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %479 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %480 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %481 = bf16[3584,512]{0,1} aten::permute(%480), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %482 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %483 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %484 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %485 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %486 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %487 = bf16[18944,3584]{0,1} aten::permute(%486), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %488 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %489 = bf16[3584,18944]{0,1} aten::permute(%488), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %490 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %491 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %492 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %493 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %494 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %495 = bf16[3584,3584]{0,1} aten::permute(%494), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %496 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %497 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %498 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %499 = bf16[3584,512]{0,1} aten::permute(%498), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %500 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %501 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %502 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %503 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %504 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %505 = bf16[18944,3584]{0,1} aten::permute(%504), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %506 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %507 = bf16[3584,18944]{0,1} aten::permute(%506), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %508 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %509 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %510 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %511 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %512 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %513 = bf16[3584,3584]{0,1} aten::permute(%512), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %514 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %515 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %516 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %517 = bf16[3584,512]{0,1} aten::permute(%516), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %518 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %519 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %520 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %521 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %522 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %523 = bf16[18944,3584]{0,1} aten::permute(%522), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %524 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %525 = bf16[3584,18944]{0,1} aten::permute(%524), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %526 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %527 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %528 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %529 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %530 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %531 = bf16[3584,3584]{0,1} aten::permute(%530), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %532 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %533 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %534 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %535 = bf16[3584,512]{0,1} aten::permute(%534), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %536 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %537 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %538 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %539 = s64[29]{0} aten::view(%29), location=embedding@functional.py:2267, xla_shape=s64[29]{0}
  %540 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %541 = bf16[29,3584]{1,0} aten::index_select(%540, %539), location=embedding@functional.py:2267, xla_shape=bf16[29,3584]{1,0}
  %542 = bf16[1,29,3584]{2,1,0} aten::view(%541), location=embedding@functional.py:2267, xla_shape=bf16[1,29,3584]{2,1,0}
  %543 = f32[1,29,3584]{2,1,0} xla::cast(%542), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %544 = f32[1,29,3584]{2,1,0} aten::pow(%543, %538), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %545 = f32[1,29,1]{2,1,0} aten::mean(%544), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %546 = f32[1,29,1]{2,1,0} aten::add(%545, %537, %536), scope=aten::add.556, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %547 = f32[1,29,1]{2,1,0} aten::rsqrt(%546), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %548 = f32[1,29,3584]{2,1,0} aten::mul(%543, %547), scope=aten::mul.557, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %549 = bf16[1,29,3584]{2,1,0} xla::cast(%548), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %550 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %551 = bf16[1,29,3584]{2,1,0} aten::mul(%550, %549), scope=aten::mul.558, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %552 = bf16[29,3584]{1,0} aten::view(%551), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %553 = bf16[29,512]{1,0} aten::mm(%552, %535), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %554 = bf16[1,29,512]{2,1,0} aten::view(%553), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %555 = bf16[1,29,512]{2,1,0} aten::add(%554, %533, %532), scope=aten::add.561, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %556 = bf16[1,29,4,128]{3,2,1,0} aten::view(%555), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %557 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%556), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %558 = bf16[1,4,29,128]{3,1,2,0} xla::select(%557), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %559 = bf16[1,4,29,128]{3,1,2,0} xla::select(%558), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %560 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%559), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %561 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%560), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %562 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%561), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %563 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%562), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %564 = bf16[1,28,29,128]{3,2,1,0} aten::view(%563), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %565 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%564), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %566 = bf16[28,29,128]{2,1,0} aten::view(%565), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %567 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %568 = f64[] xla::device_data(), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=f64[]
  %569 = f64[] xla::device_data(), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=f64[]
  %570 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %571 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %572 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[]
  %573 = pred[2]{0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[2]{0}
  %574 = pred[] aten::any(%573), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[]
  %575 = pred[] aten::bitwise_not(%574), location=_prepare_attention_mask_for_generation@utils.py:475, xla_shape=pred[]
  %576 = pred[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[1,29]{1,0}
  %577 = pred[] aten::any(%576), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[]
  %578 = pred[] aten::mul(%577, %575), scope=aten::mul.549, location=_prepare_attention_mask_for_generation@utils.py:478, xla_shape=pred[]
  %579 = pred[] aten::bitwise_not(%578), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=pred[]
  %580 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[]
  %581 = s64[1,29]{1,0} aten::expand(%580), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[1,29]{1,0}
  %582 = s64[1,29]{1,0} aten::mul(%581, %579), scope=aten::mul.551, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %583 = pred[1,29]{1,0} aten::ne(%26, %6), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=pred[1,29]{1,0}
  %584 = s64[1,29]{1,0} xla::cast(%583), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %585 = s64[1,29]{1,0} aten::mul(%584, %578), scope=aten::mul.550, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %586 = s64[1,29]{1,0} aten::add(%585, %582, %572), scope=aten::add.552, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %587 = s64[1,1,29]{2,1,0} aten::view(%586), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %588 = s64[1,1,29]{2,1,0} aten::expand(%587), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %589 = s64[1,29]{1,0} aten::view(%588), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,29]{1,0}
  %590 = s64[1,29]{1,0} xla::select(%589), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,29]{1,0}
  %591 = s64[1,1,29]{2,1,0} aten::view(%590), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29]{2,1,0}
  %592 = s64[1,1,1,29]{3,2,1,0} aten::view(%591), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %593 = s64[1,1,1,29]{3,2,1,0} xla::select(%592), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %594 = s64[1,1,29,29]{3,2,1,0} aten::expand(%593), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29,29]{3,2,1,0}
  %595 = bf16[1,1,29,29]{3,2,1,0} xla::cast(%594), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %596 = bf16[1,1,29,29]{3,2,1,0} aten::rsub(%595, %571, %570), scope=aten::rsub.555, location=__rsub__@_tensor.py:962, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %597 = pred[1,1,29,29]{3,2,1,0} xla::cast(%596), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %598 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%596, %597, %569), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %599 = pred[1,1,29,29]{3,2,1,0} xla::cast(%598), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %600 = f64[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=f64[]
  %601 = pred[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[]
  %602 = pred[29,29]{1,0} aten::expand(%601), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %603 = pred[29,29]{1,0} aten::tril(%602), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %604 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %605 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %606 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %607 = s64[29]{0} prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:157, xla_shape=s64[29]{0}
  %608 = s64[29]{0} aten::add(%607, %606, %605), scope=aten::add.554, location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29]{0}
  %609 = s64[29,1]{1,0} aten::view(%608), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29,1]{1,0}
  %610 = pred[29,29]{1,0} aten::lt(%607, %609), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=pred[29,29]{1,0}
  %611 = f32[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[]
  %612 = f32[29,29]{1,0} aten::expand(%611), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[29,29]{1,0}
  %613 = f32[29,29]{1,0} aten::masked_fill(%612, %610, %604), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=f32[29,29]{1,0}
  %614 = bf16[29,29]{1,0} xla::cast(%613), location=_make_causal_mask@modeling_attn_mask_utils.py:160, xla_shape=bf16[29,29]{1,0}
  %615 = bf16[29,29]{1,0} aten::masked_fill(%614, %603, %600), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=bf16[29,29]{1,0}
  %616 = bf16[1,29,29]{2,1,0} aten::view(%615), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,29,29]{2,1,0}
  %617 = bf16[1,1,29,29]{3,2,1,0} aten::view(%616), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %618 = bf16[1,1,29,29]{3,2,1,0} xla::select(%617), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %619 = bf16[1,1,29,29]{3,2,1,0} xla::select(%618), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %620 = bf16[1,1,29,29]{3,2,1,0} aten::expand(%619), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %621 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%620, %599, %568), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %622 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %623 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %624 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %625 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %626 = pred[1,29]{1,0} aten::eq(%589, %625), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=pred[1,29]{1,0}
  %627 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %628 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %629 = s64[1,29]{1,0} aten::cumsum(%589), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %630 = s64[1,29]{1,0} aten::sub(%629, %628, %627), scope=aten::sub.553, location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %631 = s64[1,29]{1,0} aten::masked_fill(%630, %626, %624), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[1,29]{1,0}
  %632 = s64[1,29]{1,0} aten::view(%631), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %633 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %634 = s64[1,29]{1,0} aten::expand(%633), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %635 = s64[1,29]{1,0} aten::add(%632, %634), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %636 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %637 = pred[1,29]{1,0} aten::lt(%632, %636), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %638 = s64[1,29]{1,0} aten::where(%637, %635, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %639 = s64[1,29,1]{2,1,0} aten::stack(%638), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %640 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %641 = bf16[29,128]{1,0} xla::select(%640), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %642 = bf16[1,29,128]{2,1,0} aten::index(%641, %639), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %643 = bf16[1,1,29,128]{3,2,1,0} aten::view(%642), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %644 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %645 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %646 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %647 = bf16[3584,512]{0,1} aten::permute(%646), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %648 = bf16[29,3584]{1,0} aten::view(%551), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %649 = bf16[29,512]{1,0} aten::mm(%648, %647), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %650 = bf16[1,29,512]{2,1,0} aten::view(%649), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %651 = bf16[1,29,512]{2,1,0} aten::add(%650, %645, %644), scope=aten::add.560, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %652 = bf16[1,29,4,128]{3,2,1,0} aten::view(%651), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %653 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%652), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %654 = bf16[1,4,29,64]{3,1,2,0} xla::select(%653), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %655 = bf16[1,4,29,64]{3,1,2,0} xla::select(%653), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %656 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%655), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %657 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%656, %654), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %658 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%657, %643), scope=aten::mul.566, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %659 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %660 = s64[1,29]{1,0} aten::expand(%659), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %661 = s64[1,29]{1,0} aten::add(%632, %660), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %662 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %663 = pred[1,29]{1,0} aten::lt(%632, %662), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %664 = s64[1,29]{1,0} aten::where(%663, %661, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %665 = s64[1,29,1]{2,1,0} aten::stack(%664), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %666 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %667 = bf16[29,128]{1,0} xla::select(%666), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %668 = bf16[1,29,128]{2,1,0} aten::index(%667, %665), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %669 = bf16[1,1,29,128]{3,2,1,0} aten::view(%668), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %670 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%653, %669), scope=aten::mul.565, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %671 = bf16[1,4,29,128]{3,2,1,0} aten::add(%670, %658, %623), scope=aten::add.567, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %672 = bf16[1,4,29,128]{3,2,1,0} xla::select(%671), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %673 = bf16[1,4,29,128]{3,2,1,0} xla::select(%672), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %674 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%673), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %675 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%674), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %676 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%675), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %677 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%676), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %678 = bf16[1,28,29,128]{3,2,1,0} aten::view(%677), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %679 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%678), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %680 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%679), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %681 = bf16[28,128,29]{2,1,0} aten::view(%680), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %682 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %683 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %684 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %685 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %686 = bf16[3584,3584]{0,1} aten::permute(%685), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %687 = bf16[29,3584]{1,0} aten::view(%551), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %688 = bf16[29,3584]{1,0} aten::mm(%687, %686), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %689 = bf16[1,29,3584]{2,1,0} aten::view(%688), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %690 = bf16[1,29,3584]{2,1,0} aten::add(%689, %684, %683), scope=aten::add.559, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %691 = bf16[1,29,28,128]{3,2,1,0} aten::view(%690), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %692 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%691), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %693 = bf16[1,28,29,64]{3,1,2,0} xla::select(%692), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %694 = bf16[1,28,29,64]{3,1,2,0} xla::select(%692), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %695 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%694), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %696 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%695, %693), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %697 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%696, %643), scope=aten::mul.563, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %698 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%692, %669), scope=aten::mul.562, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %699 = bf16[1,28,29,128]{3,2,1,0} aten::add(%698, %697, %682), scope=aten::add.564, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %700 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%699), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %701 = bf16[28,29,128]{2,1,0} aten::view(%700), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %702 = bf16[28,29,29]{2,1,0} aten::matmul(%701, %681), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %703 = bf16[1,28,29,29]{3,2,1,0} aten::view(%702), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %704 = bf16[1,28,29,29]{3,2,1,0} aten::div(%703, %622), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %705 = bf16[1,28,29,29]{3,2,1,0} aten::add(%704, %621, %567), scope=aten::add.568, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %706 = f32[1,28,29,29]{3,2,1,0} xla::cast(%705), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %707 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%706), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %708 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%707), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %709 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%708), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %710 = bf16[28,29,29]{2,1,0} aten::view(%709), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %711 = bf16[28,29,128]{2,1,0} aten::matmul(%710, %566), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %712 = bf16[1,28,29,128]{3,2,1,0} aten::view(%711), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %713 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%712), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %714 = bf16[1,29,3584]{2,1,0} aten::view(%713), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %715 = bf16[29,3584]{1,0} aten::view(%714), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %716 = bf16[29,3584]{1,0} aten::mm(%715, %531), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %717 = bf16[1,29,3584]{2,1,0} aten::view(%716), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %718 = bf16[1,29,3584]{2,1,0} aten::add(%542, %717, %529), scope=aten::add.569, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %719 = f32[1,29,3584]{2,1,0} xla::cast(%718), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %720 = f32[1,29,3584]{2,1,0} aten::pow(%719, %528), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %721 = f32[1,29,1]{2,1,0} aten::mean(%720), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %722 = f32[1,29,1]{2,1,0} aten::add(%721, %527, %526), scope=aten::add.570, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %723 = f32[1,29,1]{2,1,0} aten::rsqrt(%722), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %724 = f32[1,29,3584]{2,1,0} aten::mul(%719, %723), scope=aten::mul.571, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %725 = bf16[1,29,3584]{2,1,0} xla::cast(%724), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %726 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %727 = bf16[1,29,3584]{2,1,0} aten::mul(%726, %725), scope=aten::mul.572, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %728 = bf16[29,3584]{1,0} aten::view(%727), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %729 = bf16[29,18944]{1,0} aten::mm(%728, %525), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %730 = bf16[1,29,18944]{2,1,0} aten::view(%729), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %731 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %732 = bf16[3584,18944]{0,1} aten::permute(%731), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %733 = bf16[29,3584]{1,0} aten::view(%727), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %734 = bf16[29,18944]{1,0} aten::mm(%733, %732), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %735 = bf16[1,29,18944]{2,1,0} aten::view(%734), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %736 = bf16[1,29,18944]{2,1,0} aten::silu(%735), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %737 = bf16[1,29,18944]{2,1,0} aten::mul(%736, %730), scope=aten::mul.573, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %738 = bf16[29,18944]{1,0} aten::view(%737), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %739 = bf16[29,3584]{1,0} aten::mm(%738, %523), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %740 = bf16[1,29,3584]{2,1,0} aten::view(%739), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %741 = bf16[1,29,3584]{2,1,0} aten::add(%718, %740, %521), scope=aten::add.574, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %742 = f32[1,29,3584]{2,1,0} xla::cast(%741), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %743 = f32[1,29,3584]{2,1,0} aten::pow(%742, %520), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %744 = f32[1,29,1]{2,1,0} aten::mean(%743), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %745 = f32[1,29,1]{2,1,0} aten::add(%744, %519, %518), scope=aten::add.575, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %746 = f32[1,29,1]{2,1,0} aten::rsqrt(%745), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %747 = f32[1,29,3584]{2,1,0} aten::mul(%742, %746), scope=aten::mul.576, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %748 = bf16[1,29,3584]{2,1,0} xla::cast(%747), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %749 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %750 = bf16[1,29,3584]{2,1,0} aten::mul(%749, %748), scope=aten::mul.577, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %751 = bf16[29,3584]{1,0} aten::view(%750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %752 = bf16[29,512]{1,0} aten::mm(%751, %517), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %753 = bf16[1,29,512]{2,1,0} aten::view(%752), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %754 = bf16[1,29,512]{2,1,0} aten::add(%753, %515, %514), scope=aten::add.580, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %755 = bf16[1,29,4,128]{3,2,1,0} aten::view(%754), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %756 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%755), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %757 = bf16[1,4,29,128]{3,1,2,0} xla::select(%756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %758 = bf16[1,4,29,128]{3,1,2,0} xla::select(%757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %759 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%758), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %760 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%759), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %761 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%760), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %762 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%761), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %763 = bf16[1,28,29,128]{3,2,1,0} aten::view(%762), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %764 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%763), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %765 = bf16[28,29,128]{2,1,0} aten::view(%764), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %766 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %767 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %768 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %769 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %770 = s64[1,29]{1,0} aten::expand(%769), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %771 = s64[1,29]{1,0} aten::add(%632, %770), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %772 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %773 = pred[1,29]{1,0} aten::lt(%632, %772), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %774 = s64[1,29]{1,0} aten::where(%773, %771, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %775 = s64[1,29,1]{2,1,0} aten::stack(%774), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %776 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %777 = bf16[29,128]{1,0} xla::select(%776), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %778 = bf16[1,29,128]{2,1,0} aten::index(%777, %775), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %779 = bf16[1,1,29,128]{3,2,1,0} aten::view(%778), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %780 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %781 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %782 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %783 = bf16[3584,512]{0,1} aten::permute(%782), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %784 = bf16[29,3584]{1,0} aten::view(%750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %785 = bf16[29,512]{1,0} aten::mm(%784, %783), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %786 = bf16[1,29,512]{2,1,0} aten::view(%785), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %787 = bf16[1,29,512]{2,1,0} aten::add(%786, %781, %780), scope=aten::add.579, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %788 = bf16[1,29,4,128]{3,2,1,0} aten::view(%787), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %789 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%788), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %790 = bf16[1,4,29,64]{3,1,2,0} xla::select(%789), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %791 = bf16[1,4,29,64]{3,1,2,0} xla::select(%789), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %792 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%791), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %793 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%792, %790), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %794 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%793, %779), scope=aten::mul.585, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %795 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %796 = s64[1,29]{1,0} aten::expand(%795), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %797 = s64[1,29]{1,0} aten::add(%632, %796), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %798 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %799 = pred[1,29]{1,0} aten::lt(%632, %798), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %800 = s64[1,29]{1,0} aten::where(%799, %797, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %801 = s64[1,29,1]{2,1,0} aten::stack(%800), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %802 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %803 = bf16[29,128]{1,0} xla::select(%802), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %804 = bf16[1,29,128]{2,1,0} aten::index(%803, %801), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %805 = bf16[1,1,29,128]{3,2,1,0} aten::view(%804), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %806 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%789, %805), scope=aten::mul.584, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %807 = bf16[1,4,29,128]{3,2,1,0} aten::add(%806, %794, %768), scope=aten::add.586, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %808 = bf16[1,4,29,128]{3,2,1,0} xla::select(%807), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %809 = bf16[1,4,29,128]{3,2,1,0} xla::select(%808), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %810 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%809), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %811 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%810), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %812 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%811), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %813 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%812), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %814 = bf16[1,28,29,128]{3,2,1,0} aten::view(%813), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %815 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%814), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %816 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%815), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %817 = bf16[28,128,29]{2,1,0} aten::view(%816), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %818 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %819 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %820 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %821 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %822 = bf16[3584,3584]{0,1} aten::permute(%821), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %823 = bf16[29,3584]{1,0} aten::view(%750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %824 = bf16[29,3584]{1,0} aten::mm(%823, %822), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %825 = bf16[1,29,3584]{2,1,0} aten::view(%824), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %826 = bf16[1,29,3584]{2,1,0} aten::add(%825, %820, %819), scope=aten::add.578, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %827 = bf16[1,29,28,128]{3,2,1,0} aten::view(%826), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %828 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%827), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %829 = bf16[1,28,29,64]{3,1,2,0} xla::select(%828), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %830 = bf16[1,28,29,64]{3,1,2,0} xla::select(%828), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %831 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%830), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %832 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%831, %829), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %833 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%832, %779), scope=aten::mul.582, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %834 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%828, %805), scope=aten::mul.581, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %835 = bf16[1,28,29,128]{3,2,1,0} aten::add(%834, %833, %818), scope=aten::add.583, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %836 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%835), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %837 = bf16[28,29,128]{2,1,0} aten::view(%836), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %838 = bf16[28,29,29]{2,1,0} aten::matmul(%837, %817), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %839 = bf16[1,28,29,29]{3,2,1,0} aten::view(%838), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %840 = bf16[1,28,29,29]{3,2,1,0} aten::div(%839, %767), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %841 = bf16[1,28,29,29]{3,2,1,0} aten::add(%840, %621, %766), scope=aten::add.587, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %842 = f32[1,28,29,29]{3,2,1,0} xla::cast(%841), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %843 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%842), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %844 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%843), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %845 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%844), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %846 = bf16[28,29,29]{2,1,0} aten::view(%845), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %847 = bf16[28,29,128]{2,1,0} aten::matmul(%846, %765), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %848 = bf16[1,28,29,128]{3,2,1,0} aten::view(%847), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %849 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%848), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %850 = bf16[1,29,3584]{2,1,0} aten::view(%849), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %851 = bf16[29,3584]{1,0} aten::view(%850), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %852 = bf16[29,3584]{1,0} aten::mm(%851, %513), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %853 = bf16[1,29,3584]{2,1,0} aten::view(%852), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %854 = bf16[1,29,3584]{2,1,0} aten::add(%741, %853, %511), scope=aten::add.588, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %855 = f32[1,29,3584]{2,1,0} xla::cast(%854), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %856 = f32[1,29,3584]{2,1,0} aten::pow(%855, %510), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %857 = f32[1,29,1]{2,1,0} aten::mean(%856), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %858 = f32[1,29,1]{2,1,0} aten::add(%857, %509, %508), scope=aten::add.589, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %859 = f32[1,29,1]{2,1,0} aten::rsqrt(%858), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %860 = f32[1,29,3584]{2,1,0} aten::mul(%855, %859), scope=aten::mul.590, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %861 = bf16[1,29,3584]{2,1,0} xla::cast(%860), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %862 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %863 = bf16[1,29,3584]{2,1,0} aten::mul(%862, %861), scope=aten::mul.591, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %864 = bf16[29,3584]{1,0} aten::view(%863), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %865 = bf16[29,18944]{1,0} aten::mm(%864, %507), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %866 = bf16[1,29,18944]{2,1,0} aten::view(%865), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %867 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %868 = bf16[3584,18944]{0,1} aten::permute(%867), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %869 = bf16[29,3584]{1,0} aten::view(%863), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %870 = bf16[29,18944]{1,0} aten::mm(%869, %868), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %871 = bf16[1,29,18944]{2,1,0} aten::view(%870), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %872 = bf16[1,29,18944]{2,1,0} aten::silu(%871), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %873 = bf16[1,29,18944]{2,1,0} aten::mul(%872, %866), scope=aten::mul.592, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %874 = bf16[29,18944]{1,0} aten::view(%873), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %875 = bf16[29,3584]{1,0} aten::mm(%874, %505), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %876 = bf16[1,29,3584]{2,1,0} aten::view(%875), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %877 = bf16[1,29,3584]{2,1,0} aten::add(%854, %876, %503), scope=aten::add.593, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %878 = f32[1,29,3584]{2,1,0} xla::cast(%877), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %879 = f32[1,29,3584]{2,1,0} aten::pow(%878, %502), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %880 = f32[1,29,1]{2,1,0} aten::mean(%879), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %881 = f32[1,29,1]{2,1,0} aten::add(%880, %501, %500), scope=aten::add.594, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %882 = f32[1,29,1]{2,1,0} aten::rsqrt(%881), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %883 = f32[1,29,3584]{2,1,0} aten::mul(%878, %882), scope=aten::mul.595, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %884 = bf16[1,29,3584]{2,1,0} xla::cast(%883), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %885 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %886 = bf16[1,29,3584]{2,1,0} aten::mul(%885, %884), scope=aten::mul.596, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %887 = bf16[29,3584]{1,0} aten::view(%886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %888 = bf16[29,512]{1,0} aten::mm(%887, %499), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %889 = bf16[1,29,512]{2,1,0} aten::view(%888), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %890 = bf16[1,29,512]{2,1,0} aten::add(%889, %497, %496), scope=aten::add.599, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %891 = bf16[1,29,4,128]{3,2,1,0} aten::view(%890), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %892 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%891), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %893 = bf16[1,4,29,128]{3,1,2,0} xla::select(%892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %894 = bf16[1,4,29,128]{3,1,2,0} xla::select(%893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %895 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%894), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %896 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%895), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %897 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%896), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %898 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%897), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %899 = bf16[1,28,29,128]{3,2,1,0} aten::view(%898), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %900 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%899), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %901 = bf16[28,29,128]{2,1,0} aten::view(%900), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %902 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %903 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %904 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %905 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %906 = s64[1,29]{1,0} aten::expand(%905), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %907 = s64[1,29]{1,0} aten::add(%632, %906), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %908 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %909 = pred[1,29]{1,0} aten::lt(%632, %908), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %910 = s64[1,29]{1,0} aten::where(%909, %907, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %911 = s64[1,29,1]{2,1,0} aten::stack(%910), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %912 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %913 = bf16[29,128]{1,0} xla::select(%912), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %914 = bf16[1,29,128]{2,1,0} aten::index(%913, %911), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %915 = bf16[1,1,29,128]{3,2,1,0} aten::view(%914), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %916 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %917 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %918 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %919 = bf16[3584,512]{0,1} aten::permute(%918), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %920 = bf16[29,3584]{1,0} aten::view(%886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %921 = bf16[29,512]{1,0} aten::mm(%920, %919), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %922 = bf16[1,29,512]{2,1,0} aten::view(%921), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %923 = bf16[1,29,512]{2,1,0} aten::add(%922, %917, %916), scope=aten::add.598, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %924 = bf16[1,29,4,128]{3,2,1,0} aten::view(%923), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %925 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%924), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %926 = bf16[1,4,29,64]{3,1,2,0} xla::select(%925), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %927 = bf16[1,4,29,64]{3,1,2,0} xla::select(%925), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %928 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%927), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %929 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%928, %926), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %930 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%929, %915), scope=aten::mul.604, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %931 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %932 = s64[1,29]{1,0} aten::expand(%931), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %933 = s64[1,29]{1,0} aten::add(%632, %932), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %934 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %935 = pred[1,29]{1,0} aten::lt(%632, %934), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %936 = s64[1,29]{1,0} aten::where(%935, %933, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %937 = s64[1,29,1]{2,1,0} aten::stack(%936), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %938 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %939 = bf16[29,128]{1,0} xla::select(%938), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %940 = bf16[1,29,128]{2,1,0} aten::index(%939, %937), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %941 = bf16[1,1,29,128]{3,2,1,0} aten::view(%940), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %942 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%925, %941), scope=aten::mul.603, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %943 = bf16[1,4,29,128]{3,2,1,0} aten::add(%942, %930, %904), scope=aten::add.605, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %944 = bf16[1,4,29,128]{3,2,1,0} xla::select(%943), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %945 = bf16[1,4,29,128]{3,2,1,0} xla::select(%944), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %946 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%945), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %947 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%946), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %948 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%947), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %949 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%948), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %950 = bf16[1,28,29,128]{3,2,1,0} aten::view(%949), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %951 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%950), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %952 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%951), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %953 = bf16[28,128,29]{2,1,0} aten::view(%952), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %954 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %955 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %956 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %957 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %958 = bf16[3584,3584]{0,1} aten::permute(%957), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %959 = bf16[29,3584]{1,0} aten::view(%886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %960 = bf16[29,3584]{1,0} aten::mm(%959, %958), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %961 = bf16[1,29,3584]{2,1,0} aten::view(%960), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %962 = bf16[1,29,3584]{2,1,0} aten::add(%961, %956, %955), scope=aten::add.597, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %963 = bf16[1,29,28,128]{3,2,1,0} aten::view(%962), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %964 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%963), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %965 = bf16[1,28,29,64]{3,1,2,0} xla::select(%964), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %966 = bf16[1,28,29,64]{3,1,2,0} xla::select(%964), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %967 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%966), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %968 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%967, %965), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %969 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%968, %915), scope=aten::mul.601, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %970 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%964, %941), scope=aten::mul.600, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %971 = bf16[1,28,29,128]{3,2,1,0} aten::add(%970, %969, %954), scope=aten::add.602, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %972 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%971), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %973 = bf16[28,29,128]{2,1,0} aten::view(%972), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %974 = bf16[28,29,29]{2,1,0} aten::matmul(%973, %953), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %975 = bf16[1,28,29,29]{3,2,1,0} aten::view(%974), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %976 = bf16[1,28,29,29]{3,2,1,0} aten::div(%975, %903), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %977 = bf16[1,28,29,29]{3,2,1,0} aten::add(%976, %621, %902), scope=aten::add.606, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %978 = f32[1,28,29,29]{3,2,1,0} xla::cast(%977), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %979 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%978), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %980 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%979), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %981 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%980), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %982 = bf16[28,29,29]{2,1,0} aten::view(%981), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %983 = bf16[28,29,128]{2,1,0} aten::matmul(%982, %901), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %984 = bf16[1,28,29,128]{3,2,1,0} aten::view(%983), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %985 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%984), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %986 = bf16[1,29,3584]{2,1,0} aten::view(%985), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %987 = bf16[29,3584]{1,0} aten::view(%986), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %988 = bf16[29,3584]{1,0} aten::mm(%987, %495), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %989 = bf16[1,29,3584]{2,1,0} aten::view(%988), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %990 = bf16[1,29,3584]{2,1,0} aten::add(%877, %989, %493), scope=aten::add.607, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %991 = f32[1,29,3584]{2,1,0} xla::cast(%990), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %992 = f32[1,29,3584]{2,1,0} aten::pow(%991, %492), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %993 = f32[1,29,1]{2,1,0} aten::mean(%992), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %994 = f32[1,29,1]{2,1,0} aten::add(%993, %491, %490), scope=aten::add.608, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %995 = f32[1,29,1]{2,1,0} aten::rsqrt(%994), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %996 = f32[1,29,3584]{2,1,0} aten::mul(%991, %995), scope=aten::mul.609, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %997 = bf16[1,29,3584]{2,1,0} xla::cast(%996), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %998 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %999 = bf16[1,29,3584]{2,1,0} aten::mul(%998, %997), scope=aten::mul.610, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1000 = bf16[29,3584]{1,0} aten::view(%999), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1001 = bf16[29,18944]{1,0} aten::mm(%1000, %489), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1002 = bf16[1,29,18944]{2,1,0} aten::view(%1001), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1003 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1004 = bf16[3584,18944]{0,1} aten::permute(%1003), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1005 = bf16[29,3584]{1,0} aten::view(%999), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1006 = bf16[29,18944]{1,0} aten::mm(%1005, %1004), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1007 = bf16[1,29,18944]{2,1,0} aten::view(%1006), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1008 = bf16[1,29,18944]{2,1,0} aten::silu(%1007), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1009 = bf16[1,29,18944]{2,1,0} aten::mul(%1008, %1002), scope=aten::mul.611, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1010 = bf16[29,18944]{1,0} aten::view(%1009), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1011 = bf16[29,3584]{1,0} aten::mm(%1010, %487), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1012 = bf16[1,29,3584]{2,1,0} aten::view(%1011), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1013 = bf16[1,29,3584]{2,1,0} aten::add(%990, %1012, %485), scope=aten::add.612, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1014 = f32[1,29,3584]{2,1,0} xla::cast(%1013), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1015 = f32[1,29,3584]{2,1,0} aten::pow(%1014, %484), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1016 = f32[1,29,1]{2,1,0} aten::mean(%1015), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1017 = f32[1,29,1]{2,1,0} aten::add(%1016, %483, %482), scope=aten::add.613, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1018 = f32[1,29,1]{2,1,0} aten::rsqrt(%1017), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1019 = f32[1,29,3584]{2,1,0} aten::mul(%1014, %1018), scope=aten::mul.614, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1020 = bf16[1,29,3584]{2,1,0} xla::cast(%1019), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1021 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1022 = bf16[1,29,3584]{2,1,0} aten::mul(%1021, %1020), scope=aten::mul.615, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1023 = bf16[29,3584]{1,0} aten::view(%1022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1024 = bf16[29,512]{1,0} aten::mm(%1023, %481), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1025 = bf16[1,29,512]{2,1,0} aten::view(%1024), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1026 = bf16[1,29,512]{2,1,0} aten::add(%1025, %479, %478), scope=aten::add.618, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1027 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1026), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1028 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1027), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1029 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1030 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1031 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1030), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1032 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1031), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1033 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1032), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1034 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1033), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1035 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1034), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1036 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1035), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1037 = bf16[28,29,128]{2,1,0} aten::view(%1036), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1038 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1039 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1040 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1041 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1042 = s64[1,29]{1,0} aten::expand(%1041), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1043 = s64[1,29]{1,0} aten::add(%632, %1042), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1044 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1045 = pred[1,29]{1,0} aten::lt(%632, %1044), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1046 = s64[1,29]{1,0} aten::where(%1045, %1043, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1047 = s64[1,29,1]{2,1,0} aten::stack(%1046), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1048 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1049 = bf16[29,128]{1,0} xla::select(%1048), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1050 = bf16[1,29,128]{2,1,0} aten::index(%1049, %1047), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1051 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1050), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1052 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1053 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1054 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1055 = bf16[3584,512]{0,1} aten::permute(%1054), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1056 = bf16[29,3584]{1,0} aten::view(%1022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1057 = bf16[29,512]{1,0} aten::mm(%1056, %1055), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1058 = bf16[1,29,512]{2,1,0} aten::view(%1057), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1059 = bf16[1,29,512]{2,1,0} aten::add(%1058, %1053, %1052), scope=aten::add.617, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1060 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1059), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1061 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1060), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1062 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1061), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1063 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1061), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1064 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1063), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1065 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1064, %1062), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1066 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1065, %1051), scope=aten::mul.623, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1067 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1068 = s64[1,29]{1,0} aten::expand(%1067), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1069 = s64[1,29]{1,0} aten::add(%632, %1068), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1070 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1071 = pred[1,29]{1,0} aten::lt(%632, %1070), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1072 = s64[1,29]{1,0} aten::where(%1071, %1069, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1073 = s64[1,29,1]{2,1,0} aten::stack(%1072), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1074 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1075 = bf16[29,128]{1,0} xla::select(%1074), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1076 = bf16[1,29,128]{2,1,0} aten::index(%1075, %1073), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1077 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1076), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1078 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1061, %1077), scope=aten::mul.622, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1079 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1078, %1066, %1040), scope=aten::add.624, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1080 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1079), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1081 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1080), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1082 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1081), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1083 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1082), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1084 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1083), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1085 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1084), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1086 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1085), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1087 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1086), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1088 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1087), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1089 = bf16[28,128,29]{2,1,0} aten::view(%1088), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1090 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1091 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1092 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1093 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1094 = bf16[3584,3584]{0,1} aten::permute(%1093), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1095 = bf16[29,3584]{1,0} aten::view(%1022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1096 = bf16[29,3584]{1,0} aten::mm(%1095, %1094), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1097 = bf16[1,29,3584]{2,1,0} aten::view(%1096), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1098 = bf16[1,29,3584]{2,1,0} aten::add(%1097, %1092, %1091), scope=aten::add.616, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1099 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1098), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1100 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1099), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1101 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1100), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1102 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1100), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1103 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1102), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1104 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1103, %1101), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1105 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1104, %1051), scope=aten::mul.620, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1106 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1100, %1077), scope=aten::mul.619, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1107 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1106, %1105, %1090), scope=aten::add.621, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1108 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1107), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1109 = bf16[28,29,128]{2,1,0} aten::view(%1108), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1110 = bf16[28,29,29]{2,1,0} aten::matmul(%1109, %1089), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1111 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1110), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1112 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1111, %1039), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1113 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1112, %621, %1038), scope=aten::add.625, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1114 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1113), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1115 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1114), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1116 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1115), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1117 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1116), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1118 = bf16[28,29,29]{2,1,0} aten::view(%1117), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1119 = bf16[28,29,128]{2,1,0} aten::matmul(%1118, %1037), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1120 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1119), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1121 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1120), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1122 = bf16[1,29,3584]{2,1,0} aten::view(%1121), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1123 = bf16[29,3584]{1,0} aten::view(%1122), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1124 = bf16[29,3584]{1,0} aten::mm(%1123, %477), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1125 = bf16[1,29,3584]{2,1,0} aten::view(%1124), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1126 = bf16[1,29,3584]{2,1,0} aten::add(%1013, %1125, %475), scope=aten::add.626, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1127 = f32[1,29,3584]{2,1,0} xla::cast(%1126), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1128 = f32[1,29,3584]{2,1,0} aten::pow(%1127, %474), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1129 = f32[1,29,1]{2,1,0} aten::mean(%1128), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1130 = f32[1,29,1]{2,1,0} aten::add(%1129, %473, %472), scope=aten::add.627, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1131 = f32[1,29,1]{2,1,0} aten::rsqrt(%1130), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1132 = f32[1,29,3584]{2,1,0} aten::mul(%1127, %1131), scope=aten::mul.628, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1133 = bf16[1,29,3584]{2,1,0} xla::cast(%1132), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1134 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1135 = bf16[1,29,3584]{2,1,0} aten::mul(%1134, %1133), scope=aten::mul.629, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1136 = bf16[29,3584]{1,0} aten::view(%1135), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1137 = bf16[29,18944]{1,0} aten::mm(%1136, %471), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1138 = bf16[1,29,18944]{2,1,0} aten::view(%1137), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1139 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1140 = bf16[3584,18944]{0,1} aten::permute(%1139), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1141 = bf16[29,3584]{1,0} aten::view(%1135), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1142 = bf16[29,18944]{1,0} aten::mm(%1141, %1140), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1143 = bf16[1,29,18944]{2,1,0} aten::view(%1142), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1144 = bf16[1,29,18944]{2,1,0} aten::silu(%1143), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1145 = bf16[1,29,18944]{2,1,0} aten::mul(%1144, %1138), scope=aten::mul.630, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1146 = bf16[29,18944]{1,0} aten::view(%1145), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1147 = bf16[29,3584]{1,0} aten::mm(%1146, %469), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1148 = bf16[1,29,3584]{2,1,0} aten::view(%1147), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1149 = bf16[1,29,3584]{2,1,0} aten::add(%1126, %1148, %467), scope=aten::add.631, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1150 = f32[1,29,3584]{2,1,0} xla::cast(%1149), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1151 = f32[1,29,3584]{2,1,0} aten::pow(%1150, %466), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1152 = f32[1,29,1]{2,1,0} aten::mean(%1151), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1153 = f32[1,29,1]{2,1,0} aten::add(%1152, %465, %464), scope=aten::add.632, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1154 = f32[1,29,1]{2,1,0} aten::rsqrt(%1153), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1155 = f32[1,29,3584]{2,1,0} aten::mul(%1150, %1154), scope=aten::mul.633, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1156 = bf16[1,29,3584]{2,1,0} xla::cast(%1155), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1157 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1158 = bf16[1,29,3584]{2,1,0} aten::mul(%1157, %1156), scope=aten::mul.634, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1159 = bf16[29,3584]{1,0} aten::view(%1158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1160 = bf16[29,512]{1,0} aten::mm(%1159, %463), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1161 = bf16[1,29,512]{2,1,0} aten::view(%1160), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1162 = bf16[1,29,512]{2,1,0} aten::add(%1161, %461, %460), scope=aten::add.637, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1163 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1162), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1164 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1163), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1165 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1166 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1167 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1166), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1168 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1167), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1169 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1168), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1170 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1169), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1171 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1170), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1172 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1171), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1173 = bf16[28,29,128]{2,1,0} aten::view(%1172), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1174 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1175 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1176 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1177 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1178 = s64[1,29]{1,0} aten::expand(%1177), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1179 = s64[1,29]{1,0} aten::add(%632, %1178), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1180 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1181 = pred[1,29]{1,0} aten::lt(%632, %1180), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1182 = s64[1,29]{1,0} aten::where(%1181, %1179, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1183 = s64[1,29,1]{2,1,0} aten::stack(%1182), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1184 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1185 = bf16[29,128]{1,0} xla::select(%1184), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1186 = bf16[1,29,128]{2,1,0} aten::index(%1185, %1183), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1187 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1186), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1188 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1189 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1190 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1191 = bf16[3584,512]{0,1} aten::permute(%1190), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1192 = bf16[29,3584]{1,0} aten::view(%1158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1193 = bf16[29,512]{1,0} aten::mm(%1192, %1191), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1194 = bf16[1,29,512]{2,1,0} aten::view(%1193), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1195 = bf16[1,29,512]{2,1,0} aten::add(%1194, %1189, %1188), scope=aten::add.636, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1196 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1195), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1197 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1196), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1198 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1197), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1199 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1197), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1200 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1199), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1201 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1200, %1198), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1202 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1201, %1187), scope=aten::mul.642, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1203 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1204 = s64[1,29]{1,0} aten::expand(%1203), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1205 = s64[1,29]{1,0} aten::add(%632, %1204), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1206 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1207 = pred[1,29]{1,0} aten::lt(%632, %1206), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1208 = s64[1,29]{1,0} aten::where(%1207, %1205, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1209 = s64[1,29,1]{2,1,0} aten::stack(%1208), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1210 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1211 = bf16[29,128]{1,0} xla::select(%1210), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1212 = bf16[1,29,128]{2,1,0} aten::index(%1211, %1209), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1213 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1212), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1214 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1197, %1213), scope=aten::mul.641, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1215 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1214, %1202, %1176), scope=aten::add.643, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1216 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1215), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1217 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1216), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1218 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1217), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1219 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1218), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1220 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1219), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1221 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1220), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1222 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1221), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1223 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1222), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1224 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1223), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1225 = bf16[28,128,29]{2,1,0} aten::view(%1224), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1226 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1227 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1228 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1229 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1230 = bf16[3584,3584]{0,1} aten::permute(%1229), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1231 = bf16[29,3584]{1,0} aten::view(%1158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1232 = bf16[29,3584]{1,0} aten::mm(%1231, %1230), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1233 = bf16[1,29,3584]{2,1,0} aten::view(%1232), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1234 = bf16[1,29,3584]{2,1,0} aten::add(%1233, %1228, %1227), scope=aten::add.635, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1235 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1234), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1236 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1235), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1237 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1236), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1238 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1236), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1239 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1238), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1240 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1239, %1237), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1241 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1240, %1187), scope=aten::mul.639, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1242 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1236, %1213), scope=aten::mul.638, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1243 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1242, %1241, %1226), scope=aten::add.640, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1244 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1243), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1245 = bf16[28,29,128]{2,1,0} aten::view(%1244), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1246 = bf16[28,29,29]{2,1,0} aten::matmul(%1245, %1225), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1247 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1246), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1248 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1247, %1175), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1249 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1248, %621, %1174), scope=aten::add.644, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1250 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1249), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1251 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1250), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1252 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1251), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1253 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1252), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1254 = bf16[28,29,29]{2,1,0} aten::view(%1253), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1255 = bf16[28,29,128]{2,1,0} aten::matmul(%1254, %1173), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1256 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1255), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1257 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1256), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1258 = bf16[1,29,3584]{2,1,0} aten::view(%1257), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1259 = bf16[29,3584]{1,0} aten::view(%1258), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1260 = bf16[29,3584]{1,0} aten::mm(%1259, %459), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1261 = bf16[1,29,3584]{2,1,0} aten::view(%1260), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1262 = bf16[1,29,3584]{2,1,0} aten::add(%1149, %1261, %457), scope=aten::add.645, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1263 = f32[1,29,3584]{2,1,0} xla::cast(%1262), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1264 = f32[1,29,3584]{2,1,0} aten::pow(%1263, %456), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1265 = f32[1,29,1]{2,1,0} aten::mean(%1264), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1266 = f32[1,29,1]{2,1,0} aten::add(%1265, %455, %454), scope=aten::add.646, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1267 = f32[1,29,1]{2,1,0} aten::rsqrt(%1266), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1268 = f32[1,29,3584]{2,1,0} aten::mul(%1263, %1267), scope=aten::mul.647, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1269 = bf16[1,29,3584]{2,1,0} xla::cast(%1268), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1270 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1271 = bf16[1,29,3584]{2,1,0} aten::mul(%1270, %1269), scope=aten::mul.648, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1272 = bf16[29,3584]{1,0} aten::view(%1271), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1273 = bf16[29,18944]{1,0} aten::mm(%1272, %453), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1274 = bf16[1,29,18944]{2,1,0} aten::view(%1273), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1275 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1276 = bf16[3584,18944]{0,1} aten::permute(%1275), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1277 = bf16[29,3584]{1,0} aten::view(%1271), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1278 = bf16[29,18944]{1,0} aten::mm(%1277, %1276), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1279 = bf16[1,29,18944]{2,1,0} aten::view(%1278), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1280 = bf16[1,29,18944]{2,1,0} aten::silu(%1279), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1281 = bf16[1,29,18944]{2,1,0} aten::mul(%1280, %1274), scope=aten::mul.649, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1282 = bf16[29,18944]{1,0} aten::view(%1281), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1283 = bf16[29,3584]{1,0} aten::mm(%1282, %451), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1284 = bf16[1,29,3584]{2,1,0} aten::view(%1283), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1285 = bf16[1,29,3584]{2,1,0} aten::add(%1262, %1284, %449), scope=aten::add.650, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1286 = f32[1,29,3584]{2,1,0} xla::cast(%1285), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1287 = f32[1,29,3584]{2,1,0} aten::pow(%1286, %448), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1288 = f32[1,29,1]{2,1,0} aten::mean(%1287), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1289 = f32[1,29,1]{2,1,0} aten::add(%1288, %447, %446), scope=aten::add.651, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1290 = f32[1,29,1]{2,1,0} aten::rsqrt(%1289), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1291 = f32[1,29,3584]{2,1,0} aten::mul(%1286, %1290), scope=aten::mul.652, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1292 = bf16[1,29,3584]{2,1,0} xla::cast(%1291), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1293 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1294 = bf16[1,29,3584]{2,1,0} aten::mul(%1293, %1292), scope=aten::mul.653, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1295 = bf16[29,3584]{1,0} aten::view(%1294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1296 = bf16[29,512]{1,0} aten::mm(%1295, %445), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1297 = bf16[1,29,512]{2,1,0} aten::view(%1296), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1298 = bf16[1,29,512]{2,1,0} aten::add(%1297, %443, %442), scope=aten::add.656, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1299 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1298), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1300 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1299), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1301 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1302 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1303 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1302), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1304 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1303), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1305 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1304), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1306 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1305), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1307 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1306), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1308 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1307), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1309 = bf16[28,29,128]{2,1,0} aten::view(%1308), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1310 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1311 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1312 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1313 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1314 = s64[1,29]{1,0} aten::expand(%1313), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1315 = s64[1,29]{1,0} aten::add(%632, %1314), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1316 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1317 = pred[1,29]{1,0} aten::lt(%632, %1316), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1318 = s64[1,29]{1,0} aten::where(%1317, %1315, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1319 = s64[1,29,1]{2,1,0} aten::stack(%1318), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1320 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1321 = bf16[29,128]{1,0} xla::select(%1320), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1322 = bf16[1,29,128]{2,1,0} aten::index(%1321, %1319), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1323 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1322), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1324 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1325 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1326 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1327 = bf16[3584,512]{0,1} aten::permute(%1326), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1328 = bf16[29,3584]{1,0} aten::view(%1294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1329 = bf16[29,512]{1,0} aten::mm(%1328, %1327), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1330 = bf16[1,29,512]{2,1,0} aten::view(%1329), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1331 = bf16[1,29,512]{2,1,0} aten::add(%1330, %1325, %1324), scope=aten::add.655, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1332 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1331), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1333 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1332), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1334 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1333), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1335 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1333), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1336 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1335), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1337 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1336, %1334), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1338 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1337, %1323), scope=aten::mul.661, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1339 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1340 = s64[1,29]{1,0} aten::expand(%1339), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1341 = s64[1,29]{1,0} aten::add(%632, %1340), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1342 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1343 = pred[1,29]{1,0} aten::lt(%632, %1342), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1344 = s64[1,29]{1,0} aten::where(%1343, %1341, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1345 = s64[1,29,1]{2,1,0} aten::stack(%1344), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1346 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1347 = bf16[29,128]{1,0} xla::select(%1346), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1348 = bf16[1,29,128]{2,1,0} aten::index(%1347, %1345), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1349 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1348), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1350 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1333, %1349), scope=aten::mul.660, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1351 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1350, %1338, %1312), scope=aten::add.662, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1352 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1351), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1353 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1352), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1354 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1353), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1355 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1354), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1356 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1355), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1357 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1356), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1358 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1357), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1359 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1358), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1360 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1359), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1361 = bf16[28,128,29]{2,1,0} aten::view(%1360), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1362 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1363 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1364 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1365 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1366 = bf16[3584,3584]{0,1} aten::permute(%1365), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1367 = bf16[29,3584]{1,0} aten::view(%1294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1368 = bf16[29,3584]{1,0} aten::mm(%1367, %1366), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1369 = bf16[1,29,3584]{2,1,0} aten::view(%1368), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1370 = bf16[1,29,3584]{2,1,0} aten::add(%1369, %1364, %1363), scope=aten::add.654, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1371 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1370), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1372 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1371), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1373 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1372), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1374 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1372), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1375 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1374), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1376 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1375, %1373), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1377 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1376, %1323), scope=aten::mul.658, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1378 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1372, %1349), scope=aten::mul.657, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1379 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1378, %1377, %1362), scope=aten::add.659, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1380 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1379), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1381 = bf16[28,29,128]{2,1,0} aten::view(%1380), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1382 = bf16[28,29,29]{2,1,0} aten::matmul(%1381, %1361), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1383 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1382), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1384 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1383, %1311), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1385 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1384, %621, %1310), scope=aten::add.663, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1386 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1385), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1387 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1386), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1388 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1387), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1389 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1388), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1390 = bf16[28,29,29]{2,1,0} aten::view(%1389), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1391 = bf16[28,29,128]{2,1,0} aten::matmul(%1390, %1309), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1392 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1391), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1393 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1392), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1394 = bf16[1,29,3584]{2,1,0} aten::view(%1393), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1395 = bf16[29,3584]{1,0} aten::view(%1394), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1396 = bf16[29,3584]{1,0} aten::mm(%1395, %441), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1397 = bf16[1,29,3584]{2,1,0} aten::view(%1396), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1398 = bf16[1,29,3584]{2,1,0} aten::add(%1285, %1397, %439), scope=aten::add.664, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1399 = f32[1,29,3584]{2,1,0} xla::cast(%1398), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1400 = f32[1,29,3584]{2,1,0} aten::pow(%1399, %438), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1401 = f32[1,29,1]{2,1,0} aten::mean(%1400), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1402 = f32[1,29,1]{2,1,0} aten::add(%1401, %437, %436), scope=aten::add.665, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1403 = f32[1,29,1]{2,1,0} aten::rsqrt(%1402), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1404 = f32[1,29,3584]{2,1,0} aten::mul(%1399, %1403), scope=aten::mul.666, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1405 = bf16[1,29,3584]{2,1,0} xla::cast(%1404), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1406 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1407 = bf16[1,29,3584]{2,1,0} aten::mul(%1406, %1405), scope=aten::mul.667, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1408 = bf16[29,3584]{1,0} aten::view(%1407), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1409 = bf16[29,18944]{1,0} aten::mm(%1408, %435), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1410 = bf16[1,29,18944]{2,1,0} aten::view(%1409), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1411 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1412 = bf16[3584,18944]{0,1} aten::permute(%1411), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1413 = bf16[29,3584]{1,0} aten::view(%1407), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1414 = bf16[29,18944]{1,0} aten::mm(%1413, %1412), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1415 = bf16[1,29,18944]{2,1,0} aten::view(%1414), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1416 = bf16[1,29,18944]{2,1,0} aten::silu(%1415), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1417 = bf16[1,29,18944]{2,1,0} aten::mul(%1416, %1410), scope=aten::mul.668, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1418 = bf16[29,18944]{1,0} aten::view(%1417), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1419 = bf16[29,3584]{1,0} aten::mm(%1418, %433), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1420 = bf16[1,29,3584]{2,1,0} aten::view(%1419), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1421 = bf16[1,29,3584]{2,1,0} aten::add(%1398, %1420, %431), scope=aten::add.669, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1422 = f32[1,29,3584]{2,1,0} xla::cast(%1421), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1423 = f32[1,29,3584]{2,1,0} aten::pow(%1422, %430), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1424 = f32[1,29,1]{2,1,0} aten::mean(%1423), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1425 = f32[1,29,1]{2,1,0} aten::add(%1424, %429, %428), scope=aten::add.670, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1426 = f32[1,29,1]{2,1,0} aten::rsqrt(%1425), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1427 = f32[1,29,3584]{2,1,0} aten::mul(%1422, %1426), scope=aten::mul.671, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1428 = bf16[1,29,3584]{2,1,0} xla::cast(%1427), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1429 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1430 = bf16[1,29,3584]{2,1,0} aten::mul(%1429, %1428), scope=aten::mul.672, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1431 = bf16[29,3584]{1,0} aten::view(%1430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1432 = bf16[29,512]{1,0} aten::mm(%1431, %427), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1433 = bf16[1,29,512]{2,1,0} aten::view(%1432), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1434 = bf16[1,29,512]{2,1,0} aten::add(%1433, %425, %424), scope=aten::add.675, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1435 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1434), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1436 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1435), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1437 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1438 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1439 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1438), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1440 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1439), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1441 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1440), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1442 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1441), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1443 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1442), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1444 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1443), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1445 = bf16[28,29,128]{2,1,0} aten::view(%1444), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1446 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1447 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1448 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1449 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1450 = s64[1,29]{1,0} aten::expand(%1449), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1451 = s64[1,29]{1,0} aten::add(%632, %1450), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1452 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1453 = pred[1,29]{1,0} aten::lt(%632, %1452), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1454 = s64[1,29]{1,0} aten::where(%1453, %1451, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1455 = s64[1,29,1]{2,1,0} aten::stack(%1454), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1456 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1457 = bf16[29,128]{1,0} xla::select(%1456), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1458 = bf16[1,29,128]{2,1,0} aten::index(%1457, %1455), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1459 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1458), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1460 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1461 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1462 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1463 = bf16[3584,512]{0,1} aten::permute(%1462), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1464 = bf16[29,3584]{1,0} aten::view(%1430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1465 = bf16[29,512]{1,0} aten::mm(%1464, %1463), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1466 = bf16[1,29,512]{2,1,0} aten::view(%1465), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1467 = bf16[1,29,512]{2,1,0} aten::add(%1466, %1461, %1460), scope=aten::add.674, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1468 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1467), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1469 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1468), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1470 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1469), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1471 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1469), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1472 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1471), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1473 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1472, %1470), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1474 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1473, %1459), scope=aten::mul.680, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1475 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1476 = s64[1,29]{1,0} aten::expand(%1475), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1477 = s64[1,29]{1,0} aten::add(%632, %1476), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1478 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1479 = pred[1,29]{1,0} aten::lt(%632, %1478), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1480 = s64[1,29]{1,0} aten::where(%1479, %1477, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1481 = s64[1,29,1]{2,1,0} aten::stack(%1480), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1482 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1483 = bf16[29,128]{1,0} xla::select(%1482), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1484 = bf16[1,29,128]{2,1,0} aten::index(%1483, %1481), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1485 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1484), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1486 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1469, %1485), scope=aten::mul.679, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1487 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1486, %1474, %1448), scope=aten::add.681, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1488 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1487), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1489 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1488), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1490 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1489), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1491 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1490), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1492 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1491), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1493 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1492), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1494 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1493), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1495 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1494), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1496 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1495), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1497 = bf16[28,128,29]{2,1,0} aten::view(%1496), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1498 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1499 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1500 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1501 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1502 = bf16[3584,3584]{0,1} aten::permute(%1501), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1503 = bf16[29,3584]{1,0} aten::view(%1430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1504 = bf16[29,3584]{1,0} aten::mm(%1503, %1502), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1505 = bf16[1,29,3584]{2,1,0} aten::view(%1504), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1506 = bf16[1,29,3584]{2,1,0} aten::add(%1505, %1500, %1499), scope=aten::add.673, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1507 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1506), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1508 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1507), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1509 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1508), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1510 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1508), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1511 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1510), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1512 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1511, %1509), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1513 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1512, %1459), scope=aten::mul.677, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1514 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1508, %1485), scope=aten::mul.676, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1515 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1514, %1513, %1498), scope=aten::add.678, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1516 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1515), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1517 = bf16[28,29,128]{2,1,0} aten::view(%1516), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1518 = bf16[28,29,29]{2,1,0} aten::matmul(%1517, %1497), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1519 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1518), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1520 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1519, %1447), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1521 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1520, %621, %1446), scope=aten::add.682, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1522 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1521), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1523 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1522), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1524 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1523), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1525 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1524), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1526 = bf16[28,29,29]{2,1,0} aten::view(%1525), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1527 = bf16[28,29,128]{2,1,0} aten::matmul(%1526, %1445), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1528 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1527), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1529 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1528), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1530 = bf16[1,29,3584]{2,1,0} aten::view(%1529), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1531 = bf16[29,3584]{1,0} aten::view(%1530), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1532 = bf16[29,3584]{1,0} aten::mm(%1531, %423), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1533 = bf16[1,29,3584]{2,1,0} aten::view(%1532), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1534 = bf16[1,29,3584]{2,1,0} aten::add(%1421, %1533, %421), scope=aten::add.683, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1535 = f32[1,29,3584]{2,1,0} xla::cast(%1534), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1536 = f32[1,29,3584]{2,1,0} aten::pow(%1535, %420), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1537 = f32[1,29,1]{2,1,0} aten::mean(%1536), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1538 = f32[1,29,1]{2,1,0} aten::add(%1537, %419, %418), scope=aten::add.684, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1539 = f32[1,29,1]{2,1,0} aten::rsqrt(%1538), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1540 = f32[1,29,3584]{2,1,0} aten::mul(%1535, %1539), scope=aten::mul.685, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1541 = bf16[1,29,3584]{2,1,0} xla::cast(%1540), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1542 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1543 = bf16[1,29,3584]{2,1,0} aten::mul(%1542, %1541), scope=aten::mul.686, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1544 = bf16[29,3584]{1,0} aten::view(%1543), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1545 = bf16[29,18944]{1,0} aten::mm(%1544, %417), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1546 = bf16[1,29,18944]{2,1,0} aten::view(%1545), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1547 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1548 = bf16[3584,18944]{0,1} aten::permute(%1547), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1549 = bf16[29,3584]{1,0} aten::view(%1543), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1550 = bf16[29,18944]{1,0} aten::mm(%1549, %1548), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1551 = bf16[1,29,18944]{2,1,0} aten::view(%1550), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1552 = bf16[1,29,18944]{2,1,0} aten::silu(%1551), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1553 = bf16[1,29,18944]{2,1,0} aten::mul(%1552, %1546), scope=aten::mul.687, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1554 = bf16[29,18944]{1,0} aten::view(%1553), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1555 = bf16[29,3584]{1,0} aten::mm(%1554, %415), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1556 = bf16[1,29,3584]{2,1,0} aten::view(%1555), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1557 = bf16[1,29,3584]{2,1,0} aten::add(%1534, %1556, %413), scope=aten::add.688, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1558 = f32[1,29,3584]{2,1,0} xla::cast(%1557), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1559 = f32[1,29,3584]{2,1,0} aten::pow(%1558, %412), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1560 = f32[1,29,1]{2,1,0} aten::mean(%1559), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1561 = f32[1,29,1]{2,1,0} aten::add(%1560, %411, %410), scope=aten::add.689, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1562 = f32[1,29,1]{2,1,0} aten::rsqrt(%1561), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1563 = f32[1,29,3584]{2,1,0} aten::mul(%1558, %1562), scope=aten::mul.690, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1564 = bf16[1,29,3584]{2,1,0} xla::cast(%1563), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1565 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1566 = bf16[1,29,3584]{2,1,0} aten::mul(%1565, %1564), scope=aten::mul.691, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1567 = bf16[29,3584]{1,0} aten::view(%1566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1568 = bf16[29,512]{1,0} aten::mm(%1567, %409), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1569 = bf16[1,29,512]{2,1,0} aten::view(%1568), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1570 = bf16[1,29,512]{2,1,0} aten::add(%1569, %407, %406), scope=aten::add.694, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1571 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1570), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1572 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1571), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1573 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1574 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1575 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1574), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1576 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1575), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1577 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1576), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1578 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1577), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1579 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1578), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1580 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1579), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1581 = bf16[28,29,128]{2,1,0} aten::view(%1580), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1582 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1583 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1584 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1585 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1586 = s64[1,29]{1,0} aten::expand(%1585), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1587 = s64[1,29]{1,0} aten::add(%632, %1586), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1588 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1589 = pred[1,29]{1,0} aten::lt(%632, %1588), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1590 = s64[1,29]{1,0} aten::where(%1589, %1587, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1591 = s64[1,29,1]{2,1,0} aten::stack(%1590), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1592 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1593 = bf16[29,128]{1,0} xla::select(%1592), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1594 = bf16[1,29,128]{2,1,0} aten::index(%1593, %1591), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1595 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1594), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1596 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1597 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1598 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1599 = bf16[3584,512]{0,1} aten::permute(%1598), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1600 = bf16[29,3584]{1,0} aten::view(%1566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1601 = bf16[29,512]{1,0} aten::mm(%1600, %1599), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1602 = bf16[1,29,512]{2,1,0} aten::view(%1601), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1603 = bf16[1,29,512]{2,1,0} aten::add(%1602, %1597, %1596), scope=aten::add.693, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1604 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1603), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1605 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1604), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1606 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1605), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1607 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1605), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1608 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1607), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1609 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1608, %1606), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1610 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1609, %1595), scope=aten::mul.699, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1611 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1612 = s64[1,29]{1,0} aten::expand(%1611), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1613 = s64[1,29]{1,0} aten::add(%632, %1612), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1614 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1615 = pred[1,29]{1,0} aten::lt(%632, %1614), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1616 = s64[1,29]{1,0} aten::where(%1615, %1613, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1617 = s64[1,29,1]{2,1,0} aten::stack(%1616), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1618 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1619 = bf16[29,128]{1,0} xla::select(%1618), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1620 = bf16[1,29,128]{2,1,0} aten::index(%1619, %1617), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1621 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1620), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1622 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1605, %1621), scope=aten::mul.698, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1623 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1622, %1610, %1584), scope=aten::add.700, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1624 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1623), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1625 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1624), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1626 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1625), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1627 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1626), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1628 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1627), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1629 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1628), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1630 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1629), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1631 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1630), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1632 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1631), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1633 = bf16[28,128,29]{2,1,0} aten::view(%1632), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1634 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1635 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1636 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1637 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1638 = bf16[3584,3584]{0,1} aten::permute(%1637), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1639 = bf16[29,3584]{1,0} aten::view(%1566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1640 = bf16[29,3584]{1,0} aten::mm(%1639, %1638), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1641 = bf16[1,29,3584]{2,1,0} aten::view(%1640), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1642 = bf16[1,29,3584]{2,1,0} aten::add(%1641, %1636, %1635), scope=aten::add.692, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1643 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1642), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1644 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1643), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1645 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1644), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1646 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1644), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1647 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1646), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1648 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1647, %1645), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1649 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1648, %1595), scope=aten::mul.696, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1650 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1644, %1621), scope=aten::mul.695, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1651 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1650, %1649, %1634), scope=aten::add.697, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1652 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1651), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1653 = bf16[28,29,128]{2,1,0} aten::view(%1652), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1654 = bf16[28,29,29]{2,1,0} aten::matmul(%1653, %1633), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1655 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1654), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1656 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1655, %1583), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1657 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1656, %621, %1582), scope=aten::add.701, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1658 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1657), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1659 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1658), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1660 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1659), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1661 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1660), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1662 = bf16[28,29,29]{2,1,0} aten::view(%1661), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1663 = bf16[28,29,128]{2,1,0} aten::matmul(%1662, %1581), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1664 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1663), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1665 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1664), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1666 = bf16[1,29,3584]{2,1,0} aten::view(%1665), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1667 = bf16[29,3584]{1,0} aten::view(%1666), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1668 = bf16[29,3584]{1,0} aten::mm(%1667, %405), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1669 = bf16[1,29,3584]{2,1,0} aten::view(%1668), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1670 = bf16[1,29,3584]{2,1,0} aten::add(%1557, %1669, %403), scope=aten::add.702, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1671 = f32[1,29,3584]{2,1,0} xla::cast(%1670), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1672 = f32[1,29,3584]{2,1,0} aten::pow(%1671, %402), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1673 = f32[1,29,1]{2,1,0} aten::mean(%1672), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1674 = f32[1,29,1]{2,1,0} aten::add(%1673, %401, %400), scope=aten::add.703, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1675 = f32[1,29,1]{2,1,0} aten::rsqrt(%1674), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1676 = f32[1,29,3584]{2,1,0} aten::mul(%1671, %1675), scope=aten::mul.704, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1677 = bf16[1,29,3584]{2,1,0} xla::cast(%1676), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1678 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1679 = bf16[1,29,3584]{2,1,0} aten::mul(%1678, %1677), scope=aten::mul.705, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1680 = bf16[29,3584]{1,0} aten::view(%1679), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1681 = bf16[29,18944]{1,0} aten::mm(%1680, %399), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1682 = bf16[1,29,18944]{2,1,0} aten::view(%1681), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1683 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1684 = bf16[3584,18944]{0,1} aten::permute(%1683), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1685 = bf16[29,3584]{1,0} aten::view(%1679), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1686 = bf16[29,18944]{1,0} aten::mm(%1685, %1684), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1687 = bf16[1,29,18944]{2,1,0} aten::view(%1686), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1688 = bf16[1,29,18944]{2,1,0} aten::silu(%1687), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1689 = bf16[1,29,18944]{2,1,0} aten::mul(%1688, %1682), scope=aten::mul.706, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1690 = bf16[29,18944]{1,0} aten::view(%1689), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1691 = bf16[29,3584]{1,0} aten::mm(%1690, %397), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1692 = bf16[1,29,3584]{2,1,0} aten::view(%1691), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1693 = bf16[1,29,3584]{2,1,0} aten::add(%1670, %1692, %395), scope=aten::add.707, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1694 = f32[1,29,3584]{2,1,0} xla::cast(%1693), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1695 = f32[1,29,3584]{2,1,0} aten::pow(%1694, %394), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1696 = f32[1,29,1]{2,1,0} aten::mean(%1695), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1697 = f32[1,29,1]{2,1,0} aten::add(%1696, %393, %392), scope=aten::add.708, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1698 = f32[1,29,1]{2,1,0} aten::rsqrt(%1697), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1699 = f32[1,29,3584]{2,1,0} aten::mul(%1694, %1698), scope=aten::mul.709, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1700 = bf16[1,29,3584]{2,1,0} xla::cast(%1699), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1701 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1702 = bf16[1,29,3584]{2,1,0} aten::mul(%1701, %1700), scope=aten::mul.710, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1703 = bf16[29,3584]{1,0} aten::view(%1702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1704 = bf16[29,512]{1,0} aten::mm(%1703, %391), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1705 = bf16[1,29,512]{2,1,0} aten::view(%1704), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1706 = bf16[1,29,512]{2,1,0} aten::add(%1705, %389, %388), scope=aten::add.713, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1707 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1706), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1708 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1707), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1709 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1710 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1711 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1710), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1712 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1711), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1713 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1712), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1714 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1713), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1715 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1714), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1716 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1715), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1717 = bf16[28,29,128]{2,1,0} aten::view(%1716), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1718 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1719 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1720 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1721 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1722 = s64[1,29]{1,0} aten::expand(%1721), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1723 = s64[1,29]{1,0} aten::add(%632, %1722), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1724 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1725 = pred[1,29]{1,0} aten::lt(%632, %1724), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1726 = s64[1,29]{1,0} aten::where(%1725, %1723, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1727 = s64[1,29,1]{2,1,0} aten::stack(%1726), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1728 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1729 = bf16[29,128]{1,0} xla::select(%1728), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1730 = bf16[1,29,128]{2,1,0} aten::index(%1729, %1727), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1731 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1730), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1732 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1733 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1734 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1735 = bf16[3584,512]{0,1} aten::permute(%1734), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1736 = bf16[29,3584]{1,0} aten::view(%1702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1737 = bf16[29,512]{1,0} aten::mm(%1736, %1735), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1738 = bf16[1,29,512]{2,1,0} aten::view(%1737), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1739 = bf16[1,29,512]{2,1,0} aten::add(%1738, %1733, %1732), scope=aten::add.712, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1740 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1739), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1741 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1740), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1742 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1741), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1743 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1741), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1744 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1743), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1745 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1744, %1742), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1746 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1745, %1731), scope=aten::mul.718, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1747 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1748 = s64[1,29]{1,0} aten::expand(%1747), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1749 = s64[1,29]{1,0} aten::add(%632, %1748), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1750 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1751 = pred[1,29]{1,0} aten::lt(%632, %1750), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1752 = s64[1,29]{1,0} aten::where(%1751, %1749, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1753 = s64[1,29,1]{2,1,0} aten::stack(%1752), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1754 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1755 = bf16[29,128]{1,0} xla::select(%1754), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1756 = bf16[1,29,128]{2,1,0} aten::index(%1755, %1753), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1757 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1756), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1758 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1741, %1757), scope=aten::mul.717, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1759 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1758, %1746, %1720), scope=aten::add.719, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1760 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1759), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1761 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1760), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1762 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1761), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1763 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1762), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1764 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1763), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1765 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1764), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1766 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1765), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1767 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1766), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1768 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1767), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1769 = bf16[28,128,29]{2,1,0} aten::view(%1768), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1770 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1771 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1772 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1773 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1774 = bf16[3584,3584]{0,1} aten::permute(%1773), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1775 = bf16[29,3584]{1,0} aten::view(%1702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1776 = bf16[29,3584]{1,0} aten::mm(%1775, %1774), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1777 = bf16[1,29,3584]{2,1,0} aten::view(%1776), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1778 = bf16[1,29,3584]{2,1,0} aten::add(%1777, %1772, %1771), scope=aten::add.711, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1779 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1778), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1780 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1779), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1781 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1780), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1782 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1780), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1783 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1782), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1784 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1783, %1781), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1785 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1784, %1731), scope=aten::mul.715, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1786 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1780, %1757), scope=aten::mul.714, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1787 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1786, %1785, %1770), scope=aten::add.716, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1788 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1787), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1789 = bf16[28,29,128]{2,1,0} aten::view(%1788), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1790 = bf16[28,29,29]{2,1,0} aten::matmul(%1789, %1769), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1791 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1790), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1792 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1791, %1719), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1793 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1792, %621, %1718), scope=aten::add.720, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1794 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1793), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1795 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1794), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1796 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1795), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1797 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1796), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1798 = bf16[28,29,29]{2,1,0} aten::view(%1797), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1799 = bf16[28,29,128]{2,1,0} aten::matmul(%1798, %1717), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1800 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1799), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1801 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1800), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1802 = bf16[1,29,3584]{2,1,0} aten::view(%1801), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1803 = bf16[29,3584]{1,0} aten::view(%1802), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1804 = bf16[29,3584]{1,0} aten::mm(%1803, %387), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1805 = bf16[1,29,3584]{2,1,0} aten::view(%1804), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1806 = bf16[1,29,3584]{2,1,0} aten::add(%1693, %1805, %385), scope=aten::add.721, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1807 = f32[1,29,3584]{2,1,0} xla::cast(%1806), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1808 = f32[1,29,3584]{2,1,0} aten::pow(%1807, %384), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1809 = f32[1,29,1]{2,1,0} aten::mean(%1808), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1810 = f32[1,29,1]{2,1,0} aten::add(%1809, %383, %382), scope=aten::add.722, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1811 = f32[1,29,1]{2,1,0} aten::rsqrt(%1810), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1812 = f32[1,29,3584]{2,1,0} aten::mul(%1807, %1811), scope=aten::mul.723, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1813 = bf16[1,29,3584]{2,1,0} xla::cast(%1812), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1814 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1815 = bf16[1,29,3584]{2,1,0} aten::mul(%1814, %1813), scope=aten::mul.724, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1816 = bf16[29,3584]{1,0} aten::view(%1815), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1817 = bf16[29,18944]{1,0} aten::mm(%1816, %381), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1818 = bf16[1,29,18944]{2,1,0} aten::view(%1817), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1819 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1820 = bf16[3584,18944]{0,1} aten::permute(%1819), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1821 = bf16[29,3584]{1,0} aten::view(%1815), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1822 = bf16[29,18944]{1,0} aten::mm(%1821, %1820), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1823 = bf16[1,29,18944]{2,1,0} aten::view(%1822), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1824 = bf16[1,29,18944]{2,1,0} aten::silu(%1823), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1825 = bf16[1,29,18944]{2,1,0} aten::mul(%1824, %1818), scope=aten::mul.725, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1826 = bf16[29,18944]{1,0} aten::view(%1825), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1827 = bf16[29,3584]{1,0} aten::mm(%1826, %379), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1828 = bf16[1,29,3584]{2,1,0} aten::view(%1827), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1829 = bf16[1,29,3584]{2,1,0} aten::add(%1806, %1828, %377), scope=aten::add.726, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1830 = f32[1,29,3584]{2,1,0} xla::cast(%1829), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1831 = f32[1,29,3584]{2,1,0} aten::pow(%1830, %376), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1832 = f32[1,29,1]{2,1,0} aten::mean(%1831), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1833 = f32[1,29,1]{2,1,0} aten::add(%1832, %375, %374), scope=aten::add.727, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1834 = f32[1,29,1]{2,1,0} aten::rsqrt(%1833), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1835 = f32[1,29,3584]{2,1,0} aten::mul(%1830, %1834), scope=aten::mul.728, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1836 = bf16[1,29,3584]{2,1,0} xla::cast(%1835), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1837 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1838 = bf16[1,29,3584]{2,1,0} aten::mul(%1837, %1836), scope=aten::mul.729, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1839 = bf16[29,3584]{1,0} aten::view(%1838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1840 = bf16[29,512]{1,0} aten::mm(%1839, %373), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1841 = bf16[1,29,512]{2,1,0} aten::view(%1840), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1842 = bf16[1,29,512]{2,1,0} aten::add(%1841, %371, %370), scope=aten::add.732, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1843 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1842), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1844 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1843), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1845 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1846 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1847 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1846), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1848 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1847), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1849 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1848), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1850 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1849), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1851 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1850), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1852 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1851), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1853 = bf16[28,29,128]{2,1,0} aten::view(%1852), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1854 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1855 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1856 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1857 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1858 = s64[1,29]{1,0} aten::expand(%1857), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1859 = s64[1,29]{1,0} aten::add(%632, %1858), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1860 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1861 = pred[1,29]{1,0} aten::lt(%632, %1860), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1862 = s64[1,29]{1,0} aten::where(%1861, %1859, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1863 = s64[1,29,1]{2,1,0} aten::stack(%1862), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1864 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1865 = bf16[29,128]{1,0} xla::select(%1864), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1866 = bf16[1,29,128]{2,1,0} aten::index(%1865, %1863), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1867 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1866), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1868 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1869 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1870 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1871 = bf16[3584,512]{0,1} aten::permute(%1870), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1872 = bf16[29,3584]{1,0} aten::view(%1838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1873 = bf16[29,512]{1,0} aten::mm(%1872, %1871), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1874 = bf16[1,29,512]{2,1,0} aten::view(%1873), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1875 = bf16[1,29,512]{2,1,0} aten::add(%1874, %1869, %1868), scope=aten::add.731, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1876 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1875), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1877 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1876), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1878 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1877), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1879 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1877), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1880 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1879), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1881 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1880, %1878), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1882 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1881, %1867), scope=aten::mul.737, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1883 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1884 = s64[1,29]{1,0} aten::expand(%1883), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1885 = s64[1,29]{1,0} aten::add(%632, %1884), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1886 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1887 = pred[1,29]{1,0} aten::lt(%632, %1886), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1888 = s64[1,29]{1,0} aten::where(%1887, %1885, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1889 = s64[1,29,1]{2,1,0} aten::stack(%1888), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1890 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1891 = bf16[29,128]{1,0} xla::select(%1890), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1892 = bf16[1,29,128]{2,1,0} aten::index(%1891, %1889), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1893 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1892), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1894 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1877, %1893), scope=aten::mul.736, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1895 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1894, %1882, %1856), scope=aten::add.738, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1896 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1895), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1897 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1896), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1898 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1897), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1899 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1898), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1900 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1899), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1901 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1900), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1902 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1901), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1903 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1902), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1904 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1903), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1905 = bf16[28,128,29]{2,1,0} aten::view(%1904), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1906 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1907 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1908 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1909 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1910 = bf16[3584,3584]{0,1} aten::permute(%1909), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1911 = bf16[29,3584]{1,0} aten::view(%1838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1912 = bf16[29,3584]{1,0} aten::mm(%1911, %1910), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1913 = bf16[1,29,3584]{2,1,0} aten::view(%1912), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1914 = bf16[1,29,3584]{2,1,0} aten::add(%1913, %1908, %1907), scope=aten::add.730, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1915 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1914), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1916 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1915), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1917 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1916), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1918 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1916), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1919 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1918), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1920 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1919, %1917), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1921 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1920, %1867), scope=aten::mul.734, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1922 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1916, %1893), scope=aten::mul.733, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1923 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1922, %1921, %1906), scope=aten::add.735, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1924 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1923), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1925 = bf16[28,29,128]{2,1,0} aten::view(%1924), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1926 = bf16[28,29,29]{2,1,0} aten::matmul(%1925, %1905), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1927 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1926), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1928 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1927, %1855), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1929 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1928, %621, %1854), scope=aten::add.739, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1930 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1929), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1931 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1930), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1932 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1931), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1933 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1932), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1934 = bf16[28,29,29]{2,1,0} aten::view(%1933), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1935 = bf16[28,29,128]{2,1,0} aten::matmul(%1934, %1853), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1936 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1935), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1937 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1936), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1938 = bf16[1,29,3584]{2,1,0} aten::view(%1937), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1939 = bf16[29,3584]{1,0} aten::view(%1938), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1940 = bf16[29,3584]{1,0} aten::mm(%1939, %369), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1941 = bf16[1,29,3584]{2,1,0} aten::view(%1940), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1942 = bf16[1,29,3584]{2,1,0} aten::add(%1829, %1941, %367), scope=aten::add.740, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1943 = f32[1,29,3584]{2,1,0} xla::cast(%1942), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1944 = f32[1,29,3584]{2,1,0} aten::pow(%1943, %366), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1945 = f32[1,29,1]{2,1,0} aten::mean(%1944), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1946 = f32[1,29,1]{2,1,0} aten::add(%1945, %365, %364), scope=aten::add.741, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1947 = f32[1,29,1]{2,1,0} aten::rsqrt(%1946), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1948 = f32[1,29,3584]{2,1,0} aten::mul(%1943, %1947), scope=aten::mul.742, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1949 = bf16[1,29,3584]{2,1,0} xla::cast(%1948), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1950 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1951 = bf16[1,29,3584]{2,1,0} aten::mul(%1950, %1949), scope=aten::mul.743, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1952 = bf16[29,3584]{1,0} aten::view(%1951), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1953 = bf16[29,18944]{1,0} aten::mm(%1952, %363), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1954 = bf16[1,29,18944]{2,1,0} aten::view(%1953), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1955 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1956 = bf16[3584,18944]{0,1} aten::permute(%1955), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1957 = bf16[29,3584]{1,0} aten::view(%1951), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1958 = bf16[29,18944]{1,0} aten::mm(%1957, %1956), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1959 = bf16[1,29,18944]{2,1,0} aten::view(%1958), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1960 = bf16[1,29,18944]{2,1,0} aten::silu(%1959), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1961 = bf16[1,29,18944]{2,1,0} aten::mul(%1960, %1954), scope=aten::mul.744, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1962 = bf16[29,18944]{1,0} aten::view(%1961), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1963 = bf16[29,3584]{1,0} aten::mm(%1962, %361), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1964 = bf16[1,29,3584]{2,1,0} aten::view(%1963), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1965 = bf16[1,29,3584]{2,1,0} aten::add(%1942, %1964, %359), scope=aten::add.745, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1966 = f32[1,29,3584]{2,1,0} xla::cast(%1965), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1967 = f32[1,29,3584]{2,1,0} aten::pow(%1966, %358), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1968 = f32[1,29,1]{2,1,0} aten::mean(%1967), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1969 = f32[1,29,1]{2,1,0} aten::add(%1968, %357, %356), scope=aten::add.746, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1970 = f32[1,29,1]{2,1,0} aten::rsqrt(%1969), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1971 = f32[1,29,3584]{2,1,0} aten::mul(%1966, %1970), scope=aten::mul.747, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1972 = bf16[1,29,3584]{2,1,0} xla::cast(%1971), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1973 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1974 = bf16[1,29,3584]{2,1,0} aten::mul(%1973, %1972), scope=aten::mul.748, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1975 = bf16[29,3584]{1,0} aten::view(%1974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1976 = bf16[29,512]{1,0} aten::mm(%1975, %355), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1977 = bf16[1,29,512]{2,1,0} aten::view(%1976), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1978 = bf16[1,29,512]{2,1,0} aten::add(%1977, %353, %352), scope=aten::add.751, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1979 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1978), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1980 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1979), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1981 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1982 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1983 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1982), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1984 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1983), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1985 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1984), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1986 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1985), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1987 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1986), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1988 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1987), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1989 = bf16[28,29,128]{2,1,0} aten::view(%1988), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1990 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1991 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1992 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1993 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1994 = s64[1,29]{1,0} aten::expand(%1993), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1995 = s64[1,29]{1,0} aten::add(%632, %1994), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1996 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1997 = pred[1,29]{1,0} aten::lt(%632, %1996), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1998 = s64[1,29]{1,0} aten::where(%1997, %1995, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1999 = s64[1,29,1]{2,1,0} aten::stack(%1998), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2000 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2001 = bf16[29,128]{1,0} xla::select(%2000), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2002 = bf16[1,29,128]{2,1,0} aten::index(%2001, %1999), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2003 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2002), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2004 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2005 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2006 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2007 = bf16[3584,512]{0,1} aten::permute(%2006), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2008 = bf16[29,3584]{1,0} aten::view(%1974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2009 = bf16[29,512]{1,0} aten::mm(%2008, %2007), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2010 = bf16[1,29,512]{2,1,0} aten::view(%2009), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2011 = bf16[1,29,512]{2,1,0} aten::add(%2010, %2005, %2004), scope=aten::add.750, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2012 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2011), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2013 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2012), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2014 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2013), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2015 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2013), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2016 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2015), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2017 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2016, %2014), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2018 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2017, %2003), scope=aten::mul.756, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2019 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2020 = s64[1,29]{1,0} aten::expand(%2019), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2021 = s64[1,29]{1,0} aten::add(%632, %2020), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2022 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2023 = pred[1,29]{1,0} aten::lt(%632, %2022), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2024 = s64[1,29]{1,0} aten::where(%2023, %2021, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2025 = s64[1,29,1]{2,1,0} aten::stack(%2024), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2026 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2027 = bf16[29,128]{1,0} xla::select(%2026), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2028 = bf16[1,29,128]{2,1,0} aten::index(%2027, %2025), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2029 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2028), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2030 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2013, %2029), scope=aten::mul.755, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2031 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2030, %2018, %1992), scope=aten::add.757, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2032 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2031), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2033 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2032), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2034 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2033), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2035 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2034), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2036 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2035), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2037 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2036), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2038 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2037), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2039 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2038), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2040 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2039), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2041 = bf16[28,128,29]{2,1,0} aten::view(%2040), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2042 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2043 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2044 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2045 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2046 = bf16[3584,3584]{0,1} aten::permute(%2045), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2047 = bf16[29,3584]{1,0} aten::view(%1974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2048 = bf16[29,3584]{1,0} aten::mm(%2047, %2046), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2049 = bf16[1,29,3584]{2,1,0} aten::view(%2048), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2050 = bf16[1,29,3584]{2,1,0} aten::add(%2049, %2044, %2043), scope=aten::add.749, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2051 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2050), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2052 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2051), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2053 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2052), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2054 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2052), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2055 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2054), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2056 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2055, %2053), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2057 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2056, %2003), scope=aten::mul.753, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2058 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2052, %2029), scope=aten::mul.752, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2059 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2058, %2057, %2042), scope=aten::add.754, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2060 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2059), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2061 = bf16[28,29,128]{2,1,0} aten::view(%2060), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2062 = bf16[28,29,29]{2,1,0} aten::matmul(%2061, %2041), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2063 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2062), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2064 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2063, %1991), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2065 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2064, %621, %1990), scope=aten::add.758, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2066 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2065), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2067 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2066), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2068 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2067), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2069 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2068), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2070 = bf16[28,29,29]{2,1,0} aten::view(%2069), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2071 = bf16[28,29,128]{2,1,0} aten::matmul(%2070, %1989), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2072 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2071), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2073 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2072), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2074 = bf16[1,29,3584]{2,1,0} aten::view(%2073), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2075 = bf16[29,3584]{1,0} aten::view(%2074), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2076 = bf16[29,3584]{1,0} aten::mm(%2075, %351), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2077 = bf16[1,29,3584]{2,1,0} aten::view(%2076), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2078 = bf16[1,29,3584]{2,1,0} aten::add(%1965, %2077, %349), scope=aten::add.759, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2079 = f32[1,29,3584]{2,1,0} xla::cast(%2078), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2080 = f32[1,29,3584]{2,1,0} aten::pow(%2079, %348), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2081 = f32[1,29,1]{2,1,0} aten::mean(%2080), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2082 = f32[1,29,1]{2,1,0} aten::add(%2081, %347, %346), scope=aten::add.760, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2083 = f32[1,29,1]{2,1,0} aten::rsqrt(%2082), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2084 = f32[1,29,3584]{2,1,0} aten::mul(%2079, %2083), scope=aten::mul.761, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2085 = bf16[1,29,3584]{2,1,0} xla::cast(%2084), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2086 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2087 = bf16[1,29,3584]{2,1,0} aten::mul(%2086, %2085), scope=aten::mul.762, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2088 = bf16[29,3584]{1,0} aten::view(%2087), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2089 = bf16[29,18944]{1,0} aten::mm(%2088, %345), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2090 = bf16[1,29,18944]{2,1,0} aten::view(%2089), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2091 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2092 = bf16[3584,18944]{0,1} aten::permute(%2091), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2093 = bf16[29,3584]{1,0} aten::view(%2087), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2094 = bf16[29,18944]{1,0} aten::mm(%2093, %2092), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2095 = bf16[1,29,18944]{2,1,0} aten::view(%2094), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2096 = bf16[1,29,18944]{2,1,0} aten::silu(%2095), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2097 = bf16[1,29,18944]{2,1,0} aten::mul(%2096, %2090), scope=aten::mul.763, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2098 = bf16[29,18944]{1,0} aten::view(%2097), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2099 = bf16[29,3584]{1,0} aten::mm(%2098, %343), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2100 = bf16[1,29,3584]{2,1,0} aten::view(%2099), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2101 = bf16[1,29,3584]{2,1,0} aten::add(%2078, %2100, %341), scope=aten::add.764, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2102 = f32[1,29,3584]{2,1,0} xla::cast(%2101), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2103 = f32[1,29,3584]{2,1,0} aten::pow(%2102, %340), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2104 = f32[1,29,1]{2,1,0} aten::mean(%2103), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2105 = f32[1,29,1]{2,1,0} aten::add(%2104, %339, %338), scope=aten::add.765, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2106 = f32[1,29,1]{2,1,0} aten::rsqrt(%2105), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2107 = f32[1,29,3584]{2,1,0} aten::mul(%2102, %2106), scope=aten::mul.766, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2108 = bf16[1,29,3584]{2,1,0} xla::cast(%2107), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2109 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2110 = bf16[1,29,3584]{2,1,0} aten::mul(%2109, %2108), scope=aten::mul.767, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2111 = bf16[29,3584]{1,0} aten::view(%2110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2112 = bf16[29,512]{1,0} aten::mm(%2111, %337), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2113 = bf16[1,29,512]{2,1,0} aten::view(%2112), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2114 = bf16[1,29,512]{2,1,0} aten::add(%2113, %335, %334), scope=aten::add.770, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2115 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2114), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2116 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2115), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2117 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2118 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2119 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2118), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2120 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2119), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2121 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2120), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2122 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2121), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2123 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2122), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2124 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2123), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2125 = bf16[28,29,128]{2,1,0} aten::view(%2124), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2126 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2127 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2128 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2129 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2130 = s64[1,29]{1,0} aten::expand(%2129), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2131 = s64[1,29]{1,0} aten::add(%632, %2130), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2132 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2133 = pred[1,29]{1,0} aten::lt(%632, %2132), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2134 = s64[1,29]{1,0} aten::where(%2133, %2131, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2135 = s64[1,29,1]{2,1,0} aten::stack(%2134), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2136 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2137 = bf16[29,128]{1,0} xla::select(%2136), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2138 = bf16[1,29,128]{2,1,0} aten::index(%2137, %2135), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2139 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2138), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2140 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2141 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2142 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2143 = bf16[3584,512]{0,1} aten::permute(%2142), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2144 = bf16[29,3584]{1,0} aten::view(%2110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2145 = bf16[29,512]{1,0} aten::mm(%2144, %2143), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2146 = bf16[1,29,512]{2,1,0} aten::view(%2145), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2147 = bf16[1,29,512]{2,1,0} aten::add(%2146, %2141, %2140), scope=aten::add.769, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2148 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2147), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2149 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2148), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2150 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2149), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2151 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2149), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2152 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2151), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2153 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2152, %2150), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2154 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2153, %2139), scope=aten::mul.775, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2155 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2156 = s64[1,29]{1,0} aten::expand(%2155), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2157 = s64[1,29]{1,0} aten::add(%632, %2156), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2158 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2159 = pred[1,29]{1,0} aten::lt(%632, %2158), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2160 = s64[1,29]{1,0} aten::where(%2159, %2157, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2161 = s64[1,29,1]{2,1,0} aten::stack(%2160), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2162 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2163 = bf16[29,128]{1,0} xla::select(%2162), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2164 = bf16[1,29,128]{2,1,0} aten::index(%2163, %2161), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2165 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2164), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2166 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2149, %2165), scope=aten::mul.774, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2167 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2166, %2154, %2128), scope=aten::add.776, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2168 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2167), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2169 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2168), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2170 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2169), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2171 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2170), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2172 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2171), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2173 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2172), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2174 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2173), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2175 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2174), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2176 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2175), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2177 = bf16[28,128,29]{2,1,0} aten::view(%2176), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2178 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2179 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2180 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2181 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2182 = bf16[3584,3584]{0,1} aten::permute(%2181), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2183 = bf16[29,3584]{1,0} aten::view(%2110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2184 = bf16[29,3584]{1,0} aten::mm(%2183, %2182), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2185 = bf16[1,29,3584]{2,1,0} aten::view(%2184), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2186 = bf16[1,29,3584]{2,1,0} aten::add(%2185, %2180, %2179), scope=aten::add.768, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2187 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2186), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2188 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2187), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2189 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2188), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2190 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2188), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2191 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2190), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2192 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2191, %2189), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2193 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2192, %2139), scope=aten::mul.772, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2194 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2188, %2165), scope=aten::mul.771, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2195 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2194, %2193, %2178), scope=aten::add.773, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2196 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2195), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2197 = bf16[28,29,128]{2,1,0} aten::view(%2196), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2198 = bf16[28,29,29]{2,1,0} aten::matmul(%2197, %2177), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2199 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2198), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2200 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2199, %2127), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2201 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2200, %621, %2126), scope=aten::add.777, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2202 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2201), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2203 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2202), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2204 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2203), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2205 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2204), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2206 = bf16[28,29,29]{2,1,0} aten::view(%2205), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2207 = bf16[28,29,128]{2,1,0} aten::matmul(%2206, %2125), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2208 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2207), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2209 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2208), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2210 = bf16[1,29,3584]{2,1,0} aten::view(%2209), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2211 = bf16[29,3584]{1,0} aten::view(%2210), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2212 = bf16[29,3584]{1,0} aten::mm(%2211, %333), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2213 = bf16[1,29,3584]{2,1,0} aten::view(%2212), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2214 = bf16[1,29,3584]{2,1,0} aten::add(%2101, %2213, %331), scope=aten::add.778, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2215 = f32[1,29,3584]{2,1,0} xla::cast(%2214), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2216 = f32[1,29,3584]{2,1,0} aten::pow(%2215, %330), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2217 = f32[1,29,1]{2,1,0} aten::mean(%2216), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2218 = f32[1,29,1]{2,1,0} aten::add(%2217, %329, %328), scope=aten::add.779, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2219 = f32[1,29,1]{2,1,0} aten::rsqrt(%2218), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2220 = f32[1,29,3584]{2,1,0} aten::mul(%2215, %2219), scope=aten::mul.780, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2221 = bf16[1,29,3584]{2,1,0} xla::cast(%2220), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2222 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2223 = bf16[1,29,3584]{2,1,0} aten::mul(%2222, %2221), scope=aten::mul.781, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2224 = bf16[29,3584]{1,0} aten::view(%2223), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2225 = bf16[29,18944]{1,0} aten::mm(%2224, %327), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2226 = bf16[1,29,18944]{2,1,0} aten::view(%2225), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2227 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2228 = bf16[3584,18944]{0,1} aten::permute(%2227), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2229 = bf16[29,3584]{1,0} aten::view(%2223), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2230 = bf16[29,18944]{1,0} aten::mm(%2229, %2228), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2231 = bf16[1,29,18944]{2,1,0} aten::view(%2230), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2232 = bf16[1,29,18944]{2,1,0} aten::silu(%2231), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2233 = bf16[1,29,18944]{2,1,0} aten::mul(%2232, %2226), scope=aten::mul.782, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2234 = bf16[29,18944]{1,0} aten::view(%2233), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2235 = bf16[29,3584]{1,0} aten::mm(%2234, %325), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2236 = bf16[1,29,3584]{2,1,0} aten::view(%2235), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2237 = bf16[1,29,3584]{2,1,0} aten::add(%2214, %2236, %323), scope=aten::add.783, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2238 = f32[1,29,3584]{2,1,0} xla::cast(%2237), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2239 = f32[1,29,3584]{2,1,0} aten::pow(%2238, %322), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2240 = f32[1,29,1]{2,1,0} aten::mean(%2239), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2241 = f32[1,29,1]{2,1,0} aten::add(%2240, %321, %320), scope=aten::add.784, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2242 = f32[1,29,1]{2,1,0} aten::rsqrt(%2241), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2243 = f32[1,29,3584]{2,1,0} aten::mul(%2238, %2242), scope=aten::mul.785, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2244 = bf16[1,29,3584]{2,1,0} xla::cast(%2243), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2245 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2246 = bf16[1,29,3584]{2,1,0} aten::mul(%2245, %2244), scope=aten::mul.786, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2247 = bf16[29,3584]{1,0} aten::view(%2246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2248 = bf16[29,512]{1,0} aten::mm(%2247, %319), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2249 = bf16[1,29,512]{2,1,0} aten::view(%2248), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2250 = bf16[1,29,512]{2,1,0} aten::add(%2249, %317, %316), scope=aten::add.789, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2251 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2250), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2252 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2251), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2253 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2254 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2255 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2254), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2256 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2255), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2257 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2256), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2258 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2257), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2259 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2258), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2260 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2259), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2261 = bf16[28,29,128]{2,1,0} aten::view(%2260), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2262 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2263 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2264 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2265 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2266 = s64[1,29]{1,0} aten::expand(%2265), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2267 = s64[1,29]{1,0} aten::add(%632, %2266), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2268 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2269 = pred[1,29]{1,0} aten::lt(%632, %2268), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2270 = s64[1,29]{1,0} aten::where(%2269, %2267, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2271 = s64[1,29,1]{2,1,0} aten::stack(%2270), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2272 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2273 = bf16[29,128]{1,0} xla::select(%2272), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2274 = bf16[1,29,128]{2,1,0} aten::index(%2273, %2271), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2275 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2274), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2276 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2277 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2278 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2279 = bf16[3584,512]{0,1} aten::permute(%2278), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2280 = bf16[29,3584]{1,0} aten::view(%2246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2281 = bf16[29,512]{1,0} aten::mm(%2280, %2279), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2282 = bf16[1,29,512]{2,1,0} aten::view(%2281), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2283 = bf16[1,29,512]{2,1,0} aten::add(%2282, %2277, %2276), scope=aten::add.788, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2284 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2283), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2285 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2284), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2286 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2285), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2287 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2285), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2288 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2287), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2289 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2288, %2286), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2290 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2289, %2275), scope=aten::mul.794, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2291 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2292 = s64[1,29]{1,0} aten::expand(%2291), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2293 = s64[1,29]{1,0} aten::add(%632, %2292), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2294 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2295 = pred[1,29]{1,0} aten::lt(%632, %2294), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2296 = s64[1,29]{1,0} aten::where(%2295, %2293, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2297 = s64[1,29,1]{2,1,0} aten::stack(%2296), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2298 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2299 = bf16[29,128]{1,0} xla::select(%2298), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2300 = bf16[1,29,128]{2,1,0} aten::index(%2299, %2297), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2301 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2300), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2302 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2285, %2301), scope=aten::mul.793, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2303 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2302, %2290, %2264), scope=aten::add.795, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2304 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2303), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2305 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2304), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2306 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2305), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2307 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2306), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2308 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2307), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2309 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2308), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2310 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2309), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2311 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2310), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2312 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2311), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2313 = bf16[28,128,29]{2,1,0} aten::view(%2312), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2314 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2315 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2316 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2317 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2318 = bf16[3584,3584]{0,1} aten::permute(%2317), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2319 = bf16[29,3584]{1,0} aten::view(%2246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2320 = bf16[29,3584]{1,0} aten::mm(%2319, %2318), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2321 = bf16[1,29,3584]{2,1,0} aten::view(%2320), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2322 = bf16[1,29,3584]{2,1,0} aten::add(%2321, %2316, %2315), scope=aten::add.787, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2323 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2322), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2324 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2323), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2325 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2324), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2326 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2324), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2327 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2326), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2328 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2327, %2325), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2329 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2328, %2275), scope=aten::mul.791, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2330 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2324, %2301), scope=aten::mul.790, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2331 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2330, %2329, %2314), scope=aten::add.792, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2332 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2331), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2333 = bf16[28,29,128]{2,1,0} aten::view(%2332), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2334 = bf16[28,29,29]{2,1,0} aten::matmul(%2333, %2313), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2335 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2334), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2336 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2335, %2263), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2337 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2336, %621, %2262), scope=aten::add.796, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2338 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2337), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2339 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2338), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2340 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2339), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2341 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2340), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2342 = bf16[28,29,29]{2,1,0} aten::view(%2341), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2343 = bf16[28,29,128]{2,1,0} aten::matmul(%2342, %2261), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2344 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2343), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2345 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2344), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2346 = bf16[1,29,3584]{2,1,0} aten::view(%2345), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2347 = bf16[29,3584]{1,0} aten::view(%2346), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2348 = bf16[29,3584]{1,0} aten::mm(%2347, %315), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2349 = bf16[1,29,3584]{2,1,0} aten::view(%2348), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2350 = bf16[1,29,3584]{2,1,0} aten::add(%2237, %2349, %313), scope=aten::add.797, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2351 = f32[1,29,3584]{2,1,0} xla::cast(%2350), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2352 = f32[1,29,3584]{2,1,0} aten::pow(%2351, %312), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2353 = f32[1,29,1]{2,1,0} aten::mean(%2352), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2354 = f32[1,29,1]{2,1,0} aten::add(%2353, %311, %310), scope=aten::add.798, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2355 = f32[1,29,1]{2,1,0} aten::rsqrt(%2354), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2356 = f32[1,29,3584]{2,1,0} aten::mul(%2351, %2355), scope=aten::mul.799, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2357 = bf16[1,29,3584]{2,1,0} xla::cast(%2356), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2358 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2359 = bf16[1,29,3584]{2,1,0} aten::mul(%2358, %2357), scope=aten::mul.800, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2360 = bf16[29,3584]{1,0} aten::view(%2359), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2361 = bf16[29,18944]{1,0} aten::mm(%2360, %309), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2362 = bf16[1,29,18944]{2,1,0} aten::view(%2361), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2363 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2364 = bf16[3584,18944]{0,1} aten::permute(%2363), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2365 = bf16[29,3584]{1,0} aten::view(%2359), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2366 = bf16[29,18944]{1,0} aten::mm(%2365, %2364), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2367 = bf16[1,29,18944]{2,1,0} aten::view(%2366), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2368 = bf16[1,29,18944]{2,1,0} aten::silu(%2367), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2369 = bf16[1,29,18944]{2,1,0} aten::mul(%2368, %2362), scope=aten::mul.801, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2370 = bf16[29,18944]{1,0} aten::view(%2369), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2371 = bf16[29,3584]{1,0} aten::mm(%2370, %307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2372 = bf16[1,29,3584]{2,1,0} aten::view(%2371), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2373 = bf16[1,29,3584]{2,1,0} aten::add(%2350, %2372, %305), scope=aten::add.802, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2374 = f32[1,29,3584]{2,1,0} xla::cast(%2373), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2375 = f32[1,29,3584]{2,1,0} aten::pow(%2374, %304), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2376 = f32[1,29,1]{2,1,0} aten::mean(%2375), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2377 = f32[1,29,1]{2,1,0} aten::add(%2376, %303, %302), scope=aten::add.803, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2378 = f32[1,29,1]{2,1,0} aten::rsqrt(%2377), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2379 = f32[1,29,3584]{2,1,0} aten::mul(%2374, %2378), scope=aten::mul.804, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2380 = bf16[1,29,3584]{2,1,0} xla::cast(%2379), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2381 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2382 = bf16[1,29,3584]{2,1,0} aten::mul(%2381, %2380), scope=aten::mul.805, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2383 = bf16[29,3584]{1,0} aten::view(%2382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2384 = bf16[29,512]{1,0} aten::mm(%2383, %301), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2385 = bf16[1,29,512]{2,1,0} aten::view(%2384), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2386 = bf16[1,29,512]{2,1,0} aten::add(%2385, %299, %298), scope=aten::add.808, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2387 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2386), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2388 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2387), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2389 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2390 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2391 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2390), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2392 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2391), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2393 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2392), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2394 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2393), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2395 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2394), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2396 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2395), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2397 = bf16[28,29,128]{2,1,0} aten::view(%2396), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2398 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2399 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2400 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2401 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2402 = s64[1,29]{1,0} aten::expand(%2401), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2403 = s64[1,29]{1,0} aten::add(%632, %2402), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2404 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2405 = pred[1,29]{1,0} aten::lt(%632, %2404), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2406 = s64[1,29]{1,0} aten::where(%2405, %2403, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2407 = s64[1,29,1]{2,1,0} aten::stack(%2406), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2408 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2409 = bf16[29,128]{1,0} xla::select(%2408), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2410 = bf16[1,29,128]{2,1,0} aten::index(%2409, %2407), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2411 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2410), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2412 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2413 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2414 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2415 = bf16[3584,512]{0,1} aten::permute(%2414), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2416 = bf16[29,3584]{1,0} aten::view(%2382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2417 = bf16[29,512]{1,0} aten::mm(%2416, %2415), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2418 = bf16[1,29,512]{2,1,0} aten::view(%2417), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2419 = bf16[1,29,512]{2,1,0} aten::add(%2418, %2413, %2412), scope=aten::add.807, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2420 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2419), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2421 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2420), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2422 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2421), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2423 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2421), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2424 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2423), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2425 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2424, %2422), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2426 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2425, %2411), scope=aten::mul.813, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2427 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2428 = s64[1,29]{1,0} aten::expand(%2427), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2429 = s64[1,29]{1,0} aten::add(%632, %2428), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2430 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2431 = pred[1,29]{1,0} aten::lt(%632, %2430), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2432 = s64[1,29]{1,0} aten::where(%2431, %2429, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2433 = s64[1,29,1]{2,1,0} aten::stack(%2432), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2434 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2435 = bf16[29,128]{1,0} xla::select(%2434), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2436 = bf16[1,29,128]{2,1,0} aten::index(%2435, %2433), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2437 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2436), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2438 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2421, %2437), scope=aten::mul.812, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2439 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2438, %2426, %2400), scope=aten::add.814, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2440 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2439), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2441 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2440), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2442 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2441), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2443 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2442), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2444 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2443), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2445 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2444), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2446 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2445), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2447 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2446), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2448 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2447), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2449 = bf16[28,128,29]{2,1,0} aten::view(%2448), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2450 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2451 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2452 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2453 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2454 = bf16[3584,3584]{0,1} aten::permute(%2453), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2455 = bf16[29,3584]{1,0} aten::view(%2382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2456 = bf16[29,3584]{1,0} aten::mm(%2455, %2454), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2457 = bf16[1,29,3584]{2,1,0} aten::view(%2456), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2458 = bf16[1,29,3584]{2,1,0} aten::add(%2457, %2452, %2451), scope=aten::add.806, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2459 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2458), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2460 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2459), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2461 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2460), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2462 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2460), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2463 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2462), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2464 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2463, %2461), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2465 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2464, %2411), scope=aten::mul.810, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2466 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2460, %2437), scope=aten::mul.809, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2467 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2466, %2465, %2450), scope=aten::add.811, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2468 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2467), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2469 = bf16[28,29,128]{2,1,0} aten::view(%2468), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2470 = bf16[28,29,29]{2,1,0} aten::matmul(%2469, %2449), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2471 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2470), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2472 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2471, %2399), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2473 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2472, %621, %2398), scope=aten::add.815, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2474 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2473), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2475 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2474), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2476 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2475), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2477 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2476), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2478 = bf16[28,29,29]{2,1,0} aten::view(%2477), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2479 = bf16[28,29,128]{2,1,0} aten::matmul(%2478, %2397), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2480 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2479), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2481 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2480), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2482 = bf16[1,29,3584]{2,1,0} aten::view(%2481), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2483 = bf16[29,3584]{1,0} aten::view(%2482), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2484 = bf16[29,3584]{1,0} aten::mm(%2483, %297), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2485 = bf16[1,29,3584]{2,1,0} aten::view(%2484), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2486 = bf16[1,29,3584]{2,1,0} aten::add(%2373, %2485, %295), scope=aten::add.816, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2487 = f32[1,29,3584]{2,1,0} xla::cast(%2486), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2488 = f32[1,29,3584]{2,1,0} aten::pow(%2487, %294), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2489 = f32[1,29,1]{2,1,0} aten::mean(%2488), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2490 = f32[1,29,1]{2,1,0} aten::add(%2489, %293, %292), scope=aten::add.817, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2491 = f32[1,29,1]{2,1,0} aten::rsqrt(%2490), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2492 = f32[1,29,3584]{2,1,0} aten::mul(%2487, %2491), scope=aten::mul.818, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2493 = bf16[1,29,3584]{2,1,0} xla::cast(%2492), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2494 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2495 = bf16[1,29,3584]{2,1,0} aten::mul(%2494, %2493), scope=aten::mul.819, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2496 = bf16[29,3584]{1,0} aten::view(%2495), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2497 = bf16[29,18944]{1,0} aten::mm(%2496, %291), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2498 = bf16[1,29,18944]{2,1,0} aten::view(%2497), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2499 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2500 = bf16[3584,18944]{0,1} aten::permute(%2499), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2501 = bf16[29,3584]{1,0} aten::view(%2495), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2502 = bf16[29,18944]{1,0} aten::mm(%2501, %2500), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2503 = bf16[1,29,18944]{2,1,0} aten::view(%2502), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2504 = bf16[1,29,18944]{2,1,0} aten::silu(%2503), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2505 = bf16[1,29,18944]{2,1,0} aten::mul(%2504, %2498), scope=aten::mul.820, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2506 = bf16[29,18944]{1,0} aten::view(%2505), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2507 = bf16[29,3584]{1,0} aten::mm(%2506, %289), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2508 = bf16[1,29,3584]{2,1,0} aten::view(%2507), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2509 = bf16[1,29,3584]{2,1,0} aten::add(%2486, %2508, %287), scope=aten::add.821, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2510 = f32[1,29,3584]{2,1,0} xla::cast(%2509), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2511 = f32[1,29,3584]{2,1,0} aten::pow(%2510, %286), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2512 = f32[1,29,1]{2,1,0} aten::mean(%2511), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2513 = f32[1,29,1]{2,1,0} aten::add(%2512, %285, %284), scope=aten::add.822, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2514 = f32[1,29,1]{2,1,0} aten::rsqrt(%2513), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2515 = f32[1,29,3584]{2,1,0} aten::mul(%2510, %2514), scope=aten::mul.823, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2516 = bf16[1,29,3584]{2,1,0} xla::cast(%2515), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2517 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2518 = bf16[1,29,3584]{2,1,0} aten::mul(%2517, %2516), scope=aten::mul.824, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2519 = bf16[29,3584]{1,0} aten::view(%2518), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2520 = bf16[29,512]{1,0} aten::mm(%2519, %283), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2521 = bf16[1,29,512]{2,1,0} aten::view(%2520), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2522 = bf16[1,29,512]{2,1,0} aten::add(%2521, %281, %280), scope=aten::add.827, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2523 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2522), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2524 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2523), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2525 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2526 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2527 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2526), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2528 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2527), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2529 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2528), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2530 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2529), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2531 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2530), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2532 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2531), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2533 = bf16[28,29,128]{2,1,0} aten::view(%2532), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2534 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2535 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2536 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2537 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2538 = s64[1,29]{1,0} aten::expand(%2537), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2539 = s64[1,29]{1,0} aten::add(%632, %2538), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2540 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2541 = pred[1,29]{1,0} aten::lt(%632, %2540), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2542 = s64[1,29]{1,0} aten::where(%2541, %2539, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2543 = s64[1,29,1]{2,1,0} aten::stack(%2542), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2544 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2545 = bf16[29,128]{1,0} xla::select(%2544), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2546 = bf16[1,29,128]{2,1,0} aten::index(%2545, %2543), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2547 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2546), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2548 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2549 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2550 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2551 = bf16[3584,512]{0,1} aten::permute(%2550), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2552 = bf16[29,3584]{1,0} aten::view(%2518), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2553 = bf16[29,512]{1,0} aten::mm(%2552, %2551), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2554 = bf16[1,29,512]{2,1,0} aten::view(%2553), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2555 = bf16[1,29,512]{2,1,0} aten::add(%2554, %2549, %2548), scope=aten::add.826, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2556 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2555), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2557 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2556), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2558 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2557), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2559 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2557), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2560 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2559), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2561 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2560, %2558), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2562 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2561, %2547), scope=aten::mul.832, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2563 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2564 = s64[1,29]{1,0} aten::expand(%2563), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2565 = s64[1,29]{1,0} aten::add(%632, %2564), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2566 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2567 = pred[1,29]{1,0} aten::lt(%632, %2566), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2568 = s64[1,29]{1,0} aten::where(%2567, %2565, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2569 = s64[1,29,1]{2,1,0} aten::stack(%2568), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2570 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2571 = bf16[29,128]{1,0} xla::select(%2570), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2572 = bf16[1,29,128]{2,1,0} aten::index(%2571, %2569), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2573 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2572), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2574 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2557, %2573), scope=aten::mul.831, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2575 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2574, %2562, %2536), scope=aten::add.833, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2576 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2575), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2577 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2576), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2578 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2577), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2579 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2578), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2580 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2579), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2581 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2580), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2582 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2581), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2583 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2582), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2584 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2583), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2585 = bf16[28,128,29]{2,1,0} aten::view(%2584), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2586 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2587 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2588 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2589 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2590 = bf16[3584,3584]{0,1} aten::permute(%2589), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2591 = bf16[29,3584]{1,0} aten::view(%2518), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2592 = bf16[29,3584]{1,0} aten::mm(%2591, %2590), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2593 = bf16[1,29,3584]{2,1,0} aten::view(%2592), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2594 = bf16[1,29,3584]{2,1,0} aten::add(%2593, %2588, %2587), scope=aten::add.825, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2595 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2594), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2596 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2595), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2597 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2596), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2598 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2596), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2599 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2598), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2600 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2599, %2597), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2601 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2600, %2547), scope=aten::mul.829, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2602 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2596, %2573), scope=aten::mul.828, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2603 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2602, %2601, %2586), scope=aten::add.830, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2604 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2603), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2605 = bf16[28,29,128]{2,1,0} aten::view(%2604), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2606 = bf16[28,29,29]{2,1,0} aten::matmul(%2605, %2585), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2607 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2606), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2608 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2607, %2535), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2609 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2608, %621, %2534), scope=aten::add.834, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2610 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2609), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2611 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2610), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2612 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2611), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2613 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2612), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2614 = bf16[28,29,29]{2,1,0} aten::view(%2613), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2615 = bf16[28,29,128]{2,1,0} aten::matmul(%2614, %2533), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2616 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2615), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2617 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2616), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2618 = bf16[1,29,3584]{2,1,0} aten::view(%2617), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2619 = bf16[29,3584]{1,0} aten::view(%2618), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2620 = bf16[29,3584]{1,0} aten::mm(%2619, %279), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2621 = bf16[1,29,3584]{2,1,0} aten::view(%2620), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2622 = bf16[1,29,3584]{2,1,0} aten::add(%2509, %2621, %277), scope=aten::add.835, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2623 = f32[1,29,3584]{2,1,0} xla::cast(%2622), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2624 = f32[1,29,3584]{2,1,0} aten::pow(%2623, %276), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2625 = f32[1,29,1]{2,1,0} aten::mean(%2624), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2626 = f32[1,29,1]{2,1,0} aten::add(%2625, %275, %274), scope=aten::add.836, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2627 = f32[1,29,1]{2,1,0} aten::rsqrt(%2626), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2628 = f32[1,29,3584]{2,1,0} aten::mul(%2623, %2627), scope=aten::mul.837, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2629 = bf16[1,29,3584]{2,1,0} xla::cast(%2628), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2630 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2631 = bf16[1,29,3584]{2,1,0} aten::mul(%2630, %2629), scope=aten::mul.838, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2632 = bf16[29,3584]{1,0} aten::view(%2631), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2633 = bf16[29,18944]{1,0} aten::mm(%2632, %273), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2634 = bf16[1,29,18944]{2,1,0} aten::view(%2633), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2635 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2636 = bf16[3584,18944]{0,1} aten::permute(%2635), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2637 = bf16[29,3584]{1,0} aten::view(%2631), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2638 = bf16[29,18944]{1,0} aten::mm(%2637, %2636), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2639 = bf16[1,29,18944]{2,1,0} aten::view(%2638), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2640 = bf16[1,29,18944]{2,1,0} aten::silu(%2639), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2641 = bf16[1,29,18944]{2,1,0} aten::mul(%2640, %2634), scope=aten::mul.839, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2642 = bf16[29,18944]{1,0} aten::view(%2641), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2643 = bf16[29,3584]{1,0} aten::mm(%2642, %271), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2644 = bf16[1,29,3584]{2,1,0} aten::view(%2643), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2645 = bf16[1,29,3584]{2,1,0} aten::add(%2622, %2644, %269), scope=aten::add.840, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2646 = f32[1,29,3584]{2,1,0} xla::cast(%2645), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2647 = f32[1,29,3584]{2,1,0} aten::pow(%2646, %268), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2648 = f32[1,29,1]{2,1,0} aten::mean(%2647), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2649 = f32[1,29,1]{2,1,0} aten::add(%2648, %267, %266), scope=aten::add.841, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2650 = f32[1,29,1]{2,1,0} aten::rsqrt(%2649), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2651 = f32[1,29,3584]{2,1,0} aten::mul(%2646, %2650), scope=aten::mul.842, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2652 = bf16[1,29,3584]{2,1,0} xla::cast(%2651), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2653 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2654 = bf16[1,29,3584]{2,1,0} aten::mul(%2653, %2652), scope=aten::mul.843, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2655 = bf16[29,3584]{1,0} aten::view(%2654), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2656 = bf16[29,512]{1,0} aten::mm(%2655, %265), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2657 = bf16[1,29,512]{2,1,0} aten::view(%2656), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2658 = bf16[1,29,512]{2,1,0} aten::add(%2657, %263, %262), scope=aten::add.846, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2659 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2658), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2660 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2659), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2661 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2662 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2663 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2662), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2664 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2663), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2665 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2664), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2666 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2665), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2667 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2666), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2668 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2667), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2669 = bf16[28,29,128]{2,1,0} aten::view(%2668), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2670 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2671 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2672 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2673 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2674 = s64[1,29]{1,0} aten::expand(%2673), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2675 = s64[1,29]{1,0} aten::add(%632, %2674), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2676 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2677 = pred[1,29]{1,0} aten::lt(%632, %2676), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2678 = s64[1,29]{1,0} aten::where(%2677, %2675, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2679 = s64[1,29,1]{2,1,0} aten::stack(%2678), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2680 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2681 = bf16[29,128]{1,0} xla::select(%2680), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2682 = bf16[1,29,128]{2,1,0} aten::index(%2681, %2679), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2683 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2682), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2684 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2685 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2686 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2687 = bf16[3584,512]{0,1} aten::permute(%2686), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2688 = bf16[29,3584]{1,0} aten::view(%2654), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2689 = bf16[29,512]{1,0} aten::mm(%2688, %2687), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2690 = bf16[1,29,512]{2,1,0} aten::view(%2689), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2691 = bf16[1,29,512]{2,1,0} aten::add(%2690, %2685, %2684), scope=aten::add.845, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2692 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2691), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2693 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2692), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2694 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2693), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2695 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2693), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2696 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2695), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2697 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2696, %2694), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2698 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2697, %2683), scope=aten::mul.851, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2699 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2700 = s64[1,29]{1,0} aten::expand(%2699), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2701 = s64[1,29]{1,0} aten::add(%632, %2700), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2702 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2703 = pred[1,29]{1,0} aten::lt(%632, %2702), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2704 = s64[1,29]{1,0} aten::where(%2703, %2701, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2705 = s64[1,29,1]{2,1,0} aten::stack(%2704), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2706 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2707 = bf16[29,128]{1,0} xla::select(%2706), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2708 = bf16[1,29,128]{2,1,0} aten::index(%2707, %2705), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2709 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2708), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2710 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2693, %2709), scope=aten::mul.850, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2711 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2710, %2698, %2672), scope=aten::add.852, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2712 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2711), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2713 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2712), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2714 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2713), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2715 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2714), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2716 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2715), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2717 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2716), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2718 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2717), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2719 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2718), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2720 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2719), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2721 = bf16[28,128,29]{2,1,0} aten::view(%2720), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2722 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2723 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2724 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2725 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2726 = bf16[3584,3584]{0,1} aten::permute(%2725), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2727 = bf16[29,3584]{1,0} aten::view(%2654), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2728 = bf16[29,3584]{1,0} aten::mm(%2727, %2726), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2729 = bf16[1,29,3584]{2,1,0} aten::view(%2728), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2730 = bf16[1,29,3584]{2,1,0} aten::add(%2729, %2724, %2723), scope=aten::add.844, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2731 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2730), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2732 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2731), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2733 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2732), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2734 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2732), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2735 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2734), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2736 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2735, %2733), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2737 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2736, %2683), scope=aten::mul.848, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2738 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2732, %2709), scope=aten::mul.847, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2739 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2738, %2737, %2722), scope=aten::add.849, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2740 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2739), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2741 = bf16[28,29,128]{2,1,0} aten::view(%2740), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2742 = bf16[28,29,29]{2,1,0} aten::matmul(%2741, %2721), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2743 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2742), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2744 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2743, %2671), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2745 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2744, %621, %2670), scope=aten::add.853, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2746 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2745), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2747 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2746), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2748 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2747), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2749 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2748), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2750 = bf16[28,29,29]{2,1,0} aten::view(%2749), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2751 = bf16[28,29,128]{2,1,0} aten::matmul(%2750, %2669), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2752 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2751), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2753 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2752), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2754 = bf16[1,29,3584]{2,1,0} aten::view(%2753), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2755 = bf16[29,3584]{1,0} aten::view(%2754), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2756 = bf16[29,3584]{1,0} aten::mm(%2755, %261), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2757 = bf16[1,29,3584]{2,1,0} aten::view(%2756), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2758 = bf16[1,29,3584]{2,1,0} aten::add(%2645, %2757, %259), scope=aten::add.854, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2759 = f32[1,29,3584]{2,1,0} xla::cast(%2758), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2760 = f32[1,29,3584]{2,1,0} aten::pow(%2759, %258), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2761 = f32[1,29,1]{2,1,0} aten::mean(%2760), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2762 = f32[1,29,1]{2,1,0} aten::add(%2761, %257, %256), scope=aten::add.855, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2763 = f32[1,29,1]{2,1,0} aten::rsqrt(%2762), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2764 = f32[1,29,3584]{2,1,0} aten::mul(%2759, %2763), scope=aten::mul.856, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2765 = bf16[1,29,3584]{2,1,0} xla::cast(%2764), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2766 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2767 = bf16[1,29,3584]{2,1,0} aten::mul(%2766, %2765), scope=aten::mul.857, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2768 = bf16[29,3584]{1,0} aten::view(%2767), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2769 = bf16[29,18944]{1,0} aten::mm(%2768, %255), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2770 = bf16[1,29,18944]{2,1,0} aten::view(%2769), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2771 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2772 = bf16[3584,18944]{0,1} aten::permute(%2771), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2773 = bf16[29,3584]{1,0} aten::view(%2767), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2774 = bf16[29,18944]{1,0} aten::mm(%2773, %2772), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2775 = bf16[1,29,18944]{2,1,0} aten::view(%2774), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2776 = bf16[1,29,18944]{2,1,0} aten::silu(%2775), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2777 = bf16[1,29,18944]{2,1,0} aten::mul(%2776, %2770), scope=aten::mul.858, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2778 = bf16[29,18944]{1,0} aten::view(%2777), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2779 = bf16[29,3584]{1,0} aten::mm(%2778, %253), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2780 = bf16[1,29,3584]{2,1,0} aten::view(%2779), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2781 = bf16[1,29,3584]{2,1,0} aten::add(%2758, %2780, %251), scope=aten::add.859, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2782 = f32[1,29,3584]{2,1,0} xla::cast(%2781), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2783 = f32[1,29,3584]{2,1,0} aten::pow(%2782, %250), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2784 = f32[1,29,1]{2,1,0} aten::mean(%2783), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2785 = f32[1,29,1]{2,1,0} aten::add(%2784, %249, %248), scope=aten::add.860, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2786 = f32[1,29,1]{2,1,0} aten::rsqrt(%2785), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2787 = f32[1,29,3584]{2,1,0} aten::mul(%2782, %2786), scope=aten::mul.861, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2788 = bf16[1,29,3584]{2,1,0} xla::cast(%2787), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2789 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2790 = bf16[1,29,3584]{2,1,0} aten::mul(%2789, %2788), scope=aten::mul.862, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2791 = bf16[29,3584]{1,0} aten::view(%2790), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2792 = bf16[29,512]{1,0} aten::mm(%2791, %247), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2793 = bf16[1,29,512]{2,1,0} aten::view(%2792), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2794 = bf16[1,29,512]{2,1,0} aten::add(%2793, %245, %244), scope=aten::add.865, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2795 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2794), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2796 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2795), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2797 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2798 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2799 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2798), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2800 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2799), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2801 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2800), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2802 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2801), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2803 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2802), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2804 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2803), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2805 = bf16[28,29,128]{2,1,0} aten::view(%2804), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2806 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2807 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2808 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2809 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2810 = s64[1,29]{1,0} aten::expand(%2809), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2811 = s64[1,29]{1,0} aten::add(%632, %2810), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2812 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2813 = pred[1,29]{1,0} aten::lt(%632, %2812), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2814 = s64[1,29]{1,0} aten::where(%2813, %2811, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2815 = s64[1,29,1]{2,1,0} aten::stack(%2814), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2816 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2817 = bf16[29,128]{1,0} xla::select(%2816), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2818 = bf16[1,29,128]{2,1,0} aten::index(%2817, %2815), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2819 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2818), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2820 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2821 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2822 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2823 = bf16[3584,512]{0,1} aten::permute(%2822), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2824 = bf16[29,3584]{1,0} aten::view(%2790), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2825 = bf16[29,512]{1,0} aten::mm(%2824, %2823), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2826 = bf16[1,29,512]{2,1,0} aten::view(%2825), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2827 = bf16[1,29,512]{2,1,0} aten::add(%2826, %2821, %2820), scope=aten::add.864, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2828 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2827), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2829 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2828), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2830 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2829), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2831 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2829), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2832 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2831), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2833 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2832, %2830), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2834 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2833, %2819), scope=aten::mul.870, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2835 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2836 = s64[1,29]{1,0} aten::expand(%2835), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2837 = s64[1,29]{1,0} aten::add(%632, %2836), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2838 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2839 = pred[1,29]{1,0} aten::lt(%632, %2838), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2840 = s64[1,29]{1,0} aten::where(%2839, %2837, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2841 = s64[1,29,1]{2,1,0} aten::stack(%2840), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2842 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2843 = bf16[29,128]{1,0} xla::select(%2842), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2844 = bf16[1,29,128]{2,1,0} aten::index(%2843, %2841), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2845 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2844), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2846 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2829, %2845), scope=aten::mul.869, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2847 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2846, %2834, %2808), scope=aten::add.871, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2848 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2847), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2849 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2848), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2850 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2849), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2851 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2850), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2852 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2851), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2853 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2852), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2854 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2853), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2855 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2854), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2856 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2855), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2857 = bf16[28,128,29]{2,1,0} aten::view(%2856), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2858 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2859 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2860 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2861 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2862 = bf16[3584,3584]{0,1} aten::permute(%2861), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2863 = bf16[29,3584]{1,0} aten::view(%2790), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2864 = bf16[29,3584]{1,0} aten::mm(%2863, %2862), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2865 = bf16[1,29,3584]{2,1,0} aten::view(%2864), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2866 = bf16[1,29,3584]{2,1,0} aten::add(%2865, %2860, %2859), scope=aten::add.863, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2867 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2866), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2868 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2867), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2869 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2868), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2870 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2868), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2871 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2870), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2872 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2871, %2869), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2873 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2872, %2819), scope=aten::mul.867, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2874 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2868, %2845), scope=aten::mul.866, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2875 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2874, %2873, %2858), scope=aten::add.868, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2876 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2875), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2877 = bf16[28,29,128]{2,1,0} aten::view(%2876), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2878 = bf16[28,29,29]{2,1,0} aten::matmul(%2877, %2857), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2879 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2878), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2880 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2879, %2807), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2881 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2880, %621, %2806), scope=aten::add.872, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2882 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2881), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2883 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2882), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2884 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2883), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2885 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2884), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2886 = bf16[28,29,29]{2,1,0} aten::view(%2885), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2887 = bf16[28,29,128]{2,1,0} aten::matmul(%2886, %2805), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2888 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2887), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2889 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2888), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2890 = bf16[1,29,3584]{2,1,0} aten::view(%2889), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2891 = bf16[29,3584]{1,0} aten::view(%2890), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2892 = bf16[29,3584]{1,0} aten::mm(%2891, %243), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2893 = bf16[1,29,3584]{2,1,0} aten::view(%2892), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2894 = bf16[1,29,3584]{2,1,0} aten::add(%2781, %2893, %241), scope=aten::add.873, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2895 = f32[1,29,3584]{2,1,0} xla::cast(%2894), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2896 = f32[1,29,3584]{2,1,0} aten::pow(%2895, %240), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2897 = f32[1,29,1]{2,1,0} aten::mean(%2896), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2898 = f32[1,29,1]{2,1,0} aten::add(%2897, %239, %238), scope=aten::add.874, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2899 = f32[1,29,1]{2,1,0} aten::rsqrt(%2898), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2900 = f32[1,29,3584]{2,1,0} aten::mul(%2895, %2899), scope=aten::mul.875, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2901 = bf16[1,29,3584]{2,1,0} xla::cast(%2900), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2902 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2903 = bf16[1,29,3584]{2,1,0} aten::mul(%2902, %2901), scope=aten::mul.876, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2904 = bf16[29,3584]{1,0} aten::view(%2903), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2905 = bf16[29,18944]{1,0} aten::mm(%2904, %237), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2906 = bf16[1,29,18944]{2,1,0} aten::view(%2905), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2907 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2908 = bf16[3584,18944]{0,1} aten::permute(%2907), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2909 = bf16[29,3584]{1,0} aten::view(%2903), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2910 = bf16[29,18944]{1,0} aten::mm(%2909, %2908), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2911 = bf16[1,29,18944]{2,1,0} aten::view(%2910), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2912 = bf16[1,29,18944]{2,1,0} aten::silu(%2911), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2913 = bf16[1,29,18944]{2,1,0} aten::mul(%2912, %2906), scope=aten::mul.877, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2914 = bf16[29,18944]{1,0} aten::view(%2913), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2915 = bf16[29,3584]{1,0} aten::mm(%2914, %235), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2916 = bf16[1,29,3584]{2,1,0} aten::view(%2915), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2917 = bf16[1,29,3584]{2,1,0} aten::add(%2894, %2916, %233), scope=aten::add.878, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2918 = f32[1,29,3584]{2,1,0} xla::cast(%2917), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2919 = f32[1,29,3584]{2,1,0} aten::pow(%2918, %232), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2920 = f32[1,29,1]{2,1,0} aten::mean(%2919), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2921 = f32[1,29,1]{2,1,0} aten::add(%2920, %231, %230), scope=aten::add.879, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2922 = f32[1,29,1]{2,1,0} aten::rsqrt(%2921), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2923 = f32[1,29,3584]{2,1,0} aten::mul(%2918, %2922), scope=aten::mul.880, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2924 = bf16[1,29,3584]{2,1,0} xla::cast(%2923), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2925 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2926 = bf16[1,29,3584]{2,1,0} aten::mul(%2925, %2924), scope=aten::mul.881, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2927 = bf16[29,3584]{1,0} aten::view(%2926), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2928 = bf16[29,512]{1,0} aten::mm(%2927, %229), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2929 = bf16[1,29,512]{2,1,0} aten::view(%2928), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2930 = bf16[1,29,512]{2,1,0} aten::add(%2929, %227, %226), scope=aten::add.884, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2931 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2930), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2932 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2931), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2933 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2934 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2935 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2934), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2936 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2935), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2937 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2936), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2938 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2937), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2939 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2938), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2940 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2939), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2941 = bf16[28,29,128]{2,1,0} aten::view(%2940), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2942 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2943 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2944 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2945 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2946 = s64[1,29]{1,0} aten::expand(%2945), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2947 = s64[1,29]{1,0} aten::add(%632, %2946), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2948 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2949 = pred[1,29]{1,0} aten::lt(%632, %2948), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2950 = s64[1,29]{1,0} aten::where(%2949, %2947, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2951 = s64[1,29,1]{2,1,0} aten::stack(%2950), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2952 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2953 = bf16[29,128]{1,0} xla::select(%2952), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2954 = bf16[1,29,128]{2,1,0} aten::index(%2953, %2951), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2955 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2954), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2956 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2957 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2958 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2959 = bf16[3584,512]{0,1} aten::permute(%2958), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2960 = bf16[29,3584]{1,0} aten::view(%2926), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2961 = bf16[29,512]{1,0} aten::mm(%2960, %2959), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2962 = bf16[1,29,512]{2,1,0} aten::view(%2961), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2963 = bf16[1,29,512]{2,1,0} aten::add(%2962, %2957, %2956), scope=aten::add.883, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2964 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2963), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2965 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2964), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2966 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2965), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2967 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2965), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2968 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2967), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2969 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2968, %2966), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2970 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2969, %2955), scope=aten::mul.889, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2971 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2972 = s64[1,29]{1,0} aten::expand(%2971), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2973 = s64[1,29]{1,0} aten::add(%632, %2972), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2974 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2975 = pred[1,29]{1,0} aten::lt(%632, %2974), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2976 = s64[1,29]{1,0} aten::where(%2975, %2973, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2977 = s64[1,29,1]{2,1,0} aten::stack(%2976), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2978 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2979 = bf16[29,128]{1,0} xla::select(%2978), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2980 = bf16[1,29,128]{2,1,0} aten::index(%2979, %2977), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2981 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2980), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2982 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2965, %2981), scope=aten::mul.888, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2983 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2982, %2970, %2944), scope=aten::add.890, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2984 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2983), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2985 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2984), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2986 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2985), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2987 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2986), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2988 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2987), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2989 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2988), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2990 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2989), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2991 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2990), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2992 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2991), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2993 = bf16[28,128,29]{2,1,0} aten::view(%2992), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2994 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2995 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2996 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2997 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2998 = bf16[3584,3584]{0,1} aten::permute(%2997), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2999 = bf16[29,3584]{1,0} aten::view(%2926), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3000 = bf16[29,3584]{1,0} aten::mm(%2999, %2998), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3001 = bf16[1,29,3584]{2,1,0} aten::view(%3000), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3002 = bf16[1,29,3584]{2,1,0} aten::add(%3001, %2996, %2995), scope=aten::add.882, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3003 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3002), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3004 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3003), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3005 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3004), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3006 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3004), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3007 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3006), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3008 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3007, %3005), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3009 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3008, %2955), scope=aten::mul.886, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3010 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3004, %2981), scope=aten::mul.885, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3011 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3010, %3009, %2994), scope=aten::add.887, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3012 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3011), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3013 = bf16[28,29,128]{2,1,0} aten::view(%3012), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3014 = bf16[28,29,29]{2,1,0} aten::matmul(%3013, %2993), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3015 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3014), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3016 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3015, %2943), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3017 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3016, %621, %2942), scope=aten::add.891, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3018 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3017), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3019 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3018), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3020 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3019), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3021 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3020), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3022 = bf16[28,29,29]{2,1,0} aten::view(%3021), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3023 = bf16[28,29,128]{2,1,0} aten::matmul(%3022, %2941), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3024 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3023), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3025 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3024), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3026 = bf16[1,29,3584]{2,1,0} aten::view(%3025), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3027 = bf16[29,3584]{1,0} aten::view(%3026), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3028 = bf16[29,3584]{1,0} aten::mm(%3027, %225), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3029 = bf16[1,29,3584]{2,1,0} aten::view(%3028), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3030 = bf16[1,29,3584]{2,1,0} aten::add(%2917, %3029, %223), scope=aten::add.892, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3031 = f32[1,29,3584]{2,1,0} xla::cast(%3030), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3032 = f32[1,29,3584]{2,1,0} aten::pow(%3031, %222), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3033 = f32[1,29,1]{2,1,0} aten::mean(%3032), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3034 = f32[1,29,1]{2,1,0} aten::add(%3033, %221, %220), scope=aten::add.893, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3035 = f32[1,29,1]{2,1,0} aten::rsqrt(%3034), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3036 = f32[1,29,3584]{2,1,0} aten::mul(%3031, %3035), scope=aten::mul.894, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3037 = bf16[1,29,3584]{2,1,0} xla::cast(%3036), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3038 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3039 = bf16[1,29,3584]{2,1,0} aten::mul(%3038, %3037), scope=aten::mul.895, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3040 = bf16[29,3584]{1,0} aten::view(%3039), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3041 = bf16[29,18944]{1,0} aten::mm(%3040, %219), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3042 = bf16[1,29,18944]{2,1,0} aten::view(%3041), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3043 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3044 = bf16[3584,18944]{0,1} aten::permute(%3043), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3045 = bf16[29,3584]{1,0} aten::view(%3039), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3046 = bf16[29,18944]{1,0} aten::mm(%3045, %3044), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3047 = bf16[1,29,18944]{2,1,0} aten::view(%3046), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3048 = bf16[1,29,18944]{2,1,0} aten::silu(%3047), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3049 = bf16[1,29,18944]{2,1,0} aten::mul(%3048, %3042), scope=aten::mul.896, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3050 = bf16[29,18944]{1,0} aten::view(%3049), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3051 = bf16[29,3584]{1,0} aten::mm(%3050, %217), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3052 = bf16[1,29,3584]{2,1,0} aten::view(%3051), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3053 = bf16[1,29,3584]{2,1,0} aten::add(%3030, %3052, %215), scope=aten::add.897, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3054 = f32[1,29,3584]{2,1,0} xla::cast(%3053), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3055 = f32[1,29,3584]{2,1,0} aten::pow(%3054, %214), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3056 = f32[1,29,1]{2,1,0} aten::mean(%3055), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3057 = f32[1,29,1]{2,1,0} aten::add(%3056, %213, %212), scope=aten::add.898, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3058 = f32[1,29,1]{2,1,0} aten::rsqrt(%3057), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3059 = f32[1,29,3584]{2,1,0} aten::mul(%3054, %3058), scope=aten::mul.899, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3060 = bf16[1,29,3584]{2,1,0} xla::cast(%3059), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3061 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3062 = bf16[1,29,3584]{2,1,0} aten::mul(%3061, %3060), scope=aten::mul.900, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3063 = bf16[29,3584]{1,0} aten::view(%3062), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3064 = bf16[29,512]{1,0} aten::mm(%3063, %211), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3065 = bf16[1,29,512]{2,1,0} aten::view(%3064), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3066 = bf16[1,29,512]{2,1,0} aten::add(%3065, %209, %208), scope=aten::add.903, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3067 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3066), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3068 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3067), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3069 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3070 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3071 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3070), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3072 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3071), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3073 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3072), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3074 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3073), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3075 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3074), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3076 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3075), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3077 = bf16[28,29,128]{2,1,0} aten::view(%3076), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3078 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3079 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3080 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3081 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3082 = s64[1,29]{1,0} aten::expand(%3081), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3083 = s64[1,29]{1,0} aten::add(%632, %3082), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3084 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3085 = pred[1,29]{1,0} aten::lt(%632, %3084), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3086 = s64[1,29]{1,0} aten::where(%3085, %3083, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3087 = s64[1,29,1]{2,1,0} aten::stack(%3086), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3088 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3089 = bf16[29,128]{1,0} xla::select(%3088), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3090 = bf16[1,29,128]{2,1,0} aten::index(%3089, %3087), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3091 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3090), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3092 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3093 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3094 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3095 = bf16[3584,512]{0,1} aten::permute(%3094), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3096 = bf16[29,3584]{1,0} aten::view(%3062), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3097 = bf16[29,512]{1,0} aten::mm(%3096, %3095), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3098 = bf16[1,29,512]{2,1,0} aten::view(%3097), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3099 = bf16[1,29,512]{2,1,0} aten::add(%3098, %3093, %3092), scope=aten::add.902, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3100 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3099), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3101 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3100), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3102 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3101), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3103 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3101), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3104 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3103), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3105 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3104, %3102), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3106 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3105, %3091), scope=aten::mul.908, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3107 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3108 = s64[1,29]{1,0} aten::expand(%3107), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3109 = s64[1,29]{1,0} aten::add(%632, %3108), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3110 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3111 = pred[1,29]{1,0} aten::lt(%632, %3110), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3112 = s64[1,29]{1,0} aten::where(%3111, %3109, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3113 = s64[1,29,1]{2,1,0} aten::stack(%3112), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3114 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3115 = bf16[29,128]{1,0} xla::select(%3114), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3116 = bf16[1,29,128]{2,1,0} aten::index(%3115, %3113), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3117 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3116), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3118 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3101, %3117), scope=aten::mul.907, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3119 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3118, %3106, %3080), scope=aten::add.909, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3120 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3119), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3121 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3120), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3122 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3121), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3123 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3122), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3124 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3123), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3125 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3124), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3126 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3125), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3127 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3126), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3128 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3127), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3129 = bf16[28,128,29]{2,1,0} aten::view(%3128), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3130 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3131 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3132 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3133 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3134 = bf16[3584,3584]{0,1} aten::permute(%3133), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3135 = bf16[29,3584]{1,0} aten::view(%3062), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3136 = bf16[29,3584]{1,0} aten::mm(%3135, %3134), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3137 = bf16[1,29,3584]{2,1,0} aten::view(%3136), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3138 = bf16[1,29,3584]{2,1,0} aten::add(%3137, %3132, %3131), scope=aten::add.901, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3139 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3138), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3140 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3139), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3141 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3140), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3142 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3140), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3143 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3142), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3144 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3143, %3141), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3145 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3144, %3091), scope=aten::mul.905, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3146 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3140, %3117), scope=aten::mul.904, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3147 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3146, %3145, %3130), scope=aten::add.906, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3148 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3147), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3149 = bf16[28,29,128]{2,1,0} aten::view(%3148), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3150 = bf16[28,29,29]{2,1,0} aten::matmul(%3149, %3129), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3151 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3150), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3152 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3151, %3079), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3153 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3152, %621, %3078), scope=aten::add.910, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3154 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3153), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3155 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3154), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3156 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3155), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3157 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3156), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3158 = bf16[28,29,29]{2,1,0} aten::view(%3157), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3159 = bf16[28,29,128]{2,1,0} aten::matmul(%3158, %3077), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3160 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3159), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3161 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3160), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3162 = bf16[1,29,3584]{2,1,0} aten::view(%3161), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3163 = bf16[29,3584]{1,0} aten::view(%3162), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3164 = bf16[29,3584]{1,0} aten::mm(%3163, %207), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3165 = bf16[1,29,3584]{2,1,0} aten::view(%3164), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3166 = bf16[1,29,3584]{2,1,0} aten::add(%3053, %3165, %205), scope=aten::add.911, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3167 = f32[1,29,3584]{2,1,0} xla::cast(%3166), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3168 = f32[1,29,3584]{2,1,0} aten::pow(%3167, %204), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3169 = f32[1,29,1]{2,1,0} aten::mean(%3168), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3170 = f32[1,29,1]{2,1,0} aten::add(%3169, %203, %202), scope=aten::add.912, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3171 = f32[1,29,1]{2,1,0} aten::rsqrt(%3170), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3172 = f32[1,29,3584]{2,1,0} aten::mul(%3167, %3171), scope=aten::mul.913, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3173 = bf16[1,29,3584]{2,1,0} xla::cast(%3172), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3174 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3175 = bf16[1,29,3584]{2,1,0} aten::mul(%3174, %3173), scope=aten::mul.914, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3176 = bf16[29,3584]{1,0} aten::view(%3175), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3177 = bf16[29,18944]{1,0} aten::mm(%3176, %201), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3178 = bf16[1,29,18944]{2,1,0} aten::view(%3177), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3179 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3180 = bf16[3584,18944]{0,1} aten::permute(%3179), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3181 = bf16[29,3584]{1,0} aten::view(%3175), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3182 = bf16[29,18944]{1,0} aten::mm(%3181, %3180), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3183 = bf16[1,29,18944]{2,1,0} aten::view(%3182), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3184 = bf16[1,29,18944]{2,1,0} aten::silu(%3183), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3185 = bf16[1,29,18944]{2,1,0} aten::mul(%3184, %3178), scope=aten::mul.915, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3186 = bf16[29,18944]{1,0} aten::view(%3185), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3187 = bf16[29,3584]{1,0} aten::mm(%3186, %199), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3188 = bf16[1,29,3584]{2,1,0} aten::view(%3187), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3189 = bf16[1,29,3584]{2,1,0} aten::add(%3166, %3188, %197), scope=aten::add.916, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3190 = f32[1,29,3584]{2,1,0} xla::cast(%3189), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3191 = f32[1,29,3584]{2,1,0} aten::pow(%3190, %196), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3192 = f32[1,29,1]{2,1,0} aten::mean(%3191), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3193 = f32[1,29,1]{2,1,0} aten::add(%3192, %195, %194), scope=aten::add.917, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3194 = f32[1,29,1]{2,1,0} aten::rsqrt(%3193), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3195 = f32[1,29,3584]{2,1,0} aten::mul(%3190, %3194), scope=aten::mul.918, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3196 = bf16[1,29,3584]{2,1,0} xla::cast(%3195), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3197 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3198 = bf16[1,29,3584]{2,1,0} aten::mul(%3197, %3196), scope=aten::mul.919, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3199 = bf16[29,3584]{1,0} aten::view(%3198), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3200 = bf16[29,512]{1,0} aten::mm(%3199, %193), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3201 = bf16[1,29,512]{2,1,0} aten::view(%3200), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3202 = bf16[1,29,512]{2,1,0} aten::add(%3201, %191, %190), scope=aten::add.922, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3203 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3202), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3204 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3203), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3205 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3206 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3207 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3206), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3208 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3207), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3209 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3208), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3210 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3209), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3211 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3210), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3212 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3211), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3213 = bf16[28,29,128]{2,1,0} aten::view(%3212), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3214 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3215 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3216 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3217 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3218 = s64[1,29]{1,0} aten::expand(%3217), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3219 = s64[1,29]{1,0} aten::add(%632, %3218), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3220 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3221 = pred[1,29]{1,0} aten::lt(%632, %3220), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3222 = s64[1,29]{1,0} aten::where(%3221, %3219, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3223 = s64[1,29,1]{2,1,0} aten::stack(%3222), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3224 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3225 = bf16[29,128]{1,0} xla::select(%3224), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3226 = bf16[1,29,128]{2,1,0} aten::index(%3225, %3223), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3227 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3226), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3228 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3229 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3230 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3231 = bf16[3584,512]{0,1} aten::permute(%3230), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3232 = bf16[29,3584]{1,0} aten::view(%3198), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3233 = bf16[29,512]{1,0} aten::mm(%3232, %3231), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3234 = bf16[1,29,512]{2,1,0} aten::view(%3233), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3235 = bf16[1,29,512]{2,1,0} aten::add(%3234, %3229, %3228), scope=aten::add.921, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3236 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3235), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3237 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3236), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3238 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3237), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3239 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3237), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3240 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3239), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3241 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3240, %3238), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3242 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3241, %3227), scope=aten::mul.927, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3243 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3244 = s64[1,29]{1,0} aten::expand(%3243), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3245 = s64[1,29]{1,0} aten::add(%632, %3244), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3246 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3247 = pred[1,29]{1,0} aten::lt(%632, %3246), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3248 = s64[1,29]{1,0} aten::where(%3247, %3245, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3249 = s64[1,29,1]{2,1,0} aten::stack(%3248), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3250 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3251 = bf16[29,128]{1,0} xla::select(%3250), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3252 = bf16[1,29,128]{2,1,0} aten::index(%3251, %3249), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3253 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3252), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3254 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3237, %3253), scope=aten::mul.926, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3255 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3254, %3242, %3216), scope=aten::add.928, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3256 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3255), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3257 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3256), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3258 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3257), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3259 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3258), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3260 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3259), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3261 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3260), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3262 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3261), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3263 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3262), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3264 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3263), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3265 = bf16[28,128,29]{2,1,0} aten::view(%3264), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3266 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3267 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3268 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3269 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3270 = bf16[3584,3584]{0,1} aten::permute(%3269), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3271 = bf16[29,3584]{1,0} aten::view(%3198), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3272 = bf16[29,3584]{1,0} aten::mm(%3271, %3270), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3273 = bf16[1,29,3584]{2,1,0} aten::view(%3272), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3274 = bf16[1,29,3584]{2,1,0} aten::add(%3273, %3268, %3267), scope=aten::add.920, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3275 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3274), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3276 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3275), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3277 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3276), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3278 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3276), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3279 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3278), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3280 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3279, %3277), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3281 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3280, %3227), scope=aten::mul.924, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3282 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3276, %3253), scope=aten::mul.923, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3283 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3282, %3281, %3266), scope=aten::add.925, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3284 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3283), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3285 = bf16[28,29,128]{2,1,0} aten::view(%3284), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3286 = bf16[28,29,29]{2,1,0} aten::matmul(%3285, %3265), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3287 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3286), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3288 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3287, %3215), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3289 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3288, %621, %3214), scope=aten::add.929, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3290 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3289), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3291 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3290), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3292 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3291), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3293 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3292), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3294 = bf16[28,29,29]{2,1,0} aten::view(%3293), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3295 = bf16[28,29,128]{2,1,0} aten::matmul(%3294, %3213), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3296 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3295), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3297 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3296), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3298 = bf16[1,29,3584]{2,1,0} aten::view(%3297), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3299 = bf16[29,3584]{1,0} aten::view(%3298), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3300 = bf16[29,3584]{1,0} aten::mm(%3299, %189), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3301 = bf16[1,29,3584]{2,1,0} aten::view(%3300), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3302 = bf16[1,29,3584]{2,1,0} aten::add(%3189, %3301, %187), scope=aten::add.930, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3303 = f32[1,29,3584]{2,1,0} xla::cast(%3302), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3304 = f32[1,29,3584]{2,1,0} aten::pow(%3303, %186), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3305 = f32[1,29,1]{2,1,0} aten::mean(%3304), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3306 = f32[1,29,1]{2,1,0} aten::add(%3305, %185, %184), scope=aten::add.931, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3307 = f32[1,29,1]{2,1,0} aten::rsqrt(%3306), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3308 = f32[1,29,3584]{2,1,0} aten::mul(%3303, %3307), scope=aten::mul.932, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3309 = bf16[1,29,3584]{2,1,0} xla::cast(%3308), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3310 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3311 = bf16[1,29,3584]{2,1,0} aten::mul(%3310, %3309), scope=aten::mul.933, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3312 = bf16[29,3584]{1,0} aten::view(%3311), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3313 = bf16[29,18944]{1,0} aten::mm(%3312, %183), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3314 = bf16[1,29,18944]{2,1,0} aten::view(%3313), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3315 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3316 = bf16[3584,18944]{0,1} aten::permute(%3315), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3317 = bf16[29,3584]{1,0} aten::view(%3311), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3318 = bf16[29,18944]{1,0} aten::mm(%3317, %3316), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3319 = bf16[1,29,18944]{2,1,0} aten::view(%3318), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3320 = bf16[1,29,18944]{2,1,0} aten::silu(%3319), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3321 = bf16[1,29,18944]{2,1,0} aten::mul(%3320, %3314), scope=aten::mul.934, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3322 = bf16[29,18944]{1,0} aten::view(%3321), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3323 = bf16[29,3584]{1,0} aten::mm(%3322, %181), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3324 = bf16[1,29,3584]{2,1,0} aten::view(%3323), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3325 = bf16[1,29,3584]{2,1,0} aten::add(%3302, %3324, %179), scope=aten::add.935, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3326 = f32[1,29,3584]{2,1,0} xla::cast(%3325), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3327 = f32[1,29,3584]{2,1,0} aten::pow(%3326, %178), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3328 = f32[1,29,1]{2,1,0} aten::mean(%3327), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3329 = f32[1,29,1]{2,1,0} aten::add(%3328, %177, %176), scope=aten::add.936, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3330 = f32[1,29,1]{2,1,0} aten::rsqrt(%3329), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3331 = f32[1,29,3584]{2,1,0} aten::mul(%3326, %3330), scope=aten::mul.937, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3332 = bf16[1,29,3584]{2,1,0} xla::cast(%3331), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3333 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3334 = bf16[1,29,3584]{2,1,0} aten::mul(%3333, %3332), scope=aten::mul.938, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3335 = bf16[29,3584]{1,0} aten::view(%3334), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3336 = bf16[29,512]{1,0} aten::mm(%3335, %175), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3337 = bf16[1,29,512]{2,1,0} aten::view(%3336), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3338 = bf16[1,29,512]{2,1,0} aten::add(%3337, %173, %172), scope=aten::add.941, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3339 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3338), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3340 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3339), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3341 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3342 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3343 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3342), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3344 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3343), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3345 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3344), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3346 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3345), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3347 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3346), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3348 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3347), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3349 = bf16[28,29,128]{2,1,0} aten::view(%3348), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3350 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3351 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3352 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3353 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3354 = s64[1,29]{1,0} aten::expand(%3353), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3355 = s64[1,29]{1,0} aten::add(%632, %3354), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3356 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3357 = pred[1,29]{1,0} aten::lt(%632, %3356), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3358 = s64[1,29]{1,0} aten::where(%3357, %3355, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3359 = s64[1,29,1]{2,1,0} aten::stack(%3358), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3360 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3361 = bf16[29,128]{1,0} xla::select(%3360), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3362 = bf16[1,29,128]{2,1,0} aten::index(%3361, %3359), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3363 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3362), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3364 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3365 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3366 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3367 = bf16[3584,512]{0,1} aten::permute(%3366), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3368 = bf16[29,3584]{1,0} aten::view(%3334), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3369 = bf16[29,512]{1,0} aten::mm(%3368, %3367), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3370 = bf16[1,29,512]{2,1,0} aten::view(%3369), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3371 = bf16[1,29,512]{2,1,0} aten::add(%3370, %3365, %3364), scope=aten::add.940, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3372 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3371), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3373 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3372), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3374 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3373), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3375 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3373), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3376 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3375), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3377 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3376, %3374), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3378 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3377, %3363), scope=aten::mul.946, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3379 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3380 = s64[1,29]{1,0} aten::expand(%3379), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3381 = s64[1,29]{1,0} aten::add(%632, %3380), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3382 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3383 = pred[1,29]{1,0} aten::lt(%632, %3382), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3384 = s64[1,29]{1,0} aten::where(%3383, %3381, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3385 = s64[1,29,1]{2,1,0} aten::stack(%3384), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3386 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3387 = bf16[29,128]{1,0} xla::select(%3386), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3388 = bf16[1,29,128]{2,1,0} aten::index(%3387, %3385), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3389 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3388), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3390 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3373, %3389), scope=aten::mul.945, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3391 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3390, %3378, %3352), scope=aten::add.947, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3392 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3391), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3393 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3392), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3394 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3393), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3395 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3394), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3396 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3395), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3397 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3396), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3398 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3397), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3399 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3398), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3400 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3399), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3401 = bf16[28,128,29]{2,1,0} aten::view(%3400), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3402 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3403 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3404 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3405 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3406 = bf16[3584,3584]{0,1} aten::permute(%3405), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3407 = bf16[29,3584]{1,0} aten::view(%3334), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3408 = bf16[29,3584]{1,0} aten::mm(%3407, %3406), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3409 = bf16[1,29,3584]{2,1,0} aten::view(%3408), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3410 = bf16[1,29,3584]{2,1,0} aten::add(%3409, %3404, %3403), scope=aten::add.939, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3411 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3410), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3412 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3411), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3413 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3412), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3414 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3412), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3415 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3414), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3416 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3415, %3413), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3417 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3416, %3363), scope=aten::mul.943, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3418 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3412, %3389), scope=aten::mul.942, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3419 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3418, %3417, %3402), scope=aten::add.944, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3420 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3419), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3421 = bf16[28,29,128]{2,1,0} aten::view(%3420), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3422 = bf16[28,29,29]{2,1,0} aten::matmul(%3421, %3401), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3423 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3422), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3424 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3423, %3351), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3425 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3424, %621, %3350), scope=aten::add.948, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3426 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3425), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3427 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3426), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3428 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3427), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3429 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3428), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3430 = bf16[28,29,29]{2,1,0} aten::view(%3429), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3431 = bf16[28,29,128]{2,1,0} aten::matmul(%3430, %3349), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3432 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3431), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3433 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3432), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3434 = bf16[1,29,3584]{2,1,0} aten::view(%3433), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3435 = bf16[29,3584]{1,0} aten::view(%3434), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3436 = bf16[29,3584]{1,0} aten::mm(%3435, %171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3437 = bf16[1,29,3584]{2,1,0} aten::view(%3436), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3438 = bf16[1,29,3584]{2,1,0} aten::add(%3325, %3437, %169), scope=aten::add.949, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3439 = f32[1,29,3584]{2,1,0} xla::cast(%3438), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3440 = f32[1,29,3584]{2,1,0} aten::pow(%3439, %168), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3441 = f32[1,29,1]{2,1,0} aten::mean(%3440), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3442 = f32[1,29,1]{2,1,0} aten::add(%3441, %167, %166), scope=aten::add.950, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3443 = f32[1,29,1]{2,1,0} aten::rsqrt(%3442), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3444 = f32[1,29,3584]{2,1,0} aten::mul(%3439, %3443), scope=aten::mul.951, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3445 = bf16[1,29,3584]{2,1,0} xla::cast(%3444), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3446 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3447 = bf16[1,29,3584]{2,1,0} aten::mul(%3446, %3445), scope=aten::mul.952, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3448 = bf16[29,3584]{1,0} aten::view(%3447), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3449 = bf16[29,18944]{1,0} aten::mm(%3448, %165), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3450 = bf16[1,29,18944]{2,1,0} aten::view(%3449), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3451 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3452 = bf16[3584,18944]{0,1} aten::permute(%3451), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3453 = bf16[29,3584]{1,0} aten::view(%3447), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3454 = bf16[29,18944]{1,0} aten::mm(%3453, %3452), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3455 = bf16[1,29,18944]{2,1,0} aten::view(%3454), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3456 = bf16[1,29,18944]{2,1,0} aten::silu(%3455), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3457 = bf16[1,29,18944]{2,1,0} aten::mul(%3456, %3450), scope=aten::mul.953, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3458 = bf16[29,18944]{1,0} aten::view(%3457), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3459 = bf16[29,3584]{1,0} aten::mm(%3458, %163), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3460 = bf16[1,29,3584]{2,1,0} aten::view(%3459), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3461 = bf16[1,29,3584]{2,1,0} aten::add(%3438, %3460, %161), scope=aten::add.954, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3462 = f32[1,29,3584]{2,1,0} xla::cast(%3461), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3463 = f32[1,29,3584]{2,1,0} aten::pow(%3462, %160), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3464 = f32[1,29,1]{2,1,0} aten::mean(%3463), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3465 = f32[1,29,1]{2,1,0} aten::add(%3464, %159, %158), scope=aten::add.955, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3466 = f32[1,29,1]{2,1,0} aten::rsqrt(%3465), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3467 = f32[1,29,3584]{2,1,0} aten::mul(%3462, %3466), scope=aten::mul.956, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3468 = bf16[1,29,3584]{2,1,0} xla::cast(%3467), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3469 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3470 = bf16[1,29,3584]{2,1,0} aten::mul(%3469, %3468), scope=aten::mul.957, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3471 = bf16[29,3584]{1,0} aten::view(%3470), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3472 = bf16[29,512]{1,0} aten::mm(%3471, %157), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3473 = bf16[1,29,512]{2,1,0} aten::view(%3472), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3474 = bf16[1,29,512]{2,1,0} aten::add(%3473, %155, %154), scope=aten::add.960, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3475 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3474), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3476 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3475), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3477 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3476), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3478 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3477), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3479 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3478), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3480 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3479), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3481 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3480), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3482 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3481), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3483 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3482), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3484 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3483), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3485 = bf16[28,29,128]{2,1,0} aten::view(%3484), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3486 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3487 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3488 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3489 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3490 = s64[1,29]{1,0} aten::expand(%3489), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3491 = s64[1,29]{1,0} aten::add(%632, %3490), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3492 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3493 = pred[1,29]{1,0} aten::lt(%632, %3492), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3494 = s64[1,29]{1,0} aten::where(%3493, %3491, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3495 = s64[1,29,1]{2,1,0} aten::stack(%3494), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3496 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3497 = bf16[29,128]{1,0} xla::select(%3496), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3498 = bf16[1,29,128]{2,1,0} aten::index(%3497, %3495), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3499 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3498), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3500 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3501 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3502 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3503 = bf16[3584,512]{0,1} aten::permute(%3502), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3504 = bf16[29,3584]{1,0} aten::view(%3470), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3505 = bf16[29,512]{1,0} aten::mm(%3504, %3503), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3506 = bf16[1,29,512]{2,1,0} aten::view(%3505), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3507 = bf16[1,29,512]{2,1,0} aten::add(%3506, %3501, %3500), scope=aten::add.959, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3508 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3507), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3509 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3508), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3510 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3509), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3511 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3509), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3512 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3511), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3513 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3512, %3510), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3514 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3513, %3499), scope=aten::mul.965, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3515 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3516 = s64[1,29]{1,0} aten::expand(%3515), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3517 = s64[1,29]{1,0} aten::add(%632, %3516), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3518 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3519 = pred[1,29]{1,0} aten::lt(%632, %3518), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3520 = s64[1,29]{1,0} aten::where(%3519, %3517, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3521 = s64[1,29,1]{2,1,0} aten::stack(%3520), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3522 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3523 = bf16[29,128]{1,0} xla::select(%3522), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3524 = bf16[1,29,128]{2,1,0} aten::index(%3523, %3521), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3525 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3524), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3526 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3509, %3525), scope=aten::mul.964, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3527 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3526, %3514, %3488), scope=aten::add.966, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3528 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3527), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3529 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3528), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3530 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3529), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3531 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3530), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3532 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3531), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3533 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3532), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3534 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3533), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3535 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3534), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3536 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3535), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3537 = bf16[28,128,29]{2,1,0} aten::view(%3536), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3538 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3539 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3540 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3541 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3542 = bf16[3584,3584]{0,1} aten::permute(%3541), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3543 = bf16[29,3584]{1,0} aten::view(%3470), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3544 = bf16[29,3584]{1,0} aten::mm(%3543, %3542), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3545 = bf16[1,29,3584]{2,1,0} aten::view(%3544), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3546 = bf16[1,29,3584]{2,1,0} aten::add(%3545, %3540, %3539), scope=aten::add.958, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3547 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3546), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3548 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3547), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3549 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3548), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3550 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3548), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3551 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3550), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3552 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3551, %3549), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3553 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3552, %3499), scope=aten::mul.962, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3554 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3548, %3525), scope=aten::mul.961, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3555 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3554, %3553, %3538), scope=aten::add.963, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3556 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3555), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3557 = bf16[28,29,128]{2,1,0} aten::view(%3556), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3558 = bf16[28,29,29]{2,1,0} aten::matmul(%3557, %3537), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3559 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3558), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3560 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3559, %3487), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3561 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3560, %621, %3486), scope=aten::add.967, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3562 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3561), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3563 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3562), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3564 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3563), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3565 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3564), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3566 = bf16[28,29,29]{2,1,0} aten::view(%3565), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3567 = bf16[28,29,128]{2,1,0} aten::matmul(%3566, %3485), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3568 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3567), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3569 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3568), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3570 = bf16[1,29,3584]{2,1,0} aten::view(%3569), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3571 = bf16[29,3584]{1,0} aten::view(%3570), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3572 = bf16[29,3584]{1,0} aten::mm(%3571, %153), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3573 = bf16[1,29,3584]{2,1,0} aten::view(%3572), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3574 = bf16[1,29,3584]{2,1,0} aten::add(%3461, %3573, %151), scope=aten::add.968, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3575 = f32[1,29,3584]{2,1,0} xla::cast(%3574), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3576 = f32[1,29,3584]{2,1,0} aten::pow(%3575, %150), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3577 = f32[1,29,1]{2,1,0} aten::mean(%3576), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3578 = f32[1,29,1]{2,1,0} aten::add(%3577, %149, %148), scope=aten::add.969, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3579 = f32[1,29,1]{2,1,0} aten::rsqrt(%3578), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3580 = f32[1,29,3584]{2,1,0} aten::mul(%3575, %3579), scope=aten::mul.970, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3581 = bf16[1,29,3584]{2,1,0} xla::cast(%3580), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3582 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3583 = bf16[1,29,3584]{2,1,0} aten::mul(%3582, %3581), scope=aten::mul.971, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3584 = bf16[29,3584]{1,0} aten::view(%3583), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3585 = bf16[29,18944]{1,0} aten::mm(%3584, %147), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3586 = bf16[1,29,18944]{2,1,0} aten::view(%3585), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3587 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3588 = bf16[3584,18944]{0,1} aten::permute(%3587), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3589 = bf16[29,3584]{1,0} aten::view(%3583), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3590 = bf16[29,18944]{1,0} aten::mm(%3589, %3588), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3591 = bf16[1,29,18944]{2,1,0} aten::view(%3590), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3592 = bf16[1,29,18944]{2,1,0} aten::silu(%3591), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3593 = bf16[1,29,18944]{2,1,0} aten::mul(%3592, %3586), scope=aten::mul.972, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3594 = bf16[29,18944]{1,0} aten::view(%3593), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3595 = bf16[29,3584]{1,0} aten::mm(%3594, %145), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3596 = bf16[1,29,3584]{2,1,0} aten::view(%3595), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3597 = bf16[1,29,3584]{2,1,0} aten::add(%3574, %3596, %143), scope=aten::add.973, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3598 = f32[1,29,3584]{2,1,0} xla::cast(%3597), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3599 = f32[1,29,3584]{2,1,0} aten::pow(%3598, %142), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3600 = f32[1,29,1]{2,1,0} aten::mean(%3599), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3601 = f32[1,29,1]{2,1,0} aten::add(%3600, %141, %140), scope=aten::add.974, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3602 = f32[1,29,1]{2,1,0} aten::rsqrt(%3601), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3603 = f32[1,29,3584]{2,1,0} aten::mul(%3598, %3602), scope=aten::mul.975, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3604 = bf16[1,29,3584]{2,1,0} xla::cast(%3603), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3605 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3606 = bf16[1,29,3584]{2,1,0} aten::mul(%3605, %3604), scope=aten::mul.976, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3607 = bf16[29,3584]{1,0} aten::view(%3606), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3608 = bf16[29,512]{1,0} aten::mm(%3607, %139), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3609 = bf16[1,29,512]{2,1,0} aten::view(%3608), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3610 = bf16[1,29,512]{2,1,0} aten::add(%3609, %137, %136), scope=aten::add.979, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3611 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3610), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3612 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3611), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3613 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3612), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3614 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3613), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3615 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3614), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3616 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3615), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3617 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3616), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3618 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3617), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3619 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3618), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3620 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3619), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3621 = bf16[28,29,128]{2,1,0} aten::view(%3620), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3622 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3623 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3624 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3625 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3626 = s64[1,29]{1,0} aten::expand(%3625), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3627 = s64[1,29]{1,0} aten::add(%632, %3626), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3628 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3629 = pred[1,29]{1,0} aten::lt(%632, %3628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3630 = s64[1,29]{1,0} aten::where(%3629, %3627, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3631 = s64[1,29,1]{2,1,0} aten::stack(%3630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3632 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3633 = bf16[29,128]{1,0} xla::select(%3632), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3634 = bf16[1,29,128]{2,1,0} aten::index(%3633, %3631), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3635 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3634), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3636 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3637 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3638 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3639 = bf16[3584,512]{0,1} aten::permute(%3638), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3640 = bf16[29,3584]{1,0} aten::view(%3606), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3641 = bf16[29,512]{1,0} aten::mm(%3640, %3639), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3642 = bf16[1,29,512]{2,1,0} aten::view(%3641), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3643 = bf16[1,29,512]{2,1,0} aten::add(%3642, %3637, %3636), scope=aten::add.978, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3644 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3643), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3645 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3644), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3646 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3645), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3647 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3645), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3648 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3647), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3649 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3648, %3646), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3650 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3649, %3635), scope=aten::mul.984, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3651 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3652 = s64[1,29]{1,0} aten::expand(%3651), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3653 = s64[1,29]{1,0} aten::add(%632, %3652), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3654 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3655 = pred[1,29]{1,0} aten::lt(%632, %3654), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3656 = s64[1,29]{1,0} aten::where(%3655, %3653, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3657 = s64[1,29,1]{2,1,0} aten::stack(%3656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3658 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3659 = bf16[29,128]{1,0} xla::select(%3658), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3660 = bf16[1,29,128]{2,1,0} aten::index(%3659, %3657), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3661 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3660), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3662 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3645, %3661), scope=aten::mul.983, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3663 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3662, %3650, %3624), scope=aten::add.985, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3664 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3663), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3665 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3664), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3666 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3665), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3667 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3666), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3668 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3667), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3669 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3668), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3670 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3669), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3671 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3670), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3672 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3671), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3673 = bf16[28,128,29]{2,1,0} aten::view(%3672), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3674 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3675 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3676 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3677 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3678 = bf16[3584,3584]{0,1} aten::permute(%3677), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3679 = bf16[29,3584]{1,0} aten::view(%3606), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3680 = bf16[29,3584]{1,0} aten::mm(%3679, %3678), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3681 = bf16[1,29,3584]{2,1,0} aten::view(%3680), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3682 = bf16[1,29,3584]{2,1,0} aten::add(%3681, %3676, %3675), scope=aten::add.977, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3683 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3682), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3684 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3683), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3685 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3684), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3686 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3684), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3687 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3686), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3688 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3687, %3685), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3689 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3688, %3635), scope=aten::mul.981, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3690 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3684, %3661), scope=aten::mul.980, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3691 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3690, %3689, %3674), scope=aten::add.982, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3692 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3691), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3693 = bf16[28,29,128]{2,1,0} aten::view(%3692), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3694 = bf16[28,29,29]{2,1,0} aten::matmul(%3693, %3673), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3695 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3694), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3696 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3695, %3623), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3697 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3696, %621, %3622), scope=aten::add.986, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3698 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3697), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3699 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3698), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3700 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3699), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3701 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3700), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3702 = bf16[28,29,29]{2,1,0} aten::view(%3701), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3703 = bf16[28,29,128]{2,1,0} aten::matmul(%3702, %3621), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3704 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3703), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3705 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3704), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3706 = bf16[1,29,3584]{2,1,0} aten::view(%3705), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3707 = bf16[29,3584]{1,0} aten::view(%3706), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3708 = bf16[29,3584]{1,0} aten::mm(%3707, %135), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3709 = bf16[1,29,3584]{2,1,0} aten::view(%3708), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3710 = bf16[1,29,3584]{2,1,0} aten::add(%3597, %3709, %133), scope=aten::add.987, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3711 = f32[1,29,3584]{2,1,0} xla::cast(%3710), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3712 = f32[1,29,3584]{2,1,0} aten::pow(%3711, %132), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3713 = f32[1,29,1]{2,1,0} aten::mean(%3712), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3714 = f32[1,29,1]{2,1,0} aten::add(%3713, %131, %130), scope=aten::add.988, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3715 = f32[1,29,1]{2,1,0} aten::rsqrt(%3714), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3716 = f32[1,29,3584]{2,1,0} aten::mul(%3711, %3715), scope=aten::mul.989, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3717 = bf16[1,29,3584]{2,1,0} xla::cast(%3716), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3718 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3719 = bf16[1,29,3584]{2,1,0} aten::mul(%3718, %3717), scope=aten::mul.990, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3720 = bf16[29,3584]{1,0} aten::view(%3719), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3721 = bf16[29,18944]{1,0} aten::mm(%3720, %129), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3722 = bf16[1,29,18944]{2,1,0} aten::view(%3721), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3723 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3724 = bf16[3584,18944]{0,1} aten::permute(%3723), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3725 = bf16[29,3584]{1,0} aten::view(%3719), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3726 = bf16[29,18944]{1,0} aten::mm(%3725, %3724), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3727 = bf16[1,29,18944]{2,1,0} aten::view(%3726), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3728 = bf16[1,29,18944]{2,1,0} aten::silu(%3727), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3729 = bf16[1,29,18944]{2,1,0} aten::mul(%3728, %3722), scope=aten::mul.991, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3730 = bf16[29,18944]{1,0} aten::view(%3729), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3731 = bf16[29,3584]{1,0} aten::mm(%3730, %127), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3732 = bf16[1,29,3584]{2,1,0} aten::view(%3731), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3733 = bf16[1,29,3584]{2,1,0} aten::add(%3710, %3732, %125), scope=aten::add.992, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3734 = f32[1,29,3584]{2,1,0} xla::cast(%3733), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3735 = f32[1,29,3584]{2,1,0} aten::pow(%3734, %124), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3736 = f32[1,29,1]{2,1,0} aten::mean(%3735), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3737 = f32[1,29,1]{2,1,0} aten::add(%3736, %123, %122), scope=aten::add.993, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3738 = f32[1,29,1]{2,1,0} aten::rsqrt(%3737), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3739 = f32[1,29,3584]{2,1,0} aten::mul(%3734, %3738), scope=aten::mul.994, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3740 = bf16[1,29,3584]{2,1,0} xla::cast(%3739), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3741 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3742 = bf16[1,29,3584]{2,1,0} aten::mul(%3741, %3740), scope=aten::mul.995, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3743 = bf16[29,3584]{1,0} aten::view(%3742), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3744 = bf16[29,512]{1,0} aten::mm(%3743, %121), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3745 = bf16[1,29,512]{2,1,0} aten::view(%3744), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3746 = bf16[1,29,512]{2,1,0} aten::add(%3745, %119, %118), scope=aten::add.998, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3747 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3746), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3748 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3747), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3749 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3748), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3750 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3749), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3751 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3750), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3752 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3751), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3753 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3752), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3754 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3753), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3755 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3754), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3756 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3755), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3757 = bf16[28,29,128]{2,1,0} aten::view(%3756), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3758 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3759 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3760 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3761 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3762 = s64[1,29]{1,0} aten::expand(%3761), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3763 = s64[1,29]{1,0} aten::add(%632, %3762), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3764 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3765 = pred[1,29]{1,0} aten::lt(%632, %3764), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3766 = s64[1,29]{1,0} aten::where(%3765, %3763, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3767 = s64[1,29,1]{2,1,0} aten::stack(%3766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3768 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3769 = bf16[29,128]{1,0} xla::select(%3768), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3770 = bf16[1,29,128]{2,1,0} aten::index(%3769, %3767), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3771 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3770), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3772 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3773 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3774 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3775 = bf16[3584,512]{0,1} aten::permute(%3774), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3776 = bf16[29,3584]{1,0} aten::view(%3742), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3777 = bf16[29,512]{1,0} aten::mm(%3776, %3775), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3778 = bf16[1,29,512]{2,1,0} aten::view(%3777), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3779 = bf16[1,29,512]{2,1,0} aten::add(%3778, %3773, %3772), scope=aten::add.997, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3780 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3779), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3781 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3780), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3782 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3781), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3783 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3781), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3784 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3783), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3785 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3784, %3782), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3786 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3785, %3771), scope=aten::mul.1003, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3787 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3788 = s64[1,29]{1,0} aten::expand(%3787), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3789 = s64[1,29]{1,0} aten::add(%632, %3788), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3790 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3791 = pred[1,29]{1,0} aten::lt(%632, %3790), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3792 = s64[1,29]{1,0} aten::where(%3791, %3789, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3793 = s64[1,29,1]{2,1,0} aten::stack(%3792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3794 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3795 = bf16[29,128]{1,0} xla::select(%3794), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3796 = bf16[1,29,128]{2,1,0} aten::index(%3795, %3793), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3797 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3796), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3798 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3781, %3797), scope=aten::mul.1002, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3799 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3798, %3786, %3760), scope=aten::add.1004, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3800 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3799), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3801 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3800), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3802 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3801), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3803 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3802), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3804 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3803), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3805 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3804), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3806 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3805), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3807 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3806), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3808 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3807), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3809 = bf16[28,128,29]{2,1,0} aten::view(%3808), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3810 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3811 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3812 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3813 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3814 = bf16[3584,3584]{0,1} aten::permute(%3813), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3815 = bf16[29,3584]{1,0} aten::view(%3742), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3816 = bf16[29,3584]{1,0} aten::mm(%3815, %3814), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3817 = bf16[1,29,3584]{2,1,0} aten::view(%3816), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3818 = bf16[1,29,3584]{2,1,0} aten::add(%3817, %3812, %3811), scope=aten::add.996, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3819 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3818), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3820 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3819), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3821 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3820), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3822 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3820), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3823 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3822), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3824 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3823, %3821), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3825 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3824, %3771), scope=aten::mul.1000, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3826 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3820, %3797), scope=aten::mul.999, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3827 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3826, %3825, %3810), scope=aten::add.1001, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3828 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3827), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3829 = bf16[28,29,128]{2,1,0} aten::view(%3828), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3830 = bf16[28,29,29]{2,1,0} aten::matmul(%3829, %3809), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3831 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3830), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3832 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3831, %3759), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3833 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3832, %621, %3758), scope=aten::add.1005, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3834 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3833), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3835 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3834), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3836 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3835), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3837 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3836), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3838 = bf16[28,29,29]{2,1,0} aten::view(%3837), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3839 = bf16[28,29,128]{2,1,0} aten::matmul(%3838, %3757), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3840 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3839), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3841 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3840), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3842 = bf16[1,29,3584]{2,1,0} aten::view(%3841), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3843 = bf16[29,3584]{1,0} aten::view(%3842), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3844 = bf16[29,3584]{1,0} aten::mm(%3843, %117), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3845 = bf16[1,29,3584]{2,1,0} aten::view(%3844), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3846 = bf16[1,29,3584]{2,1,0} aten::add(%3733, %3845, %115), scope=aten::add.1006, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3847 = f32[1,29,3584]{2,1,0} xla::cast(%3846), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3848 = f32[1,29,3584]{2,1,0} aten::pow(%3847, %114), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3849 = f32[1,29,1]{2,1,0} aten::mean(%3848), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3850 = f32[1,29,1]{2,1,0} aten::add(%3849, %113, %112), scope=aten::add.1007, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3851 = f32[1,29,1]{2,1,0} aten::rsqrt(%3850), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3852 = f32[1,29,3584]{2,1,0} aten::mul(%3847, %3851), scope=aten::mul.1008, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3853 = bf16[1,29,3584]{2,1,0} xla::cast(%3852), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3854 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3855 = bf16[1,29,3584]{2,1,0} aten::mul(%3854, %3853), scope=aten::mul.1009, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3856 = bf16[29,3584]{1,0} aten::view(%3855), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3857 = bf16[29,18944]{1,0} aten::mm(%3856, %111), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3858 = bf16[1,29,18944]{2,1,0} aten::view(%3857), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3859 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3860 = bf16[3584,18944]{0,1} aten::permute(%3859), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3861 = bf16[29,3584]{1,0} aten::view(%3855), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3862 = bf16[29,18944]{1,0} aten::mm(%3861, %3860), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3863 = bf16[1,29,18944]{2,1,0} aten::view(%3862), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3864 = bf16[1,29,18944]{2,1,0} aten::silu(%3863), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3865 = bf16[1,29,18944]{2,1,0} aten::mul(%3864, %3858), scope=aten::mul.1010, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3866 = bf16[29,18944]{1,0} aten::view(%3865), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3867 = bf16[29,3584]{1,0} aten::mm(%3866, %109), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3868 = bf16[1,29,3584]{2,1,0} aten::view(%3867), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3869 = bf16[1,29,3584]{2,1,0} aten::add(%3846, %3868, %107), scope=aten::add.1011, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3870 = f32[1,29,3584]{2,1,0} xla::cast(%3869), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3871 = f32[1,29,3584]{2,1,0} aten::pow(%3870, %106), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3872 = f32[1,29,1]{2,1,0} aten::mean(%3871), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3873 = f32[1,29,1]{2,1,0} aten::add(%3872, %105, %104), scope=aten::add.1012, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3874 = f32[1,29,1]{2,1,0} aten::rsqrt(%3873), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3875 = f32[1,29,3584]{2,1,0} aten::mul(%3870, %3874), scope=aten::mul.1013, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3876 = bf16[1,29,3584]{2,1,0} xla::cast(%3875), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3877 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3878 = bf16[1,29,3584]{2,1,0} aten::mul(%3877, %3876), scope=aten::mul.1014, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3879 = bf16[29,3584]{1,0} aten::view(%3878), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3880 = bf16[29,512]{1,0} aten::mm(%3879, %103), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3881 = bf16[1,29,512]{2,1,0} aten::view(%3880), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3882 = bf16[1,29,512]{2,1,0} aten::add(%3881, %101, %100), scope=aten::add.1017, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3883 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3882), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3884 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3883), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3885 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3884), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3886 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3885), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3887 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3886), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3888 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3887), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3889 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3888), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3890 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3889), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3891 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3890), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3892 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3891), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3893 = bf16[28,29,128]{2,1,0} aten::view(%3892), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3894 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3895 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3896 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3897 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3898 = s64[1,29]{1,0} aten::expand(%3897), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3899 = s64[1,29]{1,0} aten::add(%632, %3898), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3900 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3901 = pred[1,29]{1,0} aten::lt(%632, %3900), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3902 = s64[1,29]{1,0} aten::where(%3901, %3899, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3903 = s64[1,29,1]{2,1,0} aten::stack(%3902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3904 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3905 = bf16[29,128]{1,0} xla::select(%3904), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3906 = bf16[1,29,128]{2,1,0} aten::index(%3905, %3903), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3907 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3906), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3908 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3909 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3910 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3911 = bf16[3584,512]{0,1} aten::permute(%3910), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3912 = bf16[29,3584]{1,0} aten::view(%3878), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3913 = bf16[29,512]{1,0} aten::mm(%3912, %3911), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3914 = bf16[1,29,512]{2,1,0} aten::view(%3913), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3915 = bf16[1,29,512]{2,1,0} aten::add(%3914, %3909, %3908), scope=aten::add.1016, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3916 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3915), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3917 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3916), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3918 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3917), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3919 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3917), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3920 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3919), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3921 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3920, %3918), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3922 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3921, %3907), scope=aten::mul.1022, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3923 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3924 = s64[1,29]{1,0} aten::expand(%3923), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3925 = s64[1,29]{1,0} aten::add(%632, %3924), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3926 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3927 = pred[1,29]{1,0} aten::lt(%632, %3926), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3928 = s64[1,29]{1,0} aten::where(%3927, %3925, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3929 = s64[1,29,1]{2,1,0} aten::stack(%3928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3930 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3931 = bf16[29,128]{1,0} xla::select(%3930), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3932 = bf16[1,29,128]{2,1,0} aten::index(%3931, %3929), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3933 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3932), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3934 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3917, %3933), scope=aten::mul.1021, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3935 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3934, %3922, %3896), scope=aten::add.1023, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3936 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3935), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3937 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3936), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3938 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3937), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3939 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3938), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3940 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3939), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3941 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3940), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3942 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3941), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3943 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3942), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3944 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3943), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3945 = bf16[28,128,29]{2,1,0} aten::view(%3944), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3946 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3947 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3948 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3949 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3950 = bf16[3584,3584]{0,1} aten::permute(%3949), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3951 = bf16[29,3584]{1,0} aten::view(%3878), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3952 = bf16[29,3584]{1,0} aten::mm(%3951, %3950), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3953 = bf16[1,29,3584]{2,1,0} aten::view(%3952), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3954 = bf16[1,29,3584]{2,1,0} aten::add(%3953, %3948, %3947), scope=aten::add.1015, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3955 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3954), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3956 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3955), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3957 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3956), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3958 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3956), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3959 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3958), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3960 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3959, %3957), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3961 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3960, %3907), scope=aten::mul.1019, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3962 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3956, %3933), scope=aten::mul.1018, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3963 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3962, %3961, %3946), scope=aten::add.1020, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3964 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3963), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3965 = bf16[28,29,128]{2,1,0} aten::view(%3964), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3966 = bf16[28,29,29]{2,1,0} aten::matmul(%3965, %3945), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3967 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3966), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3968 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3967, %3895), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3969 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3968, %621, %3894), scope=aten::add.1024, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3970 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3969), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3971 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3970), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3972 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3971), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3973 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3972), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3974 = bf16[28,29,29]{2,1,0} aten::view(%3973), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3975 = bf16[28,29,128]{2,1,0} aten::matmul(%3974, %3893), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3976 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3975), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3977 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3976), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3978 = bf16[1,29,3584]{2,1,0} aten::view(%3977), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3979 = bf16[29,3584]{1,0} aten::view(%3978), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3980 = bf16[29,3584]{1,0} aten::mm(%3979, %99), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3981 = bf16[1,29,3584]{2,1,0} aten::view(%3980), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3982 = bf16[1,29,3584]{2,1,0} aten::add(%3869, %3981, %97), scope=aten::add.1025, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3983 = f32[1,29,3584]{2,1,0} xla::cast(%3982), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3984 = f32[1,29,3584]{2,1,0} aten::pow(%3983, %96), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3985 = f32[1,29,1]{2,1,0} aten::mean(%3984), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3986 = f32[1,29,1]{2,1,0} aten::add(%3985, %95, %94), scope=aten::add.1026, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3987 = f32[1,29,1]{2,1,0} aten::rsqrt(%3986), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3988 = f32[1,29,3584]{2,1,0} aten::mul(%3983, %3987), scope=aten::mul.1027, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3989 = bf16[1,29,3584]{2,1,0} xla::cast(%3988), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3990 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3991 = bf16[1,29,3584]{2,1,0} aten::mul(%3990, %3989), scope=aten::mul.1028, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3992 = bf16[29,3584]{1,0} aten::view(%3991), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3993 = bf16[29,18944]{1,0} aten::mm(%3992, %93), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3994 = bf16[1,29,18944]{2,1,0} aten::view(%3993), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3995 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3996 = bf16[3584,18944]{0,1} aten::permute(%3995), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3997 = bf16[29,3584]{1,0} aten::view(%3991), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3998 = bf16[29,18944]{1,0} aten::mm(%3997, %3996), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3999 = bf16[1,29,18944]{2,1,0} aten::view(%3998), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4000 = bf16[1,29,18944]{2,1,0} aten::silu(%3999), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4001 = bf16[1,29,18944]{2,1,0} aten::mul(%4000, %3994), scope=aten::mul.1029, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4002 = bf16[29,18944]{1,0} aten::view(%4001), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4003 = bf16[29,3584]{1,0} aten::mm(%4002, %91), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4004 = bf16[1,29,3584]{2,1,0} aten::view(%4003), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4005 = bf16[1,29,3584]{2,1,0} aten::add(%3982, %4004, %89), scope=aten::add.1030, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4006 = f32[1,29,3584]{2,1,0} xla::cast(%4005), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4007 = f32[1,29,3584]{2,1,0} aten::pow(%4006, %88), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4008 = f32[1,29,1]{2,1,0} aten::mean(%4007), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4009 = f32[1,29,1]{2,1,0} aten::add(%4008, %87, %86), scope=aten::add.1031, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4010 = f32[1,29,1]{2,1,0} aten::rsqrt(%4009), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4011 = f32[1,29,3584]{2,1,0} aten::mul(%4006, %4010), scope=aten::mul.1032, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4012 = bf16[1,29,3584]{2,1,0} xla::cast(%4011), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4013 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4014 = bf16[1,29,3584]{2,1,0} aten::mul(%4013, %4012), scope=aten::mul.1033, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4015 = bf16[29,3584]{1,0} aten::view(%4014), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4016 = bf16[29,512]{1,0} aten::mm(%4015, %85), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4017 = bf16[1,29,512]{2,1,0} aten::view(%4016), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4018 = bf16[1,29,512]{2,1,0} aten::add(%4017, %83, %82), scope=aten::add.1036, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4019 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4018), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4020 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4019), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4021 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4020), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4022 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4021), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4023 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4022), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4024 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4023), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4025 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4024), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4026 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4025), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4027 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4026), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4028 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4027), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4029 = bf16[28,29,128]{2,1,0} aten::view(%4028), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4030 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4031 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4032 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4033 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4034 = s64[1,29]{1,0} aten::expand(%4033), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4035 = s64[1,29]{1,0} aten::add(%632, %4034), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4036 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4037 = pred[1,29]{1,0} aten::lt(%632, %4036), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4038 = s64[1,29]{1,0} aten::where(%4037, %4035, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4039 = s64[1,29,1]{2,1,0} aten::stack(%4038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4040 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4041 = bf16[29,128]{1,0} xla::select(%4040), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4042 = bf16[1,29,128]{2,1,0} aten::index(%4041, %4039), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4043 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4042), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4044 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4045 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4046 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4047 = bf16[3584,512]{0,1} aten::permute(%4046), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4048 = bf16[29,3584]{1,0} aten::view(%4014), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4049 = bf16[29,512]{1,0} aten::mm(%4048, %4047), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4050 = bf16[1,29,512]{2,1,0} aten::view(%4049), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4051 = bf16[1,29,512]{2,1,0} aten::add(%4050, %4045, %4044), scope=aten::add.1035, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4052 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4051), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4053 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4052), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4054 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4053), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4055 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4053), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4056 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4055), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4057 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4056, %4054), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4058 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4057, %4043), scope=aten::mul.1041, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4059 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4060 = s64[1,29]{1,0} aten::expand(%4059), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4061 = s64[1,29]{1,0} aten::add(%632, %4060), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4062 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4063 = pred[1,29]{1,0} aten::lt(%632, %4062), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4064 = s64[1,29]{1,0} aten::where(%4063, %4061, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4065 = s64[1,29,1]{2,1,0} aten::stack(%4064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4066 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4067 = bf16[29,128]{1,0} xla::select(%4066), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4068 = bf16[1,29,128]{2,1,0} aten::index(%4067, %4065), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4069 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4068), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4070 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4053, %4069), scope=aten::mul.1040, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4071 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4070, %4058, %4032), scope=aten::add.1042, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4072 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4071), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4073 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4072), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4074 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4073), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4075 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4074), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4076 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4075), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4077 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4076), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4078 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4077), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4079 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4078), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4080 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4079), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4081 = bf16[28,128,29]{2,1,0} aten::view(%4080), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4082 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4083 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4084 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4085 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4086 = bf16[3584,3584]{0,1} aten::permute(%4085), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4087 = bf16[29,3584]{1,0} aten::view(%4014), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4088 = bf16[29,3584]{1,0} aten::mm(%4087, %4086), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4089 = bf16[1,29,3584]{2,1,0} aten::view(%4088), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4090 = bf16[1,29,3584]{2,1,0} aten::add(%4089, %4084, %4083), scope=aten::add.1034, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4091 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4090), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4092 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4091), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4093 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4092), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4094 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4092), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4095 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4094), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4096 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4095, %4093), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4097 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4096, %4043), scope=aten::mul.1038, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4098 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4092, %4069), scope=aten::mul.1037, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4099 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4098, %4097, %4082), scope=aten::add.1039, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4100 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4099), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4101 = bf16[28,29,128]{2,1,0} aten::view(%4100), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4102 = bf16[28,29,29]{2,1,0} aten::matmul(%4101, %4081), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4103 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4102), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4104 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4103, %4031), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4105 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4104, %621, %4030), scope=aten::add.1043, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4106 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4105), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4107 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4106), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4108 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4107), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4109 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4108), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4110 = bf16[28,29,29]{2,1,0} aten::view(%4109), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4111 = bf16[28,29,128]{2,1,0} aten::matmul(%4110, %4029), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4112 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4111), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4113 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4112), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4114 = bf16[1,29,3584]{2,1,0} aten::view(%4113), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4115 = bf16[29,3584]{1,0} aten::view(%4114), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4116 = bf16[29,3584]{1,0} aten::mm(%4115, %81), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4117 = bf16[1,29,3584]{2,1,0} aten::view(%4116), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4118 = bf16[1,29,3584]{2,1,0} aten::add(%4005, %4117, %79), scope=aten::add.1044, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4119 = f32[1,29,3584]{2,1,0} xla::cast(%4118), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4120 = f32[1,29,3584]{2,1,0} aten::pow(%4119, %78), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4121 = f32[1,29,1]{2,1,0} aten::mean(%4120), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4122 = f32[1,29,1]{2,1,0} aten::add(%4121, %77, %76), scope=aten::add.1045, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4123 = f32[1,29,1]{2,1,0} aten::rsqrt(%4122), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4124 = f32[1,29,3584]{2,1,0} aten::mul(%4119, %4123), scope=aten::mul.1046, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4125 = bf16[1,29,3584]{2,1,0} xla::cast(%4124), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4126 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4127 = bf16[1,29,3584]{2,1,0} aten::mul(%4126, %4125), scope=aten::mul.1047, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4128 = bf16[29,3584]{1,0} aten::view(%4127), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4129 = bf16[29,18944]{1,0} aten::mm(%4128, %75), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4130 = bf16[1,29,18944]{2,1,0} aten::view(%4129), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4131 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4132 = bf16[3584,18944]{0,1} aten::permute(%4131), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4133 = bf16[29,3584]{1,0} aten::view(%4127), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4134 = bf16[29,18944]{1,0} aten::mm(%4133, %4132), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4135 = bf16[1,29,18944]{2,1,0} aten::view(%4134), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4136 = bf16[1,29,18944]{2,1,0} aten::silu(%4135), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4137 = bf16[1,29,18944]{2,1,0} aten::mul(%4136, %4130), scope=aten::mul.1048, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4138 = bf16[29,18944]{1,0} aten::view(%4137), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4139 = bf16[29,3584]{1,0} aten::mm(%4138, %73), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4140 = bf16[1,29,3584]{2,1,0} aten::view(%4139), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4141 = bf16[1,29,3584]{2,1,0} aten::add(%4118, %4140, %71), scope=aten::add.1049, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4142 = f32[1,29,3584]{2,1,0} xla::cast(%4141), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4143 = f32[1,29,3584]{2,1,0} aten::pow(%4142, %70), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4144 = f32[1,29,1]{2,1,0} aten::mean(%4143), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4145 = f32[1,29,1]{2,1,0} aten::add(%4144, %69, %68), scope=aten::add.1050, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4146 = f32[1,29,1]{2,1,0} aten::rsqrt(%4145), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4147 = f32[1,29,3584]{2,1,0} aten::mul(%4142, %4146), scope=aten::mul.1051, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4148 = bf16[1,29,3584]{2,1,0} xla::cast(%4147), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4149 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4150 = bf16[1,29,3584]{2,1,0} aten::mul(%4149, %4148), scope=aten::mul.1052, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4151 = bf16[29,3584]{1,0} aten::view(%4150), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4152 = bf16[29,512]{1,0} aten::mm(%4151, %67), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4153 = bf16[1,29,512]{2,1,0} aten::view(%4152), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4154 = bf16[1,29,512]{2,1,0} aten::add(%4153, %65, %64), scope=aten::add.1055, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4155 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4154), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4156 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4155), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4157 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4156), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4158 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4157), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4159 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4158), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4160 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4159), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4161 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4160), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4162 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4161), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4163 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4162), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4164 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4163), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4165 = bf16[28,29,128]{2,1,0} aten::view(%4164), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4166 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4167 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4168 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4169 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4170 = s64[1,29]{1,0} aten::expand(%4169), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4171 = s64[1,29]{1,0} aten::add(%632, %4170), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4172 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4173 = pred[1,29]{1,0} aten::lt(%632, %4172), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4174 = s64[1,29]{1,0} aten::where(%4173, %4171, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4175 = s64[1,29,1]{2,1,0} aten::stack(%4174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4176 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4177 = bf16[29,128]{1,0} xla::select(%4176), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4178 = bf16[1,29,128]{2,1,0} aten::index(%4177, %4175), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4179 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4178), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4180 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4181 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4182 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4183 = bf16[3584,512]{0,1} aten::permute(%4182), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4184 = bf16[29,3584]{1,0} aten::view(%4150), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4185 = bf16[29,512]{1,0} aten::mm(%4184, %4183), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4186 = bf16[1,29,512]{2,1,0} aten::view(%4185), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4187 = bf16[1,29,512]{2,1,0} aten::add(%4186, %4181, %4180), scope=aten::add.1054, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4188 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4187), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4189 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4188), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4190 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4189), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4191 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4189), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4192 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4191), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4193 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4192, %4190), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4194 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4193, %4179), scope=aten::mul.1060, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4195 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4196 = s64[1,29]{1,0} aten::expand(%4195), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4197 = s64[1,29]{1,0} aten::add(%632, %4196), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4198 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4199 = pred[1,29]{1,0} aten::lt(%632, %4198), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4200 = s64[1,29]{1,0} aten::where(%4199, %4197, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4201 = s64[1,29,1]{2,1,0} aten::stack(%4200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4202 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4203 = bf16[29,128]{1,0} xla::select(%4202), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4204 = bf16[1,29,128]{2,1,0} aten::index(%4203, %4201), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4205 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4204), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4206 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4189, %4205), scope=aten::mul.1059, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4207 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4206, %4194, %4168), scope=aten::add.1061, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4208 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4207), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4209 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4208), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4210 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4209), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4211 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4210), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4212 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4211), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4213 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4212), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4214 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4213), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4215 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4214), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4216 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4215), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4217 = bf16[28,128,29]{2,1,0} aten::view(%4216), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4218 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4219 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4220 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4221 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4222 = bf16[3584,3584]{0,1} aten::permute(%4221), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4223 = bf16[29,3584]{1,0} aten::view(%4150), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4224 = bf16[29,3584]{1,0} aten::mm(%4223, %4222), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4225 = bf16[1,29,3584]{2,1,0} aten::view(%4224), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4226 = bf16[1,29,3584]{2,1,0} aten::add(%4225, %4220, %4219), scope=aten::add.1053, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4227 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4226), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4228 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4227), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4229 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4228), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4230 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4228), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4231 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4230), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4232 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4231, %4229), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4233 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4232, %4179), scope=aten::mul.1057, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4234 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4228, %4205), scope=aten::mul.1056, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4235 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4234, %4233, %4218), scope=aten::add.1058, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4236 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4235), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4237 = bf16[28,29,128]{2,1,0} aten::view(%4236), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4238 = bf16[28,29,29]{2,1,0} aten::matmul(%4237, %4217), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4239 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4238), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4240 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4239, %4167), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4241 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4240, %621, %4166), scope=aten::add.1062, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4242 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4241), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4243 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4242), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4244 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4243), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4245 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4244), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4246 = bf16[28,29,29]{2,1,0} aten::view(%4245), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4247 = bf16[28,29,128]{2,1,0} aten::matmul(%4246, %4165), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4248 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4247), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4249 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4248), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4250 = bf16[1,29,3584]{2,1,0} aten::view(%4249), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4251 = bf16[29,3584]{1,0} aten::view(%4250), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4252 = bf16[29,3584]{1,0} aten::mm(%4251, %63), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4253 = bf16[1,29,3584]{2,1,0} aten::view(%4252), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4254 = bf16[1,29,3584]{2,1,0} aten::add(%4141, %4253, %61), scope=aten::add.1063, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4255 = f32[1,29,3584]{2,1,0} xla::cast(%4254), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4256 = f32[1,29,3584]{2,1,0} aten::pow(%4255, %60), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4257 = f32[1,29,1]{2,1,0} aten::mean(%4256), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4258 = f32[1,29,1]{2,1,0} aten::add(%4257, %59, %58), scope=aten::add.1064, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4259 = f32[1,29,1]{2,1,0} aten::rsqrt(%4258), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4260 = f32[1,29,3584]{2,1,0} aten::mul(%4255, %4259), scope=aten::mul.1065, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4261 = bf16[1,29,3584]{2,1,0} xla::cast(%4260), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4262 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4263 = bf16[1,29,3584]{2,1,0} aten::mul(%4262, %4261), scope=aten::mul.1066, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4264 = bf16[29,3584]{1,0} aten::view(%4263), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4265 = bf16[29,18944]{1,0} aten::mm(%4264, %57), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4266 = bf16[1,29,18944]{2,1,0} aten::view(%4265), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4267 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4268 = bf16[3584,18944]{0,1} aten::permute(%4267), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4269 = bf16[29,3584]{1,0} aten::view(%4263), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4270 = bf16[29,18944]{1,0} aten::mm(%4269, %4268), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4271 = bf16[1,29,18944]{2,1,0} aten::view(%4270), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4272 = bf16[1,29,18944]{2,1,0} aten::silu(%4271), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4273 = bf16[1,29,18944]{2,1,0} aten::mul(%4272, %4266), scope=aten::mul.1067, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4274 = bf16[29,18944]{1,0} aten::view(%4273), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4275 = bf16[29,3584]{1,0} aten::mm(%4274, %55), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4276 = bf16[1,29,3584]{2,1,0} aten::view(%4275), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4277 = bf16[1,29,3584]{2,1,0} aten::add(%4254, %4276, %53), scope=aten::add.1068, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4278 = f32[1,29,3584]{2,1,0} xla::cast(%4277), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4279 = f32[1,29,3584]{2,1,0} aten::pow(%4278, %52), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4280 = f32[1,29,1]{2,1,0} aten::mean(%4279), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4281 = f32[1,29,1]{2,1,0} aten::add(%4280, %51, %50), scope=aten::add.1069, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4282 = f32[1,29,1]{2,1,0} aten::rsqrt(%4281), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4283 = f32[1,29,3584]{2,1,0} aten::mul(%4278, %4282), scope=aten::mul.1070, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4284 = bf16[1,29,3584]{2,1,0} xla::cast(%4283), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4285 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4286 = bf16[1,29,3584]{2,1,0} aten::mul(%4285, %4284), scope=aten::mul.1071, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4287 = bf16[29,3584]{1,0} aten::view(%4286), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4288 = bf16[29,512]{1,0} aten::mm(%4287, %49), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4289 = bf16[1,29,512]{2,1,0} aten::view(%4288), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4290 = bf16[1,29,512]{2,1,0} aten::add(%4289, %47, %46), scope=aten::add.1074, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4291 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4290), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4292 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4291), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4293 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4292), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4294 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4293), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4295 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4294), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4296 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4295), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4297 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4296), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4298 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4297), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4299 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4298), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4300 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4299), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4301 = bf16[28,29,128]{2,1,0} aten::view(%4300), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4302 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4303 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4304 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4305 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4306 = s64[1,29]{1,0} aten::expand(%4305), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4307 = s64[1,29]{1,0} aten::add(%632, %4306), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4308 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4309 = pred[1,29]{1,0} aten::lt(%632, %4308), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4310 = s64[1,29]{1,0} aten::where(%4309, %4307, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4311 = s64[1,29,1]{2,1,0} aten::stack(%4310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4312 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4313 = bf16[29,128]{1,0} xla::select(%4312), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4314 = bf16[1,29,128]{2,1,0} aten::index(%4313, %4311), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4315 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4314), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4316 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4317 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4318 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4319 = bf16[3584,512]{0,1} aten::permute(%4318), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4320 = bf16[29,3584]{1,0} aten::view(%4286), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4321 = bf16[29,512]{1,0} aten::mm(%4320, %4319), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4322 = bf16[1,29,512]{2,1,0} aten::view(%4321), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4323 = bf16[1,29,512]{2,1,0} aten::add(%4322, %4317, %4316), scope=aten::add.1073, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4324 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4323), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4325 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4324), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4326 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4325), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4327 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4325), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4328 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4327), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4329 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4328, %4326), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4330 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4329, %4315), scope=aten::mul.1079, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4331 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4332 = s64[1,29]{1,0} aten::expand(%4331), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4333 = s64[1,29]{1,0} aten::add(%632, %4332), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4334 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4335 = pred[1,29]{1,0} aten::lt(%632, %4334), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4336 = s64[1,29]{1,0} aten::where(%4335, %4333, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4337 = s64[1,29,1]{2,1,0} aten::stack(%4336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4338 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4339 = bf16[29,128]{1,0} xla::select(%4338), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4340 = bf16[1,29,128]{2,1,0} aten::index(%4339, %4337), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4341 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4340), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4342 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4325, %4341), scope=aten::mul.1078, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4343 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4342, %4330, %4304), scope=aten::add.1080, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4344 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4343), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4345 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4344), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4346 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4345), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4347 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4346), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4348 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4347), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4349 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4348), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4350 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4349), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4351 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4350), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4352 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4351), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4353 = bf16[28,128,29]{2,1,0} aten::view(%4352), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4354 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4355 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4356 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4357 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4358 = bf16[3584,3584]{0,1} aten::permute(%4357), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4359 = bf16[29,3584]{1,0} aten::view(%4286), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4360 = bf16[29,3584]{1,0} aten::mm(%4359, %4358), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4361 = bf16[1,29,3584]{2,1,0} aten::view(%4360), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4362 = bf16[1,29,3584]{2,1,0} aten::add(%4361, %4356, %4355), scope=aten::add.1072, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4363 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4362), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4364 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4363), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4365 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4364), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4366 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4364), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4367 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4366), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4368 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4367, %4365), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4369 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4368, %4315), scope=aten::mul.1076, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4370 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4364, %4341), scope=aten::mul.1075, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4371 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4370, %4369, %4354), scope=aten::add.1077, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4372 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4371), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4373 = bf16[28,29,128]{2,1,0} aten::view(%4372), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4374 = bf16[28,29,29]{2,1,0} aten::matmul(%4373, %4353), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4375 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4374), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4376 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4375, %4303), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4377 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4376, %621, %4302), scope=aten::add.1081, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4378 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4377), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4379 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4378), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4380 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4379), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4381 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4380), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4382 = bf16[28,29,29]{2,1,0} aten::view(%4381), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4383 = bf16[28,29,128]{2,1,0} aten::matmul(%4382, %4301), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4384 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4383), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4385 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4384), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4386 = bf16[1,29,3584]{2,1,0} aten::view(%4385), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4387 = bf16[29,3584]{1,0} aten::view(%4386), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4388 = bf16[29,3584]{1,0} aten::mm(%4387, %45), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4389 = bf16[1,29,3584]{2,1,0} aten::view(%4388), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4390 = bf16[1,29,3584]{2,1,0} aten::add(%4277, %4389, %43), scope=aten::add.1082, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4391 = f32[1,29,3584]{2,1,0} xla::cast(%4390), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4392 = f32[1,29,3584]{2,1,0} aten::pow(%4391, %42), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4393 = f32[1,29,1]{2,1,0} aten::mean(%4392), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4394 = f32[1,29,1]{2,1,0} aten::add(%4393, %41, %40), scope=aten::add.1083, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4395 = f32[1,29,1]{2,1,0} aten::rsqrt(%4394), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4396 = f32[1,29,3584]{2,1,0} aten::mul(%4391, %4395), scope=aten::mul.1084, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4397 = bf16[1,29,3584]{2,1,0} xla::cast(%4396), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4398 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4399 = bf16[1,29,3584]{2,1,0} aten::mul(%4398, %4397), scope=aten::mul.1085, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4400 = bf16[29,3584]{1,0} aten::view(%4399), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4401 = bf16[29,18944]{1,0} aten::mm(%4400, %39), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4402 = bf16[1,29,18944]{2,1,0} aten::view(%4401), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4403 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4404 = bf16[3584,18944]{0,1} aten::permute(%4403), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4405 = bf16[29,3584]{1,0} aten::view(%4399), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4406 = bf16[29,18944]{1,0} aten::mm(%4405, %4404), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4407 = bf16[1,29,18944]{2,1,0} aten::view(%4406), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4408 = bf16[1,29,18944]{2,1,0} aten::silu(%4407), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4409 = bf16[1,29,18944]{2,1,0} aten::mul(%4408, %4402), scope=aten::mul.1086, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4410 = bf16[29,18944]{1,0} aten::view(%4409), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4411 = bf16[29,3584]{1,0} aten::mm(%4410, %37), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4412 = bf16[1,29,3584]{2,1,0} aten::view(%4411), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4413 = bf16[1,29,3584]{2,1,0} aten::add(%4390, %4412, %35), scope=aten::add.1087, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4414 = f32[1,29,3584]{2,1,0} xla::cast(%4413), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4415 = f32[1,29,3584]{2,1,0} aten::pow(%4414, %34), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4416 = f32[1,29,1]{2,1,0} aten::mean(%4415), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4417 = f32[1,29,1]{2,1,0} aten::add(%4416, %33, %32), scope=aten::add.1088, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4418 = f32[1,29,1]{2,1,0} aten::rsqrt(%4417), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4419 = f32[1,29,3584]{2,1,0} aten::mul(%4414, %4418), scope=aten::mul.1089, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4420 = bf16[1,29,3584]{2,1,0} xla::cast(%4419), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4421 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4422 = bf16[1,29,3584]{2,1,0} aten::mul(%4421, %4420), scope=aten::mul.1090, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4423 = bf16[29,3584]{1,0} aten::view(%4422), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4424 = bf16[29,152064]{1,0} aten::mm(%4423, %31), location=forward@linear.py:117, xla_shape=bf16[29,152064]{1,0}
  %4425 = bf16[1,29,152064]{2,1,0} aten::view(%4424), location=forward@linear.py:117, xla_shape=bf16[1,29,152064]{2,1,0}
  %4426 = f32[1,29,152064]{2,1,0} xla::cast(%4425), location=forward@modeling_qwen2.py:1163, xla_shape=f32[1,29,152064]{2,1,0}
  %4427 = f32[1,29,152064]{2,1,0} xla::select(%4426), location=_sample@utils.py:2407, xla_shape=f32[1,29,152064]{2,1,0}
  %4428 = f32[1,1,152064]{2,1,0} xla::generic_slice(%4427), location=_sample@utils.py:2407, xla_shape=f32[1,1,152064]{2,1,0}
  %4429 = f32[1,152064]{1,0} aten::view(%4428), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4430 = f32[1,152064]{1,0} xla::select(%4429), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4431 = f32[1,29]{1,0} aten::gather(%4430, %29), location=__call__@logits_process.py:341, xla_shape=f32[1,29]{1,0}
  %4432 = f32[1,29]{1,0} aten::div(%4431, %25), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4433 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %4434 = f32[1,29]{1,0} aten::mul(%4431, %4433), scope=aten::mul.1091, location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4435 = s64[] prim::Constant(), location=__call__@logits_process.py:344, xla_shape=s64[]
  %4436 = pred[1,29]{1,0} aten::lt(%4431, %4435), location=__call__@logits_process.py:344, xla_shape=pred[1,29]{1,0}
  %4437 = f32[1,29]{1,0} aten::where(%4436, %4434, %4432), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4438 = f32[1,152064]{1,0} aten::scatter(%4430, %29, %4437), location=__call__@logits_process.py:346, xla_shape=f32[1,152064]{1,0}
  %4439 = f32[1,152064]{1,0} aten::div(%4438, %24), location=__call__@logits_process.py:292, xla_shape=f32[1,152064]{1,0}
  %4440 = (f32[1,20]{1,0}, s64[1,20]{1,0}) aten::topk(%4439), num_outputs=2, location=__call__@logits_process.py:520, xla_shape=(f32[1,20]{1,0}, s64[1,20]{1,0})
  %4441 = f32[1,1]{1,0} xla::generic_slice(%4440.0), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4442 = f32[1]{0} aten::view(%4441), location=__call__@logits_process.py:520, xla_shape=f32[1]{0}
  %4443 = f32[1,1]{1,0} aten::view(%4442), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4444 = pred[1,152064]{1,0} aten::lt(%4439, %4443), location=__call__@logits_process.py:520, xla_shape=pred[1,152064]{1,0}
  %4445 = f32[1,152064]{1,0} aten::masked_fill(%4439, %4444, %23), location=__call__@logits_process.py:521, xla_shape=f32[1,152064]{1,0}
  %4446 = (f32[1,152064]{1,0}, s64[1,152064]{1,0}) aten::topk(%4445), num_outputs=2, location=__call__@logits_process.py:458, xla_shape=(f32[1,152064]{1,0}, s64[1,152064]{1,0})
  %4447 = f32[1,152064]{1,0} aten::softmax(%4446.0), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4448 = f32[1,152064]{1,0} aten::cumsum(%4447), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4449 = pred[1,152064]{1,0} aten::le(%4448, %22), location=__call__@logits_process.py:462, xla_shape=pred[1,152064]{1,0}
  %4450 = pred[1,152064]{1,0} xla::unselect(%4449, %21), location=__call__@logits_process.py:464, xla_shape=pred[1,152064]{1,0}
  %4451 = pred[1,152064]{1,0} aten::scatter(%4450, %4446.1, %4450), location=__call__@logits_process.py:467, xla_shape=pred[1,152064]{1,0}
  %4452 = f32[1,152064]{1,0} aten::masked_fill(%4445, %4451, %17), location=__call__@logits_process.py:468, xla_shape=f32[1,152064]{1,0}
  %4453 = f32[1,152064]{1,0} aten::softmax(%4452), location=softmax@functional.py:1888, xla_shape=f32[1,152064]{1,0}
  %4454 = s64[1,1]{1,0} aten::multinomial(%4453, %16), location=_sample@utils.py:2437, xla_shape=s64[1,1]{1,0}
  %4455 = s64[1]{0} aten::view(%4454), location=_sample@utils.py:2437, xla_shape=s64[1]{0}
  %4456 = s64[1]{0} aten::mul(%4455, %4), scope=aten::mul.1092, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4457 = s64[1]{0} aten::add(%4456, %7, %0), scope=aten::add.1095, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4458 = s64[1]{0} xla::select(%4457), location=_sample@utils.py:2446, xla_shape=s64[1]{0}
  %4459 = s64[1,1]{1,0} aten::view(%4458), location=_sample@utils.py:2446, xla_shape=s64[1,1]{1,0}
  %4460 = s64[1,30]{1,0} aten::cat(%29, %4459), location=_sample@utils.py:2446, xla_shape=s64[1,30]{1,0}
  %4461 = s64[1,30]{1,0} xla::select(%4460), location=__call__@stopping_criteria.py:534, xla_shape=s64[1,30]{1,0}
  %4462 = s64[1,1]{1,0} xla::generic_slice(%4461), location=__call__@stopping_criteria.py:534, xla_shape=s64[1,1]{1,0}
  %4463 = s64[1]{0} aten::view(%4462), location=__call__@stopping_criteria.py:534, xla_shape=s64[1]{0}, ROOT=0
}

Graph Hash: 21559f962b979a831128b4b8d6d10465

## END_GRAPH

[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  _has_unfinished_sequences (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1922)
  _sample (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:2392)
  generate (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/generation/utils.py:1758)
  decorate_context (/workspaces/hug/hug/lib/python3.10/site-packages/torch/utils/_contextlib.py:116)
  <module> (/tmp/ipykernel_1456554/2982293035.py:14)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (b43a080c251b62cde4cfe98c840c63c4)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_sample@utils.py:2456, xla_shape=s64[]
  %1 = pred[1]{0} xla::device_data(), location=__call__@stopping_criteria.py:534, xla_shape=pred[1]{0}
  %2 = pred[] xla::device_data(), location=__call__@stopping_criteria.py:82, xla_shape=pred[]
  %3 = pred[1]{0} aten::expand(%2), location=__call__@stopping_criteria.py:82, xla_shape=pred[1]{0}
  %4 = pred[] xla::device_data(), location=__call__@stopping_criteria.py:542, xla_shape=pred[]
  %5 = pred[1]{0} aten::expand(%4), location=__call__@stopping_criteria.py:542, xla_shape=pred[1]{0}
  %6 = pred[1]{0} aten::bitwise_or(%5, %3), location=__call__@stopping_criteria.py:546, xla_shape=pred[1]{0}
  %7 = pred[1]{0} aten::bitwise_or(%6, %1), location=__call__@stopping_criteria.py:546, xla_shape=pred[1]{0}
  %8 = pred[1]{0} aten::bitwise_not(%7), location=_sample@utils.py:2455, xla_shape=pred[1]{0}
  %9 = s64[] prim::Constant(), location=_sample@utils.py:2389, xla_shape=s64[]
  %10 = s64[1]{0} aten::expand(%9), location=_sample@utils.py:2389, xla_shape=s64[1]{0}
  %11 = s64[1]{0} aten::bitwise_and(%10, %8), location=_sample@utils.py:2455, xla_shape=s64[1]{0}
  %12 = s64[] aten::max(%11), location=_sample@utils.py:2456, xla_shape=s64[]
  %13 = pred[] aten::eq(%12, %0), location=_sample@utils.py:2456, xla_shape=pred[], ROOT=0
}

Graph Hash: aa649370a67c9feb3603953c7b4c93a6

## END_GRAPH

[ScheduleSyncTensorsGraph]
TensorsGraphInfo:
  <lambda> (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/utils/generic.py:259)
  to_py_obj (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/utils/generic.py:274)
  decode (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:3834)
  <listcomp> (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:3797)
  batch_decode (/workspaces/hug/hug/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:3796)
  <module> (/tmp/ipykernel_1456554/2982293035.py:20)
  run_code (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3577)
  run_ast_nodes (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3517)
  run_cell_async (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3334)
  _pseudo_sync_runner (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/async_helpers.py:128)
  _run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3130)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/IPython/core/interactiveshell.py:3075)
  run_cell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/zmqshell.py:549)
  do_execute (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:449)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:778)
  execute_request (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/ipkernel.py:362)
  dispatch_shell (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:437)
  process_one (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:534)
  dispatch_queue (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelbase.py:545)
  _run (/usr/local/lib/python3.10/asyncio/events.py:80)
  _run_once (/usr/local/lib/python3.10/asyncio/base_events.py:1909)
  run_forever (/usr/local/lib/python3.10/asyncio/base_events.py:603)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/tornado/platform/asyncio.py:205)
  start (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel/kernelapp.py:739)
  launch_instance (/workspaces/hug/hug/lib/python3.10/site-packages/traitlets/config/application.py:1075)
  <module> (/workspaces/hug/hug/lib/python3.10/site-packages/ipykernel_launcher.py:18)
  _run_code (/usr/local/lib/python3.10/runpy.py:86)
  _run_module_as_main (/usr/local/lib/python3.10/runpy.py:196)

Root Hashes: (f55a821d9238f67b97f058024b384513)

## BEGIN_GRAPH
IR {
  %0 = s64[] prim::Constant(), location=_sample@utils.py:2443, xla_shape=s64[]
  %1 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %2 = s64[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=s64[]
  %3 = s64[] prim::Constant(), location=_sample@utils.py:2389, xla_shape=s64[]
  %4 = s64[1]{0} aten::expand(%3), location=_sample@utils.py:2389, xla_shape=s64[1]{0}
  %5 = s64[1]{0} aten::rsub(%4, %2, %1), scope=aten::rsub.1093, location=__rsub__@_tensor.py:962, xla_shape=s64[1]{0}
  %6 = s64[] xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[]
  %7 = s64[1]{0} aten::mul(%6, %5), scope=aten::mul.1094, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %8 = s64[] xla::device_data(), location=_sample@utils.py:2437, xla_shape=s64[]
  %9 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %10 = s64[] aten::mul(%9, %8), location=_sample@utils.py:2437, xla_shape=s64[]
  %11 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %12 = s64[] aten::add(%11, %10), location=_sample@utils.py:2437, xla_shape=s64[]
  %13 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %14 = s64[] aten::mul(%13, %12), location=_sample@utils.py:2437, xla_shape=s64[]
  %15 = s64[] prim::Constant(), location=_sample@utils.py:2437, xla_shape=s64[]
  %16 = s64[] aten::add(%15, %14), location=_sample@utils.py:2437, xla_shape=s64[]
  %17 = f64[] xla::device_data(), location=__call__@logits_process.py:468, xla_shape=f64[]
  %18 = pred[] prim::Constant(), location=__call__@logits_process.py:464, xla_shape=pred[]
  %19 = pred[] aten::expand(%18), location=__call__@logits_process.py:464, xla_shape=pred[]
  %20 = pred[] aten::view(%19), location=__call__@logits_process.py:464, xla_shape=pred[]
  %21 = pred[1,1]{1,0} aten::expand(%20), location=__call__@logits_process.py:464, xla_shape=pred[1,1]{1,0}
  %22 = f64[] xla::device_data(), location=__call__@logits_process.py:462, xla_shape=f64[]
  %23 = f64[] xla::device_data(), location=__call__@logits_process.py:521, xla_shape=f64[]
  %24 = f32[] xla::device_data(), location=__call__@logits_process.py:292, xla_shape=f32[]
  %25 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %26 = s64[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %27 = s64[1,1,29]{2,1,0} aten::view(%26), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %28 = s64[1,1,29]{2,1,0} aten::expand(%27), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,1,29]{2,1,0}
  %29 = s64[1,29]{1,0} aten::view(%28), location=_expand_inputs_for_generation@utils.py:602, xla_shape=s64[1,29]{1,0}
  %30 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %31 = bf16[3584,152064]{0,1} aten::permute(%30), location=forward@linear.py:117, xla_shape=bf16[3584,152064]{0,1}
  %32 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %33 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %34 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %35 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %36 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %37 = bf16[18944,3584]{0,1} aten::permute(%36), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %38 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %39 = bf16[3584,18944]{0,1} aten::permute(%38), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %40 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %41 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %42 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %43 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %44 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %45 = bf16[3584,3584]{0,1} aten::permute(%44), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %46 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %47 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %48 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %49 = bf16[3584,512]{0,1} aten::permute(%48), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %50 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %51 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %52 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %53 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %54 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %55 = bf16[18944,3584]{0,1} aten::permute(%54), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %56 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %57 = bf16[3584,18944]{0,1} aten::permute(%56), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %58 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %59 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %60 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %61 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %62 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %63 = bf16[3584,3584]{0,1} aten::permute(%62), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %64 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %65 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %66 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %67 = bf16[3584,512]{0,1} aten::permute(%66), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %68 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %69 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %70 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %71 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %72 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %73 = bf16[18944,3584]{0,1} aten::permute(%72), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %74 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %75 = bf16[3584,18944]{0,1} aten::permute(%74), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %76 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %77 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %78 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %79 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %80 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %81 = bf16[3584,3584]{0,1} aten::permute(%80), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %82 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %83 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %84 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %85 = bf16[3584,512]{0,1} aten::permute(%84), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %86 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %87 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %88 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %89 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %90 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %91 = bf16[18944,3584]{0,1} aten::permute(%90), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %92 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %93 = bf16[3584,18944]{0,1} aten::permute(%92), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %94 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %95 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %96 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %97 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %98 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %99 = bf16[3584,3584]{0,1} aten::permute(%98), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %100 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %101 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %102 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %103 = bf16[3584,512]{0,1} aten::permute(%102), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %104 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %105 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %106 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %107 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %108 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %109 = bf16[18944,3584]{0,1} aten::permute(%108), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %110 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %111 = bf16[3584,18944]{0,1} aten::permute(%110), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %112 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %113 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %114 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %115 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %116 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %117 = bf16[3584,3584]{0,1} aten::permute(%116), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %118 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %119 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %120 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %121 = bf16[3584,512]{0,1} aten::permute(%120), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %122 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %123 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %124 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %125 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %126 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %127 = bf16[18944,3584]{0,1} aten::permute(%126), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %128 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %129 = bf16[3584,18944]{0,1} aten::permute(%128), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %130 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %131 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %132 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %133 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %134 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %135 = bf16[3584,3584]{0,1} aten::permute(%134), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %136 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %137 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %138 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %139 = bf16[3584,512]{0,1} aten::permute(%138), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %140 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %141 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %142 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %143 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %144 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %145 = bf16[18944,3584]{0,1} aten::permute(%144), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %146 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %147 = bf16[3584,18944]{0,1} aten::permute(%146), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %148 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %149 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %150 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %151 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %152 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %153 = bf16[3584,3584]{0,1} aten::permute(%152), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %154 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %155 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %156 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %157 = bf16[3584,512]{0,1} aten::permute(%156), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %158 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %159 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %160 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %161 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %162 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %163 = bf16[18944,3584]{0,1} aten::permute(%162), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %164 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %165 = bf16[3584,18944]{0,1} aten::permute(%164), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %166 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %167 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %168 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %169 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %170 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %171 = bf16[3584,3584]{0,1} aten::permute(%170), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %172 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %173 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %174 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %175 = bf16[3584,512]{0,1} aten::permute(%174), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %176 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %177 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %178 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %179 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %180 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %181 = bf16[18944,3584]{0,1} aten::permute(%180), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %182 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %183 = bf16[3584,18944]{0,1} aten::permute(%182), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %184 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %185 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %186 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %187 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %188 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %189 = bf16[3584,3584]{0,1} aten::permute(%188), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %190 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %191 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %192 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %193 = bf16[3584,512]{0,1} aten::permute(%192), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %194 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %195 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %196 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %197 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %198 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %199 = bf16[18944,3584]{0,1} aten::permute(%198), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %200 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %201 = bf16[3584,18944]{0,1} aten::permute(%200), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %202 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %203 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %204 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %205 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %206 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %207 = bf16[3584,3584]{0,1} aten::permute(%206), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %208 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %209 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %210 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %211 = bf16[3584,512]{0,1} aten::permute(%210), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %212 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %213 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %214 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %215 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %216 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %217 = bf16[18944,3584]{0,1} aten::permute(%216), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %218 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %219 = bf16[3584,18944]{0,1} aten::permute(%218), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %220 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %221 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %222 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %223 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %224 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %225 = bf16[3584,3584]{0,1} aten::permute(%224), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %226 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %227 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %228 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %229 = bf16[3584,512]{0,1} aten::permute(%228), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %230 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %231 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %232 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %233 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %234 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %235 = bf16[18944,3584]{0,1} aten::permute(%234), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %236 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %237 = bf16[3584,18944]{0,1} aten::permute(%236), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %238 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %239 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %240 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %241 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %242 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %243 = bf16[3584,3584]{0,1} aten::permute(%242), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %244 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %245 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %246 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %247 = bf16[3584,512]{0,1} aten::permute(%246), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %248 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %249 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %250 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %251 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %252 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %253 = bf16[18944,3584]{0,1} aten::permute(%252), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %254 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %255 = bf16[3584,18944]{0,1} aten::permute(%254), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %256 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %257 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %258 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %259 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %260 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %261 = bf16[3584,3584]{0,1} aten::permute(%260), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %262 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %263 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %264 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %265 = bf16[3584,512]{0,1} aten::permute(%264), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %266 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %267 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %268 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %269 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %270 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %271 = bf16[18944,3584]{0,1} aten::permute(%270), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %272 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %273 = bf16[3584,18944]{0,1} aten::permute(%272), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %274 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %275 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %276 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %277 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %278 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %279 = bf16[3584,3584]{0,1} aten::permute(%278), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %280 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %281 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %282 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %283 = bf16[3584,512]{0,1} aten::permute(%282), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %284 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %285 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %286 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %287 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %288 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %289 = bf16[18944,3584]{0,1} aten::permute(%288), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %290 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %291 = bf16[3584,18944]{0,1} aten::permute(%290), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %292 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %293 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %294 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %295 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %296 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %297 = bf16[3584,3584]{0,1} aten::permute(%296), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %298 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %299 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %300 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %301 = bf16[3584,512]{0,1} aten::permute(%300), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %302 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %303 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %304 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %305 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %306 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %307 = bf16[18944,3584]{0,1} aten::permute(%306), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %308 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %309 = bf16[3584,18944]{0,1} aten::permute(%308), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %310 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %311 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %312 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %313 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %314 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %315 = bf16[3584,3584]{0,1} aten::permute(%314), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %316 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %317 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %318 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %319 = bf16[3584,512]{0,1} aten::permute(%318), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %320 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %321 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %322 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %323 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %324 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %325 = bf16[18944,3584]{0,1} aten::permute(%324), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %326 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %327 = bf16[3584,18944]{0,1} aten::permute(%326), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %328 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %329 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %330 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %331 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %332 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %333 = bf16[3584,3584]{0,1} aten::permute(%332), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %334 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %335 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %336 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %337 = bf16[3584,512]{0,1} aten::permute(%336), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %338 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %339 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %340 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %341 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %342 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %343 = bf16[18944,3584]{0,1} aten::permute(%342), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %344 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %345 = bf16[3584,18944]{0,1} aten::permute(%344), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %346 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %347 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %348 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %349 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %350 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %351 = bf16[3584,3584]{0,1} aten::permute(%350), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %352 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %353 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %354 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %355 = bf16[3584,512]{0,1} aten::permute(%354), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %356 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %357 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %358 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %359 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %360 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %361 = bf16[18944,3584]{0,1} aten::permute(%360), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %362 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %363 = bf16[3584,18944]{0,1} aten::permute(%362), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %364 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %365 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %366 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %367 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %368 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %369 = bf16[3584,3584]{0,1} aten::permute(%368), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %370 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %371 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %372 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %373 = bf16[3584,512]{0,1} aten::permute(%372), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %374 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %375 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %376 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %377 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %378 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %379 = bf16[18944,3584]{0,1} aten::permute(%378), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %380 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %381 = bf16[3584,18944]{0,1} aten::permute(%380), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %382 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %383 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %384 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %385 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %386 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %387 = bf16[3584,3584]{0,1} aten::permute(%386), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %388 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %389 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %390 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %391 = bf16[3584,512]{0,1} aten::permute(%390), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %392 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %393 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %394 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %395 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %396 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %397 = bf16[18944,3584]{0,1} aten::permute(%396), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %398 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %399 = bf16[3584,18944]{0,1} aten::permute(%398), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %400 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %401 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %402 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %403 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %404 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %405 = bf16[3584,3584]{0,1} aten::permute(%404), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %406 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %407 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %408 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %409 = bf16[3584,512]{0,1} aten::permute(%408), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %410 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %411 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %412 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %413 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %414 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %415 = bf16[18944,3584]{0,1} aten::permute(%414), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %416 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %417 = bf16[3584,18944]{0,1} aten::permute(%416), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %418 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %419 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %420 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %421 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %422 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %423 = bf16[3584,3584]{0,1} aten::permute(%422), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %424 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %425 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %426 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %427 = bf16[3584,512]{0,1} aten::permute(%426), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %428 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %429 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %430 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %431 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %432 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %433 = bf16[18944,3584]{0,1} aten::permute(%432), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %434 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %435 = bf16[3584,18944]{0,1} aten::permute(%434), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %436 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %437 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %438 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %439 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %440 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %441 = bf16[3584,3584]{0,1} aten::permute(%440), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %442 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %443 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %444 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %445 = bf16[3584,512]{0,1} aten::permute(%444), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %446 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %447 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %448 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %449 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %450 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %451 = bf16[18944,3584]{0,1} aten::permute(%450), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %452 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %453 = bf16[3584,18944]{0,1} aten::permute(%452), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %454 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %455 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %456 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %457 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %458 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %459 = bf16[3584,3584]{0,1} aten::permute(%458), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %460 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %461 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %462 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %463 = bf16[3584,512]{0,1} aten::permute(%462), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %464 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %465 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %466 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %467 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %468 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %469 = bf16[18944,3584]{0,1} aten::permute(%468), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %470 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %471 = bf16[3584,18944]{0,1} aten::permute(%470), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %472 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %473 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %474 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %475 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %476 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %477 = bf16[3584,3584]{0,1} aten::permute(%476), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %478 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %479 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %480 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %481 = bf16[3584,512]{0,1} aten::permute(%480), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %482 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %483 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %484 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %485 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %486 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %487 = bf16[18944,3584]{0,1} aten::permute(%486), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %488 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %489 = bf16[3584,18944]{0,1} aten::permute(%488), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %490 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %491 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %492 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %493 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %494 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %495 = bf16[3584,3584]{0,1} aten::permute(%494), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %496 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %497 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %498 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %499 = bf16[3584,512]{0,1} aten::permute(%498), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %500 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %501 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %502 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %503 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %504 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %505 = bf16[18944,3584]{0,1} aten::permute(%504), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %506 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %507 = bf16[3584,18944]{0,1} aten::permute(%506), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %508 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %509 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %510 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %511 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %512 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %513 = bf16[3584,3584]{0,1} aten::permute(%512), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %514 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %515 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %516 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %517 = bf16[3584,512]{0,1} aten::permute(%516), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %518 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %519 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %520 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %521 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:762, xla_shape=bf16[]
  %522 = bf16[3584,18944]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,18944]{1,0}
  %523 = bf16[18944,3584]{0,1} aten::permute(%522), location=forward@linear.py:117, xla_shape=bf16[18944,3584]{0,1}
  %524 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %525 = bf16[3584,18944]{0,1} aten::permute(%524), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %526 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %527 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %528 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %529 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:756, xla_shape=bf16[]
  %530 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %531 = bf16[3584,3584]{0,1} aten::permute(%530), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %532 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %533 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %534 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %535 = bf16[3584,512]{0,1} aten::permute(%534), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %536 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %537 = f32[] xla::device_data(), location=forward@modeling_qwen2.py:88, xla_shape=f32[]
  %538 = f32[] prim::Constant(), location=forward@modeling_qwen2.py:87, xla_shape=f32[]
  %539 = s64[29]{0} aten::view(%29), location=embedding@functional.py:2267, xla_shape=s64[29]{0}
  %540 = bf16[152064,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[152064,3584]{1,0}
  %541 = bf16[29,3584]{1,0} aten::index_select(%540, %539), location=embedding@functional.py:2267, xla_shape=bf16[29,3584]{1,0}
  %542 = bf16[1,29,3584]{2,1,0} aten::view(%541), location=embedding@functional.py:2267, xla_shape=bf16[1,29,3584]{2,1,0}
  %543 = f32[1,29,3584]{2,1,0} xla::cast(%542), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %544 = f32[1,29,3584]{2,1,0} aten::pow(%543, %538), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %545 = f32[1,29,1]{2,1,0} aten::mean(%544), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %546 = f32[1,29,1]{2,1,0} aten::add(%545, %537, %536), scope=aten::add.556, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %547 = f32[1,29,1]{2,1,0} aten::rsqrt(%546), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %548 = f32[1,29,3584]{2,1,0} aten::mul(%543, %547), scope=aten::mul.557, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %549 = bf16[1,29,3584]{2,1,0} xla::cast(%548), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %550 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %551 = bf16[1,29,3584]{2,1,0} aten::mul(%550, %549), scope=aten::mul.558, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %552 = bf16[29,3584]{1,0} aten::view(%551), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %553 = bf16[29,512]{1,0} aten::mm(%552, %535), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %554 = bf16[1,29,512]{2,1,0} aten::view(%553), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %555 = bf16[1,29,512]{2,1,0} aten::add(%554, %533, %532), scope=aten::add.561, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %556 = bf16[1,29,4,128]{3,2,1,0} aten::view(%555), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %557 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%556), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %558 = bf16[1,4,29,128]{3,1,2,0} xla::select(%557), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %559 = bf16[1,4,29,128]{3,1,2,0} xla::select(%558), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %560 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%559), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %561 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%560), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %562 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%561), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %563 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%562), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %564 = bf16[1,28,29,128]{3,2,1,0} aten::view(%563), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %565 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%564), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %566 = bf16[28,29,128]{2,1,0} aten::view(%565), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %567 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %568 = f64[] xla::device_data(), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=f64[]
  %569 = f64[] xla::device_data(), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=f64[]
  %570 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %571 = bf16[] prim::Constant(), location=__rsub__@_tensor.py:962, xla_shape=bf16[]
  %572 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[]
  %573 = pred[2]{0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[2]{0}
  %574 = pred[] aten::any(%573), location=_prepare_attention_mask_for_generation@utils.py:476, xla_shape=pred[]
  %575 = pred[] aten::bitwise_not(%574), location=_prepare_attention_mask_for_generation@utils.py:475, xla_shape=pred[]
  %576 = pred[1,29]{1,0} xla::device_data(), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[1,29]{1,0}
  %577 = pred[] aten::any(%576), location=_prepare_attention_mask_for_generation@utils.py:473, xla_shape=pred[]
  %578 = pred[] aten::mul(%577, %575), scope=aten::mul.549, location=_prepare_attention_mask_for_generation@utils.py:478, xla_shape=pred[]
  %579 = pred[] aten::bitwise_not(%578), location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=pred[]
  %580 = s64[] prim::Constant(), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[]
  %581 = s64[1,29]{1,0} aten::expand(%580), location=_prepare_attention_mask_for_generation@utils.py:457, xla_shape=s64[1,29]{1,0}
  %582 = s64[1,29]{1,0} aten::mul(%581, %579), scope=aten::mul.551, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %583 = pred[1,29]{1,0} aten::ne(%26, %6), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=pred[1,29]{1,0}
  %584 = s64[1,29]{1,0} xla::cast(%583), location=_prepare_attention_mask_for_generation@utils.py:479, xla_shape=s64[1,29]{1,0}
  %585 = s64[1,29]{1,0} aten::mul(%584, %578), scope=aten::mul.550, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %586 = s64[1,29]{1,0} aten::add(%585, %582, %572), scope=aten::add.552, location=_prepare_attention_mask_for_generation@utils.py:482, xla_shape=s64[1,29]{1,0}
  %587 = s64[1,1,29]{2,1,0} aten::view(%586), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %588 = s64[1,1,29]{2,1,0} aten::expand(%587), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,1,29]{2,1,0}
  %589 = s64[1,29]{1,0} aten::view(%588), location=_expand_dict_for_generation@utils.py:598, xla_shape=s64[1,29]{1,0}
  %590 = s64[1,29]{1,0} xla::select(%589), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,29]{1,0}
  %591 = s64[1,1,29]{2,1,0} aten::view(%590), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29]{2,1,0}
  %592 = s64[1,1,1,29]{3,2,1,0} aten::view(%591), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %593 = s64[1,1,1,29]{3,2,1,0} xla::select(%592), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,1,29]{3,2,1,0}
  %594 = s64[1,1,29,29]{3,2,1,0} aten::expand(%593), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=s64[1,1,29,29]{3,2,1,0}
  %595 = bf16[1,1,29,29]{3,2,1,0} xla::cast(%594), location=_expand_mask@modeling_attn_mask_utils.py:182, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %596 = bf16[1,1,29,29]{3,2,1,0} aten::rsub(%595, %571, %570), scope=aten::rsub.555, location=__rsub__@_tensor.py:962, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %597 = pred[1,1,29,29]{3,2,1,0} xla::cast(%596), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %598 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%596, %597, %569), location=_expand_mask@modeling_attn_mask_utils.py:186, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %599 = pred[1,1,29,29]{3,2,1,0} xla::cast(%598), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=pred[1,1,29,29]{3,2,1,0}
  %600 = f64[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=f64[]
  %601 = pred[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[]
  %602 = pred[29,29]{1,0} aten::expand(%601), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %603 = pred[29,29]{1,0} aten::tril(%602), location=_make_causal_mask@modeling_attn_mask_utils.py:169, xla_shape=pred[29,29]{1,0}
  %604 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %605 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %606 = s64[] prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[]
  %607 = s64[29]{0} prim::Constant(), location=_make_causal_mask@modeling_attn_mask_utils.py:157, xla_shape=s64[29]{0}
  %608 = s64[29]{0} aten::add(%607, %606, %605), scope=aten::add.554, location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29]{0}
  %609 = s64[29,1]{1,0} aten::view(%608), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=s64[29,1]{1,0}
  %610 = pred[29,29]{1,0} aten::lt(%607, %609), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=pred[29,29]{1,0}
  %611 = f32[] xla::device_data(), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[]
  %612 = f32[29,29]{1,0} aten::expand(%611), location=_make_causal_mask@modeling_attn_mask_utils.py:156, xla_shape=f32[29,29]{1,0}
  %613 = f32[29,29]{1,0} aten::masked_fill(%612, %610, %604), location=_make_causal_mask@modeling_attn_mask_utils.py:158, xla_shape=f32[29,29]{1,0}
  %614 = bf16[29,29]{1,0} xla::cast(%613), location=_make_causal_mask@modeling_attn_mask_utils.py:160, xla_shape=bf16[29,29]{1,0}
  %615 = bf16[29,29]{1,0} aten::masked_fill(%614, %603, %600), location=_make_causal_mask@modeling_attn_mask_utils.py:170, xla_shape=bf16[29,29]{1,0}
  %616 = bf16[1,29,29]{2,1,0} aten::view(%615), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,29,29]{2,1,0}
  %617 = bf16[1,1,29,29]{3,2,1,0} aten::view(%616), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %618 = bf16[1,1,29,29]{3,2,1,0} xla::select(%617), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %619 = bf16[1,1,29,29]{3,2,1,0} xla::select(%618), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %620 = bf16[1,1,29,29]{3,2,1,0} aten::expand(%619), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %621 = bf16[1,1,29,29]{3,2,1,0} aten::masked_fill(%620, %599, %568), location=to_4d@modeling_attn_mask_utils.py:137, xla_shape=bf16[1,1,29,29]{3,2,1,0}
  %622 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %623 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %624 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %625 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[]
  %626 = pred[1,29]{1,0} aten::eq(%589, %625), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=pred[1,29]{1,0}
  %627 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %628 = s64[] prim::Constant(), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[]
  %629 = s64[1,29]{1,0} aten::cumsum(%589), location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %630 = s64[1,29]{1,0} aten::sub(%629, %628, %627), scope=aten::sub.553, location=prepare_inputs_for_generation@modeling_qwen2.py:1226, xla_shape=s64[1,29]{1,0}
  %631 = s64[1,29]{1,0} aten::masked_fill(%630, %626, %624), location=prepare_inputs_for_generation@modeling_qwen2.py:1227, xla_shape=s64[1,29]{1,0}
  %632 = s64[1,29]{1,0} aten::view(%631), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %633 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %634 = s64[1,29]{1,0} aten::expand(%633), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %635 = s64[1,29]{1,0} aten::add(%632, %634), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %636 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %637 = pred[1,29]{1,0} aten::lt(%632, %636), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %638 = s64[1,29]{1,0} aten::where(%637, %635, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %639 = s64[1,29,1]{2,1,0} aten::stack(%638), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %640 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %641 = bf16[29,128]{1,0} xla::select(%640), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %642 = bf16[1,29,128]{2,1,0} aten::index(%641, %639), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %643 = bf16[1,1,29,128]{3,2,1,0} aten::view(%642), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %644 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %645 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %646 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %647 = bf16[3584,512]{0,1} aten::permute(%646), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %648 = bf16[29,3584]{1,0} aten::view(%551), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %649 = bf16[29,512]{1,0} aten::mm(%648, %647), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %650 = bf16[1,29,512]{2,1,0} aten::view(%649), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %651 = bf16[1,29,512]{2,1,0} aten::add(%650, %645, %644), scope=aten::add.560, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %652 = bf16[1,29,4,128]{3,2,1,0} aten::view(%651), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %653 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%652), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %654 = bf16[1,4,29,64]{3,1,2,0} xla::select(%653), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %655 = bf16[1,4,29,64]{3,1,2,0} xla::select(%653), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %656 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%655), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %657 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%656, %654), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %658 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%657, %643), scope=aten::mul.566, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %659 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %660 = s64[1,29]{1,0} aten::expand(%659), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %661 = s64[1,29]{1,0} aten::add(%632, %660), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %662 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %663 = pred[1,29]{1,0} aten::lt(%632, %662), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %664 = s64[1,29]{1,0} aten::where(%663, %661, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %665 = s64[1,29,1]{2,1,0} aten::stack(%664), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %666 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %667 = bf16[29,128]{1,0} xla::select(%666), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %668 = bf16[1,29,128]{2,1,0} aten::index(%667, %665), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %669 = bf16[1,1,29,128]{3,2,1,0} aten::view(%668), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %670 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%653, %669), scope=aten::mul.565, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %671 = bf16[1,4,29,128]{3,2,1,0} aten::add(%670, %658, %623), scope=aten::add.567, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %672 = bf16[1,4,29,128]{3,2,1,0} xla::select(%671), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %673 = bf16[1,4,29,128]{3,2,1,0} xla::select(%672), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %674 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%673), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %675 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%674), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %676 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%675), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %677 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%676), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %678 = bf16[1,28,29,128]{3,2,1,0} aten::view(%677), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %679 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%678), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %680 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%679), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %681 = bf16[28,128,29]{2,1,0} aten::view(%680), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %682 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %683 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %684 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %685 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %686 = bf16[3584,3584]{0,1} aten::permute(%685), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %687 = bf16[29,3584]{1,0} aten::view(%551), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %688 = bf16[29,3584]{1,0} aten::mm(%687, %686), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %689 = bf16[1,29,3584]{2,1,0} aten::view(%688), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %690 = bf16[1,29,3584]{2,1,0} aten::add(%689, %684, %683), scope=aten::add.559, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %691 = bf16[1,29,28,128]{3,2,1,0} aten::view(%690), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %692 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%691), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %693 = bf16[1,28,29,64]{3,1,2,0} xla::select(%692), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %694 = bf16[1,28,29,64]{3,1,2,0} xla::select(%692), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %695 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%694), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %696 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%695, %693), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %697 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%696, %643), scope=aten::mul.563, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %698 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%692, %669), scope=aten::mul.562, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %699 = bf16[1,28,29,128]{3,2,1,0} aten::add(%698, %697, %682), scope=aten::add.564, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %700 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%699), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %701 = bf16[28,29,128]{2,1,0} aten::view(%700), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %702 = bf16[28,29,29]{2,1,0} aten::matmul(%701, %681), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %703 = bf16[1,28,29,29]{3,2,1,0} aten::view(%702), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %704 = bf16[1,28,29,29]{3,2,1,0} aten::div(%703, %622), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %705 = bf16[1,28,29,29]{3,2,1,0} aten::add(%704, %621, %567), scope=aten::add.568, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %706 = f32[1,28,29,29]{3,2,1,0} xla::cast(%705), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %707 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%706), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %708 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%707), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %709 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%708), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %710 = bf16[28,29,29]{2,1,0} aten::view(%709), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %711 = bf16[28,29,128]{2,1,0} aten::matmul(%710, %566), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %712 = bf16[1,28,29,128]{3,2,1,0} aten::view(%711), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %713 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%712), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %714 = bf16[1,29,3584]{2,1,0} aten::view(%713), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %715 = bf16[29,3584]{1,0} aten::view(%714), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %716 = bf16[29,3584]{1,0} aten::mm(%715, %531), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %717 = bf16[1,29,3584]{2,1,0} aten::view(%716), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %718 = bf16[1,29,3584]{2,1,0} aten::add(%542, %717, %529), scope=aten::add.569, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %719 = f32[1,29,3584]{2,1,0} xla::cast(%718), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %720 = f32[1,29,3584]{2,1,0} aten::pow(%719, %528), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %721 = f32[1,29,1]{2,1,0} aten::mean(%720), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %722 = f32[1,29,1]{2,1,0} aten::add(%721, %527, %526), scope=aten::add.570, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %723 = f32[1,29,1]{2,1,0} aten::rsqrt(%722), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %724 = f32[1,29,3584]{2,1,0} aten::mul(%719, %723), scope=aten::mul.571, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %725 = bf16[1,29,3584]{2,1,0} xla::cast(%724), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %726 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %727 = bf16[1,29,3584]{2,1,0} aten::mul(%726, %725), scope=aten::mul.572, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %728 = bf16[29,3584]{1,0} aten::view(%727), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %729 = bf16[29,18944]{1,0} aten::mm(%728, %525), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %730 = bf16[1,29,18944]{2,1,0} aten::view(%729), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %731 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %732 = bf16[3584,18944]{0,1} aten::permute(%731), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %733 = bf16[29,3584]{1,0} aten::view(%727), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %734 = bf16[29,18944]{1,0} aten::mm(%733, %732), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %735 = bf16[1,29,18944]{2,1,0} aten::view(%734), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %736 = bf16[1,29,18944]{2,1,0} aten::silu(%735), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %737 = bf16[1,29,18944]{2,1,0} aten::mul(%736, %730), scope=aten::mul.573, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %738 = bf16[29,18944]{1,0} aten::view(%737), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %739 = bf16[29,3584]{1,0} aten::mm(%738, %523), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %740 = bf16[1,29,3584]{2,1,0} aten::view(%739), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %741 = bf16[1,29,3584]{2,1,0} aten::add(%718, %740, %521), scope=aten::add.574, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %742 = f32[1,29,3584]{2,1,0} xla::cast(%741), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %743 = f32[1,29,3584]{2,1,0} aten::pow(%742, %520), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %744 = f32[1,29,1]{2,1,0} aten::mean(%743), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %745 = f32[1,29,1]{2,1,0} aten::add(%744, %519, %518), scope=aten::add.575, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %746 = f32[1,29,1]{2,1,0} aten::rsqrt(%745), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %747 = f32[1,29,3584]{2,1,0} aten::mul(%742, %746), scope=aten::mul.576, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %748 = bf16[1,29,3584]{2,1,0} xla::cast(%747), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %749 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %750 = bf16[1,29,3584]{2,1,0} aten::mul(%749, %748), scope=aten::mul.577, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %751 = bf16[29,3584]{1,0} aten::view(%750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %752 = bf16[29,512]{1,0} aten::mm(%751, %517), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %753 = bf16[1,29,512]{2,1,0} aten::view(%752), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %754 = bf16[1,29,512]{2,1,0} aten::add(%753, %515, %514), scope=aten::add.580, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %755 = bf16[1,29,4,128]{3,2,1,0} aten::view(%754), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %756 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%755), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %757 = bf16[1,4,29,128]{3,1,2,0} xla::select(%756), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %758 = bf16[1,4,29,128]{3,1,2,0} xla::select(%757), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %759 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%758), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %760 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%759), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %761 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%760), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %762 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%761), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %763 = bf16[1,28,29,128]{3,2,1,0} aten::view(%762), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %764 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%763), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %765 = bf16[28,29,128]{2,1,0} aten::view(%764), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %766 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %767 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %768 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %769 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %770 = s64[1,29]{1,0} aten::expand(%769), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %771 = s64[1,29]{1,0} aten::add(%632, %770), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %772 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %773 = pred[1,29]{1,0} aten::lt(%632, %772), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %774 = s64[1,29]{1,0} aten::where(%773, %771, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %775 = s64[1,29,1]{2,1,0} aten::stack(%774), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %776 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %777 = bf16[29,128]{1,0} xla::select(%776), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %778 = bf16[1,29,128]{2,1,0} aten::index(%777, %775), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %779 = bf16[1,1,29,128]{3,2,1,0} aten::view(%778), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %780 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %781 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %782 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %783 = bf16[3584,512]{0,1} aten::permute(%782), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %784 = bf16[29,3584]{1,0} aten::view(%750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %785 = bf16[29,512]{1,0} aten::mm(%784, %783), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %786 = bf16[1,29,512]{2,1,0} aten::view(%785), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %787 = bf16[1,29,512]{2,1,0} aten::add(%786, %781, %780), scope=aten::add.579, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %788 = bf16[1,29,4,128]{3,2,1,0} aten::view(%787), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %789 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%788), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %790 = bf16[1,4,29,64]{3,1,2,0} xla::select(%789), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %791 = bf16[1,4,29,64]{3,1,2,0} xla::select(%789), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %792 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%791), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %793 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%792, %790), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %794 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%793, %779), scope=aten::mul.585, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %795 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %796 = s64[1,29]{1,0} aten::expand(%795), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %797 = s64[1,29]{1,0} aten::add(%632, %796), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %798 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %799 = pred[1,29]{1,0} aten::lt(%632, %798), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %800 = s64[1,29]{1,0} aten::where(%799, %797, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %801 = s64[1,29,1]{2,1,0} aten::stack(%800), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %802 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %803 = bf16[29,128]{1,0} xla::select(%802), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %804 = bf16[1,29,128]{2,1,0} aten::index(%803, %801), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %805 = bf16[1,1,29,128]{3,2,1,0} aten::view(%804), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %806 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%789, %805), scope=aten::mul.584, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %807 = bf16[1,4,29,128]{3,2,1,0} aten::add(%806, %794, %768), scope=aten::add.586, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %808 = bf16[1,4,29,128]{3,2,1,0} xla::select(%807), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %809 = bf16[1,4,29,128]{3,2,1,0} xla::select(%808), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %810 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%809), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %811 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%810), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %812 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%811), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %813 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%812), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %814 = bf16[1,28,29,128]{3,2,1,0} aten::view(%813), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %815 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%814), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %816 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%815), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %817 = bf16[28,128,29]{2,1,0} aten::view(%816), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %818 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %819 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %820 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %821 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %822 = bf16[3584,3584]{0,1} aten::permute(%821), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %823 = bf16[29,3584]{1,0} aten::view(%750), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %824 = bf16[29,3584]{1,0} aten::mm(%823, %822), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %825 = bf16[1,29,3584]{2,1,0} aten::view(%824), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %826 = bf16[1,29,3584]{2,1,0} aten::add(%825, %820, %819), scope=aten::add.578, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %827 = bf16[1,29,28,128]{3,2,1,0} aten::view(%826), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %828 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%827), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %829 = bf16[1,28,29,64]{3,1,2,0} xla::select(%828), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %830 = bf16[1,28,29,64]{3,1,2,0} xla::select(%828), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %831 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%830), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %832 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%831, %829), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %833 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%832, %779), scope=aten::mul.582, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %834 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%828, %805), scope=aten::mul.581, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %835 = bf16[1,28,29,128]{3,2,1,0} aten::add(%834, %833, %818), scope=aten::add.583, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %836 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%835), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %837 = bf16[28,29,128]{2,1,0} aten::view(%836), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %838 = bf16[28,29,29]{2,1,0} aten::matmul(%837, %817), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %839 = bf16[1,28,29,29]{3,2,1,0} aten::view(%838), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %840 = bf16[1,28,29,29]{3,2,1,0} aten::div(%839, %767), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %841 = bf16[1,28,29,29]{3,2,1,0} aten::add(%840, %621, %766), scope=aten::add.587, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %842 = f32[1,28,29,29]{3,2,1,0} xla::cast(%841), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %843 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%842), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %844 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%843), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %845 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%844), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %846 = bf16[28,29,29]{2,1,0} aten::view(%845), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %847 = bf16[28,29,128]{2,1,0} aten::matmul(%846, %765), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %848 = bf16[1,28,29,128]{3,2,1,0} aten::view(%847), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %849 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%848), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %850 = bf16[1,29,3584]{2,1,0} aten::view(%849), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %851 = bf16[29,3584]{1,0} aten::view(%850), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %852 = bf16[29,3584]{1,0} aten::mm(%851, %513), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %853 = bf16[1,29,3584]{2,1,0} aten::view(%852), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %854 = bf16[1,29,3584]{2,1,0} aten::add(%741, %853, %511), scope=aten::add.588, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %855 = f32[1,29,3584]{2,1,0} xla::cast(%854), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %856 = f32[1,29,3584]{2,1,0} aten::pow(%855, %510), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %857 = f32[1,29,1]{2,1,0} aten::mean(%856), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %858 = f32[1,29,1]{2,1,0} aten::add(%857, %509, %508), scope=aten::add.589, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %859 = f32[1,29,1]{2,1,0} aten::rsqrt(%858), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %860 = f32[1,29,3584]{2,1,0} aten::mul(%855, %859), scope=aten::mul.590, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %861 = bf16[1,29,3584]{2,1,0} xla::cast(%860), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %862 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %863 = bf16[1,29,3584]{2,1,0} aten::mul(%862, %861), scope=aten::mul.591, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %864 = bf16[29,3584]{1,0} aten::view(%863), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %865 = bf16[29,18944]{1,0} aten::mm(%864, %507), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %866 = bf16[1,29,18944]{2,1,0} aten::view(%865), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %867 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %868 = bf16[3584,18944]{0,1} aten::permute(%867), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %869 = bf16[29,3584]{1,0} aten::view(%863), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %870 = bf16[29,18944]{1,0} aten::mm(%869, %868), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %871 = bf16[1,29,18944]{2,1,0} aten::view(%870), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %872 = bf16[1,29,18944]{2,1,0} aten::silu(%871), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %873 = bf16[1,29,18944]{2,1,0} aten::mul(%872, %866), scope=aten::mul.592, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %874 = bf16[29,18944]{1,0} aten::view(%873), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %875 = bf16[29,3584]{1,0} aten::mm(%874, %505), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %876 = bf16[1,29,3584]{2,1,0} aten::view(%875), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %877 = bf16[1,29,3584]{2,1,0} aten::add(%854, %876, %503), scope=aten::add.593, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %878 = f32[1,29,3584]{2,1,0} xla::cast(%877), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %879 = f32[1,29,3584]{2,1,0} aten::pow(%878, %502), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %880 = f32[1,29,1]{2,1,0} aten::mean(%879), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %881 = f32[1,29,1]{2,1,0} aten::add(%880, %501, %500), scope=aten::add.594, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %882 = f32[1,29,1]{2,1,0} aten::rsqrt(%881), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %883 = f32[1,29,3584]{2,1,0} aten::mul(%878, %882), scope=aten::mul.595, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %884 = bf16[1,29,3584]{2,1,0} xla::cast(%883), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %885 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %886 = bf16[1,29,3584]{2,1,0} aten::mul(%885, %884), scope=aten::mul.596, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %887 = bf16[29,3584]{1,0} aten::view(%886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %888 = bf16[29,512]{1,0} aten::mm(%887, %499), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %889 = bf16[1,29,512]{2,1,0} aten::view(%888), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %890 = bf16[1,29,512]{2,1,0} aten::add(%889, %497, %496), scope=aten::add.599, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %891 = bf16[1,29,4,128]{3,2,1,0} aten::view(%890), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %892 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%891), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %893 = bf16[1,4,29,128]{3,1,2,0} xla::select(%892), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %894 = bf16[1,4,29,128]{3,1,2,0} xla::select(%893), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %895 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%894), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %896 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%895), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %897 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%896), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %898 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%897), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %899 = bf16[1,28,29,128]{3,2,1,0} aten::view(%898), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %900 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%899), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %901 = bf16[28,29,128]{2,1,0} aten::view(%900), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %902 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %903 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %904 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %905 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %906 = s64[1,29]{1,0} aten::expand(%905), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %907 = s64[1,29]{1,0} aten::add(%632, %906), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %908 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %909 = pred[1,29]{1,0} aten::lt(%632, %908), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %910 = s64[1,29]{1,0} aten::where(%909, %907, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %911 = s64[1,29,1]{2,1,0} aten::stack(%910), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %912 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %913 = bf16[29,128]{1,0} xla::select(%912), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %914 = bf16[1,29,128]{2,1,0} aten::index(%913, %911), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %915 = bf16[1,1,29,128]{3,2,1,0} aten::view(%914), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %916 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %917 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %918 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %919 = bf16[3584,512]{0,1} aten::permute(%918), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %920 = bf16[29,3584]{1,0} aten::view(%886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %921 = bf16[29,512]{1,0} aten::mm(%920, %919), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %922 = bf16[1,29,512]{2,1,0} aten::view(%921), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %923 = bf16[1,29,512]{2,1,0} aten::add(%922, %917, %916), scope=aten::add.598, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %924 = bf16[1,29,4,128]{3,2,1,0} aten::view(%923), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %925 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%924), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %926 = bf16[1,4,29,64]{3,1,2,0} xla::select(%925), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %927 = bf16[1,4,29,64]{3,1,2,0} xla::select(%925), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %928 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%927), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %929 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%928, %926), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %930 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%929, %915), scope=aten::mul.604, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %931 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %932 = s64[1,29]{1,0} aten::expand(%931), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %933 = s64[1,29]{1,0} aten::add(%632, %932), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %934 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %935 = pred[1,29]{1,0} aten::lt(%632, %934), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %936 = s64[1,29]{1,0} aten::where(%935, %933, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %937 = s64[1,29,1]{2,1,0} aten::stack(%936), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %938 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %939 = bf16[29,128]{1,0} xla::select(%938), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %940 = bf16[1,29,128]{2,1,0} aten::index(%939, %937), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %941 = bf16[1,1,29,128]{3,2,1,0} aten::view(%940), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %942 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%925, %941), scope=aten::mul.603, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %943 = bf16[1,4,29,128]{3,2,1,0} aten::add(%942, %930, %904), scope=aten::add.605, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %944 = bf16[1,4,29,128]{3,2,1,0} xla::select(%943), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %945 = bf16[1,4,29,128]{3,2,1,0} xla::select(%944), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %946 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%945), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %947 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%946), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %948 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%947), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %949 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%948), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %950 = bf16[1,28,29,128]{3,2,1,0} aten::view(%949), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %951 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%950), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %952 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%951), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %953 = bf16[28,128,29]{2,1,0} aten::view(%952), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %954 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %955 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %956 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %957 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %958 = bf16[3584,3584]{0,1} aten::permute(%957), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %959 = bf16[29,3584]{1,0} aten::view(%886), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %960 = bf16[29,3584]{1,0} aten::mm(%959, %958), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %961 = bf16[1,29,3584]{2,1,0} aten::view(%960), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %962 = bf16[1,29,3584]{2,1,0} aten::add(%961, %956, %955), scope=aten::add.597, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %963 = bf16[1,29,28,128]{3,2,1,0} aten::view(%962), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %964 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%963), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %965 = bf16[1,28,29,64]{3,1,2,0} xla::select(%964), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %966 = bf16[1,28,29,64]{3,1,2,0} xla::select(%964), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %967 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%966), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %968 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%967, %965), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %969 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%968, %915), scope=aten::mul.601, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %970 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%964, %941), scope=aten::mul.600, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %971 = bf16[1,28,29,128]{3,2,1,0} aten::add(%970, %969, %954), scope=aten::add.602, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %972 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%971), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %973 = bf16[28,29,128]{2,1,0} aten::view(%972), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %974 = bf16[28,29,29]{2,1,0} aten::matmul(%973, %953), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %975 = bf16[1,28,29,29]{3,2,1,0} aten::view(%974), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %976 = bf16[1,28,29,29]{3,2,1,0} aten::div(%975, %903), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %977 = bf16[1,28,29,29]{3,2,1,0} aten::add(%976, %621, %902), scope=aten::add.606, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %978 = f32[1,28,29,29]{3,2,1,0} xla::cast(%977), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %979 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%978), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %980 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%979), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %981 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%980), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %982 = bf16[28,29,29]{2,1,0} aten::view(%981), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %983 = bf16[28,29,128]{2,1,0} aten::matmul(%982, %901), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %984 = bf16[1,28,29,128]{3,2,1,0} aten::view(%983), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %985 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%984), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %986 = bf16[1,29,3584]{2,1,0} aten::view(%985), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %987 = bf16[29,3584]{1,0} aten::view(%986), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %988 = bf16[29,3584]{1,0} aten::mm(%987, %495), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %989 = bf16[1,29,3584]{2,1,0} aten::view(%988), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %990 = bf16[1,29,3584]{2,1,0} aten::add(%877, %989, %493), scope=aten::add.607, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %991 = f32[1,29,3584]{2,1,0} xla::cast(%990), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %992 = f32[1,29,3584]{2,1,0} aten::pow(%991, %492), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %993 = f32[1,29,1]{2,1,0} aten::mean(%992), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %994 = f32[1,29,1]{2,1,0} aten::add(%993, %491, %490), scope=aten::add.608, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %995 = f32[1,29,1]{2,1,0} aten::rsqrt(%994), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %996 = f32[1,29,3584]{2,1,0} aten::mul(%991, %995), scope=aten::mul.609, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %997 = bf16[1,29,3584]{2,1,0} xla::cast(%996), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %998 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %999 = bf16[1,29,3584]{2,1,0} aten::mul(%998, %997), scope=aten::mul.610, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1000 = bf16[29,3584]{1,0} aten::view(%999), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1001 = bf16[29,18944]{1,0} aten::mm(%1000, %489), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1002 = bf16[1,29,18944]{2,1,0} aten::view(%1001), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1003 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1004 = bf16[3584,18944]{0,1} aten::permute(%1003), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1005 = bf16[29,3584]{1,0} aten::view(%999), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1006 = bf16[29,18944]{1,0} aten::mm(%1005, %1004), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1007 = bf16[1,29,18944]{2,1,0} aten::view(%1006), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1008 = bf16[1,29,18944]{2,1,0} aten::silu(%1007), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1009 = bf16[1,29,18944]{2,1,0} aten::mul(%1008, %1002), scope=aten::mul.611, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1010 = bf16[29,18944]{1,0} aten::view(%1009), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1011 = bf16[29,3584]{1,0} aten::mm(%1010, %487), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1012 = bf16[1,29,3584]{2,1,0} aten::view(%1011), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1013 = bf16[1,29,3584]{2,1,0} aten::add(%990, %1012, %485), scope=aten::add.612, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1014 = f32[1,29,3584]{2,1,0} xla::cast(%1013), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1015 = f32[1,29,3584]{2,1,0} aten::pow(%1014, %484), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1016 = f32[1,29,1]{2,1,0} aten::mean(%1015), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1017 = f32[1,29,1]{2,1,0} aten::add(%1016, %483, %482), scope=aten::add.613, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1018 = f32[1,29,1]{2,1,0} aten::rsqrt(%1017), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1019 = f32[1,29,3584]{2,1,0} aten::mul(%1014, %1018), scope=aten::mul.614, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1020 = bf16[1,29,3584]{2,1,0} xla::cast(%1019), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1021 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1022 = bf16[1,29,3584]{2,1,0} aten::mul(%1021, %1020), scope=aten::mul.615, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1023 = bf16[29,3584]{1,0} aten::view(%1022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1024 = bf16[29,512]{1,0} aten::mm(%1023, %481), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1025 = bf16[1,29,512]{2,1,0} aten::view(%1024), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1026 = bf16[1,29,512]{2,1,0} aten::add(%1025, %479, %478), scope=aten::add.618, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1027 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1026), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1028 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1027), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1029 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1028), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1030 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1029), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1031 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1030), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1032 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1031), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1033 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1032), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1034 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1033), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1035 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1034), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1036 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1035), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1037 = bf16[28,29,128]{2,1,0} aten::view(%1036), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1038 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1039 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1040 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1041 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1042 = s64[1,29]{1,0} aten::expand(%1041), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1043 = s64[1,29]{1,0} aten::add(%632, %1042), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1044 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1045 = pred[1,29]{1,0} aten::lt(%632, %1044), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1046 = s64[1,29]{1,0} aten::where(%1045, %1043, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1047 = s64[1,29,1]{2,1,0} aten::stack(%1046), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1048 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1049 = bf16[29,128]{1,0} xla::select(%1048), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1050 = bf16[1,29,128]{2,1,0} aten::index(%1049, %1047), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1051 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1050), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1052 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1053 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1054 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1055 = bf16[3584,512]{0,1} aten::permute(%1054), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1056 = bf16[29,3584]{1,0} aten::view(%1022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1057 = bf16[29,512]{1,0} aten::mm(%1056, %1055), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1058 = bf16[1,29,512]{2,1,0} aten::view(%1057), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1059 = bf16[1,29,512]{2,1,0} aten::add(%1058, %1053, %1052), scope=aten::add.617, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1060 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1059), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1061 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1060), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1062 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1061), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1063 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1061), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1064 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1063), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1065 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1064, %1062), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1066 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1065, %1051), scope=aten::mul.623, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1067 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1068 = s64[1,29]{1,0} aten::expand(%1067), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1069 = s64[1,29]{1,0} aten::add(%632, %1068), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1070 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1071 = pred[1,29]{1,0} aten::lt(%632, %1070), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1072 = s64[1,29]{1,0} aten::where(%1071, %1069, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1073 = s64[1,29,1]{2,1,0} aten::stack(%1072), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1074 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1075 = bf16[29,128]{1,0} xla::select(%1074), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1076 = bf16[1,29,128]{2,1,0} aten::index(%1075, %1073), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1077 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1076), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1078 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1061, %1077), scope=aten::mul.622, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1079 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1078, %1066, %1040), scope=aten::add.624, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1080 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1079), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1081 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1080), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1082 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1081), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1083 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1082), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1084 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1083), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1085 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1084), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1086 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1085), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1087 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1086), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1088 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1087), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1089 = bf16[28,128,29]{2,1,0} aten::view(%1088), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1090 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1091 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1092 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1093 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1094 = bf16[3584,3584]{0,1} aten::permute(%1093), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1095 = bf16[29,3584]{1,0} aten::view(%1022), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1096 = bf16[29,3584]{1,0} aten::mm(%1095, %1094), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1097 = bf16[1,29,3584]{2,1,0} aten::view(%1096), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1098 = bf16[1,29,3584]{2,1,0} aten::add(%1097, %1092, %1091), scope=aten::add.616, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1099 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1098), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1100 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1099), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1101 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1100), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1102 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1100), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1103 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1102), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1104 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1103, %1101), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1105 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1104, %1051), scope=aten::mul.620, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1106 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1100, %1077), scope=aten::mul.619, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1107 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1106, %1105, %1090), scope=aten::add.621, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1108 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1107), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1109 = bf16[28,29,128]{2,1,0} aten::view(%1108), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1110 = bf16[28,29,29]{2,1,0} aten::matmul(%1109, %1089), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1111 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1110), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1112 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1111, %1039), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1113 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1112, %621, %1038), scope=aten::add.625, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1114 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1113), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1115 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1114), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1116 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1115), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1117 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1116), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1118 = bf16[28,29,29]{2,1,0} aten::view(%1117), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1119 = bf16[28,29,128]{2,1,0} aten::matmul(%1118, %1037), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1120 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1119), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1121 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1120), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1122 = bf16[1,29,3584]{2,1,0} aten::view(%1121), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1123 = bf16[29,3584]{1,0} aten::view(%1122), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1124 = bf16[29,3584]{1,0} aten::mm(%1123, %477), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1125 = bf16[1,29,3584]{2,1,0} aten::view(%1124), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1126 = bf16[1,29,3584]{2,1,0} aten::add(%1013, %1125, %475), scope=aten::add.626, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1127 = f32[1,29,3584]{2,1,0} xla::cast(%1126), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1128 = f32[1,29,3584]{2,1,0} aten::pow(%1127, %474), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1129 = f32[1,29,1]{2,1,0} aten::mean(%1128), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1130 = f32[1,29,1]{2,1,0} aten::add(%1129, %473, %472), scope=aten::add.627, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1131 = f32[1,29,1]{2,1,0} aten::rsqrt(%1130), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1132 = f32[1,29,3584]{2,1,0} aten::mul(%1127, %1131), scope=aten::mul.628, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1133 = bf16[1,29,3584]{2,1,0} xla::cast(%1132), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1134 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1135 = bf16[1,29,3584]{2,1,0} aten::mul(%1134, %1133), scope=aten::mul.629, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1136 = bf16[29,3584]{1,0} aten::view(%1135), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1137 = bf16[29,18944]{1,0} aten::mm(%1136, %471), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1138 = bf16[1,29,18944]{2,1,0} aten::view(%1137), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1139 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1140 = bf16[3584,18944]{0,1} aten::permute(%1139), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1141 = bf16[29,3584]{1,0} aten::view(%1135), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1142 = bf16[29,18944]{1,0} aten::mm(%1141, %1140), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1143 = bf16[1,29,18944]{2,1,0} aten::view(%1142), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1144 = bf16[1,29,18944]{2,1,0} aten::silu(%1143), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1145 = bf16[1,29,18944]{2,1,0} aten::mul(%1144, %1138), scope=aten::mul.630, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1146 = bf16[29,18944]{1,0} aten::view(%1145), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1147 = bf16[29,3584]{1,0} aten::mm(%1146, %469), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1148 = bf16[1,29,3584]{2,1,0} aten::view(%1147), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1149 = bf16[1,29,3584]{2,1,0} aten::add(%1126, %1148, %467), scope=aten::add.631, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1150 = f32[1,29,3584]{2,1,0} xla::cast(%1149), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1151 = f32[1,29,3584]{2,1,0} aten::pow(%1150, %466), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1152 = f32[1,29,1]{2,1,0} aten::mean(%1151), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1153 = f32[1,29,1]{2,1,0} aten::add(%1152, %465, %464), scope=aten::add.632, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1154 = f32[1,29,1]{2,1,0} aten::rsqrt(%1153), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1155 = f32[1,29,3584]{2,1,0} aten::mul(%1150, %1154), scope=aten::mul.633, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1156 = bf16[1,29,3584]{2,1,0} xla::cast(%1155), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1157 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1158 = bf16[1,29,3584]{2,1,0} aten::mul(%1157, %1156), scope=aten::mul.634, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1159 = bf16[29,3584]{1,0} aten::view(%1158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1160 = bf16[29,512]{1,0} aten::mm(%1159, %463), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1161 = bf16[1,29,512]{2,1,0} aten::view(%1160), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1162 = bf16[1,29,512]{2,1,0} aten::add(%1161, %461, %460), scope=aten::add.637, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1163 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1162), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1164 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1163), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1165 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1164), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1166 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1165), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1167 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1166), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1168 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1167), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1169 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1168), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1170 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1169), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1171 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1170), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1172 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1171), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1173 = bf16[28,29,128]{2,1,0} aten::view(%1172), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1174 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1175 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1176 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1177 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1178 = s64[1,29]{1,0} aten::expand(%1177), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1179 = s64[1,29]{1,0} aten::add(%632, %1178), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1180 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1181 = pred[1,29]{1,0} aten::lt(%632, %1180), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1182 = s64[1,29]{1,0} aten::where(%1181, %1179, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1183 = s64[1,29,1]{2,1,0} aten::stack(%1182), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1184 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1185 = bf16[29,128]{1,0} xla::select(%1184), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1186 = bf16[1,29,128]{2,1,0} aten::index(%1185, %1183), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1187 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1186), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1188 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1189 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1190 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1191 = bf16[3584,512]{0,1} aten::permute(%1190), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1192 = bf16[29,3584]{1,0} aten::view(%1158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1193 = bf16[29,512]{1,0} aten::mm(%1192, %1191), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1194 = bf16[1,29,512]{2,1,0} aten::view(%1193), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1195 = bf16[1,29,512]{2,1,0} aten::add(%1194, %1189, %1188), scope=aten::add.636, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1196 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1195), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1197 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1196), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1198 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1197), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1199 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1197), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1200 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1199), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1201 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1200, %1198), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1202 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1201, %1187), scope=aten::mul.642, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1203 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1204 = s64[1,29]{1,0} aten::expand(%1203), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1205 = s64[1,29]{1,0} aten::add(%632, %1204), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1206 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1207 = pred[1,29]{1,0} aten::lt(%632, %1206), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1208 = s64[1,29]{1,0} aten::where(%1207, %1205, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1209 = s64[1,29,1]{2,1,0} aten::stack(%1208), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1210 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1211 = bf16[29,128]{1,0} xla::select(%1210), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1212 = bf16[1,29,128]{2,1,0} aten::index(%1211, %1209), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1213 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1212), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1214 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1197, %1213), scope=aten::mul.641, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1215 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1214, %1202, %1176), scope=aten::add.643, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1216 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1215), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1217 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1216), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1218 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1217), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1219 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1218), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1220 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1219), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1221 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1220), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1222 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1221), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1223 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1222), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1224 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1223), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1225 = bf16[28,128,29]{2,1,0} aten::view(%1224), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1226 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1227 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1228 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1229 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1230 = bf16[3584,3584]{0,1} aten::permute(%1229), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1231 = bf16[29,3584]{1,0} aten::view(%1158), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1232 = bf16[29,3584]{1,0} aten::mm(%1231, %1230), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1233 = bf16[1,29,3584]{2,1,0} aten::view(%1232), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1234 = bf16[1,29,3584]{2,1,0} aten::add(%1233, %1228, %1227), scope=aten::add.635, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1235 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1234), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1236 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1235), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1237 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1236), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1238 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1236), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1239 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1238), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1240 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1239, %1237), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1241 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1240, %1187), scope=aten::mul.639, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1242 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1236, %1213), scope=aten::mul.638, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1243 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1242, %1241, %1226), scope=aten::add.640, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1244 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1243), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1245 = bf16[28,29,128]{2,1,0} aten::view(%1244), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1246 = bf16[28,29,29]{2,1,0} aten::matmul(%1245, %1225), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1247 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1246), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1248 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1247, %1175), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1249 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1248, %621, %1174), scope=aten::add.644, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1250 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1249), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1251 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1250), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1252 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1251), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1253 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1252), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1254 = bf16[28,29,29]{2,1,0} aten::view(%1253), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1255 = bf16[28,29,128]{2,1,0} aten::matmul(%1254, %1173), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1256 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1255), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1257 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1256), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1258 = bf16[1,29,3584]{2,1,0} aten::view(%1257), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1259 = bf16[29,3584]{1,0} aten::view(%1258), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1260 = bf16[29,3584]{1,0} aten::mm(%1259, %459), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1261 = bf16[1,29,3584]{2,1,0} aten::view(%1260), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1262 = bf16[1,29,3584]{2,1,0} aten::add(%1149, %1261, %457), scope=aten::add.645, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1263 = f32[1,29,3584]{2,1,0} xla::cast(%1262), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1264 = f32[1,29,3584]{2,1,0} aten::pow(%1263, %456), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1265 = f32[1,29,1]{2,1,0} aten::mean(%1264), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1266 = f32[1,29,1]{2,1,0} aten::add(%1265, %455, %454), scope=aten::add.646, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1267 = f32[1,29,1]{2,1,0} aten::rsqrt(%1266), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1268 = f32[1,29,3584]{2,1,0} aten::mul(%1263, %1267), scope=aten::mul.647, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1269 = bf16[1,29,3584]{2,1,0} xla::cast(%1268), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1270 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1271 = bf16[1,29,3584]{2,1,0} aten::mul(%1270, %1269), scope=aten::mul.648, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1272 = bf16[29,3584]{1,0} aten::view(%1271), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1273 = bf16[29,18944]{1,0} aten::mm(%1272, %453), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1274 = bf16[1,29,18944]{2,1,0} aten::view(%1273), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1275 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1276 = bf16[3584,18944]{0,1} aten::permute(%1275), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1277 = bf16[29,3584]{1,0} aten::view(%1271), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1278 = bf16[29,18944]{1,0} aten::mm(%1277, %1276), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1279 = bf16[1,29,18944]{2,1,0} aten::view(%1278), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1280 = bf16[1,29,18944]{2,1,0} aten::silu(%1279), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1281 = bf16[1,29,18944]{2,1,0} aten::mul(%1280, %1274), scope=aten::mul.649, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1282 = bf16[29,18944]{1,0} aten::view(%1281), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1283 = bf16[29,3584]{1,0} aten::mm(%1282, %451), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1284 = bf16[1,29,3584]{2,1,0} aten::view(%1283), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1285 = bf16[1,29,3584]{2,1,0} aten::add(%1262, %1284, %449), scope=aten::add.650, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1286 = f32[1,29,3584]{2,1,0} xla::cast(%1285), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1287 = f32[1,29,3584]{2,1,0} aten::pow(%1286, %448), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1288 = f32[1,29,1]{2,1,0} aten::mean(%1287), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1289 = f32[1,29,1]{2,1,0} aten::add(%1288, %447, %446), scope=aten::add.651, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1290 = f32[1,29,1]{2,1,0} aten::rsqrt(%1289), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1291 = f32[1,29,3584]{2,1,0} aten::mul(%1286, %1290), scope=aten::mul.652, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1292 = bf16[1,29,3584]{2,1,0} xla::cast(%1291), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1293 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1294 = bf16[1,29,3584]{2,1,0} aten::mul(%1293, %1292), scope=aten::mul.653, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1295 = bf16[29,3584]{1,0} aten::view(%1294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1296 = bf16[29,512]{1,0} aten::mm(%1295, %445), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1297 = bf16[1,29,512]{2,1,0} aten::view(%1296), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1298 = bf16[1,29,512]{2,1,0} aten::add(%1297, %443, %442), scope=aten::add.656, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1299 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1298), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1300 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1299), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1301 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1300), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1302 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1301), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1303 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1302), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1304 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1303), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1305 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1304), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1306 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1305), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1307 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1306), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1308 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1307), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1309 = bf16[28,29,128]{2,1,0} aten::view(%1308), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1310 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1311 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1312 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1313 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1314 = s64[1,29]{1,0} aten::expand(%1313), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1315 = s64[1,29]{1,0} aten::add(%632, %1314), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1316 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1317 = pred[1,29]{1,0} aten::lt(%632, %1316), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1318 = s64[1,29]{1,0} aten::where(%1317, %1315, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1319 = s64[1,29,1]{2,1,0} aten::stack(%1318), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1320 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1321 = bf16[29,128]{1,0} xla::select(%1320), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1322 = bf16[1,29,128]{2,1,0} aten::index(%1321, %1319), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1323 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1322), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1324 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1325 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1326 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1327 = bf16[3584,512]{0,1} aten::permute(%1326), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1328 = bf16[29,3584]{1,0} aten::view(%1294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1329 = bf16[29,512]{1,0} aten::mm(%1328, %1327), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1330 = bf16[1,29,512]{2,1,0} aten::view(%1329), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1331 = bf16[1,29,512]{2,1,0} aten::add(%1330, %1325, %1324), scope=aten::add.655, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1332 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1331), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1333 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1332), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1334 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1333), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1335 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1333), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1336 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1335), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1337 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1336, %1334), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1338 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1337, %1323), scope=aten::mul.661, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1339 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1340 = s64[1,29]{1,0} aten::expand(%1339), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1341 = s64[1,29]{1,0} aten::add(%632, %1340), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1342 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1343 = pred[1,29]{1,0} aten::lt(%632, %1342), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1344 = s64[1,29]{1,0} aten::where(%1343, %1341, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1345 = s64[1,29,1]{2,1,0} aten::stack(%1344), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1346 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1347 = bf16[29,128]{1,0} xla::select(%1346), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1348 = bf16[1,29,128]{2,1,0} aten::index(%1347, %1345), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1349 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1348), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1350 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1333, %1349), scope=aten::mul.660, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1351 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1350, %1338, %1312), scope=aten::add.662, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1352 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1351), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1353 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1352), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1354 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1353), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1355 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1354), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1356 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1355), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1357 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1356), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1358 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1357), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1359 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1358), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1360 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1359), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1361 = bf16[28,128,29]{2,1,0} aten::view(%1360), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1362 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1363 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1364 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1365 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1366 = bf16[3584,3584]{0,1} aten::permute(%1365), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1367 = bf16[29,3584]{1,0} aten::view(%1294), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1368 = bf16[29,3584]{1,0} aten::mm(%1367, %1366), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1369 = bf16[1,29,3584]{2,1,0} aten::view(%1368), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1370 = bf16[1,29,3584]{2,1,0} aten::add(%1369, %1364, %1363), scope=aten::add.654, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1371 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1370), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1372 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1371), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1373 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1372), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1374 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1372), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1375 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1374), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1376 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1375, %1373), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1377 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1376, %1323), scope=aten::mul.658, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1378 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1372, %1349), scope=aten::mul.657, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1379 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1378, %1377, %1362), scope=aten::add.659, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1380 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1379), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1381 = bf16[28,29,128]{2,1,0} aten::view(%1380), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1382 = bf16[28,29,29]{2,1,0} aten::matmul(%1381, %1361), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1383 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1382), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1384 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1383, %1311), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1385 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1384, %621, %1310), scope=aten::add.663, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1386 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1385), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1387 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1386), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1388 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1387), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1389 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1388), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1390 = bf16[28,29,29]{2,1,0} aten::view(%1389), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1391 = bf16[28,29,128]{2,1,0} aten::matmul(%1390, %1309), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1392 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1391), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1393 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1392), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1394 = bf16[1,29,3584]{2,1,0} aten::view(%1393), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1395 = bf16[29,3584]{1,0} aten::view(%1394), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1396 = bf16[29,3584]{1,0} aten::mm(%1395, %441), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1397 = bf16[1,29,3584]{2,1,0} aten::view(%1396), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1398 = bf16[1,29,3584]{2,1,0} aten::add(%1285, %1397, %439), scope=aten::add.664, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1399 = f32[1,29,3584]{2,1,0} xla::cast(%1398), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1400 = f32[1,29,3584]{2,1,0} aten::pow(%1399, %438), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1401 = f32[1,29,1]{2,1,0} aten::mean(%1400), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1402 = f32[1,29,1]{2,1,0} aten::add(%1401, %437, %436), scope=aten::add.665, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1403 = f32[1,29,1]{2,1,0} aten::rsqrt(%1402), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1404 = f32[1,29,3584]{2,1,0} aten::mul(%1399, %1403), scope=aten::mul.666, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1405 = bf16[1,29,3584]{2,1,0} xla::cast(%1404), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1406 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1407 = bf16[1,29,3584]{2,1,0} aten::mul(%1406, %1405), scope=aten::mul.667, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1408 = bf16[29,3584]{1,0} aten::view(%1407), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1409 = bf16[29,18944]{1,0} aten::mm(%1408, %435), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1410 = bf16[1,29,18944]{2,1,0} aten::view(%1409), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1411 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1412 = bf16[3584,18944]{0,1} aten::permute(%1411), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1413 = bf16[29,3584]{1,0} aten::view(%1407), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1414 = bf16[29,18944]{1,0} aten::mm(%1413, %1412), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1415 = bf16[1,29,18944]{2,1,0} aten::view(%1414), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1416 = bf16[1,29,18944]{2,1,0} aten::silu(%1415), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1417 = bf16[1,29,18944]{2,1,0} aten::mul(%1416, %1410), scope=aten::mul.668, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1418 = bf16[29,18944]{1,0} aten::view(%1417), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1419 = bf16[29,3584]{1,0} aten::mm(%1418, %433), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1420 = bf16[1,29,3584]{2,1,0} aten::view(%1419), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1421 = bf16[1,29,3584]{2,1,0} aten::add(%1398, %1420, %431), scope=aten::add.669, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1422 = f32[1,29,3584]{2,1,0} xla::cast(%1421), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1423 = f32[1,29,3584]{2,1,0} aten::pow(%1422, %430), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1424 = f32[1,29,1]{2,1,0} aten::mean(%1423), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1425 = f32[1,29,1]{2,1,0} aten::add(%1424, %429, %428), scope=aten::add.670, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1426 = f32[1,29,1]{2,1,0} aten::rsqrt(%1425), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1427 = f32[1,29,3584]{2,1,0} aten::mul(%1422, %1426), scope=aten::mul.671, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1428 = bf16[1,29,3584]{2,1,0} xla::cast(%1427), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1429 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1430 = bf16[1,29,3584]{2,1,0} aten::mul(%1429, %1428), scope=aten::mul.672, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1431 = bf16[29,3584]{1,0} aten::view(%1430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1432 = bf16[29,512]{1,0} aten::mm(%1431, %427), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1433 = bf16[1,29,512]{2,1,0} aten::view(%1432), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1434 = bf16[1,29,512]{2,1,0} aten::add(%1433, %425, %424), scope=aten::add.675, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1435 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1434), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1436 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1435), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1437 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1436), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1438 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1437), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1439 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1438), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1440 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1439), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1441 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1440), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1442 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1441), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1443 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1442), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1444 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1443), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1445 = bf16[28,29,128]{2,1,0} aten::view(%1444), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1446 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1447 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1448 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1449 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1450 = s64[1,29]{1,0} aten::expand(%1449), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1451 = s64[1,29]{1,0} aten::add(%632, %1450), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1452 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1453 = pred[1,29]{1,0} aten::lt(%632, %1452), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1454 = s64[1,29]{1,0} aten::where(%1453, %1451, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1455 = s64[1,29,1]{2,1,0} aten::stack(%1454), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1456 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1457 = bf16[29,128]{1,0} xla::select(%1456), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1458 = bf16[1,29,128]{2,1,0} aten::index(%1457, %1455), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1459 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1458), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1460 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1461 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1462 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1463 = bf16[3584,512]{0,1} aten::permute(%1462), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1464 = bf16[29,3584]{1,0} aten::view(%1430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1465 = bf16[29,512]{1,0} aten::mm(%1464, %1463), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1466 = bf16[1,29,512]{2,1,0} aten::view(%1465), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1467 = bf16[1,29,512]{2,1,0} aten::add(%1466, %1461, %1460), scope=aten::add.674, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1468 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1467), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1469 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1468), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1470 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1469), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1471 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1469), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1472 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1471), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1473 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1472, %1470), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1474 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1473, %1459), scope=aten::mul.680, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1475 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1476 = s64[1,29]{1,0} aten::expand(%1475), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1477 = s64[1,29]{1,0} aten::add(%632, %1476), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1478 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1479 = pred[1,29]{1,0} aten::lt(%632, %1478), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1480 = s64[1,29]{1,0} aten::where(%1479, %1477, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1481 = s64[1,29,1]{2,1,0} aten::stack(%1480), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1482 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1483 = bf16[29,128]{1,0} xla::select(%1482), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1484 = bf16[1,29,128]{2,1,0} aten::index(%1483, %1481), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1485 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1484), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1486 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1469, %1485), scope=aten::mul.679, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1487 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1486, %1474, %1448), scope=aten::add.681, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1488 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1487), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1489 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1488), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1490 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1489), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1491 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1490), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1492 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1491), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1493 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1492), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1494 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1493), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1495 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1494), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1496 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1495), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1497 = bf16[28,128,29]{2,1,0} aten::view(%1496), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1498 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1499 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1500 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1501 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1502 = bf16[3584,3584]{0,1} aten::permute(%1501), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1503 = bf16[29,3584]{1,0} aten::view(%1430), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1504 = bf16[29,3584]{1,0} aten::mm(%1503, %1502), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1505 = bf16[1,29,3584]{2,1,0} aten::view(%1504), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1506 = bf16[1,29,3584]{2,1,0} aten::add(%1505, %1500, %1499), scope=aten::add.673, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1507 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1506), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1508 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1507), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1509 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1508), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1510 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1508), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1511 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1510), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1512 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1511, %1509), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1513 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1512, %1459), scope=aten::mul.677, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1514 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1508, %1485), scope=aten::mul.676, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1515 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1514, %1513, %1498), scope=aten::add.678, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1516 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1515), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1517 = bf16[28,29,128]{2,1,0} aten::view(%1516), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1518 = bf16[28,29,29]{2,1,0} aten::matmul(%1517, %1497), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1519 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1518), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1520 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1519, %1447), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1521 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1520, %621, %1446), scope=aten::add.682, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1522 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1521), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1523 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1522), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1524 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1523), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1525 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1524), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1526 = bf16[28,29,29]{2,1,0} aten::view(%1525), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1527 = bf16[28,29,128]{2,1,0} aten::matmul(%1526, %1445), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1528 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1527), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1529 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1528), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1530 = bf16[1,29,3584]{2,1,0} aten::view(%1529), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1531 = bf16[29,3584]{1,0} aten::view(%1530), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1532 = bf16[29,3584]{1,0} aten::mm(%1531, %423), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1533 = bf16[1,29,3584]{2,1,0} aten::view(%1532), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1534 = bf16[1,29,3584]{2,1,0} aten::add(%1421, %1533, %421), scope=aten::add.683, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1535 = f32[1,29,3584]{2,1,0} xla::cast(%1534), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1536 = f32[1,29,3584]{2,1,0} aten::pow(%1535, %420), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1537 = f32[1,29,1]{2,1,0} aten::mean(%1536), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1538 = f32[1,29,1]{2,1,0} aten::add(%1537, %419, %418), scope=aten::add.684, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1539 = f32[1,29,1]{2,1,0} aten::rsqrt(%1538), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1540 = f32[1,29,3584]{2,1,0} aten::mul(%1535, %1539), scope=aten::mul.685, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1541 = bf16[1,29,3584]{2,1,0} xla::cast(%1540), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1542 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1543 = bf16[1,29,3584]{2,1,0} aten::mul(%1542, %1541), scope=aten::mul.686, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1544 = bf16[29,3584]{1,0} aten::view(%1543), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1545 = bf16[29,18944]{1,0} aten::mm(%1544, %417), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1546 = bf16[1,29,18944]{2,1,0} aten::view(%1545), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1547 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1548 = bf16[3584,18944]{0,1} aten::permute(%1547), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1549 = bf16[29,3584]{1,0} aten::view(%1543), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1550 = bf16[29,18944]{1,0} aten::mm(%1549, %1548), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1551 = bf16[1,29,18944]{2,1,0} aten::view(%1550), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1552 = bf16[1,29,18944]{2,1,0} aten::silu(%1551), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1553 = bf16[1,29,18944]{2,1,0} aten::mul(%1552, %1546), scope=aten::mul.687, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1554 = bf16[29,18944]{1,0} aten::view(%1553), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1555 = bf16[29,3584]{1,0} aten::mm(%1554, %415), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1556 = bf16[1,29,3584]{2,1,0} aten::view(%1555), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1557 = bf16[1,29,3584]{2,1,0} aten::add(%1534, %1556, %413), scope=aten::add.688, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1558 = f32[1,29,3584]{2,1,0} xla::cast(%1557), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1559 = f32[1,29,3584]{2,1,0} aten::pow(%1558, %412), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1560 = f32[1,29,1]{2,1,0} aten::mean(%1559), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1561 = f32[1,29,1]{2,1,0} aten::add(%1560, %411, %410), scope=aten::add.689, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1562 = f32[1,29,1]{2,1,0} aten::rsqrt(%1561), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1563 = f32[1,29,3584]{2,1,0} aten::mul(%1558, %1562), scope=aten::mul.690, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1564 = bf16[1,29,3584]{2,1,0} xla::cast(%1563), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1565 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1566 = bf16[1,29,3584]{2,1,0} aten::mul(%1565, %1564), scope=aten::mul.691, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1567 = bf16[29,3584]{1,0} aten::view(%1566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1568 = bf16[29,512]{1,0} aten::mm(%1567, %409), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1569 = bf16[1,29,512]{2,1,0} aten::view(%1568), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1570 = bf16[1,29,512]{2,1,0} aten::add(%1569, %407, %406), scope=aten::add.694, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1571 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1570), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1572 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1571), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1573 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1572), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1574 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1573), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1575 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1574), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1576 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1575), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1577 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1576), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1578 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1577), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1579 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1578), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1580 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1579), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1581 = bf16[28,29,128]{2,1,0} aten::view(%1580), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1582 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1583 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1584 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1585 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1586 = s64[1,29]{1,0} aten::expand(%1585), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1587 = s64[1,29]{1,0} aten::add(%632, %1586), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1588 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1589 = pred[1,29]{1,0} aten::lt(%632, %1588), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1590 = s64[1,29]{1,0} aten::where(%1589, %1587, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1591 = s64[1,29,1]{2,1,0} aten::stack(%1590), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1592 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1593 = bf16[29,128]{1,0} xla::select(%1592), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1594 = bf16[1,29,128]{2,1,0} aten::index(%1593, %1591), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1595 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1594), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1596 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1597 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1598 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1599 = bf16[3584,512]{0,1} aten::permute(%1598), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1600 = bf16[29,3584]{1,0} aten::view(%1566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1601 = bf16[29,512]{1,0} aten::mm(%1600, %1599), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1602 = bf16[1,29,512]{2,1,0} aten::view(%1601), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1603 = bf16[1,29,512]{2,1,0} aten::add(%1602, %1597, %1596), scope=aten::add.693, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1604 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1603), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1605 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1604), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1606 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1605), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1607 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1605), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1608 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1607), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1609 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1608, %1606), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1610 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1609, %1595), scope=aten::mul.699, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1611 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1612 = s64[1,29]{1,0} aten::expand(%1611), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1613 = s64[1,29]{1,0} aten::add(%632, %1612), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1614 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1615 = pred[1,29]{1,0} aten::lt(%632, %1614), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1616 = s64[1,29]{1,0} aten::where(%1615, %1613, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1617 = s64[1,29,1]{2,1,0} aten::stack(%1616), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1618 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1619 = bf16[29,128]{1,0} xla::select(%1618), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1620 = bf16[1,29,128]{2,1,0} aten::index(%1619, %1617), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1621 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1620), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1622 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1605, %1621), scope=aten::mul.698, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1623 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1622, %1610, %1584), scope=aten::add.700, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1624 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1623), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1625 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1624), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1626 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1625), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1627 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1626), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1628 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1627), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1629 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1628), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1630 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1629), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1631 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1630), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1632 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1631), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1633 = bf16[28,128,29]{2,1,0} aten::view(%1632), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1634 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1635 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1636 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1637 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1638 = bf16[3584,3584]{0,1} aten::permute(%1637), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1639 = bf16[29,3584]{1,0} aten::view(%1566), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1640 = bf16[29,3584]{1,0} aten::mm(%1639, %1638), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1641 = bf16[1,29,3584]{2,1,0} aten::view(%1640), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1642 = bf16[1,29,3584]{2,1,0} aten::add(%1641, %1636, %1635), scope=aten::add.692, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1643 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1642), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1644 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1643), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1645 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1644), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1646 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1644), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1647 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1646), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1648 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1647, %1645), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1649 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1648, %1595), scope=aten::mul.696, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1650 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1644, %1621), scope=aten::mul.695, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1651 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1650, %1649, %1634), scope=aten::add.697, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1652 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1651), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1653 = bf16[28,29,128]{2,1,0} aten::view(%1652), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1654 = bf16[28,29,29]{2,1,0} aten::matmul(%1653, %1633), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1655 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1654), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1656 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1655, %1583), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1657 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1656, %621, %1582), scope=aten::add.701, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1658 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1657), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1659 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1658), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1660 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1659), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1661 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1660), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1662 = bf16[28,29,29]{2,1,0} aten::view(%1661), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1663 = bf16[28,29,128]{2,1,0} aten::matmul(%1662, %1581), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1664 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1663), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1665 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1664), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1666 = bf16[1,29,3584]{2,1,0} aten::view(%1665), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1667 = bf16[29,3584]{1,0} aten::view(%1666), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1668 = bf16[29,3584]{1,0} aten::mm(%1667, %405), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1669 = bf16[1,29,3584]{2,1,0} aten::view(%1668), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1670 = bf16[1,29,3584]{2,1,0} aten::add(%1557, %1669, %403), scope=aten::add.702, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1671 = f32[1,29,3584]{2,1,0} xla::cast(%1670), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1672 = f32[1,29,3584]{2,1,0} aten::pow(%1671, %402), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1673 = f32[1,29,1]{2,1,0} aten::mean(%1672), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1674 = f32[1,29,1]{2,1,0} aten::add(%1673, %401, %400), scope=aten::add.703, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1675 = f32[1,29,1]{2,1,0} aten::rsqrt(%1674), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1676 = f32[1,29,3584]{2,1,0} aten::mul(%1671, %1675), scope=aten::mul.704, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1677 = bf16[1,29,3584]{2,1,0} xla::cast(%1676), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1678 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1679 = bf16[1,29,3584]{2,1,0} aten::mul(%1678, %1677), scope=aten::mul.705, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1680 = bf16[29,3584]{1,0} aten::view(%1679), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1681 = bf16[29,18944]{1,0} aten::mm(%1680, %399), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1682 = bf16[1,29,18944]{2,1,0} aten::view(%1681), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1683 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1684 = bf16[3584,18944]{0,1} aten::permute(%1683), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1685 = bf16[29,3584]{1,0} aten::view(%1679), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1686 = bf16[29,18944]{1,0} aten::mm(%1685, %1684), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1687 = bf16[1,29,18944]{2,1,0} aten::view(%1686), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1688 = bf16[1,29,18944]{2,1,0} aten::silu(%1687), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1689 = bf16[1,29,18944]{2,1,0} aten::mul(%1688, %1682), scope=aten::mul.706, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1690 = bf16[29,18944]{1,0} aten::view(%1689), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1691 = bf16[29,3584]{1,0} aten::mm(%1690, %397), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1692 = bf16[1,29,3584]{2,1,0} aten::view(%1691), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1693 = bf16[1,29,3584]{2,1,0} aten::add(%1670, %1692, %395), scope=aten::add.707, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1694 = f32[1,29,3584]{2,1,0} xla::cast(%1693), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1695 = f32[1,29,3584]{2,1,0} aten::pow(%1694, %394), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1696 = f32[1,29,1]{2,1,0} aten::mean(%1695), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1697 = f32[1,29,1]{2,1,0} aten::add(%1696, %393, %392), scope=aten::add.708, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1698 = f32[1,29,1]{2,1,0} aten::rsqrt(%1697), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1699 = f32[1,29,3584]{2,1,0} aten::mul(%1694, %1698), scope=aten::mul.709, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1700 = bf16[1,29,3584]{2,1,0} xla::cast(%1699), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1701 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1702 = bf16[1,29,3584]{2,1,0} aten::mul(%1701, %1700), scope=aten::mul.710, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1703 = bf16[29,3584]{1,0} aten::view(%1702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1704 = bf16[29,512]{1,0} aten::mm(%1703, %391), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1705 = bf16[1,29,512]{2,1,0} aten::view(%1704), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1706 = bf16[1,29,512]{2,1,0} aten::add(%1705, %389, %388), scope=aten::add.713, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1707 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1706), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1708 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1707), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1709 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1708), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1710 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1709), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1711 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1710), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1712 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1711), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1713 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1712), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1714 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1713), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1715 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1714), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1716 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1715), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1717 = bf16[28,29,128]{2,1,0} aten::view(%1716), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1718 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1719 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1720 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1721 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1722 = s64[1,29]{1,0} aten::expand(%1721), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1723 = s64[1,29]{1,0} aten::add(%632, %1722), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1724 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1725 = pred[1,29]{1,0} aten::lt(%632, %1724), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1726 = s64[1,29]{1,0} aten::where(%1725, %1723, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1727 = s64[1,29,1]{2,1,0} aten::stack(%1726), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1728 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1729 = bf16[29,128]{1,0} xla::select(%1728), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1730 = bf16[1,29,128]{2,1,0} aten::index(%1729, %1727), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1731 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1730), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1732 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1733 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1734 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1735 = bf16[3584,512]{0,1} aten::permute(%1734), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1736 = bf16[29,3584]{1,0} aten::view(%1702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1737 = bf16[29,512]{1,0} aten::mm(%1736, %1735), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1738 = bf16[1,29,512]{2,1,0} aten::view(%1737), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1739 = bf16[1,29,512]{2,1,0} aten::add(%1738, %1733, %1732), scope=aten::add.712, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1740 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1739), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1741 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1740), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1742 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1741), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1743 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1741), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1744 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1743), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1745 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1744, %1742), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1746 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1745, %1731), scope=aten::mul.718, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1747 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1748 = s64[1,29]{1,0} aten::expand(%1747), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1749 = s64[1,29]{1,0} aten::add(%632, %1748), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1750 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1751 = pred[1,29]{1,0} aten::lt(%632, %1750), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1752 = s64[1,29]{1,0} aten::where(%1751, %1749, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1753 = s64[1,29,1]{2,1,0} aten::stack(%1752), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1754 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1755 = bf16[29,128]{1,0} xla::select(%1754), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1756 = bf16[1,29,128]{2,1,0} aten::index(%1755, %1753), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1757 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1756), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1758 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1741, %1757), scope=aten::mul.717, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1759 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1758, %1746, %1720), scope=aten::add.719, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1760 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1759), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1761 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1760), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1762 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1761), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1763 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1762), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1764 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1763), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1765 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1764), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1766 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1765), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1767 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1766), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1768 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1767), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1769 = bf16[28,128,29]{2,1,0} aten::view(%1768), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1770 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1771 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1772 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1773 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1774 = bf16[3584,3584]{0,1} aten::permute(%1773), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1775 = bf16[29,3584]{1,0} aten::view(%1702), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1776 = bf16[29,3584]{1,0} aten::mm(%1775, %1774), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1777 = bf16[1,29,3584]{2,1,0} aten::view(%1776), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1778 = bf16[1,29,3584]{2,1,0} aten::add(%1777, %1772, %1771), scope=aten::add.711, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1779 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1778), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1780 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1779), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1781 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1780), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1782 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1780), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1783 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1782), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1784 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1783, %1781), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1785 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1784, %1731), scope=aten::mul.715, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1786 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1780, %1757), scope=aten::mul.714, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1787 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1786, %1785, %1770), scope=aten::add.716, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1788 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1787), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1789 = bf16[28,29,128]{2,1,0} aten::view(%1788), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1790 = bf16[28,29,29]{2,1,0} aten::matmul(%1789, %1769), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1791 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1790), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1792 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1791, %1719), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1793 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1792, %621, %1718), scope=aten::add.720, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1794 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1793), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1795 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1794), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1796 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1795), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1797 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1796), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1798 = bf16[28,29,29]{2,1,0} aten::view(%1797), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1799 = bf16[28,29,128]{2,1,0} aten::matmul(%1798, %1717), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1800 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1799), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1801 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1800), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1802 = bf16[1,29,3584]{2,1,0} aten::view(%1801), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1803 = bf16[29,3584]{1,0} aten::view(%1802), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1804 = bf16[29,3584]{1,0} aten::mm(%1803, %387), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1805 = bf16[1,29,3584]{2,1,0} aten::view(%1804), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1806 = bf16[1,29,3584]{2,1,0} aten::add(%1693, %1805, %385), scope=aten::add.721, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1807 = f32[1,29,3584]{2,1,0} xla::cast(%1806), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1808 = f32[1,29,3584]{2,1,0} aten::pow(%1807, %384), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1809 = f32[1,29,1]{2,1,0} aten::mean(%1808), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1810 = f32[1,29,1]{2,1,0} aten::add(%1809, %383, %382), scope=aten::add.722, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1811 = f32[1,29,1]{2,1,0} aten::rsqrt(%1810), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1812 = f32[1,29,3584]{2,1,0} aten::mul(%1807, %1811), scope=aten::mul.723, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1813 = bf16[1,29,3584]{2,1,0} xla::cast(%1812), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1814 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1815 = bf16[1,29,3584]{2,1,0} aten::mul(%1814, %1813), scope=aten::mul.724, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1816 = bf16[29,3584]{1,0} aten::view(%1815), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1817 = bf16[29,18944]{1,0} aten::mm(%1816, %381), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1818 = bf16[1,29,18944]{2,1,0} aten::view(%1817), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1819 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1820 = bf16[3584,18944]{0,1} aten::permute(%1819), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1821 = bf16[29,3584]{1,0} aten::view(%1815), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1822 = bf16[29,18944]{1,0} aten::mm(%1821, %1820), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1823 = bf16[1,29,18944]{2,1,0} aten::view(%1822), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1824 = bf16[1,29,18944]{2,1,0} aten::silu(%1823), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1825 = bf16[1,29,18944]{2,1,0} aten::mul(%1824, %1818), scope=aten::mul.725, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1826 = bf16[29,18944]{1,0} aten::view(%1825), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1827 = bf16[29,3584]{1,0} aten::mm(%1826, %379), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1828 = bf16[1,29,3584]{2,1,0} aten::view(%1827), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1829 = bf16[1,29,3584]{2,1,0} aten::add(%1806, %1828, %377), scope=aten::add.726, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1830 = f32[1,29,3584]{2,1,0} xla::cast(%1829), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1831 = f32[1,29,3584]{2,1,0} aten::pow(%1830, %376), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1832 = f32[1,29,1]{2,1,0} aten::mean(%1831), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1833 = f32[1,29,1]{2,1,0} aten::add(%1832, %375, %374), scope=aten::add.727, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1834 = f32[1,29,1]{2,1,0} aten::rsqrt(%1833), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1835 = f32[1,29,3584]{2,1,0} aten::mul(%1830, %1834), scope=aten::mul.728, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1836 = bf16[1,29,3584]{2,1,0} xla::cast(%1835), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1837 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1838 = bf16[1,29,3584]{2,1,0} aten::mul(%1837, %1836), scope=aten::mul.729, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1839 = bf16[29,3584]{1,0} aten::view(%1838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1840 = bf16[29,512]{1,0} aten::mm(%1839, %373), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1841 = bf16[1,29,512]{2,1,0} aten::view(%1840), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1842 = bf16[1,29,512]{2,1,0} aten::add(%1841, %371, %370), scope=aten::add.732, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1843 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1842), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1844 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1843), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1845 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1844), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1846 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1845), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1847 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1846), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1848 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1847), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1849 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1848), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1850 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1849), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1851 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1850), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1852 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1851), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1853 = bf16[28,29,128]{2,1,0} aten::view(%1852), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1854 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1855 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1856 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1857 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1858 = s64[1,29]{1,0} aten::expand(%1857), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1859 = s64[1,29]{1,0} aten::add(%632, %1858), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1860 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1861 = pred[1,29]{1,0} aten::lt(%632, %1860), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1862 = s64[1,29]{1,0} aten::where(%1861, %1859, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1863 = s64[1,29,1]{2,1,0} aten::stack(%1862), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %1864 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1865 = bf16[29,128]{1,0} xla::select(%1864), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %1866 = bf16[1,29,128]{2,1,0} aten::index(%1865, %1863), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %1867 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1866), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1868 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1869 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %1870 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %1871 = bf16[3584,512]{0,1} aten::permute(%1870), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %1872 = bf16[29,3584]{1,0} aten::view(%1838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1873 = bf16[29,512]{1,0} aten::mm(%1872, %1871), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1874 = bf16[1,29,512]{2,1,0} aten::view(%1873), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1875 = bf16[1,29,512]{2,1,0} aten::add(%1874, %1869, %1868), scope=aten::add.731, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1876 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1875), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1877 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1876), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1878 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1877), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1879 = bf16[1,4,29,64]{3,1,2,0} xla::select(%1877), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1880 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%1879), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %1881 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%1880, %1878), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1882 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1881, %1867), scope=aten::mul.737, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1883 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1884 = s64[1,29]{1,0} aten::expand(%1883), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1885 = s64[1,29]{1,0} aten::add(%632, %1884), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1886 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %1887 = pred[1,29]{1,0} aten::lt(%632, %1886), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %1888 = s64[1,29]{1,0} aten::where(%1887, %1885, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %1889 = s64[1,29,1]{2,1,0} aten::stack(%1888), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %1890 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %1891 = bf16[29,128]{1,0} xla::select(%1890), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %1892 = bf16[1,29,128]{2,1,0} aten::index(%1891, %1889), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %1893 = bf16[1,1,29,128]{3,2,1,0} aten::view(%1892), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %1894 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%1877, %1893), scope=aten::mul.736, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1895 = bf16[1,4,29,128]{3,2,1,0} aten::add(%1894, %1882, %1856), scope=aten::add.738, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1896 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1895), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1897 = bf16[1,4,29,128]{3,2,1,0} xla::select(%1896), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %1898 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1897), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1899 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1898), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1900 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1899), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1901 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1900), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1902 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1901), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1903 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%1902), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %1904 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%1903), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %1905 = bf16[28,128,29]{2,1,0} aten::view(%1904), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %1906 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %1907 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %1908 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1909 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %1910 = bf16[3584,3584]{0,1} aten::permute(%1909), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %1911 = bf16[29,3584]{1,0} aten::view(%1838), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1912 = bf16[29,3584]{1,0} aten::mm(%1911, %1910), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1913 = bf16[1,29,3584]{2,1,0} aten::view(%1912), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1914 = bf16[1,29,3584]{2,1,0} aten::add(%1913, %1908, %1907), scope=aten::add.730, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1915 = bf16[1,29,28,128]{3,2,1,0} aten::view(%1914), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %1916 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%1915), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %1917 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1916), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1918 = bf16[1,28,29,64]{3,1,2,0} xla::select(%1916), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1919 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%1918), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %1920 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%1919, %1917), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1921 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1920, %1867), scope=aten::mul.734, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1922 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%1916, %1893), scope=aten::mul.733, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1923 = bf16[1,28,29,128]{3,2,1,0} aten::add(%1922, %1921, %1906), scope=aten::add.735, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1924 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1923), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1925 = bf16[28,29,128]{2,1,0} aten::view(%1924), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %1926 = bf16[28,29,29]{2,1,0} aten::matmul(%1925, %1905), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %1927 = bf16[1,28,29,29]{3,2,1,0} aten::view(%1926), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1928 = bf16[1,28,29,29]{3,2,1,0} aten::div(%1927, %1855), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1929 = bf16[1,28,29,29]{3,2,1,0} aten::add(%1928, %621, %1854), scope=aten::add.739, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1930 = f32[1,28,29,29]{3,2,1,0} xla::cast(%1929), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1931 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%1930), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %1932 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%1931), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1933 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%1932), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %1934 = bf16[28,29,29]{2,1,0} aten::view(%1933), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %1935 = bf16[28,29,128]{2,1,0} aten::matmul(%1934, %1853), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1936 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1935), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1937 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%1936), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %1938 = bf16[1,29,3584]{2,1,0} aten::view(%1937), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %1939 = bf16[29,3584]{1,0} aten::view(%1938), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1940 = bf16[29,3584]{1,0} aten::mm(%1939, %369), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1941 = bf16[1,29,3584]{2,1,0} aten::view(%1940), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1942 = bf16[1,29,3584]{2,1,0} aten::add(%1829, %1941, %367), scope=aten::add.740, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %1943 = f32[1,29,3584]{2,1,0} xla::cast(%1942), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1944 = f32[1,29,3584]{2,1,0} aten::pow(%1943, %366), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1945 = f32[1,29,1]{2,1,0} aten::mean(%1944), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1946 = f32[1,29,1]{2,1,0} aten::add(%1945, %365, %364), scope=aten::add.741, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1947 = f32[1,29,1]{2,1,0} aten::rsqrt(%1946), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1948 = f32[1,29,3584]{2,1,0} aten::mul(%1943, %1947), scope=aten::mul.742, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1949 = bf16[1,29,3584]{2,1,0} xla::cast(%1948), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1950 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1951 = bf16[1,29,3584]{2,1,0} aten::mul(%1950, %1949), scope=aten::mul.743, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1952 = bf16[29,3584]{1,0} aten::view(%1951), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1953 = bf16[29,18944]{1,0} aten::mm(%1952, %363), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1954 = bf16[1,29,18944]{2,1,0} aten::view(%1953), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1955 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %1956 = bf16[3584,18944]{0,1} aten::permute(%1955), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %1957 = bf16[29,3584]{1,0} aten::view(%1951), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1958 = bf16[29,18944]{1,0} aten::mm(%1957, %1956), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1959 = bf16[1,29,18944]{2,1,0} aten::view(%1958), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %1960 = bf16[1,29,18944]{2,1,0} aten::silu(%1959), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %1961 = bf16[1,29,18944]{2,1,0} aten::mul(%1960, %1954), scope=aten::mul.744, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %1962 = bf16[29,18944]{1,0} aten::view(%1961), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %1963 = bf16[29,3584]{1,0} aten::mm(%1962, %361), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1964 = bf16[1,29,3584]{2,1,0} aten::view(%1963), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %1965 = bf16[1,29,3584]{2,1,0} aten::add(%1942, %1964, %359), scope=aten::add.745, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %1966 = f32[1,29,3584]{2,1,0} xla::cast(%1965), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %1967 = f32[1,29,3584]{2,1,0} aten::pow(%1966, %358), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %1968 = f32[1,29,1]{2,1,0} aten::mean(%1967), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %1969 = f32[1,29,1]{2,1,0} aten::add(%1968, %357, %356), scope=aten::add.746, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1970 = f32[1,29,1]{2,1,0} aten::rsqrt(%1969), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %1971 = f32[1,29,3584]{2,1,0} aten::mul(%1966, %1970), scope=aten::mul.747, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %1972 = bf16[1,29,3584]{2,1,0} xla::cast(%1971), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1973 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %1974 = bf16[1,29,3584]{2,1,0} aten::mul(%1973, %1972), scope=aten::mul.748, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %1975 = bf16[29,3584]{1,0} aten::view(%1974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %1976 = bf16[29,512]{1,0} aten::mm(%1975, %355), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %1977 = bf16[1,29,512]{2,1,0} aten::view(%1976), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1978 = bf16[1,29,512]{2,1,0} aten::add(%1977, %353, %352), scope=aten::add.751, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %1979 = bf16[1,29,4,128]{3,2,1,0} aten::view(%1978), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %1980 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%1979), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1981 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1980), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1982 = bf16[1,4,29,128]{3,1,2,0} xla::select(%1981), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %1983 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%1982), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1984 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1983), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1985 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%1984), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %1986 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%1985), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %1987 = bf16[1,28,29,128]{3,2,1,0} aten::view(%1986), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1988 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%1987), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %1989 = bf16[28,29,128]{2,1,0} aten::view(%1988), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %1990 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %1991 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %1992 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %1993 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1994 = s64[1,29]{1,0} aten::expand(%1993), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1995 = s64[1,29]{1,0} aten::add(%632, %1994), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1996 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %1997 = pred[1,29]{1,0} aten::lt(%632, %1996), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %1998 = s64[1,29]{1,0} aten::where(%1997, %1995, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %1999 = s64[1,29,1]{2,1,0} aten::stack(%1998), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2000 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2001 = bf16[29,128]{1,0} xla::select(%2000), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2002 = bf16[1,29,128]{2,1,0} aten::index(%2001, %1999), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2003 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2002), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2004 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2005 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2006 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2007 = bf16[3584,512]{0,1} aten::permute(%2006), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2008 = bf16[29,3584]{1,0} aten::view(%1974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2009 = bf16[29,512]{1,0} aten::mm(%2008, %2007), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2010 = bf16[1,29,512]{2,1,0} aten::view(%2009), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2011 = bf16[1,29,512]{2,1,0} aten::add(%2010, %2005, %2004), scope=aten::add.750, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2012 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2011), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2013 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2012), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2014 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2013), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2015 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2013), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2016 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2015), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2017 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2016, %2014), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2018 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2017, %2003), scope=aten::mul.756, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2019 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2020 = s64[1,29]{1,0} aten::expand(%2019), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2021 = s64[1,29]{1,0} aten::add(%632, %2020), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2022 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2023 = pred[1,29]{1,0} aten::lt(%632, %2022), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2024 = s64[1,29]{1,0} aten::where(%2023, %2021, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2025 = s64[1,29,1]{2,1,0} aten::stack(%2024), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2026 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2027 = bf16[29,128]{1,0} xla::select(%2026), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2028 = bf16[1,29,128]{2,1,0} aten::index(%2027, %2025), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2029 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2028), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2030 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2013, %2029), scope=aten::mul.755, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2031 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2030, %2018, %1992), scope=aten::add.757, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2032 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2031), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2033 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2032), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2034 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2033), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2035 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2034), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2036 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2035), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2037 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2036), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2038 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2037), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2039 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2038), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2040 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2039), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2041 = bf16[28,128,29]{2,1,0} aten::view(%2040), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2042 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2043 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2044 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2045 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2046 = bf16[3584,3584]{0,1} aten::permute(%2045), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2047 = bf16[29,3584]{1,0} aten::view(%1974), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2048 = bf16[29,3584]{1,0} aten::mm(%2047, %2046), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2049 = bf16[1,29,3584]{2,1,0} aten::view(%2048), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2050 = bf16[1,29,3584]{2,1,0} aten::add(%2049, %2044, %2043), scope=aten::add.749, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2051 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2050), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2052 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2051), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2053 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2052), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2054 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2052), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2055 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2054), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2056 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2055, %2053), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2057 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2056, %2003), scope=aten::mul.753, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2058 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2052, %2029), scope=aten::mul.752, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2059 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2058, %2057, %2042), scope=aten::add.754, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2060 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2059), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2061 = bf16[28,29,128]{2,1,0} aten::view(%2060), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2062 = bf16[28,29,29]{2,1,0} aten::matmul(%2061, %2041), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2063 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2062), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2064 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2063, %1991), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2065 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2064, %621, %1990), scope=aten::add.758, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2066 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2065), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2067 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2066), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2068 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2067), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2069 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2068), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2070 = bf16[28,29,29]{2,1,0} aten::view(%2069), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2071 = bf16[28,29,128]{2,1,0} aten::matmul(%2070, %1989), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2072 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2071), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2073 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2072), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2074 = bf16[1,29,3584]{2,1,0} aten::view(%2073), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2075 = bf16[29,3584]{1,0} aten::view(%2074), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2076 = bf16[29,3584]{1,0} aten::mm(%2075, %351), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2077 = bf16[1,29,3584]{2,1,0} aten::view(%2076), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2078 = bf16[1,29,3584]{2,1,0} aten::add(%1965, %2077, %349), scope=aten::add.759, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2079 = f32[1,29,3584]{2,1,0} xla::cast(%2078), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2080 = f32[1,29,3584]{2,1,0} aten::pow(%2079, %348), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2081 = f32[1,29,1]{2,1,0} aten::mean(%2080), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2082 = f32[1,29,1]{2,1,0} aten::add(%2081, %347, %346), scope=aten::add.760, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2083 = f32[1,29,1]{2,1,0} aten::rsqrt(%2082), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2084 = f32[1,29,3584]{2,1,0} aten::mul(%2079, %2083), scope=aten::mul.761, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2085 = bf16[1,29,3584]{2,1,0} xla::cast(%2084), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2086 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2087 = bf16[1,29,3584]{2,1,0} aten::mul(%2086, %2085), scope=aten::mul.762, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2088 = bf16[29,3584]{1,0} aten::view(%2087), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2089 = bf16[29,18944]{1,0} aten::mm(%2088, %345), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2090 = bf16[1,29,18944]{2,1,0} aten::view(%2089), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2091 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2092 = bf16[3584,18944]{0,1} aten::permute(%2091), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2093 = bf16[29,3584]{1,0} aten::view(%2087), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2094 = bf16[29,18944]{1,0} aten::mm(%2093, %2092), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2095 = bf16[1,29,18944]{2,1,0} aten::view(%2094), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2096 = bf16[1,29,18944]{2,1,0} aten::silu(%2095), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2097 = bf16[1,29,18944]{2,1,0} aten::mul(%2096, %2090), scope=aten::mul.763, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2098 = bf16[29,18944]{1,0} aten::view(%2097), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2099 = bf16[29,3584]{1,0} aten::mm(%2098, %343), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2100 = bf16[1,29,3584]{2,1,0} aten::view(%2099), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2101 = bf16[1,29,3584]{2,1,0} aten::add(%2078, %2100, %341), scope=aten::add.764, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2102 = f32[1,29,3584]{2,1,0} xla::cast(%2101), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2103 = f32[1,29,3584]{2,1,0} aten::pow(%2102, %340), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2104 = f32[1,29,1]{2,1,0} aten::mean(%2103), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2105 = f32[1,29,1]{2,1,0} aten::add(%2104, %339, %338), scope=aten::add.765, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2106 = f32[1,29,1]{2,1,0} aten::rsqrt(%2105), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2107 = f32[1,29,3584]{2,1,0} aten::mul(%2102, %2106), scope=aten::mul.766, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2108 = bf16[1,29,3584]{2,1,0} xla::cast(%2107), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2109 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2110 = bf16[1,29,3584]{2,1,0} aten::mul(%2109, %2108), scope=aten::mul.767, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2111 = bf16[29,3584]{1,0} aten::view(%2110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2112 = bf16[29,512]{1,0} aten::mm(%2111, %337), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2113 = bf16[1,29,512]{2,1,0} aten::view(%2112), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2114 = bf16[1,29,512]{2,1,0} aten::add(%2113, %335, %334), scope=aten::add.770, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2115 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2114), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2116 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2115), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2117 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2116), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2118 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2117), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2119 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2118), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2120 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2119), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2121 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2120), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2122 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2121), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2123 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2122), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2124 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2123), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2125 = bf16[28,29,128]{2,1,0} aten::view(%2124), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2126 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2127 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2128 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2129 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2130 = s64[1,29]{1,0} aten::expand(%2129), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2131 = s64[1,29]{1,0} aten::add(%632, %2130), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2132 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2133 = pred[1,29]{1,0} aten::lt(%632, %2132), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2134 = s64[1,29]{1,0} aten::where(%2133, %2131, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2135 = s64[1,29,1]{2,1,0} aten::stack(%2134), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2136 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2137 = bf16[29,128]{1,0} xla::select(%2136), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2138 = bf16[1,29,128]{2,1,0} aten::index(%2137, %2135), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2139 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2138), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2140 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2141 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2142 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2143 = bf16[3584,512]{0,1} aten::permute(%2142), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2144 = bf16[29,3584]{1,0} aten::view(%2110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2145 = bf16[29,512]{1,0} aten::mm(%2144, %2143), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2146 = bf16[1,29,512]{2,1,0} aten::view(%2145), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2147 = bf16[1,29,512]{2,1,0} aten::add(%2146, %2141, %2140), scope=aten::add.769, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2148 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2147), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2149 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2148), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2150 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2149), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2151 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2149), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2152 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2151), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2153 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2152, %2150), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2154 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2153, %2139), scope=aten::mul.775, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2155 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2156 = s64[1,29]{1,0} aten::expand(%2155), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2157 = s64[1,29]{1,0} aten::add(%632, %2156), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2158 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2159 = pred[1,29]{1,0} aten::lt(%632, %2158), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2160 = s64[1,29]{1,0} aten::where(%2159, %2157, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2161 = s64[1,29,1]{2,1,0} aten::stack(%2160), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2162 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2163 = bf16[29,128]{1,0} xla::select(%2162), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2164 = bf16[1,29,128]{2,1,0} aten::index(%2163, %2161), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2165 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2164), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2166 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2149, %2165), scope=aten::mul.774, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2167 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2166, %2154, %2128), scope=aten::add.776, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2168 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2167), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2169 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2168), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2170 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2169), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2171 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2170), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2172 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2171), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2173 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2172), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2174 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2173), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2175 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2174), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2176 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2175), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2177 = bf16[28,128,29]{2,1,0} aten::view(%2176), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2178 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2179 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2180 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2181 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2182 = bf16[3584,3584]{0,1} aten::permute(%2181), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2183 = bf16[29,3584]{1,0} aten::view(%2110), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2184 = bf16[29,3584]{1,0} aten::mm(%2183, %2182), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2185 = bf16[1,29,3584]{2,1,0} aten::view(%2184), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2186 = bf16[1,29,3584]{2,1,0} aten::add(%2185, %2180, %2179), scope=aten::add.768, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2187 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2186), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2188 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2187), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2189 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2188), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2190 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2188), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2191 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2190), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2192 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2191, %2189), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2193 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2192, %2139), scope=aten::mul.772, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2194 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2188, %2165), scope=aten::mul.771, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2195 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2194, %2193, %2178), scope=aten::add.773, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2196 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2195), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2197 = bf16[28,29,128]{2,1,0} aten::view(%2196), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2198 = bf16[28,29,29]{2,1,0} aten::matmul(%2197, %2177), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2199 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2198), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2200 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2199, %2127), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2201 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2200, %621, %2126), scope=aten::add.777, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2202 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2201), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2203 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2202), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2204 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2203), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2205 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2204), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2206 = bf16[28,29,29]{2,1,0} aten::view(%2205), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2207 = bf16[28,29,128]{2,1,0} aten::matmul(%2206, %2125), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2208 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2207), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2209 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2208), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2210 = bf16[1,29,3584]{2,1,0} aten::view(%2209), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2211 = bf16[29,3584]{1,0} aten::view(%2210), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2212 = bf16[29,3584]{1,0} aten::mm(%2211, %333), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2213 = bf16[1,29,3584]{2,1,0} aten::view(%2212), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2214 = bf16[1,29,3584]{2,1,0} aten::add(%2101, %2213, %331), scope=aten::add.778, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2215 = f32[1,29,3584]{2,1,0} xla::cast(%2214), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2216 = f32[1,29,3584]{2,1,0} aten::pow(%2215, %330), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2217 = f32[1,29,1]{2,1,0} aten::mean(%2216), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2218 = f32[1,29,1]{2,1,0} aten::add(%2217, %329, %328), scope=aten::add.779, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2219 = f32[1,29,1]{2,1,0} aten::rsqrt(%2218), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2220 = f32[1,29,3584]{2,1,0} aten::mul(%2215, %2219), scope=aten::mul.780, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2221 = bf16[1,29,3584]{2,1,0} xla::cast(%2220), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2222 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2223 = bf16[1,29,3584]{2,1,0} aten::mul(%2222, %2221), scope=aten::mul.781, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2224 = bf16[29,3584]{1,0} aten::view(%2223), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2225 = bf16[29,18944]{1,0} aten::mm(%2224, %327), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2226 = bf16[1,29,18944]{2,1,0} aten::view(%2225), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2227 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2228 = bf16[3584,18944]{0,1} aten::permute(%2227), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2229 = bf16[29,3584]{1,0} aten::view(%2223), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2230 = bf16[29,18944]{1,0} aten::mm(%2229, %2228), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2231 = bf16[1,29,18944]{2,1,0} aten::view(%2230), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2232 = bf16[1,29,18944]{2,1,0} aten::silu(%2231), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2233 = bf16[1,29,18944]{2,1,0} aten::mul(%2232, %2226), scope=aten::mul.782, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2234 = bf16[29,18944]{1,0} aten::view(%2233), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2235 = bf16[29,3584]{1,0} aten::mm(%2234, %325), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2236 = bf16[1,29,3584]{2,1,0} aten::view(%2235), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2237 = bf16[1,29,3584]{2,1,0} aten::add(%2214, %2236, %323), scope=aten::add.783, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2238 = f32[1,29,3584]{2,1,0} xla::cast(%2237), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2239 = f32[1,29,3584]{2,1,0} aten::pow(%2238, %322), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2240 = f32[1,29,1]{2,1,0} aten::mean(%2239), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2241 = f32[1,29,1]{2,1,0} aten::add(%2240, %321, %320), scope=aten::add.784, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2242 = f32[1,29,1]{2,1,0} aten::rsqrt(%2241), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2243 = f32[1,29,3584]{2,1,0} aten::mul(%2238, %2242), scope=aten::mul.785, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2244 = bf16[1,29,3584]{2,1,0} xla::cast(%2243), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2245 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2246 = bf16[1,29,3584]{2,1,0} aten::mul(%2245, %2244), scope=aten::mul.786, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2247 = bf16[29,3584]{1,0} aten::view(%2246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2248 = bf16[29,512]{1,0} aten::mm(%2247, %319), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2249 = bf16[1,29,512]{2,1,0} aten::view(%2248), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2250 = bf16[1,29,512]{2,1,0} aten::add(%2249, %317, %316), scope=aten::add.789, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2251 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2250), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2252 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2251), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2253 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2252), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2254 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2253), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2255 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2254), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2256 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2255), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2257 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2256), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2258 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2257), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2259 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2258), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2260 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2259), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2261 = bf16[28,29,128]{2,1,0} aten::view(%2260), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2262 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2263 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2264 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2265 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2266 = s64[1,29]{1,0} aten::expand(%2265), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2267 = s64[1,29]{1,0} aten::add(%632, %2266), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2268 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2269 = pred[1,29]{1,0} aten::lt(%632, %2268), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2270 = s64[1,29]{1,0} aten::where(%2269, %2267, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2271 = s64[1,29,1]{2,1,0} aten::stack(%2270), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2272 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2273 = bf16[29,128]{1,0} xla::select(%2272), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2274 = bf16[1,29,128]{2,1,0} aten::index(%2273, %2271), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2275 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2274), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2276 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2277 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2278 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2279 = bf16[3584,512]{0,1} aten::permute(%2278), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2280 = bf16[29,3584]{1,0} aten::view(%2246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2281 = bf16[29,512]{1,0} aten::mm(%2280, %2279), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2282 = bf16[1,29,512]{2,1,0} aten::view(%2281), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2283 = bf16[1,29,512]{2,1,0} aten::add(%2282, %2277, %2276), scope=aten::add.788, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2284 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2283), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2285 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2284), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2286 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2285), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2287 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2285), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2288 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2287), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2289 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2288, %2286), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2290 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2289, %2275), scope=aten::mul.794, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2291 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2292 = s64[1,29]{1,0} aten::expand(%2291), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2293 = s64[1,29]{1,0} aten::add(%632, %2292), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2294 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2295 = pred[1,29]{1,0} aten::lt(%632, %2294), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2296 = s64[1,29]{1,0} aten::where(%2295, %2293, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2297 = s64[1,29,1]{2,1,0} aten::stack(%2296), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2298 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2299 = bf16[29,128]{1,0} xla::select(%2298), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2300 = bf16[1,29,128]{2,1,0} aten::index(%2299, %2297), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2301 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2300), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2302 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2285, %2301), scope=aten::mul.793, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2303 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2302, %2290, %2264), scope=aten::add.795, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2304 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2303), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2305 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2304), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2306 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2305), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2307 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2306), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2308 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2307), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2309 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2308), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2310 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2309), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2311 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2310), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2312 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2311), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2313 = bf16[28,128,29]{2,1,0} aten::view(%2312), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2314 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2315 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2316 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2317 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2318 = bf16[3584,3584]{0,1} aten::permute(%2317), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2319 = bf16[29,3584]{1,0} aten::view(%2246), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2320 = bf16[29,3584]{1,0} aten::mm(%2319, %2318), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2321 = bf16[1,29,3584]{2,1,0} aten::view(%2320), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2322 = bf16[1,29,3584]{2,1,0} aten::add(%2321, %2316, %2315), scope=aten::add.787, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2323 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2322), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2324 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2323), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2325 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2324), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2326 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2324), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2327 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2326), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2328 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2327, %2325), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2329 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2328, %2275), scope=aten::mul.791, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2330 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2324, %2301), scope=aten::mul.790, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2331 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2330, %2329, %2314), scope=aten::add.792, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2332 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2331), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2333 = bf16[28,29,128]{2,1,0} aten::view(%2332), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2334 = bf16[28,29,29]{2,1,0} aten::matmul(%2333, %2313), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2335 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2334), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2336 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2335, %2263), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2337 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2336, %621, %2262), scope=aten::add.796, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2338 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2337), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2339 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2338), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2340 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2339), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2341 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2340), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2342 = bf16[28,29,29]{2,1,0} aten::view(%2341), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2343 = bf16[28,29,128]{2,1,0} aten::matmul(%2342, %2261), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2344 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2343), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2345 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2344), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2346 = bf16[1,29,3584]{2,1,0} aten::view(%2345), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2347 = bf16[29,3584]{1,0} aten::view(%2346), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2348 = bf16[29,3584]{1,0} aten::mm(%2347, %315), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2349 = bf16[1,29,3584]{2,1,0} aten::view(%2348), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2350 = bf16[1,29,3584]{2,1,0} aten::add(%2237, %2349, %313), scope=aten::add.797, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2351 = f32[1,29,3584]{2,1,0} xla::cast(%2350), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2352 = f32[1,29,3584]{2,1,0} aten::pow(%2351, %312), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2353 = f32[1,29,1]{2,1,0} aten::mean(%2352), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2354 = f32[1,29,1]{2,1,0} aten::add(%2353, %311, %310), scope=aten::add.798, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2355 = f32[1,29,1]{2,1,0} aten::rsqrt(%2354), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2356 = f32[1,29,3584]{2,1,0} aten::mul(%2351, %2355), scope=aten::mul.799, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2357 = bf16[1,29,3584]{2,1,0} xla::cast(%2356), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2358 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2359 = bf16[1,29,3584]{2,1,0} aten::mul(%2358, %2357), scope=aten::mul.800, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2360 = bf16[29,3584]{1,0} aten::view(%2359), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2361 = bf16[29,18944]{1,0} aten::mm(%2360, %309), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2362 = bf16[1,29,18944]{2,1,0} aten::view(%2361), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2363 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2364 = bf16[3584,18944]{0,1} aten::permute(%2363), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2365 = bf16[29,3584]{1,0} aten::view(%2359), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2366 = bf16[29,18944]{1,0} aten::mm(%2365, %2364), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2367 = bf16[1,29,18944]{2,1,0} aten::view(%2366), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2368 = bf16[1,29,18944]{2,1,0} aten::silu(%2367), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2369 = bf16[1,29,18944]{2,1,0} aten::mul(%2368, %2362), scope=aten::mul.801, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2370 = bf16[29,18944]{1,0} aten::view(%2369), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2371 = bf16[29,3584]{1,0} aten::mm(%2370, %307), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2372 = bf16[1,29,3584]{2,1,0} aten::view(%2371), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2373 = bf16[1,29,3584]{2,1,0} aten::add(%2350, %2372, %305), scope=aten::add.802, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2374 = f32[1,29,3584]{2,1,0} xla::cast(%2373), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2375 = f32[1,29,3584]{2,1,0} aten::pow(%2374, %304), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2376 = f32[1,29,1]{2,1,0} aten::mean(%2375), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2377 = f32[1,29,1]{2,1,0} aten::add(%2376, %303, %302), scope=aten::add.803, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2378 = f32[1,29,1]{2,1,0} aten::rsqrt(%2377), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2379 = f32[1,29,3584]{2,1,0} aten::mul(%2374, %2378), scope=aten::mul.804, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2380 = bf16[1,29,3584]{2,1,0} xla::cast(%2379), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2381 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2382 = bf16[1,29,3584]{2,1,0} aten::mul(%2381, %2380), scope=aten::mul.805, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2383 = bf16[29,3584]{1,0} aten::view(%2382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2384 = bf16[29,512]{1,0} aten::mm(%2383, %301), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2385 = bf16[1,29,512]{2,1,0} aten::view(%2384), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2386 = bf16[1,29,512]{2,1,0} aten::add(%2385, %299, %298), scope=aten::add.808, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2387 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2386), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2388 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2387), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2389 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2388), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2390 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2389), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2391 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2390), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2392 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2391), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2393 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2392), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2394 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2393), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2395 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2394), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2396 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2395), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2397 = bf16[28,29,128]{2,1,0} aten::view(%2396), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2398 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2399 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2400 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2401 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2402 = s64[1,29]{1,0} aten::expand(%2401), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2403 = s64[1,29]{1,0} aten::add(%632, %2402), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2404 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2405 = pred[1,29]{1,0} aten::lt(%632, %2404), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2406 = s64[1,29]{1,0} aten::where(%2405, %2403, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2407 = s64[1,29,1]{2,1,0} aten::stack(%2406), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2408 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2409 = bf16[29,128]{1,0} xla::select(%2408), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2410 = bf16[1,29,128]{2,1,0} aten::index(%2409, %2407), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2411 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2410), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2412 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2413 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2414 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2415 = bf16[3584,512]{0,1} aten::permute(%2414), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2416 = bf16[29,3584]{1,0} aten::view(%2382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2417 = bf16[29,512]{1,0} aten::mm(%2416, %2415), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2418 = bf16[1,29,512]{2,1,0} aten::view(%2417), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2419 = bf16[1,29,512]{2,1,0} aten::add(%2418, %2413, %2412), scope=aten::add.807, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2420 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2419), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2421 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2420), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2422 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2421), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2423 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2421), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2424 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2423), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2425 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2424, %2422), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2426 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2425, %2411), scope=aten::mul.813, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2427 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2428 = s64[1,29]{1,0} aten::expand(%2427), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2429 = s64[1,29]{1,0} aten::add(%632, %2428), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2430 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2431 = pred[1,29]{1,0} aten::lt(%632, %2430), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2432 = s64[1,29]{1,0} aten::where(%2431, %2429, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2433 = s64[1,29,1]{2,1,0} aten::stack(%2432), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2434 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2435 = bf16[29,128]{1,0} xla::select(%2434), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2436 = bf16[1,29,128]{2,1,0} aten::index(%2435, %2433), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2437 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2436), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2438 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2421, %2437), scope=aten::mul.812, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2439 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2438, %2426, %2400), scope=aten::add.814, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2440 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2439), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2441 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2440), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2442 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2441), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2443 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2442), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2444 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2443), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2445 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2444), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2446 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2445), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2447 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2446), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2448 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2447), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2449 = bf16[28,128,29]{2,1,0} aten::view(%2448), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2450 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2451 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2452 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2453 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2454 = bf16[3584,3584]{0,1} aten::permute(%2453), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2455 = bf16[29,3584]{1,0} aten::view(%2382), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2456 = bf16[29,3584]{1,0} aten::mm(%2455, %2454), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2457 = bf16[1,29,3584]{2,1,0} aten::view(%2456), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2458 = bf16[1,29,3584]{2,1,0} aten::add(%2457, %2452, %2451), scope=aten::add.806, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2459 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2458), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2460 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2459), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2461 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2460), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2462 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2460), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2463 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2462), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2464 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2463, %2461), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2465 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2464, %2411), scope=aten::mul.810, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2466 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2460, %2437), scope=aten::mul.809, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2467 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2466, %2465, %2450), scope=aten::add.811, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2468 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2467), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2469 = bf16[28,29,128]{2,1,0} aten::view(%2468), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2470 = bf16[28,29,29]{2,1,0} aten::matmul(%2469, %2449), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2471 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2470), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2472 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2471, %2399), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2473 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2472, %621, %2398), scope=aten::add.815, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2474 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2473), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2475 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2474), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2476 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2475), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2477 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2476), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2478 = bf16[28,29,29]{2,1,0} aten::view(%2477), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2479 = bf16[28,29,128]{2,1,0} aten::matmul(%2478, %2397), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2480 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2479), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2481 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2480), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2482 = bf16[1,29,3584]{2,1,0} aten::view(%2481), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2483 = bf16[29,3584]{1,0} aten::view(%2482), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2484 = bf16[29,3584]{1,0} aten::mm(%2483, %297), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2485 = bf16[1,29,3584]{2,1,0} aten::view(%2484), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2486 = bf16[1,29,3584]{2,1,0} aten::add(%2373, %2485, %295), scope=aten::add.816, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2487 = f32[1,29,3584]{2,1,0} xla::cast(%2486), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2488 = f32[1,29,3584]{2,1,0} aten::pow(%2487, %294), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2489 = f32[1,29,1]{2,1,0} aten::mean(%2488), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2490 = f32[1,29,1]{2,1,0} aten::add(%2489, %293, %292), scope=aten::add.817, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2491 = f32[1,29,1]{2,1,0} aten::rsqrt(%2490), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2492 = f32[1,29,3584]{2,1,0} aten::mul(%2487, %2491), scope=aten::mul.818, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2493 = bf16[1,29,3584]{2,1,0} xla::cast(%2492), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2494 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2495 = bf16[1,29,3584]{2,1,0} aten::mul(%2494, %2493), scope=aten::mul.819, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2496 = bf16[29,3584]{1,0} aten::view(%2495), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2497 = bf16[29,18944]{1,0} aten::mm(%2496, %291), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2498 = bf16[1,29,18944]{2,1,0} aten::view(%2497), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2499 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2500 = bf16[3584,18944]{0,1} aten::permute(%2499), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2501 = bf16[29,3584]{1,0} aten::view(%2495), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2502 = bf16[29,18944]{1,0} aten::mm(%2501, %2500), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2503 = bf16[1,29,18944]{2,1,0} aten::view(%2502), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2504 = bf16[1,29,18944]{2,1,0} aten::silu(%2503), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2505 = bf16[1,29,18944]{2,1,0} aten::mul(%2504, %2498), scope=aten::mul.820, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2506 = bf16[29,18944]{1,0} aten::view(%2505), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2507 = bf16[29,3584]{1,0} aten::mm(%2506, %289), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2508 = bf16[1,29,3584]{2,1,0} aten::view(%2507), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2509 = bf16[1,29,3584]{2,1,0} aten::add(%2486, %2508, %287), scope=aten::add.821, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2510 = f32[1,29,3584]{2,1,0} xla::cast(%2509), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2511 = f32[1,29,3584]{2,1,0} aten::pow(%2510, %286), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2512 = f32[1,29,1]{2,1,0} aten::mean(%2511), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2513 = f32[1,29,1]{2,1,0} aten::add(%2512, %285, %284), scope=aten::add.822, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2514 = f32[1,29,1]{2,1,0} aten::rsqrt(%2513), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2515 = f32[1,29,3584]{2,1,0} aten::mul(%2510, %2514), scope=aten::mul.823, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2516 = bf16[1,29,3584]{2,1,0} xla::cast(%2515), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2517 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2518 = bf16[1,29,3584]{2,1,0} aten::mul(%2517, %2516), scope=aten::mul.824, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2519 = bf16[29,3584]{1,0} aten::view(%2518), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2520 = bf16[29,512]{1,0} aten::mm(%2519, %283), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2521 = bf16[1,29,512]{2,1,0} aten::view(%2520), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2522 = bf16[1,29,512]{2,1,0} aten::add(%2521, %281, %280), scope=aten::add.827, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2523 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2522), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2524 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2523), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2525 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2524), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2526 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2525), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2527 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2526), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2528 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2527), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2529 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2528), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2530 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2529), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2531 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2530), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2532 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2531), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2533 = bf16[28,29,128]{2,1,0} aten::view(%2532), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2534 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2535 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2536 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2537 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2538 = s64[1,29]{1,0} aten::expand(%2537), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2539 = s64[1,29]{1,0} aten::add(%632, %2538), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2540 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2541 = pred[1,29]{1,0} aten::lt(%632, %2540), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2542 = s64[1,29]{1,0} aten::where(%2541, %2539, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2543 = s64[1,29,1]{2,1,0} aten::stack(%2542), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2544 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2545 = bf16[29,128]{1,0} xla::select(%2544), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2546 = bf16[1,29,128]{2,1,0} aten::index(%2545, %2543), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2547 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2546), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2548 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2549 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2550 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2551 = bf16[3584,512]{0,1} aten::permute(%2550), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2552 = bf16[29,3584]{1,0} aten::view(%2518), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2553 = bf16[29,512]{1,0} aten::mm(%2552, %2551), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2554 = bf16[1,29,512]{2,1,0} aten::view(%2553), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2555 = bf16[1,29,512]{2,1,0} aten::add(%2554, %2549, %2548), scope=aten::add.826, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2556 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2555), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2557 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2556), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2558 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2557), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2559 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2557), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2560 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2559), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2561 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2560, %2558), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2562 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2561, %2547), scope=aten::mul.832, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2563 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2564 = s64[1,29]{1,0} aten::expand(%2563), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2565 = s64[1,29]{1,0} aten::add(%632, %2564), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2566 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2567 = pred[1,29]{1,0} aten::lt(%632, %2566), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2568 = s64[1,29]{1,0} aten::where(%2567, %2565, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2569 = s64[1,29,1]{2,1,0} aten::stack(%2568), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2570 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2571 = bf16[29,128]{1,0} xla::select(%2570), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2572 = bf16[1,29,128]{2,1,0} aten::index(%2571, %2569), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2573 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2572), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2574 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2557, %2573), scope=aten::mul.831, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2575 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2574, %2562, %2536), scope=aten::add.833, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2576 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2575), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2577 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2576), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2578 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2577), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2579 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2578), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2580 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2579), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2581 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2580), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2582 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2581), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2583 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2582), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2584 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2583), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2585 = bf16[28,128,29]{2,1,0} aten::view(%2584), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2586 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2587 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2588 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2589 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2590 = bf16[3584,3584]{0,1} aten::permute(%2589), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2591 = bf16[29,3584]{1,0} aten::view(%2518), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2592 = bf16[29,3584]{1,0} aten::mm(%2591, %2590), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2593 = bf16[1,29,3584]{2,1,0} aten::view(%2592), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2594 = bf16[1,29,3584]{2,1,0} aten::add(%2593, %2588, %2587), scope=aten::add.825, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2595 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2594), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2596 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2595), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2597 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2596), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2598 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2596), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2599 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2598), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2600 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2599, %2597), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2601 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2600, %2547), scope=aten::mul.829, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2602 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2596, %2573), scope=aten::mul.828, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2603 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2602, %2601, %2586), scope=aten::add.830, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2604 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2603), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2605 = bf16[28,29,128]{2,1,0} aten::view(%2604), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2606 = bf16[28,29,29]{2,1,0} aten::matmul(%2605, %2585), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2607 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2606), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2608 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2607, %2535), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2609 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2608, %621, %2534), scope=aten::add.834, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2610 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2609), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2611 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2610), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2612 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2611), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2613 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2612), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2614 = bf16[28,29,29]{2,1,0} aten::view(%2613), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2615 = bf16[28,29,128]{2,1,0} aten::matmul(%2614, %2533), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2616 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2615), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2617 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2616), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2618 = bf16[1,29,3584]{2,1,0} aten::view(%2617), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2619 = bf16[29,3584]{1,0} aten::view(%2618), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2620 = bf16[29,3584]{1,0} aten::mm(%2619, %279), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2621 = bf16[1,29,3584]{2,1,0} aten::view(%2620), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2622 = bf16[1,29,3584]{2,1,0} aten::add(%2509, %2621, %277), scope=aten::add.835, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2623 = f32[1,29,3584]{2,1,0} xla::cast(%2622), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2624 = f32[1,29,3584]{2,1,0} aten::pow(%2623, %276), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2625 = f32[1,29,1]{2,1,0} aten::mean(%2624), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2626 = f32[1,29,1]{2,1,0} aten::add(%2625, %275, %274), scope=aten::add.836, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2627 = f32[1,29,1]{2,1,0} aten::rsqrt(%2626), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2628 = f32[1,29,3584]{2,1,0} aten::mul(%2623, %2627), scope=aten::mul.837, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2629 = bf16[1,29,3584]{2,1,0} xla::cast(%2628), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2630 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2631 = bf16[1,29,3584]{2,1,0} aten::mul(%2630, %2629), scope=aten::mul.838, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2632 = bf16[29,3584]{1,0} aten::view(%2631), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2633 = bf16[29,18944]{1,0} aten::mm(%2632, %273), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2634 = bf16[1,29,18944]{2,1,0} aten::view(%2633), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2635 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2636 = bf16[3584,18944]{0,1} aten::permute(%2635), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2637 = bf16[29,3584]{1,0} aten::view(%2631), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2638 = bf16[29,18944]{1,0} aten::mm(%2637, %2636), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2639 = bf16[1,29,18944]{2,1,0} aten::view(%2638), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2640 = bf16[1,29,18944]{2,1,0} aten::silu(%2639), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2641 = bf16[1,29,18944]{2,1,0} aten::mul(%2640, %2634), scope=aten::mul.839, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2642 = bf16[29,18944]{1,0} aten::view(%2641), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2643 = bf16[29,3584]{1,0} aten::mm(%2642, %271), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2644 = bf16[1,29,3584]{2,1,0} aten::view(%2643), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2645 = bf16[1,29,3584]{2,1,0} aten::add(%2622, %2644, %269), scope=aten::add.840, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2646 = f32[1,29,3584]{2,1,0} xla::cast(%2645), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2647 = f32[1,29,3584]{2,1,0} aten::pow(%2646, %268), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2648 = f32[1,29,1]{2,1,0} aten::mean(%2647), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2649 = f32[1,29,1]{2,1,0} aten::add(%2648, %267, %266), scope=aten::add.841, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2650 = f32[1,29,1]{2,1,0} aten::rsqrt(%2649), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2651 = f32[1,29,3584]{2,1,0} aten::mul(%2646, %2650), scope=aten::mul.842, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2652 = bf16[1,29,3584]{2,1,0} xla::cast(%2651), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2653 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2654 = bf16[1,29,3584]{2,1,0} aten::mul(%2653, %2652), scope=aten::mul.843, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2655 = bf16[29,3584]{1,0} aten::view(%2654), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2656 = bf16[29,512]{1,0} aten::mm(%2655, %265), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2657 = bf16[1,29,512]{2,1,0} aten::view(%2656), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2658 = bf16[1,29,512]{2,1,0} aten::add(%2657, %263, %262), scope=aten::add.846, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2659 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2658), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2660 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2659), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2661 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2660), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2662 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2661), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2663 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2662), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2664 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2663), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2665 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2664), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2666 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2665), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2667 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2666), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2668 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2667), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2669 = bf16[28,29,128]{2,1,0} aten::view(%2668), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2670 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2671 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2672 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2673 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2674 = s64[1,29]{1,0} aten::expand(%2673), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2675 = s64[1,29]{1,0} aten::add(%632, %2674), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2676 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2677 = pred[1,29]{1,0} aten::lt(%632, %2676), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2678 = s64[1,29]{1,0} aten::where(%2677, %2675, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2679 = s64[1,29,1]{2,1,0} aten::stack(%2678), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2680 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2681 = bf16[29,128]{1,0} xla::select(%2680), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2682 = bf16[1,29,128]{2,1,0} aten::index(%2681, %2679), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2683 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2682), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2684 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2685 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2686 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2687 = bf16[3584,512]{0,1} aten::permute(%2686), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2688 = bf16[29,3584]{1,0} aten::view(%2654), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2689 = bf16[29,512]{1,0} aten::mm(%2688, %2687), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2690 = bf16[1,29,512]{2,1,0} aten::view(%2689), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2691 = bf16[1,29,512]{2,1,0} aten::add(%2690, %2685, %2684), scope=aten::add.845, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2692 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2691), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2693 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2692), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2694 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2693), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2695 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2693), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2696 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2695), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2697 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2696, %2694), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2698 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2697, %2683), scope=aten::mul.851, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2699 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2700 = s64[1,29]{1,0} aten::expand(%2699), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2701 = s64[1,29]{1,0} aten::add(%632, %2700), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2702 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2703 = pred[1,29]{1,0} aten::lt(%632, %2702), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2704 = s64[1,29]{1,0} aten::where(%2703, %2701, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2705 = s64[1,29,1]{2,1,0} aten::stack(%2704), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2706 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2707 = bf16[29,128]{1,0} xla::select(%2706), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2708 = bf16[1,29,128]{2,1,0} aten::index(%2707, %2705), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2709 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2708), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2710 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2693, %2709), scope=aten::mul.850, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2711 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2710, %2698, %2672), scope=aten::add.852, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2712 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2711), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2713 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2712), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2714 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2713), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2715 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2714), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2716 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2715), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2717 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2716), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2718 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2717), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2719 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2718), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2720 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2719), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2721 = bf16[28,128,29]{2,1,0} aten::view(%2720), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2722 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2723 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2724 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2725 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2726 = bf16[3584,3584]{0,1} aten::permute(%2725), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2727 = bf16[29,3584]{1,0} aten::view(%2654), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2728 = bf16[29,3584]{1,0} aten::mm(%2727, %2726), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2729 = bf16[1,29,3584]{2,1,0} aten::view(%2728), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2730 = bf16[1,29,3584]{2,1,0} aten::add(%2729, %2724, %2723), scope=aten::add.844, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2731 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2730), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2732 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2731), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2733 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2732), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2734 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2732), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2735 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2734), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2736 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2735, %2733), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2737 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2736, %2683), scope=aten::mul.848, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2738 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2732, %2709), scope=aten::mul.847, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2739 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2738, %2737, %2722), scope=aten::add.849, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2740 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2739), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2741 = bf16[28,29,128]{2,1,0} aten::view(%2740), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2742 = bf16[28,29,29]{2,1,0} aten::matmul(%2741, %2721), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2743 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2742), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2744 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2743, %2671), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2745 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2744, %621, %2670), scope=aten::add.853, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2746 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2745), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2747 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2746), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2748 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2747), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2749 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2748), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2750 = bf16[28,29,29]{2,1,0} aten::view(%2749), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2751 = bf16[28,29,128]{2,1,0} aten::matmul(%2750, %2669), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2752 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2751), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2753 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2752), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2754 = bf16[1,29,3584]{2,1,0} aten::view(%2753), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2755 = bf16[29,3584]{1,0} aten::view(%2754), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2756 = bf16[29,3584]{1,0} aten::mm(%2755, %261), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2757 = bf16[1,29,3584]{2,1,0} aten::view(%2756), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2758 = bf16[1,29,3584]{2,1,0} aten::add(%2645, %2757, %259), scope=aten::add.854, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2759 = f32[1,29,3584]{2,1,0} xla::cast(%2758), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2760 = f32[1,29,3584]{2,1,0} aten::pow(%2759, %258), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2761 = f32[1,29,1]{2,1,0} aten::mean(%2760), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2762 = f32[1,29,1]{2,1,0} aten::add(%2761, %257, %256), scope=aten::add.855, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2763 = f32[1,29,1]{2,1,0} aten::rsqrt(%2762), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2764 = f32[1,29,3584]{2,1,0} aten::mul(%2759, %2763), scope=aten::mul.856, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2765 = bf16[1,29,3584]{2,1,0} xla::cast(%2764), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2766 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2767 = bf16[1,29,3584]{2,1,0} aten::mul(%2766, %2765), scope=aten::mul.857, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2768 = bf16[29,3584]{1,0} aten::view(%2767), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2769 = bf16[29,18944]{1,0} aten::mm(%2768, %255), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2770 = bf16[1,29,18944]{2,1,0} aten::view(%2769), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2771 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2772 = bf16[3584,18944]{0,1} aten::permute(%2771), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2773 = bf16[29,3584]{1,0} aten::view(%2767), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2774 = bf16[29,18944]{1,0} aten::mm(%2773, %2772), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2775 = bf16[1,29,18944]{2,1,0} aten::view(%2774), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2776 = bf16[1,29,18944]{2,1,0} aten::silu(%2775), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2777 = bf16[1,29,18944]{2,1,0} aten::mul(%2776, %2770), scope=aten::mul.858, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2778 = bf16[29,18944]{1,0} aten::view(%2777), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2779 = bf16[29,3584]{1,0} aten::mm(%2778, %253), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2780 = bf16[1,29,3584]{2,1,0} aten::view(%2779), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2781 = bf16[1,29,3584]{2,1,0} aten::add(%2758, %2780, %251), scope=aten::add.859, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2782 = f32[1,29,3584]{2,1,0} xla::cast(%2781), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2783 = f32[1,29,3584]{2,1,0} aten::pow(%2782, %250), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2784 = f32[1,29,1]{2,1,0} aten::mean(%2783), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2785 = f32[1,29,1]{2,1,0} aten::add(%2784, %249, %248), scope=aten::add.860, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2786 = f32[1,29,1]{2,1,0} aten::rsqrt(%2785), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2787 = f32[1,29,3584]{2,1,0} aten::mul(%2782, %2786), scope=aten::mul.861, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2788 = bf16[1,29,3584]{2,1,0} xla::cast(%2787), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2789 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2790 = bf16[1,29,3584]{2,1,0} aten::mul(%2789, %2788), scope=aten::mul.862, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2791 = bf16[29,3584]{1,0} aten::view(%2790), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2792 = bf16[29,512]{1,0} aten::mm(%2791, %247), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2793 = bf16[1,29,512]{2,1,0} aten::view(%2792), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2794 = bf16[1,29,512]{2,1,0} aten::add(%2793, %245, %244), scope=aten::add.865, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2795 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2794), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2796 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2795), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2797 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2796), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2798 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2797), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2799 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2798), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2800 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2799), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2801 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2800), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2802 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2801), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2803 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2802), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2804 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2803), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2805 = bf16[28,29,128]{2,1,0} aten::view(%2804), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2806 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2807 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2808 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2809 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2810 = s64[1,29]{1,0} aten::expand(%2809), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2811 = s64[1,29]{1,0} aten::add(%632, %2810), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2812 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2813 = pred[1,29]{1,0} aten::lt(%632, %2812), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2814 = s64[1,29]{1,0} aten::where(%2813, %2811, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2815 = s64[1,29,1]{2,1,0} aten::stack(%2814), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2816 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2817 = bf16[29,128]{1,0} xla::select(%2816), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2818 = bf16[1,29,128]{2,1,0} aten::index(%2817, %2815), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2819 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2818), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2820 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2821 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2822 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2823 = bf16[3584,512]{0,1} aten::permute(%2822), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2824 = bf16[29,3584]{1,0} aten::view(%2790), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2825 = bf16[29,512]{1,0} aten::mm(%2824, %2823), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2826 = bf16[1,29,512]{2,1,0} aten::view(%2825), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2827 = bf16[1,29,512]{2,1,0} aten::add(%2826, %2821, %2820), scope=aten::add.864, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2828 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2827), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2829 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2828), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2830 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2829), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2831 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2829), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2832 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2831), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2833 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2832, %2830), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2834 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2833, %2819), scope=aten::mul.870, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2835 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2836 = s64[1,29]{1,0} aten::expand(%2835), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2837 = s64[1,29]{1,0} aten::add(%632, %2836), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2838 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2839 = pred[1,29]{1,0} aten::lt(%632, %2838), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2840 = s64[1,29]{1,0} aten::where(%2839, %2837, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2841 = s64[1,29,1]{2,1,0} aten::stack(%2840), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2842 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2843 = bf16[29,128]{1,0} xla::select(%2842), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2844 = bf16[1,29,128]{2,1,0} aten::index(%2843, %2841), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2845 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2844), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2846 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2829, %2845), scope=aten::mul.869, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2847 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2846, %2834, %2808), scope=aten::add.871, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2848 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2847), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2849 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2848), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2850 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2849), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2851 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2850), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2852 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2851), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2853 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2852), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2854 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2853), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2855 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2854), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2856 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2855), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2857 = bf16[28,128,29]{2,1,0} aten::view(%2856), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2858 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2859 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2860 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2861 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2862 = bf16[3584,3584]{0,1} aten::permute(%2861), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2863 = bf16[29,3584]{1,0} aten::view(%2790), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2864 = bf16[29,3584]{1,0} aten::mm(%2863, %2862), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2865 = bf16[1,29,3584]{2,1,0} aten::view(%2864), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2866 = bf16[1,29,3584]{2,1,0} aten::add(%2865, %2860, %2859), scope=aten::add.863, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2867 = bf16[1,29,28,128]{3,2,1,0} aten::view(%2866), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %2868 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%2867), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %2869 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2868), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2870 = bf16[1,28,29,64]{3,1,2,0} xla::select(%2868), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2871 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%2870), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %2872 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%2871, %2869), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2873 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2872, %2819), scope=aten::mul.867, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2874 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%2868, %2845), scope=aten::mul.866, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2875 = bf16[1,28,29,128]{3,2,1,0} aten::add(%2874, %2873, %2858), scope=aten::add.868, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2876 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2875), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2877 = bf16[28,29,128]{2,1,0} aten::view(%2876), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %2878 = bf16[28,29,29]{2,1,0} aten::matmul(%2877, %2857), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %2879 = bf16[1,28,29,29]{3,2,1,0} aten::view(%2878), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2880 = bf16[1,28,29,29]{3,2,1,0} aten::div(%2879, %2807), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2881 = bf16[1,28,29,29]{3,2,1,0} aten::add(%2880, %621, %2806), scope=aten::add.872, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2882 = f32[1,28,29,29]{3,2,1,0} xla::cast(%2881), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2883 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%2882), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %2884 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%2883), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2885 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%2884), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %2886 = bf16[28,29,29]{2,1,0} aten::view(%2885), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %2887 = bf16[28,29,128]{2,1,0} aten::matmul(%2886, %2805), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2888 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2887), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2889 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%2888), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %2890 = bf16[1,29,3584]{2,1,0} aten::view(%2889), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %2891 = bf16[29,3584]{1,0} aten::view(%2890), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2892 = bf16[29,3584]{1,0} aten::mm(%2891, %243), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2893 = bf16[1,29,3584]{2,1,0} aten::view(%2892), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2894 = bf16[1,29,3584]{2,1,0} aten::add(%2781, %2893, %241), scope=aten::add.873, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %2895 = f32[1,29,3584]{2,1,0} xla::cast(%2894), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2896 = f32[1,29,3584]{2,1,0} aten::pow(%2895, %240), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2897 = f32[1,29,1]{2,1,0} aten::mean(%2896), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2898 = f32[1,29,1]{2,1,0} aten::add(%2897, %239, %238), scope=aten::add.874, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2899 = f32[1,29,1]{2,1,0} aten::rsqrt(%2898), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2900 = f32[1,29,3584]{2,1,0} aten::mul(%2895, %2899), scope=aten::mul.875, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2901 = bf16[1,29,3584]{2,1,0} xla::cast(%2900), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2902 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2903 = bf16[1,29,3584]{2,1,0} aten::mul(%2902, %2901), scope=aten::mul.876, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2904 = bf16[29,3584]{1,0} aten::view(%2903), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2905 = bf16[29,18944]{1,0} aten::mm(%2904, %237), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2906 = bf16[1,29,18944]{2,1,0} aten::view(%2905), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2907 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %2908 = bf16[3584,18944]{0,1} aten::permute(%2907), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %2909 = bf16[29,3584]{1,0} aten::view(%2903), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2910 = bf16[29,18944]{1,0} aten::mm(%2909, %2908), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2911 = bf16[1,29,18944]{2,1,0} aten::view(%2910), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %2912 = bf16[1,29,18944]{2,1,0} aten::silu(%2911), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %2913 = bf16[1,29,18944]{2,1,0} aten::mul(%2912, %2906), scope=aten::mul.877, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %2914 = bf16[29,18944]{1,0} aten::view(%2913), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %2915 = bf16[29,3584]{1,0} aten::mm(%2914, %235), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2916 = bf16[1,29,3584]{2,1,0} aten::view(%2915), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %2917 = bf16[1,29,3584]{2,1,0} aten::add(%2894, %2916, %233), scope=aten::add.878, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %2918 = f32[1,29,3584]{2,1,0} xla::cast(%2917), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %2919 = f32[1,29,3584]{2,1,0} aten::pow(%2918, %232), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %2920 = f32[1,29,1]{2,1,0} aten::mean(%2919), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %2921 = f32[1,29,1]{2,1,0} aten::add(%2920, %231, %230), scope=aten::add.879, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2922 = f32[1,29,1]{2,1,0} aten::rsqrt(%2921), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %2923 = f32[1,29,3584]{2,1,0} aten::mul(%2918, %2922), scope=aten::mul.880, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %2924 = bf16[1,29,3584]{2,1,0} xla::cast(%2923), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2925 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2926 = bf16[1,29,3584]{2,1,0} aten::mul(%2925, %2924), scope=aten::mul.881, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %2927 = bf16[29,3584]{1,0} aten::view(%2926), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2928 = bf16[29,512]{1,0} aten::mm(%2927, %229), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2929 = bf16[1,29,512]{2,1,0} aten::view(%2928), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2930 = bf16[1,29,512]{2,1,0} aten::add(%2929, %227, %226), scope=aten::add.884, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2931 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2930), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2932 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2931), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2933 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2932), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2934 = bf16[1,4,29,128]{3,1,2,0} xla::select(%2933), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2935 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2934), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2936 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2935), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2937 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2936), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2938 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2937), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2939 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2938), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2940 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%2939), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2941 = bf16[28,29,128]{2,1,0} aten::view(%2940), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %2942 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %2943 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %2944 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %2945 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2946 = s64[1,29]{1,0} aten::expand(%2945), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2947 = s64[1,29]{1,0} aten::add(%632, %2946), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2948 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %2949 = pred[1,29]{1,0} aten::lt(%632, %2948), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %2950 = s64[1,29]{1,0} aten::where(%2949, %2947, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %2951 = s64[1,29,1]{2,1,0} aten::stack(%2950), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %2952 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2953 = bf16[29,128]{1,0} xla::select(%2952), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %2954 = bf16[1,29,128]{2,1,0} aten::index(%2953, %2951), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %2955 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2954), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2956 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2957 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %2958 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %2959 = bf16[3584,512]{0,1} aten::permute(%2958), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %2960 = bf16[29,3584]{1,0} aten::view(%2926), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %2961 = bf16[29,512]{1,0} aten::mm(%2960, %2959), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %2962 = bf16[1,29,512]{2,1,0} aten::view(%2961), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2963 = bf16[1,29,512]{2,1,0} aten::add(%2962, %2957, %2956), scope=aten::add.883, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %2964 = bf16[1,29,4,128]{3,2,1,0} aten::view(%2963), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %2965 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%2964), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %2966 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2965), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2967 = bf16[1,4,29,64]{3,1,2,0} xla::select(%2965), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2968 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%2967), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %2969 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%2968, %2966), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2970 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2969, %2955), scope=aten::mul.889, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2971 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2972 = s64[1,29]{1,0} aten::expand(%2971), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2973 = s64[1,29]{1,0} aten::add(%632, %2972), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2974 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %2975 = pred[1,29]{1,0} aten::lt(%632, %2974), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %2976 = s64[1,29]{1,0} aten::where(%2975, %2973, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %2977 = s64[1,29,1]{2,1,0} aten::stack(%2976), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %2978 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %2979 = bf16[29,128]{1,0} xla::select(%2978), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %2980 = bf16[1,29,128]{2,1,0} aten::index(%2979, %2977), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %2981 = bf16[1,1,29,128]{3,2,1,0} aten::view(%2980), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %2982 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%2965, %2981), scope=aten::mul.888, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2983 = bf16[1,4,29,128]{3,2,1,0} aten::add(%2982, %2970, %2944), scope=aten::add.890, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2984 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2983), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2985 = bf16[1,4,29,128]{3,2,1,0} xla::select(%2984), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %2986 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%2985), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2987 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2986), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2988 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%2987), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %2989 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%2988), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %2990 = bf16[1,28,29,128]{3,2,1,0} aten::view(%2989), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %2991 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%2990), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %2992 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%2991), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %2993 = bf16[28,128,29]{2,1,0} aten::view(%2992), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %2994 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %2995 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %2996 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %2997 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %2998 = bf16[3584,3584]{0,1} aten::permute(%2997), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %2999 = bf16[29,3584]{1,0} aten::view(%2926), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3000 = bf16[29,3584]{1,0} aten::mm(%2999, %2998), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3001 = bf16[1,29,3584]{2,1,0} aten::view(%3000), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3002 = bf16[1,29,3584]{2,1,0} aten::add(%3001, %2996, %2995), scope=aten::add.882, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3003 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3002), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3004 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3003), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3005 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3004), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3006 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3004), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3007 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3006), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3008 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3007, %3005), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3009 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3008, %2955), scope=aten::mul.886, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3010 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3004, %2981), scope=aten::mul.885, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3011 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3010, %3009, %2994), scope=aten::add.887, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3012 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3011), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3013 = bf16[28,29,128]{2,1,0} aten::view(%3012), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3014 = bf16[28,29,29]{2,1,0} aten::matmul(%3013, %2993), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3015 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3014), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3016 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3015, %2943), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3017 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3016, %621, %2942), scope=aten::add.891, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3018 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3017), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3019 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3018), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3020 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3019), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3021 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3020), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3022 = bf16[28,29,29]{2,1,0} aten::view(%3021), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3023 = bf16[28,29,128]{2,1,0} aten::matmul(%3022, %2941), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3024 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3023), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3025 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3024), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3026 = bf16[1,29,3584]{2,1,0} aten::view(%3025), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3027 = bf16[29,3584]{1,0} aten::view(%3026), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3028 = bf16[29,3584]{1,0} aten::mm(%3027, %225), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3029 = bf16[1,29,3584]{2,1,0} aten::view(%3028), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3030 = bf16[1,29,3584]{2,1,0} aten::add(%2917, %3029, %223), scope=aten::add.892, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3031 = f32[1,29,3584]{2,1,0} xla::cast(%3030), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3032 = f32[1,29,3584]{2,1,0} aten::pow(%3031, %222), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3033 = f32[1,29,1]{2,1,0} aten::mean(%3032), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3034 = f32[1,29,1]{2,1,0} aten::add(%3033, %221, %220), scope=aten::add.893, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3035 = f32[1,29,1]{2,1,0} aten::rsqrt(%3034), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3036 = f32[1,29,3584]{2,1,0} aten::mul(%3031, %3035), scope=aten::mul.894, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3037 = bf16[1,29,3584]{2,1,0} xla::cast(%3036), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3038 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3039 = bf16[1,29,3584]{2,1,0} aten::mul(%3038, %3037), scope=aten::mul.895, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3040 = bf16[29,3584]{1,0} aten::view(%3039), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3041 = bf16[29,18944]{1,0} aten::mm(%3040, %219), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3042 = bf16[1,29,18944]{2,1,0} aten::view(%3041), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3043 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3044 = bf16[3584,18944]{0,1} aten::permute(%3043), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3045 = bf16[29,3584]{1,0} aten::view(%3039), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3046 = bf16[29,18944]{1,0} aten::mm(%3045, %3044), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3047 = bf16[1,29,18944]{2,1,0} aten::view(%3046), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3048 = bf16[1,29,18944]{2,1,0} aten::silu(%3047), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3049 = bf16[1,29,18944]{2,1,0} aten::mul(%3048, %3042), scope=aten::mul.896, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3050 = bf16[29,18944]{1,0} aten::view(%3049), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3051 = bf16[29,3584]{1,0} aten::mm(%3050, %217), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3052 = bf16[1,29,3584]{2,1,0} aten::view(%3051), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3053 = bf16[1,29,3584]{2,1,0} aten::add(%3030, %3052, %215), scope=aten::add.897, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3054 = f32[1,29,3584]{2,1,0} xla::cast(%3053), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3055 = f32[1,29,3584]{2,1,0} aten::pow(%3054, %214), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3056 = f32[1,29,1]{2,1,0} aten::mean(%3055), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3057 = f32[1,29,1]{2,1,0} aten::add(%3056, %213, %212), scope=aten::add.898, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3058 = f32[1,29,1]{2,1,0} aten::rsqrt(%3057), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3059 = f32[1,29,3584]{2,1,0} aten::mul(%3054, %3058), scope=aten::mul.899, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3060 = bf16[1,29,3584]{2,1,0} xla::cast(%3059), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3061 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3062 = bf16[1,29,3584]{2,1,0} aten::mul(%3061, %3060), scope=aten::mul.900, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3063 = bf16[29,3584]{1,0} aten::view(%3062), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3064 = bf16[29,512]{1,0} aten::mm(%3063, %211), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3065 = bf16[1,29,512]{2,1,0} aten::view(%3064), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3066 = bf16[1,29,512]{2,1,0} aten::add(%3065, %209, %208), scope=aten::add.903, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3067 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3066), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3068 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3067), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3069 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3068), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3070 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3069), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3071 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3070), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3072 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3071), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3073 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3072), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3074 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3073), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3075 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3074), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3076 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3075), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3077 = bf16[28,29,128]{2,1,0} aten::view(%3076), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3078 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3079 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3080 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3081 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3082 = s64[1,29]{1,0} aten::expand(%3081), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3083 = s64[1,29]{1,0} aten::add(%632, %3082), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3084 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3085 = pred[1,29]{1,0} aten::lt(%632, %3084), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3086 = s64[1,29]{1,0} aten::where(%3085, %3083, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3087 = s64[1,29,1]{2,1,0} aten::stack(%3086), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3088 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3089 = bf16[29,128]{1,0} xla::select(%3088), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3090 = bf16[1,29,128]{2,1,0} aten::index(%3089, %3087), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3091 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3090), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3092 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3093 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3094 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3095 = bf16[3584,512]{0,1} aten::permute(%3094), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3096 = bf16[29,3584]{1,0} aten::view(%3062), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3097 = bf16[29,512]{1,0} aten::mm(%3096, %3095), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3098 = bf16[1,29,512]{2,1,0} aten::view(%3097), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3099 = bf16[1,29,512]{2,1,0} aten::add(%3098, %3093, %3092), scope=aten::add.902, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3100 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3099), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3101 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3100), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3102 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3101), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3103 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3101), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3104 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3103), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3105 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3104, %3102), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3106 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3105, %3091), scope=aten::mul.908, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3107 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3108 = s64[1,29]{1,0} aten::expand(%3107), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3109 = s64[1,29]{1,0} aten::add(%632, %3108), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3110 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3111 = pred[1,29]{1,0} aten::lt(%632, %3110), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3112 = s64[1,29]{1,0} aten::where(%3111, %3109, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3113 = s64[1,29,1]{2,1,0} aten::stack(%3112), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3114 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3115 = bf16[29,128]{1,0} xla::select(%3114), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3116 = bf16[1,29,128]{2,1,0} aten::index(%3115, %3113), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3117 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3116), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3118 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3101, %3117), scope=aten::mul.907, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3119 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3118, %3106, %3080), scope=aten::add.909, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3120 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3119), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3121 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3120), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3122 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3121), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3123 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3122), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3124 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3123), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3125 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3124), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3126 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3125), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3127 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3126), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3128 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3127), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3129 = bf16[28,128,29]{2,1,0} aten::view(%3128), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3130 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3131 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3132 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3133 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3134 = bf16[3584,3584]{0,1} aten::permute(%3133), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3135 = bf16[29,3584]{1,0} aten::view(%3062), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3136 = bf16[29,3584]{1,0} aten::mm(%3135, %3134), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3137 = bf16[1,29,3584]{2,1,0} aten::view(%3136), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3138 = bf16[1,29,3584]{2,1,0} aten::add(%3137, %3132, %3131), scope=aten::add.901, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3139 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3138), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3140 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3139), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3141 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3140), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3142 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3140), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3143 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3142), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3144 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3143, %3141), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3145 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3144, %3091), scope=aten::mul.905, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3146 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3140, %3117), scope=aten::mul.904, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3147 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3146, %3145, %3130), scope=aten::add.906, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3148 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3147), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3149 = bf16[28,29,128]{2,1,0} aten::view(%3148), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3150 = bf16[28,29,29]{2,1,0} aten::matmul(%3149, %3129), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3151 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3150), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3152 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3151, %3079), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3153 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3152, %621, %3078), scope=aten::add.910, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3154 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3153), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3155 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3154), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3156 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3155), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3157 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3156), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3158 = bf16[28,29,29]{2,1,0} aten::view(%3157), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3159 = bf16[28,29,128]{2,1,0} aten::matmul(%3158, %3077), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3160 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3159), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3161 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3160), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3162 = bf16[1,29,3584]{2,1,0} aten::view(%3161), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3163 = bf16[29,3584]{1,0} aten::view(%3162), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3164 = bf16[29,3584]{1,0} aten::mm(%3163, %207), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3165 = bf16[1,29,3584]{2,1,0} aten::view(%3164), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3166 = bf16[1,29,3584]{2,1,0} aten::add(%3053, %3165, %205), scope=aten::add.911, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3167 = f32[1,29,3584]{2,1,0} xla::cast(%3166), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3168 = f32[1,29,3584]{2,1,0} aten::pow(%3167, %204), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3169 = f32[1,29,1]{2,1,0} aten::mean(%3168), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3170 = f32[1,29,1]{2,1,0} aten::add(%3169, %203, %202), scope=aten::add.912, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3171 = f32[1,29,1]{2,1,0} aten::rsqrt(%3170), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3172 = f32[1,29,3584]{2,1,0} aten::mul(%3167, %3171), scope=aten::mul.913, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3173 = bf16[1,29,3584]{2,1,0} xla::cast(%3172), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3174 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3175 = bf16[1,29,3584]{2,1,0} aten::mul(%3174, %3173), scope=aten::mul.914, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3176 = bf16[29,3584]{1,0} aten::view(%3175), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3177 = bf16[29,18944]{1,0} aten::mm(%3176, %201), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3178 = bf16[1,29,18944]{2,1,0} aten::view(%3177), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3179 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3180 = bf16[3584,18944]{0,1} aten::permute(%3179), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3181 = bf16[29,3584]{1,0} aten::view(%3175), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3182 = bf16[29,18944]{1,0} aten::mm(%3181, %3180), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3183 = bf16[1,29,18944]{2,1,0} aten::view(%3182), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3184 = bf16[1,29,18944]{2,1,0} aten::silu(%3183), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3185 = bf16[1,29,18944]{2,1,0} aten::mul(%3184, %3178), scope=aten::mul.915, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3186 = bf16[29,18944]{1,0} aten::view(%3185), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3187 = bf16[29,3584]{1,0} aten::mm(%3186, %199), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3188 = bf16[1,29,3584]{2,1,0} aten::view(%3187), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3189 = bf16[1,29,3584]{2,1,0} aten::add(%3166, %3188, %197), scope=aten::add.916, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3190 = f32[1,29,3584]{2,1,0} xla::cast(%3189), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3191 = f32[1,29,3584]{2,1,0} aten::pow(%3190, %196), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3192 = f32[1,29,1]{2,1,0} aten::mean(%3191), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3193 = f32[1,29,1]{2,1,0} aten::add(%3192, %195, %194), scope=aten::add.917, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3194 = f32[1,29,1]{2,1,0} aten::rsqrt(%3193), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3195 = f32[1,29,3584]{2,1,0} aten::mul(%3190, %3194), scope=aten::mul.918, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3196 = bf16[1,29,3584]{2,1,0} xla::cast(%3195), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3197 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3198 = bf16[1,29,3584]{2,1,0} aten::mul(%3197, %3196), scope=aten::mul.919, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3199 = bf16[29,3584]{1,0} aten::view(%3198), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3200 = bf16[29,512]{1,0} aten::mm(%3199, %193), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3201 = bf16[1,29,512]{2,1,0} aten::view(%3200), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3202 = bf16[1,29,512]{2,1,0} aten::add(%3201, %191, %190), scope=aten::add.922, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3203 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3202), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3204 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3203), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3205 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3204), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3206 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3205), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3207 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3206), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3208 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3207), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3209 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3208), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3210 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3209), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3211 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3210), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3212 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3211), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3213 = bf16[28,29,128]{2,1,0} aten::view(%3212), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3214 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3215 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3216 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3217 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3218 = s64[1,29]{1,0} aten::expand(%3217), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3219 = s64[1,29]{1,0} aten::add(%632, %3218), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3220 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3221 = pred[1,29]{1,0} aten::lt(%632, %3220), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3222 = s64[1,29]{1,0} aten::where(%3221, %3219, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3223 = s64[1,29,1]{2,1,0} aten::stack(%3222), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3224 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3225 = bf16[29,128]{1,0} xla::select(%3224), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3226 = bf16[1,29,128]{2,1,0} aten::index(%3225, %3223), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3227 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3226), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3228 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3229 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3230 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3231 = bf16[3584,512]{0,1} aten::permute(%3230), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3232 = bf16[29,3584]{1,0} aten::view(%3198), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3233 = bf16[29,512]{1,0} aten::mm(%3232, %3231), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3234 = bf16[1,29,512]{2,1,0} aten::view(%3233), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3235 = bf16[1,29,512]{2,1,0} aten::add(%3234, %3229, %3228), scope=aten::add.921, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3236 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3235), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3237 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3236), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3238 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3237), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3239 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3237), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3240 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3239), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3241 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3240, %3238), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3242 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3241, %3227), scope=aten::mul.927, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3243 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3244 = s64[1,29]{1,0} aten::expand(%3243), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3245 = s64[1,29]{1,0} aten::add(%632, %3244), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3246 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3247 = pred[1,29]{1,0} aten::lt(%632, %3246), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3248 = s64[1,29]{1,0} aten::where(%3247, %3245, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3249 = s64[1,29,1]{2,1,0} aten::stack(%3248), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3250 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3251 = bf16[29,128]{1,0} xla::select(%3250), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3252 = bf16[1,29,128]{2,1,0} aten::index(%3251, %3249), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3253 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3252), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3254 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3237, %3253), scope=aten::mul.926, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3255 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3254, %3242, %3216), scope=aten::add.928, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3256 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3255), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3257 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3256), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3258 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3257), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3259 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3258), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3260 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3259), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3261 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3260), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3262 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3261), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3263 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3262), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3264 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3263), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3265 = bf16[28,128,29]{2,1,0} aten::view(%3264), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3266 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3267 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3268 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3269 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3270 = bf16[3584,3584]{0,1} aten::permute(%3269), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3271 = bf16[29,3584]{1,0} aten::view(%3198), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3272 = bf16[29,3584]{1,0} aten::mm(%3271, %3270), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3273 = bf16[1,29,3584]{2,1,0} aten::view(%3272), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3274 = bf16[1,29,3584]{2,1,0} aten::add(%3273, %3268, %3267), scope=aten::add.920, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3275 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3274), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3276 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3275), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3277 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3276), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3278 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3276), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3279 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3278), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3280 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3279, %3277), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3281 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3280, %3227), scope=aten::mul.924, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3282 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3276, %3253), scope=aten::mul.923, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3283 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3282, %3281, %3266), scope=aten::add.925, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3284 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3283), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3285 = bf16[28,29,128]{2,1,0} aten::view(%3284), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3286 = bf16[28,29,29]{2,1,0} aten::matmul(%3285, %3265), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3287 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3286), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3288 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3287, %3215), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3289 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3288, %621, %3214), scope=aten::add.929, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3290 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3289), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3291 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3290), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3292 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3291), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3293 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3292), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3294 = bf16[28,29,29]{2,1,0} aten::view(%3293), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3295 = bf16[28,29,128]{2,1,0} aten::matmul(%3294, %3213), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3296 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3295), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3297 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3296), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3298 = bf16[1,29,3584]{2,1,0} aten::view(%3297), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3299 = bf16[29,3584]{1,0} aten::view(%3298), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3300 = bf16[29,3584]{1,0} aten::mm(%3299, %189), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3301 = bf16[1,29,3584]{2,1,0} aten::view(%3300), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3302 = bf16[1,29,3584]{2,1,0} aten::add(%3189, %3301, %187), scope=aten::add.930, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3303 = f32[1,29,3584]{2,1,0} xla::cast(%3302), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3304 = f32[1,29,3584]{2,1,0} aten::pow(%3303, %186), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3305 = f32[1,29,1]{2,1,0} aten::mean(%3304), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3306 = f32[1,29,1]{2,1,0} aten::add(%3305, %185, %184), scope=aten::add.931, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3307 = f32[1,29,1]{2,1,0} aten::rsqrt(%3306), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3308 = f32[1,29,3584]{2,1,0} aten::mul(%3303, %3307), scope=aten::mul.932, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3309 = bf16[1,29,3584]{2,1,0} xla::cast(%3308), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3310 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3311 = bf16[1,29,3584]{2,1,0} aten::mul(%3310, %3309), scope=aten::mul.933, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3312 = bf16[29,3584]{1,0} aten::view(%3311), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3313 = bf16[29,18944]{1,0} aten::mm(%3312, %183), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3314 = bf16[1,29,18944]{2,1,0} aten::view(%3313), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3315 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3316 = bf16[3584,18944]{0,1} aten::permute(%3315), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3317 = bf16[29,3584]{1,0} aten::view(%3311), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3318 = bf16[29,18944]{1,0} aten::mm(%3317, %3316), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3319 = bf16[1,29,18944]{2,1,0} aten::view(%3318), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3320 = bf16[1,29,18944]{2,1,0} aten::silu(%3319), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3321 = bf16[1,29,18944]{2,1,0} aten::mul(%3320, %3314), scope=aten::mul.934, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3322 = bf16[29,18944]{1,0} aten::view(%3321), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3323 = bf16[29,3584]{1,0} aten::mm(%3322, %181), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3324 = bf16[1,29,3584]{2,1,0} aten::view(%3323), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3325 = bf16[1,29,3584]{2,1,0} aten::add(%3302, %3324, %179), scope=aten::add.935, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3326 = f32[1,29,3584]{2,1,0} xla::cast(%3325), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3327 = f32[1,29,3584]{2,1,0} aten::pow(%3326, %178), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3328 = f32[1,29,1]{2,1,0} aten::mean(%3327), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3329 = f32[1,29,1]{2,1,0} aten::add(%3328, %177, %176), scope=aten::add.936, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3330 = f32[1,29,1]{2,1,0} aten::rsqrt(%3329), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3331 = f32[1,29,3584]{2,1,0} aten::mul(%3326, %3330), scope=aten::mul.937, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3332 = bf16[1,29,3584]{2,1,0} xla::cast(%3331), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3333 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3334 = bf16[1,29,3584]{2,1,0} aten::mul(%3333, %3332), scope=aten::mul.938, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3335 = bf16[29,3584]{1,0} aten::view(%3334), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3336 = bf16[29,512]{1,0} aten::mm(%3335, %175), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3337 = bf16[1,29,512]{2,1,0} aten::view(%3336), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3338 = bf16[1,29,512]{2,1,0} aten::add(%3337, %173, %172), scope=aten::add.941, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3339 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3338), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3340 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3339), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3341 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3340), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3342 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3341), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3343 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3342), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3344 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3343), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3345 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3344), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3346 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3345), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3347 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3346), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3348 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3347), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3349 = bf16[28,29,128]{2,1,0} aten::view(%3348), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3350 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3351 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3352 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3353 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3354 = s64[1,29]{1,0} aten::expand(%3353), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3355 = s64[1,29]{1,0} aten::add(%632, %3354), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3356 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3357 = pred[1,29]{1,0} aten::lt(%632, %3356), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3358 = s64[1,29]{1,0} aten::where(%3357, %3355, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3359 = s64[1,29,1]{2,1,0} aten::stack(%3358), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3360 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3361 = bf16[29,128]{1,0} xla::select(%3360), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3362 = bf16[1,29,128]{2,1,0} aten::index(%3361, %3359), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3363 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3362), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3364 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3365 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3366 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3367 = bf16[3584,512]{0,1} aten::permute(%3366), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3368 = bf16[29,3584]{1,0} aten::view(%3334), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3369 = bf16[29,512]{1,0} aten::mm(%3368, %3367), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3370 = bf16[1,29,512]{2,1,0} aten::view(%3369), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3371 = bf16[1,29,512]{2,1,0} aten::add(%3370, %3365, %3364), scope=aten::add.940, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3372 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3371), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3373 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3372), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3374 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3373), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3375 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3373), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3376 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3375), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3377 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3376, %3374), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3378 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3377, %3363), scope=aten::mul.946, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3379 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3380 = s64[1,29]{1,0} aten::expand(%3379), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3381 = s64[1,29]{1,0} aten::add(%632, %3380), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3382 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3383 = pred[1,29]{1,0} aten::lt(%632, %3382), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3384 = s64[1,29]{1,0} aten::where(%3383, %3381, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3385 = s64[1,29,1]{2,1,0} aten::stack(%3384), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3386 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3387 = bf16[29,128]{1,0} xla::select(%3386), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3388 = bf16[1,29,128]{2,1,0} aten::index(%3387, %3385), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3389 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3388), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3390 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3373, %3389), scope=aten::mul.945, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3391 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3390, %3378, %3352), scope=aten::add.947, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3392 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3391), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3393 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3392), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3394 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3393), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3395 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3394), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3396 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3395), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3397 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3396), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3398 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3397), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3399 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3398), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3400 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3399), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3401 = bf16[28,128,29]{2,1,0} aten::view(%3400), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3402 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3403 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3404 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3405 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3406 = bf16[3584,3584]{0,1} aten::permute(%3405), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3407 = bf16[29,3584]{1,0} aten::view(%3334), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3408 = bf16[29,3584]{1,0} aten::mm(%3407, %3406), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3409 = bf16[1,29,3584]{2,1,0} aten::view(%3408), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3410 = bf16[1,29,3584]{2,1,0} aten::add(%3409, %3404, %3403), scope=aten::add.939, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3411 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3410), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3412 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3411), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3413 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3412), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3414 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3412), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3415 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3414), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3416 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3415, %3413), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3417 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3416, %3363), scope=aten::mul.943, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3418 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3412, %3389), scope=aten::mul.942, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3419 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3418, %3417, %3402), scope=aten::add.944, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3420 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3419), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3421 = bf16[28,29,128]{2,1,0} aten::view(%3420), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3422 = bf16[28,29,29]{2,1,0} aten::matmul(%3421, %3401), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3423 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3422), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3424 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3423, %3351), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3425 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3424, %621, %3350), scope=aten::add.948, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3426 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3425), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3427 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3426), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3428 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3427), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3429 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3428), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3430 = bf16[28,29,29]{2,1,0} aten::view(%3429), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3431 = bf16[28,29,128]{2,1,0} aten::matmul(%3430, %3349), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3432 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3431), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3433 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3432), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3434 = bf16[1,29,3584]{2,1,0} aten::view(%3433), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3435 = bf16[29,3584]{1,0} aten::view(%3434), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3436 = bf16[29,3584]{1,0} aten::mm(%3435, %171), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3437 = bf16[1,29,3584]{2,1,0} aten::view(%3436), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3438 = bf16[1,29,3584]{2,1,0} aten::add(%3325, %3437, %169), scope=aten::add.949, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3439 = f32[1,29,3584]{2,1,0} xla::cast(%3438), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3440 = f32[1,29,3584]{2,1,0} aten::pow(%3439, %168), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3441 = f32[1,29,1]{2,1,0} aten::mean(%3440), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3442 = f32[1,29,1]{2,1,0} aten::add(%3441, %167, %166), scope=aten::add.950, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3443 = f32[1,29,1]{2,1,0} aten::rsqrt(%3442), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3444 = f32[1,29,3584]{2,1,0} aten::mul(%3439, %3443), scope=aten::mul.951, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3445 = bf16[1,29,3584]{2,1,0} xla::cast(%3444), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3446 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3447 = bf16[1,29,3584]{2,1,0} aten::mul(%3446, %3445), scope=aten::mul.952, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3448 = bf16[29,3584]{1,0} aten::view(%3447), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3449 = bf16[29,18944]{1,0} aten::mm(%3448, %165), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3450 = bf16[1,29,18944]{2,1,0} aten::view(%3449), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3451 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3452 = bf16[3584,18944]{0,1} aten::permute(%3451), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3453 = bf16[29,3584]{1,0} aten::view(%3447), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3454 = bf16[29,18944]{1,0} aten::mm(%3453, %3452), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3455 = bf16[1,29,18944]{2,1,0} aten::view(%3454), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3456 = bf16[1,29,18944]{2,1,0} aten::silu(%3455), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3457 = bf16[1,29,18944]{2,1,0} aten::mul(%3456, %3450), scope=aten::mul.953, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3458 = bf16[29,18944]{1,0} aten::view(%3457), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3459 = bf16[29,3584]{1,0} aten::mm(%3458, %163), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3460 = bf16[1,29,3584]{2,1,0} aten::view(%3459), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3461 = bf16[1,29,3584]{2,1,0} aten::add(%3438, %3460, %161), scope=aten::add.954, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3462 = f32[1,29,3584]{2,1,0} xla::cast(%3461), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3463 = f32[1,29,3584]{2,1,0} aten::pow(%3462, %160), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3464 = f32[1,29,1]{2,1,0} aten::mean(%3463), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3465 = f32[1,29,1]{2,1,0} aten::add(%3464, %159, %158), scope=aten::add.955, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3466 = f32[1,29,1]{2,1,0} aten::rsqrt(%3465), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3467 = f32[1,29,3584]{2,1,0} aten::mul(%3462, %3466), scope=aten::mul.956, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3468 = bf16[1,29,3584]{2,1,0} xla::cast(%3467), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3469 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3470 = bf16[1,29,3584]{2,1,0} aten::mul(%3469, %3468), scope=aten::mul.957, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3471 = bf16[29,3584]{1,0} aten::view(%3470), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3472 = bf16[29,512]{1,0} aten::mm(%3471, %157), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3473 = bf16[1,29,512]{2,1,0} aten::view(%3472), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3474 = bf16[1,29,512]{2,1,0} aten::add(%3473, %155, %154), scope=aten::add.960, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3475 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3474), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3476 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3475), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3477 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3476), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3478 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3477), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3479 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3478), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3480 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3479), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3481 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3480), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3482 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3481), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3483 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3482), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3484 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3483), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3485 = bf16[28,29,128]{2,1,0} aten::view(%3484), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3486 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3487 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3488 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3489 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3490 = s64[1,29]{1,0} aten::expand(%3489), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3491 = s64[1,29]{1,0} aten::add(%632, %3490), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3492 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3493 = pred[1,29]{1,0} aten::lt(%632, %3492), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3494 = s64[1,29]{1,0} aten::where(%3493, %3491, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3495 = s64[1,29,1]{2,1,0} aten::stack(%3494), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3496 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3497 = bf16[29,128]{1,0} xla::select(%3496), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3498 = bf16[1,29,128]{2,1,0} aten::index(%3497, %3495), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3499 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3498), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3500 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3501 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3502 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3503 = bf16[3584,512]{0,1} aten::permute(%3502), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3504 = bf16[29,3584]{1,0} aten::view(%3470), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3505 = bf16[29,512]{1,0} aten::mm(%3504, %3503), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3506 = bf16[1,29,512]{2,1,0} aten::view(%3505), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3507 = bf16[1,29,512]{2,1,0} aten::add(%3506, %3501, %3500), scope=aten::add.959, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3508 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3507), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3509 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3508), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3510 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3509), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3511 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3509), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3512 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3511), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3513 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3512, %3510), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3514 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3513, %3499), scope=aten::mul.965, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3515 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3516 = s64[1,29]{1,0} aten::expand(%3515), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3517 = s64[1,29]{1,0} aten::add(%632, %3516), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3518 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3519 = pred[1,29]{1,0} aten::lt(%632, %3518), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3520 = s64[1,29]{1,0} aten::where(%3519, %3517, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3521 = s64[1,29,1]{2,1,0} aten::stack(%3520), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3522 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3523 = bf16[29,128]{1,0} xla::select(%3522), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3524 = bf16[1,29,128]{2,1,0} aten::index(%3523, %3521), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3525 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3524), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3526 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3509, %3525), scope=aten::mul.964, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3527 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3526, %3514, %3488), scope=aten::add.966, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3528 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3527), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3529 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3528), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3530 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3529), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3531 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3530), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3532 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3531), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3533 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3532), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3534 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3533), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3535 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3534), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3536 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3535), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3537 = bf16[28,128,29]{2,1,0} aten::view(%3536), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3538 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3539 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3540 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3541 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3542 = bf16[3584,3584]{0,1} aten::permute(%3541), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3543 = bf16[29,3584]{1,0} aten::view(%3470), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3544 = bf16[29,3584]{1,0} aten::mm(%3543, %3542), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3545 = bf16[1,29,3584]{2,1,0} aten::view(%3544), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3546 = bf16[1,29,3584]{2,1,0} aten::add(%3545, %3540, %3539), scope=aten::add.958, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3547 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3546), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3548 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3547), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3549 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3548), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3550 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3548), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3551 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3550), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3552 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3551, %3549), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3553 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3552, %3499), scope=aten::mul.962, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3554 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3548, %3525), scope=aten::mul.961, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3555 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3554, %3553, %3538), scope=aten::add.963, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3556 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3555), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3557 = bf16[28,29,128]{2,1,0} aten::view(%3556), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3558 = bf16[28,29,29]{2,1,0} aten::matmul(%3557, %3537), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3559 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3558), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3560 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3559, %3487), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3561 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3560, %621, %3486), scope=aten::add.967, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3562 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3561), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3563 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3562), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3564 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3563), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3565 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3564), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3566 = bf16[28,29,29]{2,1,0} aten::view(%3565), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3567 = bf16[28,29,128]{2,1,0} aten::matmul(%3566, %3485), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3568 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3567), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3569 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3568), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3570 = bf16[1,29,3584]{2,1,0} aten::view(%3569), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3571 = bf16[29,3584]{1,0} aten::view(%3570), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3572 = bf16[29,3584]{1,0} aten::mm(%3571, %153), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3573 = bf16[1,29,3584]{2,1,0} aten::view(%3572), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3574 = bf16[1,29,3584]{2,1,0} aten::add(%3461, %3573, %151), scope=aten::add.968, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3575 = f32[1,29,3584]{2,1,0} xla::cast(%3574), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3576 = f32[1,29,3584]{2,1,0} aten::pow(%3575, %150), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3577 = f32[1,29,1]{2,1,0} aten::mean(%3576), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3578 = f32[1,29,1]{2,1,0} aten::add(%3577, %149, %148), scope=aten::add.969, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3579 = f32[1,29,1]{2,1,0} aten::rsqrt(%3578), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3580 = f32[1,29,3584]{2,1,0} aten::mul(%3575, %3579), scope=aten::mul.970, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3581 = bf16[1,29,3584]{2,1,0} xla::cast(%3580), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3582 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3583 = bf16[1,29,3584]{2,1,0} aten::mul(%3582, %3581), scope=aten::mul.971, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3584 = bf16[29,3584]{1,0} aten::view(%3583), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3585 = bf16[29,18944]{1,0} aten::mm(%3584, %147), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3586 = bf16[1,29,18944]{2,1,0} aten::view(%3585), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3587 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3588 = bf16[3584,18944]{0,1} aten::permute(%3587), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3589 = bf16[29,3584]{1,0} aten::view(%3583), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3590 = bf16[29,18944]{1,0} aten::mm(%3589, %3588), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3591 = bf16[1,29,18944]{2,1,0} aten::view(%3590), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3592 = bf16[1,29,18944]{2,1,0} aten::silu(%3591), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3593 = bf16[1,29,18944]{2,1,0} aten::mul(%3592, %3586), scope=aten::mul.972, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3594 = bf16[29,18944]{1,0} aten::view(%3593), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3595 = bf16[29,3584]{1,0} aten::mm(%3594, %145), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3596 = bf16[1,29,3584]{2,1,0} aten::view(%3595), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3597 = bf16[1,29,3584]{2,1,0} aten::add(%3574, %3596, %143), scope=aten::add.973, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3598 = f32[1,29,3584]{2,1,0} xla::cast(%3597), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3599 = f32[1,29,3584]{2,1,0} aten::pow(%3598, %142), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3600 = f32[1,29,1]{2,1,0} aten::mean(%3599), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3601 = f32[1,29,1]{2,1,0} aten::add(%3600, %141, %140), scope=aten::add.974, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3602 = f32[1,29,1]{2,1,0} aten::rsqrt(%3601), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3603 = f32[1,29,3584]{2,1,0} aten::mul(%3598, %3602), scope=aten::mul.975, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3604 = bf16[1,29,3584]{2,1,0} xla::cast(%3603), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3605 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3606 = bf16[1,29,3584]{2,1,0} aten::mul(%3605, %3604), scope=aten::mul.976, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3607 = bf16[29,3584]{1,0} aten::view(%3606), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3608 = bf16[29,512]{1,0} aten::mm(%3607, %139), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3609 = bf16[1,29,512]{2,1,0} aten::view(%3608), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3610 = bf16[1,29,512]{2,1,0} aten::add(%3609, %137, %136), scope=aten::add.979, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3611 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3610), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3612 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3611), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3613 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3612), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3614 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3613), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3615 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3614), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3616 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3615), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3617 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3616), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3618 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3617), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3619 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3618), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3620 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3619), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3621 = bf16[28,29,128]{2,1,0} aten::view(%3620), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3622 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3623 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3624 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3625 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3626 = s64[1,29]{1,0} aten::expand(%3625), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3627 = s64[1,29]{1,0} aten::add(%632, %3626), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3628 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3629 = pred[1,29]{1,0} aten::lt(%632, %3628), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3630 = s64[1,29]{1,0} aten::where(%3629, %3627, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3631 = s64[1,29,1]{2,1,0} aten::stack(%3630), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3632 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3633 = bf16[29,128]{1,0} xla::select(%3632), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3634 = bf16[1,29,128]{2,1,0} aten::index(%3633, %3631), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3635 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3634), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3636 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3637 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3638 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3639 = bf16[3584,512]{0,1} aten::permute(%3638), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3640 = bf16[29,3584]{1,0} aten::view(%3606), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3641 = bf16[29,512]{1,0} aten::mm(%3640, %3639), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3642 = bf16[1,29,512]{2,1,0} aten::view(%3641), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3643 = bf16[1,29,512]{2,1,0} aten::add(%3642, %3637, %3636), scope=aten::add.978, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3644 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3643), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3645 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3644), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3646 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3645), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3647 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3645), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3648 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3647), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3649 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3648, %3646), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3650 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3649, %3635), scope=aten::mul.984, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3651 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3652 = s64[1,29]{1,0} aten::expand(%3651), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3653 = s64[1,29]{1,0} aten::add(%632, %3652), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3654 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3655 = pred[1,29]{1,0} aten::lt(%632, %3654), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3656 = s64[1,29]{1,0} aten::where(%3655, %3653, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3657 = s64[1,29,1]{2,1,0} aten::stack(%3656), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3658 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3659 = bf16[29,128]{1,0} xla::select(%3658), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3660 = bf16[1,29,128]{2,1,0} aten::index(%3659, %3657), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3661 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3660), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3662 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3645, %3661), scope=aten::mul.983, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3663 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3662, %3650, %3624), scope=aten::add.985, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3664 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3663), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3665 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3664), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3666 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3665), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3667 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3666), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3668 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3667), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3669 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3668), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3670 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3669), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3671 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3670), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3672 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3671), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3673 = bf16[28,128,29]{2,1,0} aten::view(%3672), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3674 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3675 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3676 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3677 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3678 = bf16[3584,3584]{0,1} aten::permute(%3677), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3679 = bf16[29,3584]{1,0} aten::view(%3606), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3680 = bf16[29,3584]{1,0} aten::mm(%3679, %3678), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3681 = bf16[1,29,3584]{2,1,0} aten::view(%3680), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3682 = bf16[1,29,3584]{2,1,0} aten::add(%3681, %3676, %3675), scope=aten::add.977, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3683 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3682), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3684 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3683), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3685 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3684), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3686 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3684), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3687 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3686), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3688 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3687, %3685), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3689 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3688, %3635), scope=aten::mul.981, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3690 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3684, %3661), scope=aten::mul.980, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3691 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3690, %3689, %3674), scope=aten::add.982, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3692 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3691), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3693 = bf16[28,29,128]{2,1,0} aten::view(%3692), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3694 = bf16[28,29,29]{2,1,0} aten::matmul(%3693, %3673), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3695 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3694), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3696 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3695, %3623), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3697 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3696, %621, %3622), scope=aten::add.986, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3698 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3697), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3699 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3698), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3700 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3699), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3701 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3700), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3702 = bf16[28,29,29]{2,1,0} aten::view(%3701), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3703 = bf16[28,29,128]{2,1,0} aten::matmul(%3702, %3621), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3704 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3703), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3705 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3704), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3706 = bf16[1,29,3584]{2,1,0} aten::view(%3705), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3707 = bf16[29,3584]{1,0} aten::view(%3706), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3708 = bf16[29,3584]{1,0} aten::mm(%3707, %135), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3709 = bf16[1,29,3584]{2,1,0} aten::view(%3708), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3710 = bf16[1,29,3584]{2,1,0} aten::add(%3597, %3709, %133), scope=aten::add.987, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3711 = f32[1,29,3584]{2,1,0} xla::cast(%3710), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3712 = f32[1,29,3584]{2,1,0} aten::pow(%3711, %132), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3713 = f32[1,29,1]{2,1,0} aten::mean(%3712), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3714 = f32[1,29,1]{2,1,0} aten::add(%3713, %131, %130), scope=aten::add.988, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3715 = f32[1,29,1]{2,1,0} aten::rsqrt(%3714), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3716 = f32[1,29,3584]{2,1,0} aten::mul(%3711, %3715), scope=aten::mul.989, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3717 = bf16[1,29,3584]{2,1,0} xla::cast(%3716), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3718 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3719 = bf16[1,29,3584]{2,1,0} aten::mul(%3718, %3717), scope=aten::mul.990, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3720 = bf16[29,3584]{1,0} aten::view(%3719), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3721 = bf16[29,18944]{1,0} aten::mm(%3720, %129), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3722 = bf16[1,29,18944]{2,1,0} aten::view(%3721), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3723 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3724 = bf16[3584,18944]{0,1} aten::permute(%3723), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3725 = bf16[29,3584]{1,0} aten::view(%3719), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3726 = bf16[29,18944]{1,0} aten::mm(%3725, %3724), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3727 = bf16[1,29,18944]{2,1,0} aten::view(%3726), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3728 = bf16[1,29,18944]{2,1,0} aten::silu(%3727), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3729 = bf16[1,29,18944]{2,1,0} aten::mul(%3728, %3722), scope=aten::mul.991, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3730 = bf16[29,18944]{1,0} aten::view(%3729), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3731 = bf16[29,3584]{1,0} aten::mm(%3730, %127), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3732 = bf16[1,29,3584]{2,1,0} aten::view(%3731), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3733 = bf16[1,29,3584]{2,1,0} aten::add(%3710, %3732, %125), scope=aten::add.992, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3734 = f32[1,29,3584]{2,1,0} xla::cast(%3733), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3735 = f32[1,29,3584]{2,1,0} aten::pow(%3734, %124), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3736 = f32[1,29,1]{2,1,0} aten::mean(%3735), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3737 = f32[1,29,1]{2,1,0} aten::add(%3736, %123, %122), scope=aten::add.993, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3738 = f32[1,29,1]{2,1,0} aten::rsqrt(%3737), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3739 = f32[1,29,3584]{2,1,0} aten::mul(%3734, %3738), scope=aten::mul.994, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3740 = bf16[1,29,3584]{2,1,0} xla::cast(%3739), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3741 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3742 = bf16[1,29,3584]{2,1,0} aten::mul(%3741, %3740), scope=aten::mul.995, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3743 = bf16[29,3584]{1,0} aten::view(%3742), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3744 = bf16[29,512]{1,0} aten::mm(%3743, %121), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3745 = bf16[1,29,512]{2,1,0} aten::view(%3744), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3746 = bf16[1,29,512]{2,1,0} aten::add(%3745, %119, %118), scope=aten::add.998, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3747 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3746), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3748 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3747), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3749 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3748), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3750 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3749), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3751 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3750), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3752 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3751), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3753 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3752), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3754 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3753), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3755 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3754), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3756 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3755), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3757 = bf16[28,29,128]{2,1,0} aten::view(%3756), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3758 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3759 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3760 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3761 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3762 = s64[1,29]{1,0} aten::expand(%3761), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3763 = s64[1,29]{1,0} aten::add(%632, %3762), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3764 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3765 = pred[1,29]{1,0} aten::lt(%632, %3764), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3766 = s64[1,29]{1,0} aten::where(%3765, %3763, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3767 = s64[1,29,1]{2,1,0} aten::stack(%3766), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3768 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3769 = bf16[29,128]{1,0} xla::select(%3768), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3770 = bf16[1,29,128]{2,1,0} aten::index(%3769, %3767), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3771 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3770), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3772 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3773 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3774 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3775 = bf16[3584,512]{0,1} aten::permute(%3774), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3776 = bf16[29,3584]{1,0} aten::view(%3742), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3777 = bf16[29,512]{1,0} aten::mm(%3776, %3775), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3778 = bf16[1,29,512]{2,1,0} aten::view(%3777), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3779 = bf16[1,29,512]{2,1,0} aten::add(%3778, %3773, %3772), scope=aten::add.997, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3780 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3779), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3781 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3780), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3782 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3781), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3783 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3781), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3784 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3783), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3785 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3784, %3782), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3786 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3785, %3771), scope=aten::mul.1003, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3787 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3788 = s64[1,29]{1,0} aten::expand(%3787), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3789 = s64[1,29]{1,0} aten::add(%632, %3788), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3790 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3791 = pred[1,29]{1,0} aten::lt(%632, %3790), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3792 = s64[1,29]{1,0} aten::where(%3791, %3789, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3793 = s64[1,29,1]{2,1,0} aten::stack(%3792), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3794 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3795 = bf16[29,128]{1,0} xla::select(%3794), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3796 = bf16[1,29,128]{2,1,0} aten::index(%3795, %3793), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3797 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3796), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3798 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3781, %3797), scope=aten::mul.1002, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3799 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3798, %3786, %3760), scope=aten::add.1004, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3800 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3799), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3801 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3800), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3802 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3801), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3803 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3802), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3804 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3803), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3805 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3804), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3806 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3805), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3807 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3806), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3808 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3807), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3809 = bf16[28,128,29]{2,1,0} aten::view(%3808), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3810 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3811 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3812 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3813 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3814 = bf16[3584,3584]{0,1} aten::permute(%3813), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3815 = bf16[29,3584]{1,0} aten::view(%3742), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3816 = bf16[29,3584]{1,0} aten::mm(%3815, %3814), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3817 = bf16[1,29,3584]{2,1,0} aten::view(%3816), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3818 = bf16[1,29,3584]{2,1,0} aten::add(%3817, %3812, %3811), scope=aten::add.996, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3819 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3818), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3820 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3819), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3821 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3820), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3822 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3820), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3823 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3822), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3824 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3823, %3821), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3825 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3824, %3771), scope=aten::mul.1000, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3826 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3820, %3797), scope=aten::mul.999, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3827 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3826, %3825, %3810), scope=aten::add.1001, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3828 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3827), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3829 = bf16[28,29,128]{2,1,0} aten::view(%3828), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3830 = bf16[28,29,29]{2,1,0} aten::matmul(%3829, %3809), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3831 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3830), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3832 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3831, %3759), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3833 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3832, %621, %3758), scope=aten::add.1005, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3834 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3833), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3835 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3834), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3836 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3835), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3837 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3836), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3838 = bf16[28,29,29]{2,1,0} aten::view(%3837), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3839 = bf16[28,29,128]{2,1,0} aten::matmul(%3838, %3757), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3840 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3839), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3841 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3840), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3842 = bf16[1,29,3584]{2,1,0} aten::view(%3841), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3843 = bf16[29,3584]{1,0} aten::view(%3842), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3844 = bf16[29,3584]{1,0} aten::mm(%3843, %117), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3845 = bf16[1,29,3584]{2,1,0} aten::view(%3844), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3846 = bf16[1,29,3584]{2,1,0} aten::add(%3733, %3845, %115), scope=aten::add.1006, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3847 = f32[1,29,3584]{2,1,0} xla::cast(%3846), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3848 = f32[1,29,3584]{2,1,0} aten::pow(%3847, %114), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3849 = f32[1,29,1]{2,1,0} aten::mean(%3848), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3850 = f32[1,29,1]{2,1,0} aten::add(%3849, %113, %112), scope=aten::add.1007, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3851 = f32[1,29,1]{2,1,0} aten::rsqrt(%3850), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3852 = f32[1,29,3584]{2,1,0} aten::mul(%3847, %3851), scope=aten::mul.1008, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3853 = bf16[1,29,3584]{2,1,0} xla::cast(%3852), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3854 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3855 = bf16[1,29,3584]{2,1,0} aten::mul(%3854, %3853), scope=aten::mul.1009, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3856 = bf16[29,3584]{1,0} aten::view(%3855), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3857 = bf16[29,18944]{1,0} aten::mm(%3856, %111), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3858 = bf16[1,29,18944]{2,1,0} aten::view(%3857), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3859 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3860 = bf16[3584,18944]{0,1} aten::permute(%3859), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3861 = bf16[29,3584]{1,0} aten::view(%3855), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3862 = bf16[29,18944]{1,0} aten::mm(%3861, %3860), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3863 = bf16[1,29,18944]{2,1,0} aten::view(%3862), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3864 = bf16[1,29,18944]{2,1,0} aten::silu(%3863), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %3865 = bf16[1,29,18944]{2,1,0} aten::mul(%3864, %3858), scope=aten::mul.1010, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %3866 = bf16[29,18944]{1,0} aten::view(%3865), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3867 = bf16[29,3584]{1,0} aten::mm(%3866, %109), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3868 = bf16[1,29,3584]{2,1,0} aten::view(%3867), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3869 = bf16[1,29,3584]{2,1,0} aten::add(%3846, %3868, %107), scope=aten::add.1011, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %3870 = f32[1,29,3584]{2,1,0} xla::cast(%3869), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3871 = f32[1,29,3584]{2,1,0} aten::pow(%3870, %106), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3872 = f32[1,29,1]{2,1,0} aten::mean(%3871), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3873 = f32[1,29,1]{2,1,0} aten::add(%3872, %105, %104), scope=aten::add.1012, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3874 = f32[1,29,1]{2,1,0} aten::rsqrt(%3873), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3875 = f32[1,29,3584]{2,1,0} aten::mul(%3870, %3874), scope=aten::mul.1013, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3876 = bf16[1,29,3584]{2,1,0} xla::cast(%3875), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3877 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3878 = bf16[1,29,3584]{2,1,0} aten::mul(%3877, %3876), scope=aten::mul.1014, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3879 = bf16[29,3584]{1,0} aten::view(%3878), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3880 = bf16[29,512]{1,0} aten::mm(%3879, %103), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3881 = bf16[1,29,512]{2,1,0} aten::view(%3880), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3882 = bf16[1,29,512]{2,1,0} aten::add(%3881, %101, %100), scope=aten::add.1017, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3883 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3882), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3884 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3883), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3885 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3884), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3886 = bf16[1,4,29,128]{3,1,2,0} xla::select(%3885), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3887 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3886), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3888 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3887), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3889 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3888), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3890 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3889), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3891 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3890), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3892 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3891), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3893 = bf16[28,29,128]{2,1,0} aten::view(%3892), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3894 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %3895 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %3896 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %3897 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3898 = s64[1,29]{1,0} aten::expand(%3897), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3899 = s64[1,29]{1,0} aten::add(%632, %3898), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3900 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %3901 = pred[1,29]{1,0} aten::lt(%632, %3900), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %3902 = s64[1,29]{1,0} aten::where(%3901, %3899, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %3903 = s64[1,29,1]{2,1,0} aten::stack(%3902), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %3904 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3905 = bf16[29,128]{1,0} xla::select(%3904), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %3906 = bf16[1,29,128]{2,1,0} aten::index(%3905, %3903), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %3907 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3906), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3908 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3909 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %3910 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %3911 = bf16[3584,512]{0,1} aten::permute(%3910), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %3912 = bf16[29,3584]{1,0} aten::view(%3878), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3913 = bf16[29,512]{1,0} aten::mm(%3912, %3911), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %3914 = bf16[1,29,512]{2,1,0} aten::view(%3913), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3915 = bf16[1,29,512]{2,1,0} aten::add(%3914, %3909, %3908), scope=aten::add.1016, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %3916 = bf16[1,29,4,128]{3,2,1,0} aten::view(%3915), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %3917 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%3916), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %3918 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3917), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3919 = bf16[1,4,29,64]{3,1,2,0} xla::select(%3917), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3920 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%3919), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %3921 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%3920, %3918), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3922 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3921, %3907), scope=aten::mul.1022, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3923 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3924 = s64[1,29]{1,0} aten::expand(%3923), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3925 = s64[1,29]{1,0} aten::add(%632, %3924), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3926 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %3927 = pred[1,29]{1,0} aten::lt(%632, %3926), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %3928 = s64[1,29]{1,0} aten::where(%3927, %3925, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %3929 = s64[1,29,1]{2,1,0} aten::stack(%3928), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %3930 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %3931 = bf16[29,128]{1,0} xla::select(%3930), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %3932 = bf16[1,29,128]{2,1,0} aten::index(%3931, %3929), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %3933 = bf16[1,1,29,128]{3,2,1,0} aten::view(%3932), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %3934 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%3917, %3933), scope=aten::mul.1021, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3935 = bf16[1,4,29,128]{3,2,1,0} aten::add(%3934, %3922, %3896), scope=aten::add.1023, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3936 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3935), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3937 = bf16[1,4,29,128]{3,2,1,0} xla::select(%3936), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %3938 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%3937), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3939 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3938), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3940 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%3939), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %3941 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%3940), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %3942 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3941), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3943 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%3942), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %3944 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%3943), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %3945 = bf16[28,128,29]{2,1,0} aten::view(%3944), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %3946 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %3947 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %3948 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3949 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %3950 = bf16[3584,3584]{0,1} aten::permute(%3949), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %3951 = bf16[29,3584]{1,0} aten::view(%3878), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3952 = bf16[29,3584]{1,0} aten::mm(%3951, %3950), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3953 = bf16[1,29,3584]{2,1,0} aten::view(%3952), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3954 = bf16[1,29,3584]{2,1,0} aten::add(%3953, %3948, %3947), scope=aten::add.1015, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3955 = bf16[1,29,28,128]{3,2,1,0} aten::view(%3954), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %3956 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%3955), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %3957 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3956), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3958 = bf16[1,28,29,64]{3,1,2,0} xla::select(%3956), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3959 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%3958), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %3960 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%3959, %3957), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3961 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3960, %3907), scope=aten::mul.1019, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3962 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%3956, %3933), scope=aten::mul.1018, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3963 = bf16[1,28,29,128]{3,2,1,0} aten::add(%3962, %3961, %3946), scope=aten::add.1020, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3964 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%3963), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3965 = bf16[28,29,128]{2,1,0} aten::view(%3964), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %3966 = bf16[28,29,29]{2,1,0} aten::matmul(%3965, %3945), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %3967 = bf16[1,28,29,29]{3,2,1,0} aten::view(%3966), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3968 = bf16[1,28,29,29]{3,2,1,0} aten::div(%3967, %3895), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3969 = bf16[1,28,29,29]{3,2,1,0} aten::add(%3968, %621, %3894), scope=aten::add.1024, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3970 = f32[1,28,29,29]{3,2,1,0} xla::cast(%3969), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3971 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%3970), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %3972 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%3971), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3973 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%3972), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %3974 = bf16[28,29,29]{2,1,0} aten::view(%3973), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %3975 = bf16[28,29,128]{2,1,0} aten::matmul(%3974, %3893), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %3976 = bf16[1,28,29,128]{3,2,1,0} aten::view(%3975), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %3977 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%3976), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %3978 = bf16[1,29,3584]{2,1,0} aten::view(%3977), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %3979 = bf16[29,3584]{1,0} aten::view(%3978), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3980 = bf16[29,3584]{1,0} aten::mm(%3979, %99), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3981 = bf16[1,29,3584]{2,1,0} aten::view(%3980), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %3982 = bf16[1,29,3584]{2,1,0} aten::add(%3869, %3981, %97), scope=aten::add.1025, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %3983 = f32[1,29,3584]{2,1,0} xla::cast(%3982), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %3984 = f32[1,29,3584]{2,1,0} aten::pow(%3983, %96), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %3985 = f32[1,29,1]{2,1,0} aten::mean(%3984), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %3986 = f32[1,29,1]{2,1,0} aten::add(%3985, %95, %94), scope=aten::add.1026, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3987 = f32[1,29,1]{2,1,0} aten::rsqrt(%3986), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %3988 = f32[1,29,3584]{2,1,0} aten::mul(%3983, %3987), scope=aten::mul.1027, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %3989 = bf16[1,29,3584]{2,1,0} xla::cast(%3988), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3990 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %3991 = bf16[1,29,3584]{2,1,0} aten::mul(%3990, %3989), scope=aten::mul.1028, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %3992 = bf16[29,3584]{1,0} aten::view(%3991), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3993 = bf16[29,18944]{1,0} aten::mm(%3992, %93), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3994 = bf16[1,29,18944]{2,1,0} aten::view(%3993), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %3995 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %3996 = bf16[3584,18944]{0,1} aten::permute(%3995), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %3997 = bf16[29,3584]{1,0} aten::view(%3991), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %3998 = bf16[29,18944]{1,0} aten::mm(%3997, %3996), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %3999 = bf16[1,29,18944]{2,1,0} aten::view(%3998), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4000 = bf16[1,29,18944]{2,1,0} aten::silu(%3999), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4001 = bf16[1,29,18944]{2,1,0} aten::mul(%4000, %3994), scope=aten::mul.1029, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4002 = bf16[29,18944]{1,0} aten::view(%4001), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4003 = bf16[29,3584]{1,0} aten::mm(%4002, %91), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4004 = bf16[1,29,3584]{2,1,0} aten::view(%4003), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4005 = bf16[1,29,3584]{2,1,0} aten::add(%3982, %4004, %89), scope=aten::add.1030, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4006 = f32[1,29,3584]{2,1,0} xla::cast(%4005), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4007 = f32[1,29,3584]{2,1,0} aten::pow(%4006, %88), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4008 = f32[1,29,1]{2,1,0} aten::mean(%4007), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4009 = f32[1,29,1]{2,1,0} aten::add(%4008, %87, %86), scope=aten::add.1031, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4010 = f32[1,29,1]{2,1,0} aten::rsqrt(%4009), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4011 = f32[1,29,3584]{2,1,0} aten::mul(%4006, %4010), scope=aten::mul.1032, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4012 = bf16[1,29,3584]{2,1,0} xla::cast(%4011), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4013 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4014 = bf16[1,29,3584]{2,1,0} aten::mul(%4013, %4012), scope=aten::mul.1033, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4015 = bf16[29,3584]{1,0} aten::view(%4014), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4016 = bf16[29,512]{1,0} aten::mm(%4015, %85), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4017 = bf16[1,29,512]{2,1,0} aten::view(%4016), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4018 = bf16[1,29,512]{2,1,0} aten::add(%4017, %83, %82), scope=aten::add.1036, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4019 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4018), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4020 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4019), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4021 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4020), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4022 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4021), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4023 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4022), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4024 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4023), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4025 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4024), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4026 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4025), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4027 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4026), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4028 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4027), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4029 = bf16[28,29,128]{2,1,0} aten::view(%4028), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4030 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4031 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4032 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4033 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4034 = s64[1,29]{1,0} aten::expand(%4033), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4035 = s64[1,29]{1,0} aten::add(%632, %4034), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4036 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4037 = pred[1,29]{1,0} aten::lt(%632, %4036), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4038 = s64[1,29]{1,0} aten::where(%4037, %4035, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4039 = s64[1,29,1]{2,1,0} aten::stack(%4038), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4040 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4041 = bf16[29,128]{1,0} xla::select(%4040), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4042 = bf16[1,29,128]{2,1,0} aten::index(%4041, %4039), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4043 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4042), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4044 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4045 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4046 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4047 = bf16[3584,512]{0,1} aten::permute(%4046), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4048 = bf16[29,3584]{1,0} aten::view(%4014), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4049 = bf16[29,512]{1,0} aten::mm(%4048, %4047), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4050 = bf16[1,29,512]{2,1,0} aten::view(%4049), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4051 = bf16[1,29,512]{2,1,0} aten::add(%4050, %4045, %4044), scope=aten::add.1035, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4052 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4051), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4053 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4052), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4054 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4053), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4055 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4053), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4056 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4055), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4057 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4056, %4054), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4058 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4057, %4043), scope=aten::mul.1041, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4059 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4060 = s64[1,29]{1,0} aten::expand(%4059), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4061 = s64[1,29]{1,0} aten::add(%632, %4060), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4062 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4063 = pred[1,29]{1,0} aten::lt(%632, %4062), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4064 = s64[1,29]{1,0} aten::where(%4063, %4061, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4065 = s64[1,29,1]{2,1,0} aten::stack(%4064), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4066 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4067 = bf16[29,128]{1,0} xla::select(%4066), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4068 = bf16[1,29,128]{2,1,0} aten::index(%4067, %4065), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4069 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4068), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4070 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4053, %4069), scope=aten::mul.1040, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4071 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4070, %4058, %4032), scope=aten::add.1042, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4072 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4071), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4073 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4072), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4074 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4073), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4075 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4074), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4076 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4075), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4077 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4076), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4078 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4077), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4079 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4078), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4080 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4079), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4081 = bf16[28,128,29]{2,1,0} aten::view(%4080), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4082 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4083 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4084 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4085 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4086 = bf16[3584,3584]{0,1} aten::permute(%4085), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4087 = bf16[29,3584]{1,0} aten::view(%4014), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4088 = bf16[29,3584]{1,0} aten::mm(%4087, %4086), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4089 = bf16[1,29,3584]{2,1,0} aten::view(%4088), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4090 = bf16[1,29,3584]{2,1,0} aten::add(%4089, %4084, %4083), scope=aten::add.1034, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4091 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4090), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4092 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4091), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4093 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4092), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4094 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4092), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4095 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4094), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4096 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4095, %4093), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4097 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4096, %4043), scope=aten::mul.1038, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4098 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4092, %4069), scope=aten::mul.1037, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4099 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4098, %4097, %4082), scope=aten::add.1039, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4100 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4099), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4101 = bf16[28,29,128]{2,1,0} aten::view(%4100), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4102 = bf16[28,29,29]{2,1,0} aten::matmul(%4101, %4081), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4103 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4102), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4104 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4103, %4031), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4105 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4104, %621, %4030), scope=aten::add.1043, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4106 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4105), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4107 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4106), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4108 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4107), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4109 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4108), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4110 = bf16[28,29,29]{2,1,0} aten::view(%4109), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4111 = bf16[28,29,128]{2,1,0} aten::matmul(%4110, %4029), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4112 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4111), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4113 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4112), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4114 = bf16[1,29,3584]{2,1,0} aten::view(%4113), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4115 = bf16[29,3584]{1,0} aten::view(%4114), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4116 = bf16[29,3584]{1,0} aten::mm(%4115, %81), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4117 = bf16[1,29,3584]{2,1,0} aten::view(%4116), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4118 = bf16[1,29,3584]{2,1,0} aten::add(%4005, %4117, %79), scope=aten::add.1044, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4119 = f32[1,29,3584]{2,1,0} xla::cast(%4118), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4120 = f32[1,29,3584]{2,1,0} aten::pow(%4119, %78), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4121 = f32[1,29,1]{2,1,0} aten::mean(%4120), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4122 = f32[1,29,1]{2,1,0} aten::add(%4121, %77, %76), scope=aten::add.1045, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4123 = f32[1,29,1]{2,1,0} aten::rsqrt(%4122), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4124 = f32[1,29,3584]{2,1,0} aten::mul(%4119, %4123), scope=aten::mul.1046, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4125 = bf16[1,29,3584]{2,1,0} xla::cast(%4124), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4126 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4127 = bf16[1,29,3584]{2,1,0} aten::mul(%4126, %4125), scope=aten::mul.1047, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4128 = bf16[29,3584]{1,0} aten::view(%4127), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4129 = bf16[29,18944]{1,0} aten::mm(%4128, %75), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4130 = bf16[1,29,18944]{2,1,0} aten::view(%4129), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4131 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4132 = bf16[3584,18944]{0,1} aten::permute(%4131), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4133 = bf16[29,3584]{1,0} aten::view(%4127), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4134 = bf16[29,18944]{1,0} aten::mm(%4133, %4132), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4135 = bf16[1,29,18944]{2,1,0} aten::view(%4134), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4136 = bf16[1,29,18944]{2,1,0} aten::silu(%4135), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4137 = bf16[1,29,18944]{2,1,0} aten::mul(%4136, %4130), scope=aten::mul.1048, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4138 = bf16[29,18944]{1,0} aten::view(%4137), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4139 = bf16[29,3584]{1,0} aten::mm(%4138, %73), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4140 = bf16[1,29,3584]{2,1,0} aten::view(%4139), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4141 = bf16[1,29,3584]{2,1,0} aten::add(%4118, %4140, %71), scope=aten::add.1049, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4142 = f32[1,29,3584]{2,1,0} xla::cast(%4141), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4143 = f32[1,29,3584]{2,1,0} aten::pow(%4142, %70), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4144 = f32[1,29,1]{2,1,0} aten::mean(%4143), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4145 = f32[1,29,1]{2,1,0} aten::add(%4144, %69, %68), scope=aten::add.1050, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4146 = f32[1,29,1]{2,1,0} aten::rsqrt(%4145), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4147 = f32[1,29,3584]{2,1,0} aten::mul(%4142, %4146), scope=aten::mul.1051, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4148 = bf16[1,29,3584]{2,1,0} xla::cast(%4147), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4149 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4150 = bf16[1,29,3584]{2,1,0} aten::mul(%4149, %4148), scope=aten::mul.1052, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4151 = bf16[29,3584]{1,0} aten::view(%4150), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4152 = bf16[29,512]{1,0} aten::mm(%4151, %67), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4153 = bf16[1,29,512]{2,1,0} aten::view(%4152), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4154 = bf16[1,29,512]{2,1,0} aten::add(%4153, %65, %64), scope=aten::add.1055, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4155 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4154), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4156 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4155), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4157 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4156), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4158 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4157), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4159 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4158), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4160 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4159), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4161 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4160), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4162 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4161), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4163 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4162), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4164 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4163), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4165 = bf16[28,29,128]{2,1,0} aten::view(%4164), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4166 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4167 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4168 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4169 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4170 = s64[1,29]{1,0} aten::expand(%4169), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4171 = s64[1,29]{1,0} aten::add(%632, %4170), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4172 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4173 = pred[1,29]{1,0} aten::lt(%632, %4172), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4174 = s64[1,29]{1,0} aten::where(%4173, %4171, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4175 = s64[1,29,1]{2,1,0} aten::stack(%4174), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4176 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4177 = bf16[29,128]{1,0} xla::select(%4176), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4178 = bf16[1,29,128]{2,1,0} aten::index(%4177, %4175), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4179 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4178), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4180 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4181 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4182 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4183 = bf16[3584,512]{0,1} aten::permute(%4182), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4184 = bf16[29,3584]{1,0} aten::view(%4150), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4185 = bf16[29,512]{1,0} aten::mm(%4184, %4183), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4186 = bf16[1,29,512]{2,1,0} aten::view(%4185), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4187 = bf16[1,29,512]{2,1,0} aten::add(%4186, %4181, %4180), scope=aten::add.1054, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4188 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4187), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4189 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4188), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4190 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4189), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4191 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4189), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4192 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4191), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4193 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4192, %4190), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4194 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4193, %4179), scope=aten::mul.1060, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4195 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4196 = s64[1,29]{1,0} aten::expand(%4195), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4197 = s64[1,29]{1,0} aten::add(%632, %4196), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4198 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4199 = pred[1,29]{1,0} aten::lt(%632, %4198), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4200 = s64[1,29]{1,0} aten::where(%4199, %4197, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4201 = s64[1,29,1]{2,1,0} aten::stack(%4200), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4202 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4203 = bf16[29,128]{1,0} xla::select(%4202), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4204 = bf16[1,29,128]{2,1,0} aten::index(%4203, %4201), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4205 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4204), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4206 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4189, %4205), scope=aten::mul.1059, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4207 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4206, %4194, %4168), scope=aten::add.1061, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4208 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4207), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4209 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4208), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4210 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4209), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4211 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4210), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4212 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4211), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4213 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4212), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4214 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4213), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4215 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4214), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4216 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4215), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4217 = bf16[28,128,29]{2,1,0} aten::view(%4216), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4218 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4219 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4220 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4221 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4222 = bf16[3584,3584]{0,1} aten::permute(%4221), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4223 = bf16[29,3584]{1,0} aten::view(%4150), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4224 = bf16[29,3584]{1,0} aten::mm(%4223, %4222), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4225 = bf16[1,29,3584]{2,1,0} aten::view(%4224), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4226 = bf16[1,29,3584]{2,1,0} aten::add(%4225, %4220, %4219), scope=aten::add.1053, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4227 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4226), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4228 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4227), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4229 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4228), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4230 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4228), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4231 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4230), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4232 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4231, %4229), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4233 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4232, %4179), scope=aten::mul.1057, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4234 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4228, %4205), scope=aten::mul.1056, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4235 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4234, %4233, %4218), scope=aten::add.1058, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4236 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4235), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4237 = bf16[28,29,128]{2,1,0} aten::view(%4236), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4238 = bf16[28,29,29]{2,1,0} aten::matmul(%4237, %4217), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4239 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4238), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4240 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4239, %4167), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4241 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4240, %621, %4166), scope=aten::add.1062, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4242 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4241), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4243 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4242), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4244 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4243), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4245 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4244), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4246 = bf16[28,29,29]{2,1,0} aten::view(%4245), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4247 = bf16[28,29,128]{2,1,0} aten::matmul(%4246, %4165), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4248 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4247), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4249 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4248), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4250 = bf16[1,29,3584]{2,1,0} aten::view(%4249), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4251 = bf16[29,3584]{1,0} aten::view(%4250), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4252 = bf16[29,3584]{1,0} aten::mm(%4251, %63), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4253 = bf16[1,29,3584]{2,1,0} aten::view(%4252), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4254 = bf16[1,29,3584]{2,1,0} aten::add(%4141, %4253, %61), scope=aten::add.1063, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4255 = f32[1,29,3584]{2,1,0} xla::cast(%4254), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4256 = f32[1,29,3584]{2,1,0} aten::pow(%4255, %60), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4257 = f32[1,29,1]{2,1,0} aten::mean(%4256), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4258 = f32[1,29,1]{2,1,0} aten::add(%4257, %59, %58), scope=aten::add.1064, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4259 = f32[1,29,1]{2,1,0} aten::rsqrt(%4258), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4260 = f32[1,29,3584]{2,1,0} aten::mul(%4255, %4259), scope=aten::mul.1065, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4261 = bf16[1,29,3584]{2,1,0} xla::cast(%4260), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4262 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4263 = bf16[1,29,3584]{2,1,0} aten::mul(%4262, %4261), scope=aten::mul.1066, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4264 = bf16[29,3584]{1,0} aten::view(%4263), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4265 = bf16[29,18944]{1,0} aten::mm(%4264, %57), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4266 = bf16[1,29,18944]{2,1,0} aten::view(%4265), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4267 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4268 = bf16[3584,18944]{0,1} aten::permute(%4267), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4269 = bf16[29,3584]{1,0} aten::view(%4263), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4270 = bf16[29,18944]{1,0} aten::mm(%4269, %4268), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4271 = bf16[1,29,18944]{2,1,0} aten::view(%4270), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4272 = bf16[1,29,18944]{2,1,0} aten::silu(%4271), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4273 = bf16[1,29,18944]{2,1,0} aten::mul(%4272, %4266), scope=aten::mul.1067, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4274 = bf16[29,18944]{1,0} aten::view(%4273), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4275 = bf16[29,3584]{1,0} aten::mm(%4274, %55), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4276 = bf16[1,29,3584]{2,1,0} aten::view(%4275), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4277 = bf16[1,29,3584]{2,1,0} aten::add(%4254, %4276, %53), scope=aten::add.1068, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4278 = f32[1,29,3584]{2,1,0} xla::cast(%4277), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4279 = f32[1,29,3584]{2,1,0} aten::pow(%4278, %52), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4280 = f32[1,29,1]{2,1,0} aten::mean(%4279), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4281 = f32[1,29,1]{2,1,0} aten::add(%4280, %51, %50), scope=aten::add.1069, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4282 = f32[1,29,1]{2,1,0} aten::rsqrt(%4281), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4283 = f32[1,29,3584]{2,1,0} aten::mul(%4278, %4282), scope=aten::mul.1070, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4284 = bf16[1,29,3584]{2,1,0} xla::cast(%4283), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4285 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4286 = bf16[1,29,3584]{2,1,0} aten::mul(%4285, %4284), scope=aten::mul.1071, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4287 = bf16[29,3584]{1,0} aten::view(%4286), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4288 = bf16[29,512]{1,0} aten::mm(%4287, %49), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4289 = bf16[1,29,512]{2,1,0} aten::view(%4288), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4290 = bf16[1,29,512]{2,1,0} aten::add(%4289, %47, %46), scope=aten::add.1074, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4291 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4290), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4292 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4291), location=forward@modeling_qwen2.py:255, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4293 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4292), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4294 = bf16[1,4,29,128]{3,1,2,0} xla::select(%4293), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4295 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4294), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4296 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4295), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4297 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4296), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4298 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4297), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4299 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4298), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4300 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4299), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4301 = bf16[28,29,128]{2,1,0} aten::view(%4300), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4302 = bf16[] prim::Constant(), location=forward@modeling_qwen2.py:291, xla_shape=bf16[]
  %4303 = bf16[] xla::device_data(), location=forward@modeling_qwen2.py:277, xla_shape=bf16[]
  %4304 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[]
  %4305 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4306 = s64[1,29]{1,0} aten::expand(%4305), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4307 = s64[1,29]{1,0} aten::add(%632, %4306), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4308 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[]
  %4309 = pred[1,29]{1,0} aten::lt(%632, %4308), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=pred[1,29]{1,0}
  %4310 = s64[1,29]{1,0} aten::where(%4309, %4307, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29]{1,0}
  %4311 = s64[1,29,1]{2,1,0} aten::stack(%4310), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=s64[1,29,1]{2,1,0}
  %4312 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4313 = bf16[29,128]{1,0} xla::select(%4312), location=forward@modeling_qwen2.py:125, xla_shape=bf16[29,128]{1,0}
  %4314 = bf16[1,29,128]{2,1,0} aten::index(%4313, %4311), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,29,128]{2,1,0}
  %4315 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4314), location=apply_rotary_pos_emb@modeling_qwen2.py:160, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4316 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4317 = bf16[512]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512]{0}
  %4318 = bf16[512,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[512,3584]{1,0}
  %4319 = bf16[3584,512]{0,1} aten::permute(%4318), location=forward@linear.py:117, xla_shape=bf16[3584,512]{0,1}
  %4320 = bf16[29,3584]{1,0} aten::view(%4286), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4321 = bf16[29,512]{1,0} aten::mm(%4320, %4319), location=forward@linear.py:117, xla_shape=bf16[29,512]{1,0}
  %4322 = bf16[1,29,512]{2,1,0} aten::view(%4321), location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4323 = bf16[1,29,512]{2,1,0} aten::add(%4322, %4317, %4316), scope=aten::add.1073, location=forward@linear.py:117, xla_shape=bf16[1,29,512]{2,1,0}
  %4324 = bf16[1,29,4,128]{3,2,1,0} aten::view(%4323), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,29,4,128]{3,2,1,0}
  %4325 = bf16[1,4,29,128]{3,1,2,0} aten::permute(%4324), location=forward@modeling_qwen2.py:254, xla_shape=bf16[1,4,29,128]{3,1,2,0}
  %4326 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4325), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4327 = bf16[1,4,29,64]{3,1,2,0} xla::select(%4325), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4328 = bf16[1,4,29,64]{3,1,2,0} aten::neg(%4327), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,64]{3,1,2,0}
  %4329 = bf16[1,4,29,128]{3,2,1,0} aten::cat(%4328, %4326), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4330 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4329, %4315), scope=aten::mul.1079, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4331 = s64[] xla::device_data(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4332 = s64[1,29]{1,0} aten::expand(%4331), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4333 = s64[1,29]{1,0} aten::add(%632, %4332), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4334 = s64[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[]
  %4335 = pred[1,29]{1,0} aten::lt(%632, %4334), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=pred[1,29]{1,0}
  %4336 = s64[1,29]{1,0} aten::where(%4335, %4333, %632), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29]{1,0}
  %4337 = s64[1,29,1]{2,1,0} aten::stack(%4336), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=s64[1,29,1]{2,1,0}
  %4338 = bf16[32768,128]{1,0} xla::device_data(), location=convert@module.py:1160, xla_shape=bf16[32768,128]{1,0}
  %4339 = bf16[29,128]{1,0} xla::select(%4338), location=forward@modeling_qwen2.py:124, xla_shape=bf16[29,128]{1,0}
  %4340 = bf16[1,29,128]{2,1,0} aten::index(%4339, %4337), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,29,128]{2,1,0}
  %4341 = bf16[1,1,29,128]{3,2,1,0} aten::view(%4340), location=apply_rotary_pos_emb@modeling_qwen2.py:159, xla_shape=bf16[1,1,29,128]{3,2,1,0}
  %4342 = bf16[1,4,29,128]{3,2,1,0} aten::mul(%4325, %4341), scope=aten::mul.1078, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4343 = bf16[1,4,29,128]{3,2,1,0} aten::add(%4342, %4330, %4304), scope=aten::add.1080, location=apply_rotary_pos_emb@modeling_qwen2.py:162, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4344 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4343), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4345 = bf16[1,4,29,128]{3,2,1,0} xla::select(%4344), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,29,128]{3,2,1,0}
  %4346 = bf16[1,4,1,29,128]{4,3,2,1,0} aten::view(%4345), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4347 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4346), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4348 = bf16[1,4,1,29,128]{4,3,2,1,0} xla::select(%4347), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,1,29,128]{4,3,2,1,0}
  %4349 = bf16[1,4,7,29,128]{4,3,2,1,0} aten::expand(%4348), location=repeat_kv@modeling_qwen2.py:191, xla_shape=bf16[1,4,7,29,128]{4,3,2,1,0}
  %4350 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4349), location=repeat_kv@modeling_qwen2.py:192, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4351 = bf16[1,28,128,29]{2,3,1,0} aten::permute(%4350), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{2,3,1,0}
  %4352 = bf16[1,28,128,29]{3,2,1,0} aten::expand(%4351), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,128,29]{3,2,1,0}
  %4353 = bf16[28,128,29]{2,1,0} aten::view(%4352), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,128,29]{2,1,0}
  %4354 = bf16[] prim::Constant(), location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[]
  %4355 = bf16[] prim::Constant(), location=forward@linear.py:117, xla_shape=bf16[]
  %4356 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4357 = bf16[3584,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584,3584]{1,0}
  %4358 = bf16[3584,3584]{0,1} aten::permute(%4357), location=forward@linear.py:117, xla_shape=bf16[3584,3584]{0,1}
  %4359 = bf16[29,3584]{1,0} aten::view(%4286), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4360 = bf16[29,3584]{1,0} aten::mm(%4359, %4358), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4361 = bf16[1,29,3584]{2,1,0} aten::view(%4360), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4362 = bf16[1,29,3584]{2,1,0} aten::add(%4361, %4356, %4355), scope=aten::add.1072, location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4363 = bf16[1,29,28,128]{3,2,1,0} aten::view(%4362), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,29,28,128]{3,2,1,0}
  %4364 = bf16[1,28,29,128]{3,1,2,0} aten::permute(%4363), location=forward@modeling_qwen2.py:253, xla_shape=bf16[1,28,29,128]{3,1,2,0}
  %4365 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4364), location=rotate_half@modeling_qwen2.py:132, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4366 = bf16[1,28,29,64]{3,1,2,0} xla::select(%4364), location=rotate_half@modeling_qwen2.py:133, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4367 = bf16[1,28,29,64]{3,1,2,0} aten::neg(%4366), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,64]{3,1,2,0}
  %4368 = bf16[1,28,29,128]{3,2,1,0} aten::cat(%4367, %4365), location=rotate_half@modeling_qwen2.py:134, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4369 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4368, %4315), scope=aten::mul.1076, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4370 = bf16[1,28,29,128]{3,2,1,0} aten::mul(%4364, %4341), scope=aten::mul.1075, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4371 = bf16[1,28,29,128]{3,2,1,0} aten::add(%4370, %4369, %4354), scope=aten::add.1077, location=apply_rotary_pos_emb@modeling_qwen2.py:161, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4372 = bf16[1,28,29,128]{3,2,1,0} aten::expand(%4371), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4373 = bf16[28,29,128]{2,1,0} aten::view(%4372), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,128]{2,1,0}
  %4374 = bf16[28,29,29]{2,1,0} aten::matmul(%4373, %4353), location=forward@modeling_qwen2.py:277, xla_shape=bf16[28,29,29]{2,1,0}
  %4375 = bf16[1,28,29,29]{3,2,1,0} aten::view(%4374), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4376 = bf16[1,28,29,29]{3,2,1,0} aten::div(%4375, %4303), location=forward@modeling_qwen2.py:277, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4377 = bf16[1,28,29,29]{3,2,1,0} aten::add(%4376, %621, %4302), scope=aten::add.1081, location=forward@modeling_qwen2.py:291, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4378 = f32[1,28,29,29]{3,2,1,0} xla::cast(%4377), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4379 = f32[1,28,29,29]{3,2,1,0} aten::softmax(%4378), location=softmax@functional.py:1890, xla_shape=f32[1,28,29,29]{3,2,1,0}
  %4380 = bf16[1,28,29,29]{3,2,1,0} xla::cast(%4379), location=forward@modeling_qwen2.py:294, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4381 = bf16[1,28,29,29]{3,2,1,0} aten::expand(%4380), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,29]{3,2,1,0}
  %4382 = bf16[28,29,29]{2,1,0} aten::view(%4381), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,29]{2,1,0}
  %4383 = bf16[28,29,128]{2,1,0} aten::matmul(%4382, %4301), location=forward@modeling_qwen2.py:296, xla_shape=bf16[28,29,128]{2,1,0}
  %4384 = bf16[1,28,29,128]{3,2,1,0} aten::view(%4383), location=forward@modeling_qwen2.py:296, xla_shape=bf16[1,28,29,128]{3,2,1,0}
  %4385 = bf16[1,29,28,128]{3,1,2,0} aten::permute(%4384), location=forward@modeling_qwen2.py:304, xla_shape=bf16[1,29,28,128]{3,1,2,0}
  %4386 = bf16[1,29,3584]{2,1,0} aten::view(%4385), location=forward@modeling_qwen2.py:305, xla_shape=bf16[1,29,3584]{2,1,0}
  %4387 = bf16[29,3584]{1,0} aten::view(%4386), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4388 = bf16[29,3584]{1,0} aten::mm(%4387, %45), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4389 = bf16[1,29,3584]{2,1,0} aten::view(%4388), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4390 = bf16[1,29,3584]{2,1,0} aten::add(%4277, %4389, %43), scope=aten::add.1082, location=forward@modeling_qwen2.py:756, xla_shape=bf16[1,29,3584]{2,1,0}
  %4391 = f32[1,29,3584]{2,1,0} xla::cast(%4390), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4392 = f32[1,29,3584]{2,1,0} aten::pow(%4391, %42), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4393 = f32[1,29,1]{2,1,0} aten::mean(%4392), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4394 = f32[1,29,1]{2,1,0} aten::add(%4393, %41, %40), scope=aten::add.1083, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4395 = f32[1,29,1]{2,1,0} aten::rsqrt(%4394), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4396 = f32[1,29,3584]{2,1,0} aten::mul(%4391, %4395), scope=aten::mul.1084, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4397 = bf16[1,29,3584]{2,1,0} xla::cast(%4396), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4398 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4399 = bf16[1,29,3584]{2,1,0} aten::mul(%4398, %4397), scope=aten::mul.1085, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4400 = bf16[29,3584]{1,0} aten::view(%4399), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4401 = bf16[29,18944]{1,0} aten::mm(%4400, %39), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4402 = bf16[1,29,18944]{2,1,0} aten::view(%4401), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4403 = bf16[18944,3584]{1,0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[18944,3584]{1,0}
  %4404 = bf16[3584,18944]{0,1} aten::permute(%4403), location=forward@linear.py:117, xla_shape=bf16[3584,18944]{0,1}
  %4405 = bf16[29,3584]{1,0} aten::view(%4399), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4406 = bf16[29,18944]{1,0} aten::mm(%4405, %4404), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4407 = bf16[1,29,18944]{2,1,0} aten::view(%4406), location=forward@linear.py:117, xla_shape=bf16[1,29,18944]{2,1,0}
  %4408 = bf16[1,29,18944]{2,1,0} aten::silu(%4407), location=silu@functional.py:2105, xla_shape=bf16[1,29,18944]{2,1,0}
  %4409 = bf16[1,29,18944]{2,1,0} aten::mul(%4408, %4402), scope=aten::mul.1086, location=forward@modeling_qwen2.py:179, xla_shape=bf16[1,29,18944]{2,1,0}
  %4410 = bf16[29,18944]{1,0} aten::view(%4409), location=forward@linear.py:117, xla_shape=bf16[29,18944]{1,0}
  %4411 = bf16[29,3584]{1,0} aten::mm(%4410, %37), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4412 = bf16[1,29,3584]{2,1,0} aten::view(%4411), location=forward@linear.py:117, xla_shape=bf16[1,29,3584]{2,1,0}
  %4413 = bf16[1,29,3584]{2,1,0} aten::add(%4390, %4412, %35), scope=aten::add.1087, location=forward@modeling_qwen2.py:762, xla_shape=bf16[1,29,3584]{2,1,0}
  %4414 = f32[1,29,3584]{2,1,0} xla::cast(%4413), location=forward@modeling_qwen2.py:86, xla_shape=f32[1,29,3584]{2,1,0}
  %4415 = f32[1,29,3584]{2,1,0} aten::pow(%4414, %34), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,3584]{2,1,0}
  %4416 = f32[1,29,1]{2,1,0} aten::mean(%4415), location=forward@modeling_qwen2.py:87, xla_shape=f32[1,29,1]{2,1,0}
  %4417 = f32[1,29,1]{2,1,0} aten::add(%4416, %33, %32), scope=aten::add.1088, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4418 = f32[1,29,1]{2,1,0} aten::rsqrt(%4417), location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,1]{2,1,0}
  %4419 = f32[1,29,3584]{2,1,0} aten::mul(%4414, %4418), scope=aten::mul.1089, location=forward@modeling_qwen2.py:88, xla_shape=f32[1,29,3584]{2,1,0}
  %4420 = bf16[1,29,3584]{2,1,0} xla::cast(%4419), location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4421 = bf16[3584]{0} xla::device_data(), location=set_module_tensor_to_device@modeling.py:416, xla_shape=bf16[3584]{0}
  %4422 = bf16[1,29,3584]{2,1,0} aten::mul(%4421, %4420), scope=aten::mul.1090, location=forward@modeling_qwen2.py:89, xla_shape=bf16[1,29,3584]{2,1,0}
  %4423 = bf16[29,3584]{1,0} aten::view(%4422), location=forward@linear.py:117, xla_shape=bf16[29,3584]{1,0}
  %4424 = bf16[29,152064]{1,0} aten::mm(%4423, %31), location=forward@linear.py:117, xla_shape=bf16[29,152064]{1,0}
  %4425 = bf16[1,29,152064]{2,1,0} aten::view(%4424), location=forward@linear.py:117, xla_shape=bf16[1,29,152064]{2,1,0}
  %4426 = f32[1,29,152064]{2,1,0} xla::cast(%4425), location=forward@modeling_qwen2.py:1163, xla_shape=f32[1,29,152064]{2,1,0}
  %4427 = f32[1,29,152064]{2,1,0} xla::select(%4426), location=_sample@utils.py:2407, xla_shape=f32[1,29,152064]{2,1,0}
  %4428 = f32[1,1,152064]{2,1,0} xla::generic_slice(%4427), location=_sample@utils.py:2407, xla_shape=f32[1,1,152064]{2,1,0}
  %4429 = f32[1,152064]{1,0} aten::view(%4428), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4430 = f32[1,152064]{1,0} xla::select(%4429), location=_sample@utils.py:2407, xla_shape=f32[1,152064]{1,0}
  %4431 = f32[1,29]{1,0} aten::gather(%4430, %29), location=__call__@logits_process.py:341, xla_shape=f32[1,29]{1,0}
  %4432 = f32[1,29]{1,0} aten::div(%4431, %25), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4433 = f32[] xla::device_data(), location=__call__@logits_process.py:344, xla_shape=f32[]
  %4434 = f32[1,29]{1,0} aten::mul(%4431, %4433), scope=aten::mul.1091, location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4435 = s64[] prim::Constant(), location=__call__@logits_process.py:344, xla_shape=s64[]
  %4436 = pred[1,29]{1,0} aten::lt(%4431, %4435), location=__call__@logits_process.py:344, xla_shape=pred[1,29]{1,0}
  %4437 = f32[1,29]{1,0} aten::where(%4436, %4434, %4432), location=__call__@logits_process.py:344, xla_shape=f32[1,29]{1,0}
  %4438 = f32[1,152064]{1,0} aten::scatter(%4430, %29, %4437), location=__call__@logits_process.py:346, xla_shape=f32[1,152064]{1,0}
  %4439 = f32[1,152064]{1,0} aten::div(%4438, %24), location=__call__@logits_process.py:292, xla_shape=f32[1,152064]{1,0}
  %4440 = (f32[1,20]{1,0}, s64[1,20]{1,0}) aten::topk(%4439), num_outputs=2, location=__call__@logits_process.py:520, xla_shape=(f32[1,20]{1,0}, s64[1,20]{1,0})
  %4441 = f32[1,1]{1,0} xla::generic_slice(%4440.0), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4442 = f32[1]{0} aten::view(%4441), location=__call__@logits_process.py:520, xla_shape=f32[1]{0}
  %4443 = f32[1,1]{1,0} aten::view(%4442), location=__call__@logits_process.py:520, xla_shape=f32[1,1]{1,0}
  %4444 = pred[1,152064]{1,0} aten::lt(%4439, %4443), location=__call__@logits_process.py:520, xla_shape=pred[1,152064]{1,0}
  %4445 = f32[1,152064]{1,0} aten::masked_fill(%4439, %4444, %23), location=__call__@logits_process.py:521, xla_shape=f32[1,152064]{1,0}
  %4446 = (f32[1,152064]{1,0}, s64[1,152064]{1,0}) aten::topk(%4445), num_outputs=2, location=__call__@logits_process.py:458, xla_shape=(f32[1,152064]{1,0}, s64[1,152064]{1,0})
  %4447 = f32[1,152064]{1,0} aten::softmax(%4446.0), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4448 = f32[1,152064]{1,0} aten::cumsum(%4447), location=__call__@logits_process.py:459, xla_shape=f32[1,152064]{1,0}
  %4449 = pred[1,152064]{1,0} aten::le(%4448, %22), location=__call__@logits_process.py:462, xla_shape=pred[1,152064]{1,0}
  %4450 = pred[1,152064]{1,0} xla::unselect(%4449, %21), location=__call__@logits_process.py:464, xla_shape=pred[1,152064]{1,0}
  %4451 = pred[1,152064]{1,0} aten::scatter(%4450, %4446.1, %4450), location=__call__@logits_process.py:467, xla_shape=pred[1,152064]{1,0}
  %4452 = f32[1,152064]{1,0} aten::masked_fill(%4445, %4451, %17), location=__call__@logits_process.py:468, xla_shape=f32[1,152064]{1,0}
  %4453 = f32[1,152064]{1,0} aten::softmax(%4452), location=softmax@functional.py:1888, xla_shape=f32[1,152064]{1,0}
  %4454 = s64[1,1]{1,0} aten::multinomial(%4453, %16), location=_sample@utils.py:2437, xla_shape=s64[1,1]{1,0}
  %4455 = s64[1]{0} aten::view(%4454), location=_sample@utils.py:2437, xla_shape=s64[1]{0}
  %4456 = s64[1]{0} aten::mul(%4455, %4), scope=aten::mul.1092, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4457 = s64[1]{0} aten::add(%4456, %7, %0), scope=aten::add.1095, location=_sample@utils.py:2443, xla_shape=s64[1]{0}
  %4458 = s64[1]{0} xla::select(%4457), location=_sample@utils.py:2446, xla_shape=s64[1]{0}
  %4459 = s64[1,1]{1,0} aten::view(%4458), location=_sample@utils.py:2446, xla_shape=s64[1,1]{1,0}
  %4460 = s64[1,30]{1,0} aten::cat(%29, %4459), location=_sample@utils.py:2446, xla_shape=s64[1,30]{1,0}
  %4461 = s64[1,30]{1,0} xla::generic_slice(%4460), location=__iter__@_tensor.py:1053, xla_shape=s64[1,30]{1,0}
  %4462 = s64[30]{0} aten::view(%4461), location=__iter__@_tensor.py:1053, xla_shape=s64[30]{0}
  %4463 = s64[1]{0} xla::select(%4462), location=<listcomp>@2982293035.py:16, xla_shape=s64[1]{0}, ROOT=0
}

Graph Hash: da7b43c826b585ca56802acd21927a22

## END_GRAPH

